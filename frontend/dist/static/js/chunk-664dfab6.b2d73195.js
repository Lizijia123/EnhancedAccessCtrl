(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-664dfab6"],{"898f":function(e,t,a){"use strict";a("c0fa")},"8b83":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-form-container"},[a("el-form",{ref:"appForm",staticClass:"form-container",attrs:{model:e.appForm,rules:e.rules}},[a("sticky",{attrs:{"z-index":10,"class-name":"sub-navbar "+e.appForm.status}},[a("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:e.confirmForm}},[e._v(" Confirm ")]),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"danger"},on:{click:e.deleteForm}},[e._v(" Delete ")])],1),a("div",{staticClass:"app-form-main-container"},[a("div",{staticClass:"form-header"},[a("div",{staticClass:"home-icon"},[a("i",{staticClass:"el-icon-s-home"})]),a("h2",{staticClass:"form-title"},[e._v(e._s(e.title))])]),a("div",{staticClass:"section-header"},[a("h3",[e._v("Basic Information")]),a("div",{staticClass:"lock-icon"},[a("i",{staticClass:"el-icon-lock"})])]),a("el-row",[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"APP Name",prop:"appName"}},[a("el-input",{attrs:{placeholder:"The application name of the target application. Eg. Humhub."},model:{value:e.appForm.appName,callback:function(t){e.$set(e.appForm,"appName",t)},expression:"appForm.appName"}})],1),a("el-form-item",{attrs:{label:"APP URL",prop:"appUrl"}},[a("el-input",{attrs:{placeholder:"The URL of the target application's home page. Eg. http://111.229.33.190:8081/"},model:{value:e.appForm.appUrl,callback:function(t){e.$set(e.appForm,"appUrl",t)},expression:"appForm.appUrl"}})],1),a("el-form-item",{attrs:{label:"User Behavior Cycle",prop:"userBehaviorCycle"}},[a("el-input-number",{attrs:{min:1,max:100,"controls-position":"right"},model:{value:e.appForm.userBehaviorCycle,callback:function(t){e.$set(e.appForm,"userBehaviorCycle",t)},expression:"appForm.userBehaviorCycle"}}),a("span",{staticClass:"input-description"},[e._v("The total number of API calls in a common business process within this APP, generally between 10 and 30.")])],1),a("el-form-item",{attrs:{label:"SFWAP Address",prop:"sfwapAddress"}},[a("el-input",{attrs:{placeholder:"Deployment address (IP address and port number) of the SWAFP - Access Control"},model:{value:e.appForm.sfwapAddress,callback:function(t){e.$set(e.appForm,"sfwapAddress",t)},expression:"appForm.sfwapAddress"}})],1),a("el-form-item",{attrs:{label:"Description",prop:"description"}},[a("el-input",{attrs:{type:"textarea",rows:6,placeholder:"Description of APP functions, permission management mechanisms and system status."},model:{value:e.appForm.description,callback:function(t){e.$set(e.appForm,"description",t)},expression:"appForm.description"}})],1)],1)],1),a("div",{staticClass:"credentials-section"},[a("h3",[e._v("User Login Credentials List")]),a("div",{staticClass:"credentials-container"},[a("div",{staticClass:"credentials-header"},[a("div",{staticClass:"credential-column"},[e._v("User Role")]),a("div",{staticClass:"credential-column"},[e._v("Username")]),a("div",{staticClass:"credential-column"},[e._v("Password")]),a("div",{staticClass:"credential-column action-column"})]),a("div",{staticClass:"credentials-body"},e._l(e.appForm.credentials,(function(t,r){return a("div",{key:r,staticClass:"credential-row"},[a("div",{staticClass:"credential-column"},[a("el-input",{attrs:{placeholder:"User Role"},model:{value:t.role,callback:function(a){e.$set(t,"role",a)},expression:"credential.role"}})],1),a("div",{staticClass:"credential-column"},[a("el-input",{attrs:{placeholder:"Username"},model:{value:t.username,callback:function(a){e.$set(t,"username",a)},expression:"credential.username"}})],1),a("div",{staticClass:"credential-column"},[a("el-input",{attrs:{placeholder:"Password"},model:{value:t.password,callback:function(a){e.$set(t,"password",a)},expression:"credential.password"}})],1),a("div",{staticClass:"credential-column action-column"},[a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(t){return e.removeCredential(r)}}})],1)])})),0)]),a("div",{staticClass:"add-credential"},[a("el-button",{attrs:{type:"primary",icon:"el-icon-plus",circle:""},on:{click:e.addCredential}})],1)])],1)],1)],1)},i=[],n=a("c7eb"),s=a("1da1"),o=(a("a4d3"),a("e01a"),a("d81d"),a("a434"),a("d3b7"),a("0643"),a("a573"),a("b804")),c=a("61f7"),l=a("949f"),p={status:"draft",appName:"",appUrl:"",userBehaviorCycle:10,sfwapAddress:"",description:"",credentials:[]},u={name:"TargetAppForm",components:{Sticky:o["a"]},props:{isEdit:{type:Boolean,default:!1}},data:function(){var e=this,t=function(t,a,r){""===a?(e.$message({message:t.field+" is required",type:"error"}),r(new Error(t.field+" is required"))):r()},a=function(t,a,r){a?Object(c["d"])(a)?r():(e.$message({message:"URL format is incorrect",type:"error"}),r(new Error("URL format is incorrect"))):r()};return{appForm:Object.assign({},p),loading:!1,rules:{appName:[{validator:t}],appUrl:[{validator:a,trigger:"blur"}],sfwapAddress:[{validator:t}]},title:""}},created:function(){var e=this.$route.params&&this.$route.params.id;void 0!==e?(this.title="Edit Target APP",this.fetchData(e)):this.title="New Target APP"},methods:{fetchData:function(e){var t=this;return Object(s["a"])(Object(n["a"])().mark((function a(){var r,i;return Object(n["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.loading=!0,a.prev=1,a.next=4,Object(l["j"])({id:e});case 4:r=a.sent,i=r.data,t.appForm={status:i.is_draft?"draft":"published",appName:i.APP_name,appUrl:i.APP_url,userBehaviorCycle:i.user_behavior_cycle,sfwapAddress:i.SFWAP_address,description:i.description,credentials:i.login_credentials.map((function(e){return{role:e.user_role,username:e.username,password:e.password}}))},a.next=12;break;case 9:a.prev=9,a.t0=a["catch"](1),console.error("Failed to fetch app details:",a.t0);case 12:return a.prev=12,t.loading=!1,a.finish(12);case 15:case"end":return a.stop()}}),a,null,[[1,9,12,15]])})))()},addCredential:function(){this.appForm.credentials.push({role:"",username:"",password:""})},removeCredential:function(e){this.appForm.credentials.splice(e,1)},confirmForm:function(){var e=this;return Object(s["a"])(Object(n["a"])().mark((function t(){return Object(n["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$refs.appForm.validate(function(){var t=Object(s["a"])(Object(n["a"])().mark((function t(a){var r,i;return Object(n["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!a){t.next=25;break}if(e.loading=!0,t.prev=2,r=e.$route.params&&e.$route.params.id,i={APP_name:e.appForm.appName,APP_url:e.appForm.appUrl,user_behavior_cycle:e.appForm.userBehaviorCycle,SFWAP_address:e.appForm.sfwapAddress,description:e.appForm.description,login_credentials:e.appForm.credentials.map((function(e){return{user_role:e.role,username:e.username,password:e.password}}))},void 0!==r){t.next=10;break}return t.next=8,Object(l["n"])(i);case 8:t.next=12;break;case 10:return t.next=12,Object(l["o"])(r,i);case 12:e.$notify({title:"Success",message:"Form submitted successfully",type:"success",duration:2e3}),e.$router.go(-1),t.next=20;break;case 16:t.prev=16,t.t0=t["catch"](2),console.error("Failed to submit form:",t.t0),e.$notify({title:"Error",message:"Failed to submit form",type:"error",duration:2e3});case 20:return t.prev=20,e.loading=!1,t.finish(20);case 23:t.next=27;break;case 25:return console.log("error submit!!"),t.abrupt("return",!1);case 27:case"end":return t.stop()}}),t,null,[[2,16,20,23]])})));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}}),t)})))()},deleteForm:function(){var e=this;this.$confirm("Are you sure you want to delete this form?","Warning",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then((function(){e.$message({type:"success",message:"Delete completed"})})).catch((function(){e.$message({type:"info",message:"Delete canceled"})}))}}},d=u,m=(a("898f"),a("2877")),f=Object(m["a"])(d,r,i,!1,null,"847be630",null);t["default"]=f.exports},"949f":function(e,t,a){"use strict";a.d(t,"f",(function(){return i})),a.d(t,"j",(function(){return n})),a.d(t,"o",(function(){return s})),a.d(t,"n",(function(){return o})),a.d(t,"k",(function(){return c})),a.d(t,"r",(function(){return l})),a.d(t,"q",(function(){return p})),a.d(t,"a",(function(){return u})),a.d(t,"g",(function(){return d})),a.d(t,"i",(function(){return m})),a.d(t,"m",(function(){return f})),a.d(t,"l",(function(){return h})),a.d(t,"e",(function(){return v})),a.d(t,"d",(function(){return b})),a.d(t,"b",(function(){return g})),a.d(t,"c",(function(){return y})),a.d(t,"h",(function(){return w})),a.d(t,"p",(function(){return C}));var r=a("b775");function i(e){return Object(r["a"])({url:"/api/target-app-list/",method:"get",params:e})}function n(e){return Object(r["a"])({url:"/api/target-app/",method:"get",params:e})}function s(e,t){return Object(r["a"])({url:"/api/target-app/",method:"put",params:{id:e},data:t})}function o(e){return Object(r["a"])({url:"/api/target-app/",method:"post",params:{},data:e})}function c(e){return Object(r["a"])({url:"/api/detection/features/",method:"get",params:e})}function l(e,t){return Object(r["a"])({url:"/api/detection/features/",method:"put",params:{app_id:e},data:t})}function p(e,t){return Object(r["a"])({url:"/api/detection/config/",method:"put",params:{app_id:e},data:t})}function u(e){return Object(r["a"])({url:"/api/api-discovery/start/",method:"get",params:e})}function d(e){return Object(r["a"])({url:"/api/api-discovery/status/",method:"get",params:e})}function m(e){return Object(r["a"])({url:"/api/api-discovery/manual/status/",method:"get",params:e})}function f(e){return Object(r["a"])({url:"/api/model-construct",method:"get",params:e})}function h(e){return Object(r["a"])({url:"/api/model-construct/data-collection-status/",method:"get",params:e})}function v(e){return Object(r["a"])({url:"/api/detection/start/",method:"get",params:e})}function b(e){return Object(r["a"])({url:"/api/detection/pause/",method:"get",params:e})}function g(e){return Object(r["a"])({url:"/api/api-discovery/cancel/",method:"get",params:e})}function y(e){return Object(r["a"])({url:"/api/api-discovery/finish/",method:"get",params:e})}function w(e){return Object(r["a"])({url:"/api/api-lists/",method:"get",params:e})}function C(e,t){return Object(r["a"])({url:"/api/v2/user-api-list/",method:"put",params:{app_id:e},data:t})}},b804:function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{style:{height:e.height+"px",zIndex:e.zIndex}},[a("div",{class:e.className,style:{top:e.isSticky?e.stickyTop+"px":"",zIndex:e.zIndex,position:e.position,width:e.width,height:e.height+"px"}},[e._t("default",[a("div",[e._v("sticky")])])],2)])},i=[],n=(a("a9e3"),a("2c3e"),{name:"Sticky",props:{stickyTop:{type:Number,default:0},zIndex:{type:Number,default:1},className:{type:String,default:""}},data:function(){return{active:!1,position:"",width:void 0,height:void 0,isSticky:!1}},mounted:function(){this.height=this.$el.getBoundingClientRect().height,window.addEventListener("scroll",this.handleScroll),window.addEventListener("resize",this.handleResize)},activated:function(){this.handleScroll()},destroyed:function(){window.removeEventListener("scroll",this.handleScroll),window.removeEventListener("resize",this.handleResize)},methods:{sticky:function(){this.active||(this.position="fixed",this.active=!0,this.width=this.width+"px",this.isSticky=!0)},handleReset:function(){this.active&&this.reset()},reset:function(){this.position="",this.width="auto",this.active=!1,this.isSticky=!1},handleScroll:function(){var e=this.$el.getBoundingClientRect().width;this.width=e||"auto";var t=this.$el.getBoundingClientRect().top;t<this.stickyTop?this.sticky():this.handleReset()},handleResize:function(){this.isSticky&&(this.width=this.$el.getBoundingClientRect().width+"px")}}}),s=n,o=a("2877"),c=Object(o["a"])(s,r,i,!1,null,null,null);t["a"]=c.exports},c0fa:function(e,t,a){}}]);