2025-03-06 20:25:11,905 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 30, Feature size: 7
2025-03-06 20:25:13,762 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 30, Feature size: 7
2025-03-06 20:25:29,318 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 30, Feature size: 7
2025-03-06 20:25:31,118 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 30, Feature size: 7
2025-03-06 20:25:33,962 - INFO - Trying to construct model...
2025-03-06 20:25:33,963 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-06 20:25:34,012 - INFO - Training model... Size of feature_list: 7
2025-03-06 20:25:34,025 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:34,028 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:34,029 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:34,030 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:34,032 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:34,033 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:34,034 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:34,035 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:34,123 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:34,125 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:34,126 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:34,127 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:34,140 - INFO - Model constructed.
2025-03-06 20:25:37,679 - INFO - Trying to construct model...
2025-03-06 20:25:37,679 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-06 20:25:37,707 - INFO - Training model... Size of feature_list: 7
2025-03-06 20:25:37,715 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:37,716 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:37,717 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:37,718 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:37,720 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:37,721 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:37,722 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:37,723 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:37,750 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:37,751 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:37,753 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:37,754 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:37,765 - INFO - Model constructed.
2025-03-06 20:25:47,719 - INFO - Trying to construct model...
2025-03-06 20:25:47,719 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-06 20:25:47,749 - INFO - Training model... Size of feature_list: 7
2025-03-06 20:25:47,756 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:47,758 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:47,759 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:47,760 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:47,762 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:47,763 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:47,764 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:47,765 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:47,826 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:47,828 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:47,829 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:47,831 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:47,856 - INFO - Model constructed.
2025-03-06 20:25:51,217 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-06 20:25:51,277 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-06 20:25:51,308 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-06 20:25:51,308 - INFO - Generating simulated API sequences...
2025-03-06 20:25:51,308 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-06 20:25:52,692 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_8'], malicious_sign_seq=[0, 1] ==========
2025-03-06 20:25:52,692 - INFO - API sequence 1/12 generated
2025-03-06 20:25:52,692 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-06 20:25:53,813 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-06 20:25:53,813 - INFO - API sequence 2/12 generated
2025-03-06 20:25:53,813 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-06 20:25:54,112 - INFO - Trying to construct model...
2025-03-06 20:25:54,113 - INFO - DATA_COLLECTION_STATUS: IN_PROGRESS
2025-03-06 20:25:55,033 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[1] ==========
2025-03-06 20:25:55,033 - INFO - API sequence 3/12 generated
2025-03-06 20:25:55,033 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-06 20:25:56,199 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[1] ==========
2025-03-06 20:25:56,199 - INFO - API sequence 4/12 generated
2025-03-06 20:25:56,199 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-06 20:25:57,332 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-06 20:25:57,332 - INFO - API sequence 5/12 generated
2025-03-06 20:25:57,332 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-06 20:25:58,466 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-06 20:25:58,466 - INFO - API sequence 6/12 generated
2025-03-06 20:25:58,466 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-06 20:25:59,866 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_8'], malicious_sign_seq=[0, 1] ==========
2025-03-06 20:25:59,866 - INFO - API sequence 7/12 generated
2025-03-06 20:25:59,867 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-06 20:26:01,248 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_8'], malicious_sign_seq=[0, 1] ==========
2025-03-06 20:26:01,249 - INFO - API sequence 8/12 generated
2025-03-06 20:26:01,249 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-06 20:26:02,459 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[1] ==========
2025-03-06 20:26:02,459 - INFO - API sequence 9/12 generated
2025-03-06 20:26:02,459 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-06 20:26:03,588 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-06 20:26:03,588 - INFO - API sequence 10/12 generated
2025-03-06 20:26:03,589 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-06 20:26:04,835 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-06 20:26:04,835 - INFO - API sequence 11/12 generated
2025-03-06 20:26:04,835 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-06 20:26:05,960 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-06 20:26:05,960 - INFO - API sequence 12/12 generated
2025-03-06 20:26:05,961 - INFO - API sequences serialized to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py/serialized_llm_agents.json
2025-03-06 20:26:05,961 - INFO - Generating simulated traffic data set...
2025-03-06 20:26:05,961 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-06 20:26:05,961 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-06 20:26:05,961 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-06 20:26:05,961 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-06 20:26:05,961 - INFO - Simulated traffic data for 1/12 user collected：user: normaluser malicious: True
2025-03-06 20:26:05,961 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-06 20:26:05,961 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-06 20:26:05,962 - INFO - Simulated traffic data for 2/12 user collected：user: adminuser malicious: False
2025-03-06 20:26:05,962 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-06 20:26:05,962 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-06 20:26:05,962 - INFO - Simulated traffic data for 3/12 user collected：user: unloggeduser malicious: True
2025-03-06 20:26:05,962 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-06 20:26:05,962 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-06 20:26:05,962 - INFO - Simulated traffic data for 4/12 user collected：user: unloggeduser malicious: True
2025-03-06 20:26:05,962 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-06 20:26:05,962 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-06 20:26:05,962 - INFO - Simulated traffic data for 5/12 user collected：user: normaluser malicious: False
2025-03-06 20:26:05,962 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-06 20:26:05,962 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-06 20:26:05,963 - INFO - Simulated traffic data for 6/12 user collected：user: normaluser malicious: False
2025-03-06 20:26:05,963 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-06 20:26:05,963 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-06 20:26:05,963 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-06 20:26:05,963 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-06 20:26:05,963 - INFO - Simulated traffic data for 7/12 user collected：user: normaluser malicious: True
2025-03-06 20:26:05,963 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-06 20:26:05,963 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-06 20:26:05,963 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-06 20:26:05,963 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-06 20:26:05,963 - INFO - Simulated traffic data for 8/12 user collected：user: normaluser malicious: True
2025-03-06 20:26:05,964 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-06 20:26:05,964 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-06 20:26:05,964 - INFO - Simulated traffic data for 9/12 user collected：user: unloggeduser malicious: True
2025-03-06 20:26:05,964 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-06 20:26:05,964 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-06 20:26:05,964 - INFO - Simulated traffic data for 10/12 user collected：user: normaluser malicious: False
2025-03-06 20:26:05,964 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-06 20:26:05,964 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-06 20:26:05,964 - INFO - Simulated traffic data for 11/12 user collected：user: adminuser malicious: False
2025-03-06 20:26:05,964 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-06 20:26:05,964 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-06 20:26:05,964 - INFO - Simulated traffic data for 12/12 user collected：user: normaluser malicious: False
2025-03-06 20:26:05,967 - INFO - All simulated traffic data collected：/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/simulated_traffic_data.csv
2025-03-06 20:28:34,180 - INFO - Trying to construct model...
2025-03-06 20:28:34,180 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-06 20:28:34,208 - INFO - Training model... Size of feature_list: 7
2025-03-06 20:28:34,216 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:28:34,218 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:28:34,218 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:28:34,220 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:28:34,221 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:28:34,222 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:28:34,223 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:28:34,224 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:28:34,325 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:28:34,326 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:28:34,327 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:28:34,328 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:28:34,342 - INFO - Model constructed.
2025-03-08 16:50:21,253 - INFO - Trying to construct model...
2025-03-08 16:50:21,253 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-08 16:50:21,282 - INFO - Training model... Size of feature_list: 6
2025-03-08 16:50:21,290 - INFO - Extracting features... Size of feature_list: 6
2025-03-08 16:50:21,291 - INFO - Extracting features... Size of feature_list: 6
2025-03-08 16:50:21,292 - INFO - Extracting features... Size of feature_list: 6
2025-03-08 16:50:21,293 - INFO - Extracting features... Size of feature_list: 6
2025-03-08 16:50:21,294 - INFO - Extracting features... Size of feature_list: 6
2025-03-08 16:50:21,295 - INFO - Extracting features... Size of feature_list: 6
2025-03-08 16:50:21,296 - INFO - Extracting features... Size of feature_list: 6
2025-03-08 16:50:21,297 - INFO - Extracting features... Size of feature_list: 6
2025-03-08 16:50:21,332 - INFO - Extracting features... Size of feature_list: 6
2025-03-08 16:50:21,334 - INFO - Extracting features... Size of feature_list: 6
2025-03-08 16:50:21,335 - INFO - Extracting features... Size of feature_list: 6
2025-03-08 16:50:21,336 - INFO - Extracting features... Size of feature_list: 6
2025-03-08 16:50:21,347 - INFO - Model constructed.
2025-03-09 12:13:47,157 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-09 12:13:47,222 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-09 12:13:47,222 - INFO - Extracting API list with API discovery algorithm...
2025-03-09 12:13:47,286 - INFO - Starting Drain3 template miner
2025-03-09 12:13:47,289 - INFO - Starting Drain3 template miner
2025-03-09 12:13:47,290 - INFO - Starting Drain3 template miner
2025-03-09 12:13:47,291 - INFO - Starting Drain3 template miner
2025-03-09 12:13:47,292 - INFO - Starting Drain3 template miner
2025-03-09 12:13:48,680 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-09 12:59:20,569 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-09 12:59:20,618 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-09 12:59:20,618 - INFO - Extracting API list with API discovery algorithm...
2025-03-09 12:59:20,679 - INFO - Starting Drain3 template miner
2025-03-09 12:59:20,682 - INFO - Starting Drain3 template miner
2025-03-09 12:59:20,684 - INFO - Starting Drain3 template miner
2025-03-09 12:59:20,684 - INFO - Starting Drain3 template miner
2025-03-09 12:59:20,685 - INFO - Starting Drain3 template miner
2025-03-09 12:59:22,154 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-09 12:59:22,738 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-09 12:59:22,781 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-09 12:59:22,781 - INFO - Extracting API list with API discovery algorithm...
2025-03-09 12:59:22,842 - INFO - Starting Drain3 template miner
2025-03-09 12:59:22,845 - INFO - Starting Drain3 template miner
2025-03-09 12:59:22,847 - INFO - Starting Drain3 template miner
2025-03-09 12:59:22,847 - INFO - Starting Drain3 template miner
2025-03-09 12:59:22,848 - INFO - Starting Drain3 template miner
2025-03-09 12:59:24,331 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-09 14:04:56,858 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-09 14:04:56,912 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-09 14:04:56,961 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-09 14:04:56,962 - INFO - Generating simulated API sequences...
2025-03-09 14:04:56,962 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-09 14:04:58,384 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_8'], malicious_sign_seq=[0, 1] ==========
2025-03-09 14:04:58,385 - INFO - API sequence 1/12 generated
2025-03-09 14:04:58,385 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-09 14:04:59,695 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-09 14:04:59,695 - INFO - API sequence 2/12 generated
2025-03-09 14:04:59,695 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-09 14:05:00,907 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-09 14:05:00,907 - INFO - API sequence 3/12 generated
2025-03-09 14:05:00,907 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-09 14:05:02,174 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[1] ==========
2025-03-09 14:05:02,174 - INFO - API sequence 4/12 generated
2025-03-09 14:05:02,174 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-09 14:05:03,323 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-09 14:05:03,324 - INFO - API sequence 5/12 generated
2025-03-09 14:05:03,324 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-09 14:05:04,840 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_8'], malicious_sign_seq=[0, 1] ==========
2025-03-09 14:05:04,840 - INFO - API sequence 6/12 generated
2025-03-09 14:05:04,840 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-09 14:05:05,966 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-09 14:05:05,967 - INFO - API sequence 7/12 generated
2025-03-09 14:05:05,967 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-09 14:05:06,950 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-09 14:05:06,996 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-09 14:05:06,996 - INFO - Extracting API list with API discovery algorithm...
2025-03-09 14:05:07,062 - INFO - Starting Drain3 template miner
2025-03-09 14:05:07,064 - INFO - Starting Drain3 template miner
2025-03-09 14:05:07,066 - INFO - Starting Drain3 template miner
2025-03-09 14:05:07,067 - INFO - Starting Drain3 template miner
2025-03-09 14:05:07,067 - INFO - Starting Drain3 template miner
2025-03-09 14:05:07,256 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-09 14:05:07,256 - INFO - API sequence 8/12 generated
2025-03-09 14:05:07,256 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-09 14:05:08,429 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[1] ==========
2025-03-09 14:05:08,429 - INFO - API sequence 9/12 generated
2025-03-09 14:05:08,429 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-09 14:05:08,541 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-09 14:05:09,584 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-09 14:05:09,584 - INFO - API sequence 10/12 generated
2025-03-09 14:05:09,584 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-09 14:05:10,751 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[1] ==========
2025-03-09 14:05:10,752 - INFO - API sequence 11/12 generated
2025-03-09 14:05:10,752 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-09 14:05:12,245 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_8'], malicious_sign_seq=[0, 1] ==========
2025-03-09 14:05:12,245 - INFO - API sequence 12/12 generated
2025-03-09 14:05:12,247 - INFO - API sequences serialized to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py/serialized_llm_agents.json
2025-03-09 14:05:12,247 - INFO - Generating simulated traffic data set...
2025-03-09 14:05:12,250 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-09 14:05:12,250 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-09 14:05:12,252 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-09 14:05:12,253 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-09 14:05:12,253 - INFO - Simulated traffic data for 1/12 user collected：user: normaluser malicious: True
2025-03-09 14:05:12,255 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-09 14:05:12,256 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-09 14:05:12,256 - INFO - Simulated traffic data for 2/12 user collected：user: adminuser malicious: False
2025-03-09 14:05:12,258 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/resource/16 {}
2025-03-09 14:05:12,259 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-09 14:05:12,259 - INFO - Simulated traffic data for 3/12 user collected：user: normaluser malicious: False
2025-03-09 14:05:12,262 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-09 14:05:12,262 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-09 14:05:12,262 - INFO - Simulated traffic data for 4/12 user collected：user: unloggeduser malicious: True
2025-03-09 14:05:12,265 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-09 14:05:12,265 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-09 14:05:12,265 - INFO - Simulated traffic data for 5/12 user collected：user: normaluser malicious: False
2025-03-09 14:05:12,268 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-09 14:05:12,268 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-09 14:05:12,270 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-09 14:05:12,271 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-09 14:05:12,271 - INFO - Simulated traffic data for 6/12 user collected：user: normaluser malicious: True
2025-03-09 14:05:12,273 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-09 14:05:12,274 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-09 14:05:12,274 - INFO - Simulated traffic data for 7/12 user collected：user: adminuser malicious: False
2025-03-09 14:05:12,277 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-09 14:05:12,277 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-09 14:05:12,277 - INFO - Simulated traffic data for 8/12 user collected：user: normaluser malicious: False
2025-03-09 14:05:12,279 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-09 14:05:12,280 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-09 14:05:12,280 - INFO - Simulated traffic data for 9/12 user collected：user: unloggeduser malicious: True
2025-03-09 14:05:12,283 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-09 14:05:12,283 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-09 14:05:12,283 - INFO - Simulated traffic data for 10/12 user collected：user: normaluser malicious: False
2025-03-09 14:05:12,286 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-09 14:05:12,286 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-09 14:05:12,286 - INFO - Simulated traffic data for 11/12 user collected：user: unloggeduser malicious: True
2025-03-09 14:05:12,289 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/resource/16 {}
2025-03-09 14:05:12,289 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-09 14:05:12,292 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-09 14:05:12,292 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-09 14:05:12,292 - INFO - Simulated traffic data for 12/12 user collected：user: normaluser malicious: True
2025-03-09 14:05:12,302 - INFO - All simulated traffic data collected：/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/simulated_traffic_data.csv
2025-03-09 14:05:24,702 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-09 14:05:24,745 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-09 14:05:24,745 - INFO - Extracting API list with API discovery algorithm...
2025-03-09 14:05:24,806 - INFO - Starting Drain3 template miner
2025-03-09 14:05:24,809 - INFO - Starting Drain3 template miner
2025-03-09 14:05:24,810 - INFO - Starting Drain3 template miner
2025-03-09 14:05:24,811 - INFO - Starting Drain3 template miner
2025-03-09 14:05:24,811 - INFO - Starting Drain3 template miner
2025-03-09 14:05:26,252 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-09 14:06:13,466 - INFO - Trying to construct model...
2025-03-09 14:06:13,467 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-09 14:06:13,503 - INFO - Training model... Size of feature_list: 6
2025-03-09 14:06:13,511 - INFO - Extracting features... Size of feature_list: 6
2025-03-09 14:06:13,512 - INFO - Extracting features... Size of feature_list: 6
2025-03-09 14:06:13,513 - INFO - Extracting features... Size of feature_list: 6
2025-03-09 14:06:13,514 - INFO - Extracting features... Size of feature_list: 6
2025-03-09 14:06:13,515 - INFO - Extracting features... Size of feature_list: 6
2025-03-09 14:06:13,516 - INFO - Extracting features... Size of feature_list: 6
2025-03-09 14:06:13,518 - INFO - Extracting features... Size of feature_list: 6
2025-03-09 14:06:13,519 - INFO - Extracting features... Size of feature_list: 6
2025-03-09 14:06:13,557 - INFO - Extracting features... Size of feature_list: 6
2025-03-09 14:06:13,558 - INFO - Extracting features... Size of feature_list: 6
2025-03-09 14:06:13,560 - INFO - Extracting features... Size of feature_list: 6
2025-03-09 14:06:13,561 - INFO - Extracting features... Size of feature_list: 6
2025-03-09 14:06:13,572 - INFO - Model constructed.
2025-03-09 14:06:23,335 - INFO - Trying to construct model...
2025-03-09 14:06:23,336 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-09 14:06:23,373 - INFO - Training model... Size of feature_list: 6
2025-03-09 14:06:23,382 - INFO - Extracting features... Size of feature_list: 6
2025-03-09 14:06:23,383 - INFO - Extracting features... Size of feature_list: 6
2025-03-09 14:06:23,385 - INFO - Extracting features... Size of feature_list: 6
2025-03-09 14:06:23,386 - INFO - Extracting features... Size of feature_list: 6
2025-03-09 14:06:23,387 - INFO - Extracting features... Size of feature_list: 6
2025-03-09 14:06:23,389 - INFO - Extracting features... Size of feature_list: 6
2025-03-09 14:06:23,390 - INFO - Extracting features... Size of feature_list: 6
2025-03-09 14:06:23,391 - INFO - Extracting features... Size of feature_list: 6
2025-03-09 14:06:23,441 - INFO - Extracting features... Size of feature_list: 6
2025-03-09 14:06:23,442 - INFO - Extracting features... Size of feature_list: 6
2025-03-09 14:06:23,444 - INFO - Extracting features... Size of feature_list: 6
2025-03-09 14:06:23,445 - INFO - Extracting features... Size of feature_list: 6
2025-03-09 14:06:23,457 - INFO - Model constructed.
2025-03-09 14:07:12,514 - INFO - Detection started. Combined data duration: 30
2025-03-09 14:07:20,383 - INFO - Detection paused.
2025-03-09 15:58:06,622 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 30, Feature size: 7
2025-03-09 15:58:48,151 - INFO - Trying to construct model...
2025-03-09 15:58:48,152 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-09 15:58:48,210 - INFO - Training model... Size of feature_list: 7
2025-03-09 15:58:48,225 - INFO - Extracting features... Size of feature_list: 7
2025-03-09 15:58:48,233 - INFO - Extracting features... Size of feature_list: 7
2025-03-09 15:58:48,235 - INFO - Extracting features... Size of feature_list: 7
2025-03-09 15:58:48,236 - INFO - Extracting features... Size of feature_list: 7
2025-03-09 15:58:48,237 - INFO - Extracting features... Size of feature_list: 7
2025-03-09 15:58:48,238 - INFO - Extracting features... Size of feature_list: 7
2025-03-09 15:58:48,239 - INFO - Extracting features... Size of feature_list: 7
2025-03-09 15:58:48,240 - INFO - Extracting features... Size of feature_list: 7
2025-03-09 15:58:48,304 - INFO - Extracting features... Size of feature_list: 7
2025-03-09 15:58:48,305 - INFO - Extracting features... Size of feature_list: 7
2025-03-09 15:58:48,307 - INFO - Extracting features... Size of feature_list: 7
2025-03-09 15:58:48,308 - INFO - Extracting features... Size of feature_list: 7
2025-03-09 15:58:48,323 - INFO - Model constructed.
2025-03-09 15:59:09,531 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-09 15:59:09,610 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-09 15:59:09,644 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-09 15:59:09,645 - INFO - Generating simulated API sequences...
2025-03-09 15:59:09,646 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-09 15:59:11,001 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-09 15:59:11,001 - INFO - API sequence 1/12 generated
2025-03-09 15:59:11,002 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-09 15:59:12,198 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-09 15:59:12,198 - INFO - API sequence 2/12 generated
2025-03-09 15:59:12,198 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-09 15:59:13,347 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[1] ==========
2025-03-09 15:59:13,347 - INFO - API sequence 3/12 generated
2025-03-09 15:59:13,347 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-09 15:59:14,634 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[1] ==========
2025-03-09 15:59:14,634 - INFO - API sequence 4/12 generated
2025-03-09 15:59:14,634 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-09 15:59:14,730 - INFO - Trying to construct model...
2025-03-09 15:59:14,730 - INFO - DATA_COLLECTION_STATUS: IN_PROGRESS
2025-03-09 15:59:16,078 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_8'], malicious_sign_seq=[0, 1] ==========
2025-03-09 15:59:16,078 - INFO - API sequence 5/12 generated
2025-03-09 15:59:16,078 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-09 15:59:17,272 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-09 15:59:17,272 - INFO - API sequence 6/12 generated
2025-03-09 15:59:17,272 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-09 15:59:18,799 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_8'], malicious_sign_seq=[0, 1] ==========
2025-03-09 15:59:18,799 - INFO - API sequence 7/12 generated
2025-03-09 15:59:18,799 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-09 15:59:19,968 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[1] ==========
2025-03-09 15:59:19,968 - INFO - API sequence 8/12 generated
2025-03-09 15:59:19,969 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-09 15:59:21,259 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-09 15:59:21,260 - INFO - API sequence 9/12 generated
2025-03-09 15:59:21,260 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-09 15:59:22,664 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_8'], malicious_sign_seq=[0, 1] ==========
2025-03-09 15:59:22,664 - INFO - API sequence 10/12 generated
2025-03-09 15:59:22,665 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-09 15:59:53,196 - ERROR - JSON decoding error: Expecting value: line 1 column 1 (char 0)
Raw response: thinking failure...
Traceback (most recent call last):
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/brain.py", line 107, in _parse_llm_response_for_api_seq
    parsed_data = json.loads(json_str)
  File "/usr/lib/python3.10/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
  File "/usr/lib/python3.10/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
  File "/usr/lib/python3.10/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
2025-03-09 15:59:53,198 - INFO - ========== Method gen_api_seq() returned: seq=[], malicious_sign_seq=[] ==========
2025-03-09 15:59:53,198 - INFO - API sequence 11/12 generated
2025-03-09 15:59:53,198 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-09 16:00:08,840 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-09 16:00:08,840 - INFO - API sequence 12/12 generated
2025-03-09 16:00:08,841 - INFO - API sequences serialized to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py/serialized_llm_agents.json
2025-03-09 16:00:08,841 - INFO - Generating simulated traffic data set...
2025-03-09 16:00:08,841 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-09 16:00:08,841 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-09 16:00:08,841 - INFO - Simulated traffic data for 1/12 user collected：user: normaluser malicious: False
2025-03-09 16:00:08,841 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-09 16:00:08,841 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-09 16:00:08,841 - INFO - Simulated traffic data for 2/12 user collected：user: normaluser malicious: False
2025-03-09 16:00:08,842 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-09 16:00:08,842 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-09 16:00:08,842 - INFO - Simulated traffic data for 3/12 user collected：user: unloggeduser malicious: True
2025-03-09 16:00:08,842 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-09 16:00:08,842 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-09 16:00:08,842 - INFO - Simulated traffic data for 4/12 user collected：user: unloggeduser malicious: True
2025-03-09 16:00:08,842 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-09 16:00:08,842 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-09 16:00:08,842 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-09 16:00:08,842 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-09 16:00:08,842 - INFO - Simulated traffic data for 5/12 user collected：user: normaluser malicious: True
2025-03-09 16:00:08,843 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-09 16:00:08,843 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-09 16:00:08,843 - INFO - Simulated traffic data for 6/12 user collected：user: adminuser malicious: False
2025-03-09 16:00:08,843 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/resource/16 {}
2025-03-09 16:00:08,843 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-09 16:00:08,843 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/resource/16 {}
2025-03-09 16:00:08,843 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-09 16:00:08,843 - INFO - Simulated traffic data for 7/12 user collected：user: normaluser malicious: True
2025-03-09 16:00:08,843 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-09 16:00:08,843 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-09 16:00:08,843 - INFO - Simulated traffic data for 8/12 user collected：user: unloggeduser malicious: True
2025-03-09 16:00:08,844 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-09 16:00:08,844 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-09 16:00:08,844 - INFO - Simulated traffic data for 9/12 user collected：user: normaluser malicious: False
2025-03-09 16:00:08,844 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-09 16:00:08,844 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-09 16:00:08,844 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-09 16:00:08,844 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-09 16:00:08,844 - INFO - Simulated traffic data for 10/12 user collected：user: normaluser malicious: True
2025-03-09 16:00:08,844 - INFO - Simulated traffic data for 11/12 user collected：user: adminuser malicious: False
2025-03-09 16:00:08,844 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-09 16:00:08,844 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-09 16:00:08,844 - INFO - Simulated traffic data for 12/12 user collected：user: normaluser malicious: False
2025-03-09 16:00:08,847 - INFO - All simulated traffic data collected：/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/simulated_traffic_data.csv
2025-03-09 16:26:31,180 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 30, Feature size: 7
2025-03-09 16:26:33,028 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 30, Feature size: 7
2025-03-09 16:28:08,370 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-09 16:28:08,455 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-09 16:28:08,486 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-09 16:28:08,486 - INFO - Generating simulated API sequences...
2025-03-09 16:28:08,486 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-09 16:28:09,993 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_8'], malicious_sign_seq=[0, 1] ==========
2025-03-09 16:28:09,993 - INFO - API sequence 1/12 generated
2025-03-09 16:28:09,993 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-09 16:28:11,537 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_8'], malicious_sign_seq=[0, 1] ==========
2025-03-09 16:28:11,538 - INFO - API sequence 2/12 generated
2025-03-09 16:28:11,538 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-09 16:28:12,740 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[1] ==========
2025-03-09 16:28:12,740 - INFO - API sequence 3/12 generated
2025-03-09 16:28:12,740 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-09 16:28:14,017 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-09 16:28:14,017 - INFO - API sequence 4/12 generated
2025-03-09 16:28:14,018 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-09 16:28:15,535 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_8'], malicious_sign_seq=[0, 1] ==========
2025-03-09 16:28:15,535 - INFO - API sequence 5/12 generated
2025-03-09 16:28:15,535 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-09 16:28:15,805 - INFO - Trying to construct model...
2025-03-09 16:28:15,805 - INFO - DATA_COLLECTION_STATUS: IN_PROGRESS
2025-03-09 16:28:16,785 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-09 16:28:16,785 - INFO - API sequence 6/12 generated
2025-03-09 16:28:16,785 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-09 16:28:17,979 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-09 16:28:17,980 - INFO - API sequence 7/12 generated
2025-03-09 16:28:17,980 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-09 16:28:19,167 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-09 16:28:19,168 - INFO - API sequence 8/12 generated
2025-03-09 16:28:19,168 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-09 16:28:20,350 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-09 16:28:20,350 - INFO - API sequence 9/12 generated
2025-03-09 16:28:20,350 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-09 16:28:21,488 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-09 16:28:21,488 - INFO - API sequence 10/12 generated
2025-03-09 16:28:21,488 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-09 16:28:52,012 - ERROR - JSON decoding error: Expecting value: line 1 column 1 (char 0)
Raw response: thinking failure...
Traceback (most recent call last):
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/brain.py", line 107, in _parse_llm_response_for_api_seq
    parsed_data = json.loads(json_str)
  File "/usr/lib/python3.10/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
  File "/usr/lib/python3.10/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
  File "/usr/lib/python3.10/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
2025-03-09 16:28:52,014 - INFO - ========== Method gen_api_seq() returned: seq=[], malicious_sign_seq=[] ==========
2025-03-09 16:28:52,014 - INFO - API sequence 11/12 generated
2025-03-09 16:28:52,014 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-09 16:29:07,590 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[1] ==========
2025-03-09 16:29:07,590 - INFO - API sequence 12/12 generated
2025-03-09 16:29:07,590 - INFO - API sequences serialized to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py/serialized_llm_agents.json
2025-03-09 16:29:07,590 - INFO - Generating simulated traffic data set...
2025-03-09 16:29:07,591 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-09 16:29:07,591 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-09 16:29:07,591 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-09 16:29:07,591 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-09 16:29:07,591 - INFO - Simulated traffic data for 1/12 user collected：user: normaluser malicious: True
2025-03-09 16:29:07,591 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/memo/21 {}
2025-03-09 16:29:07,591 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-09 16:29:07,591 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-09 16:29:07,592 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-09 16:29:07,592 - INFO - Simulated traffic data for 2/12 user collected：user: normaluser malicious: True
2025-03-09 16:29:07,592 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-09 16:29:07,592 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-09 16:29:07,592 - INFO - Simulated traffic data for 3/12 user collected：user: unloggeduser malicious: True
2025-03-09 16:29:07,592 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-09 16:29:07,592 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-09 16:29:07,592 - INFO - Simulated traffic data for 4/12 user collected：user: normaluser malicious: False
2025-03-09 16:29:07,592 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-09 16:29:07,592 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-09 16:29:07,592 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-09 16:29:07,592 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-09 16:29:07,592 - INFO - Simulated traffic data for 5/12 user collected：user: normaluser malicious: True
2025-03-09 16:29:07,593 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-09 16:29:07,593 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-09 16:29:07,593 - INFO - Simulated traffic data for 6/12 user collected：user: normaluser malicious: False
2025-03-09 16:29:07,593 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-09 16:29:07,593 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-09 16:29:07,593 - INFO - Simulated traffic data for 7/12 user collected：user: adminuser malicious: False
2025-03-09 16:29:07,593 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-09 16:29:07,593 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-09 16:29:07,593 - INFO - Simulated traffic data for 8/12 user collected：user: adminuser malicious: False
2025-03-09 16:29:07,593 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-09 16:29:07,593 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-09 16:29:07,593 - INFO - Simulated traffic data for 9/12 user collected：user: normaluser malicious: False
2025-03-09 16:29:07,594 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-09 16:29:07,594 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-09 16:29:07,594 - INFO - Simulated traffic data for 10/12 user collected：user: normaluser malicious: False
2025-03-09 16:29:07,594 - INFO - Simulated traffic data for 11/12 user collected：user: unloggeduser malicious: True
2025-03-09 16:29:07,594 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-09 16:29:07,594 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-09 16:29:07,594 - INFO - Simulated traffic data for 12/12 user collected：user: unloggeduser malicious: True
2025-03-09 16:29:07,596 - INFO - All simulated traffic data collected：/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/simulated_traffic_data.csv
2025-03-09 17:36:08,844 - INFO - Trying to construct model...
2025-03-09 17:36:08,845 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-09 17:36:08,897 - INFO - Training model... Size of feature_list: 7
2025-03-09 17:36:08,913 - INFO - Extracting features... Size of feature_list: 7
2025-03-09 17:36:08,918 - INFO - Extracting features... Size of feature_list: 7
2025-03-09 17:36:08,919 - INFO - Extracting features... Size of feature_list: 7
2025-03-09 17:36:08,920 - INFO - Extracting features... Size of feature_list: 7
2025-03-09 17:36:08,922 - INFO - Extracting features... Size of feature_list: 7
2025-03-09 17:36:08,923 - INFO - Extracting features... Size of feature_list: 7
2025-03-09 17:36:08,924 - INFO - Extracting features... Size of feature_list: 7
2025-03-09 17:36:08,925 - INFO - Extracting features... Size of feature_list: 7
2025-03-09 17:36:09,037 - INFO - Extracting features... Size of feature_list: 7
2025-03-09 17:36:09,039 - INFO - Extracting features... Size of feature_list: 7
2025-03-09 17:36:09,040 - INFO - Extracting features... Size of feature_list: 7
2025-03-09 17:36:09,058 - INFO - Model constructed.
2025-03-09 21:29:53,113 - INFO - Trying to construct model...
2025-03-09 21:29:53,114 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-09 21:29:53,261 - INFO - Training model... Size of feature_list: 7
2025-03-09 21:29:53,282 - INFO - Extracting features... Size of feature_list: 7
2025-03-09 21:29:53,285 - INFO - Extracting features... Size of feature_list: 7
2025-03-09 21:29:53,286 - INFO - Extracting features... Size of feature_list: 7
2025-03-09 21:29:53,287 - INFO - Extracting features... Size of feature_list: 7
2025-03-09 21:29:53,288 - INFO - Extracting features... Size of feature_list: 7
2025-03-09 21:29:53,289 - INFO - Extracting features... Size of feature_list: 7
2025-03-09 21:29:53,290 - INFO - Extracting features... Size of feature_list: 7
2025-03-09 21:29:53,291 - INFO - Extracting features... Size of feature_list: 7
2025-03-09 21:29:53,447 - INFO - Extracting features... Size of feature_list: 7
2025-03-09 21:29:53,449 - INFO - Extracting features... Size of feature_list: 7
2025-03-09 21:29:53,450 - INFO - Extracting features... Size of feature_list: 7
2025-03-09 21:29:53,465 - INFO - Model constructed.
2025-03-09 22:15:19,535 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-09 22:15:19,598 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-09 22:15:19,598 - INFO - Extracting API list with API discovery algorithm...
2025-03-09 22:15:19,663 - INFO - Starting Drain3 template miner
2025-03-09 22:15:19,740 - INFO - Starting Drain3 template miner
2025-03-09 22:15:19,742 - INFO - Starting Drain3 template miner
2025-03-09 22:15:19,742 - INFO - Starting Drain3 template miner
2025-03-09 22:15:19,743 - INFO - Starting Drain3 template miner
2025-03-09 22:15:21,145 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-09 22:15:29,563 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-09 22:15:29,617 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-09 22:15:29,617 - INFO - Extracting API list with API discovery algorithm...
2025-03-09 22:15:29,679 - INFO - Starting Drain3 template miner
2025-03-09 22:15:29,681 - INFO - Starting Drain3 template miner
2025-03-09 22:15:29,683 - INFO - Starting Drain3 template miner
2025-03-09 22:15:29,684 - INFO - Starting Drain3 template miner
2025-03-09 22:15:29,684 - INFO - Starting Drain3 template miner
2025-03-09 22:15:31,101 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-09 22:15:41,391 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-09 22:15:41,436 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-09 22:15:41,436 - INFO - Extracting API list with API discovery algorithm...
2025-03-09 22:15:41,496 - INFO - Starting Drain3 template miner
2025-03-09 22:15:41,499 - INFO - Starting Drain3 template miner
2025-03-09 22:15:41,500 - INFO - Starting Drain3 template miner
2025-03-09 22:15:41,501 - INFO - Starting Drain3 template miner
2025-03-09 22:15:41,501 - INFO - Starting Drain3 template miner
2025-03-09 22:15:42,929 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-10 00:40:52,397 - INFO - Trying to construct model...
2025-03-10 00:40:52,398 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-10 00:40:52,425 - INFO - Training model... Size of feature_list: 6
2025-03-10 00:40:52,434 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 00:40:52,436 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 00:40:52,437 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 00:40:52,438 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 00:40:52,439 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 00:40:52,440 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 00:40:52,441 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 00:40:52,441 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 00:40:52,471 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 00:40:52,472 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 00:40:52,473 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 00:40:52,485 - INFO - Model constructed.
2025-03-10 00:41:02,438 - INFO - Trying to construct model...
2025-03-10 00:41:02,438 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-10 00:41:02,474 - INFO - Training model... Size of feature_list: 6
2025-03-10 00:41:02,483 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 00:41:02,484 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 00:41:02,485 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 00:41:02,486 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 00:41:02,487 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 00:41:02,488 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 00:41:02,489 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 00:41:02,490 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 00:41:02,525 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 00:41:02,527 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 00:41:02,528 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 00:41:02,538 - INFO - Model constructed.
2025-03-10 10:04:44,512 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 6
2025-03-10 10:06:24,793 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-10 10:06:24,967 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-10 10:06:24,968 - INFO - Extracting API list with API discovery algorithm...
2025-03-10 10:06:25,042 - INFO - Starting Drain3 template miner
2025-03-10 10:06:25,045 - INFO - Starting Drain3 template miner
2025-03-10 10:06:25,046 - INFO - Starting Drain3 template miner
2025-03-10 10:06:25,047 - INFO - Starting Drain3 template miner
2025-03-10 10:06:25,048 - INFO - Starting Drain3 template miner
2025-03-10 10:06:26,506 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-10 10:07:18,554 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-10 10:07:18,599 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-10 10:07:18,635 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-10 10:07:18,635 - INFO - Starting data generation...
2025-03-10 10:07:18,635 - INFO - API_KNOWLEDGE: [{'number': 'API_1707', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_1708', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}]
2025-03-10 10:07:18,635 - INFO - APP_KNOWLEDGE: {'func_description': 'This is an updated test applicationaaa', 'normal_seqs': ['There are no example normal seqs'], 'malicious_seqs': ['There are no example malicious seqs'], 'roles': ['admin', 'ordinary_user', 'unlogged_in_user']}
2025-03-10 10:07:18,635 - INFO - Generating simulated API sequences...
2025-03-10 10:07:18,635 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-10 10:07:19,004 - ERROR - JSON decoding error: Expecting value: line 1 column 1 (char 0)
Raw response: 
Traceback (most recent call last):
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/brain.py", line 107, in _parse_llm_response_for_api_seq
    parsed_data = json.loads(json_str)
  File "/usr/lib/python3.10/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
  File "/usr/lib/python3.10/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
  File "/usr/lib/python3.10/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
2025-03-10 10:07:19,006 - INFO - ========== Method gen_api_seq() returned: seq=[], malicious_sign_seq=[] ==========
2025-03-10 10:07:19,006 - INFO - API sequence 1/12 generated
2025-03-10 10:07:19,006 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 10:07:19,363 - ERROR - JSON decoding error: Expecting value: line 1 column 1 (char 0)
Raw response: 
Traceback (most recent call last):
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/brain.py", line 107, in _parse_llm_response_for_api_seq
    parsed_data = json.loads(json_str)
  File "/usr/lib/python3.10/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
  File "/usr/lib/python3.10/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
  File "/usr/lib/python3.10/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
2025-03-10 10:07:19,363 - INFO - ========== Method gen_api_seq() returned: seq=[], malicious_sign_seq=[] ==========
2025-03-10 10:07:19,363 - INFO - API sequence 2/12 generated
2025-03-10 10:07:19,363 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-10 10:07:19,705 - ERROR - JSON decoding error: Expecting value: line 1 column 1 (char 0)
Raw response: 
Traceback (most recent call last):
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/brain.py", line 107, in _parse_llm_response_for_api_seq
    parsed_data = json.loads(json_str)
  File "/usr/lib/python3.10/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
  File "/usr/lib/python3.10/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
  File "/usr/lib/python3.10/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
2025-03-10 10:07:19,706 - INFO - ========== Method gen_api_seq() returned: seq=[], malicious_sign_seq=[] ==========
2025-03-10 10:07:19,706 - INFO - API sequence 3/12 generated
2025-03-10 10:07:19,706 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-10 10:07:20,046 - ERROR - JSON decoding error: Expecting value: line 1 column 1 (char 0)
Raw response: 
Traceback (most recent call last):
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/brain.py", line 107, in _parse_llm_response_for_api_seq
    parsed_data = json.loads(json_str)
  File "/usr/lib/python3.10/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
  File "/usr/lib/python3.10/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
  File "/usr/lib/python3.10/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
2025-03-10 10:07:20,047 - INFO - ========== Method gen_api_seq() returned: seq=[], malicious_sign_seq=[] ==========
2025-03-10 10:07:20,047 - INFO - API sequence 4/12 generated
2025-03-10 10:07:20,047 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-10 10:07:20,401 - ERROR - JSON decoding error: Expecting value: line 1 column 1 (char 0)
Raw response: 
Traceback (most recent call last):
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/brain.py", line 107, in _parse_llm_response_for_api_seq
    parsed_data = json.loads(json_str)
  File "/usr/lib/python3.10/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
  File "/usr/lib/python3.10/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
  File "/usr/lib/python3.10/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
2025-03-10 10:07:20,402 - INFO - ========== Method gen_api_seq() returned: seq=[], malicious_sign_seq=[] ==========
2025-03-10 10:07:20,402 - INFO - API sequence 5/12 generated
2025-03-10 10:07:20,402 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-10 10:07:20,771 - ERROR - JSON decoding error: Expecting value: line 1 column 1 (char 0)
Raw response: 
Traceback (most recent call last):
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/brain.py", line 107, in _parse_llm_response_for_api_seq
    parsed_data = json.loads(json_str)
  File "/usr/lib/python3.10/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
  File "/usr/lib/python3.10/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
  File "/usr/lib/python3.10/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
2025-03-10 10:07:20,771 - INFO - ========== Method gen_api_seq() returned: seq=[], malicious_sign_seq=[] ==========
2025-03-10 10:07:20,771 - INFO - API sequence 6/12 generated
2025-03-10 10:07:20,771 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-10 10:07:21,081 - ERROR - JSON decoding error: Expecting value: line 1 column 1 (char 0)
Raw response: 
Traceback (most recent call last):
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/brain.py", line 107, in _parse_llm_response_for_api_seq
    parsed_data = json.loads(json_str)
  File "/usr/lib/python3.10/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
  File "/usr/lib/python3.10/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
  File "/usr/lib/python3.10/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
2025-03-10 10:07:21,082 - INFO - ========== Method gen_api_seq() returned: seq=[], malicious_sign_seq=[] ==========
2025-03-10 10:07:21,082 - INFO - API sequence 7/12 generated
2025-03-10 10:07:21,082 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-10 10:07:21,435 - ERROR - JSON decoding error: Expecting value: line 1 column 1 (char 0)
Raw response: 
Traceback (most recent call last):
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/brain.py", line 107, in _parse_llm_response_for_api_seq
    parsed_data = json.loads(json_str)
  File "/usr/lib/python3.10/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
  File "/usr/lib/python3.10/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
  File "/usr/lib/python3.10/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
2025-03-10 10:07:21,435 - INFO - ========== Method gen_api_seq() returned: seq=[], malicious_sign_seq=[] ==========
2025-03-10 10:07:21,435 - INFO - API sequence 8/12 generated
2025-03-10 10:07:21,436 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-10 10:07:21,771 - ERROR - JSON decoding error: Expecting value: line 1 column 1 (char 0)
Raw response: 
Traceback (most recent call last):
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/brain.py", line 107, in _parse_llm_response_for_api_seq
    parsed_data = json.loads(json_str)
  File "/usr/lib/python3.10/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
  File "/usr/lib/python3.10/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
  File "/usr/lib/python3.10/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
2025-03-10 10:07:21,771 - INFO - ========== Method gen_api_seq() returned: seq=[], malicious_sign_seq=[] ==========
2025-03-10 10:07:21,772 - INFO - API sequence 9/12 generated
2025-03-10 10:07:21,772 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 10:07:22,104 - ERROR - JSON decoding error: Expecting value: line 1 column 1 (char 0)
Raw response: 
Traceback (most recent call last):
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/brain.py", line 107, in _parse_llm_response_for_api_seq
    parsed_data = json.loads(json_str)
  File "/usr/lib/python3.10/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
  File "/usr/lib/python3.10/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
  File "/usr/lib/python3.10/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
2025-03-10 10:07:22,104 - INFO - ========== Method gen_api_seq() returned: seq=[], malicious_sign_seq=[] ==========
2025-03-10 10:07:22,105 - INFO - API sequence 10/12 generated
2025-03-10 10:07:22,105 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 10:07:52,618 - ERROR - JSON decoding error: Expecting value: line 1 column 1 (char 0)
Raw response: thinking failure...
Traceback (most recent call last):
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/brain.py", line 107, in _parse_llm_response_for_api_seq
    parsed_data = json.loads(json_str)
  File "/usr/lib/python3.10/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
  File "/usr/lib/python3.10/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
  File "/usr/lib/python3.10/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
2025-03-10 10:07:52,619 - INFO - ========== Method gen_api_seq() returned: seq=[], malicious_sign_seq=[] ==========
2025-03-10 10:07:52,619 - INFO - API sequence 11/12 generated
2025-03-10 10:07:52,619 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 10:08:07,376 - ERROR - JSON decoding error: Expecting value: line 1 column 1 (char 0)
Raw response: 
Traceback (most recent call last):
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/brain.py", line 107, in _parse_llm_response_for_api_seq
    parsed_data = json.loads(json_str)
  File "/usr/lib/python3.10/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
  File "/usr/lib/python3.10/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
  File "/usr/lib/python3.10/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
2025-03-10 10:08:07,376 - INFO - ========== Method gen_api_seq() returned: seq=[], malicious_sign_seq=[] ==========
2025-03-10 10:08:07,376 - INFO - API sequence 12/12 generated
2025-03-10 10:08:07,376 - INFO - API sequences serialized to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py/serialized_llm_agents.json
2025-03-10 10:08:07,377 - INFO - Generating simulated traffic data set...
2025-03-10 10:08:07,377 - INFO - Simulated traffic data for 1/12 user collected：user: normaluser malicious: True
2025-03-10 10:08:07,377 - INFO - Simulated traffic data for 2/12 user collected：user: normaluser malicious: False
2025-03-10 10:08:07,377 - INFO - Simulated traffic data for 3/12 user collected：user: adminuser malicious: False
2025-03-10 10:08:07,377 - INFO - Simulated traffic data for 4/12 user collected：user: unloggeduser malicious: True
2025-03-10 10:08:07,377 - INFO - Simulated traffic data for 5/12 user collected：user: normaluser malicious: True
2025-03-10 10:08:07,377 - INFO - Simulated traffic data for 6/12 user collected：user: unloggeduser malicious: True
2025-03-10 10:08:07,377 - INFO - Simulated traffic data for 7/12 user collected：user: unloggeduser malicious: True
2025-03-10 10:08:07,377 - INFO - Simulated traffic data for 8/12 user collected：user: adminuser malicious: False
2025-03-10 10:08:07,377 - INFO - Simulated traffic data for 9/12 user collected：user: normaluser malicious: True
2025-03-10 10:08:07,377 - INFO - Simulated traffic data for 10/12 user collected：user: normaluser malicious: False
2025-03-10 10:08:07,377 - INFO - Simulated traffic data for 11/12 user collected：user: normaluser malicious: False
2025-03-10 10:08:07,377 - INFO - Simulated traffic data for 12/12 user collected：user: normaluser malicious: False
2025-03-10 10:08:07,383 - INFO - All simulated traffic data collected：/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/simulated_traffic_data.csv
2025-03-10 10:09:21,488 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 6
2025-03-10 10:09:21,927 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-10 10:09:21,976 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-10 10:09:22,008 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-10 10:09:22,008 - INFO - Starting data generation...
2025-03-10 10:09:22,008 - INFO - API_KNOWLEDGE: [{'number': 'API_1709', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_1710', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}]
2025-03-10 10:09:22,008 - INFO - APP_KNOWLEDGE: {'func_description': 'This is an updated test applicationaaa', 'normal_seqs': ['There are no example normal seqs'], 'malicious_seqs': ['There are no example malicious seqs'], 'roles': ['admin', 'ordinary_user', 'unlogged_in_user']}
2025-03-10 10:09:22,307 - INFO - Generating simulated API sequences...
2025-03-10 10:09:22,307 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-10 10:09:23,669 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 10:09:23,674 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-10 10:09:23,675 - INFO - API sequence 1/12 generated
2025-03-10 10:09:23,675 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 10:09:25,600 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 10:09:25,601 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-10 10:09:25,601 - INFO - API sequence 2/12 generated
2025-03-10 10:09:25,601 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-10 10:09:28,296 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 10:09:28,297 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-10 10:09:28,298 - INFO - API sequence 3/12 generated
2025-03-10 10:09:28,298 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-10 10:09:29,457 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 10:09:29,458 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-10 10:09:29,458 - INFO - API sequence 4/12 generated
2025-03-10 10:09:29,458 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 10:09:30,537 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 10:09:30,538 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-10 10:09:30,539 - INFO - API sequence 5/12 generated
2025-03-10 10:09:30,539 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-10 10:09:31,868 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 10:09:31,869 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-10 10:09:31,869 - INFO - API sequence 6/12 generated
2025-03-10 10:09:31,869 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-10 10:09:33,488 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 10:09:33,488 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-10 10:09:33,489 - INFO - API sequence 7/12 generated
2025-03-10 10:09:33,489 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 10:09:35,491 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 10:09:35,492 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-10 10:09:35,492 - INFO - API sequence 8/12 generated
2025-03-10 10:09:35,493 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-10 10:09:37,030 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 10:09:37,031 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-10 10:09:37,031 - INFO - API sequence 9/12 generated
2025-03-10 10:09:37,031 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-10 10:09:38,078 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 10:09:38,079 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-10 10:09:38,079 - INFO - API sequence 10/12 generated
2025-03-10 10:09:38,079 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 10:09:40,201 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 10:09:40,202 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-10 10:09:40,202 - INFO - API sequence 11/12 generated
2025-03-10 10:09:40,202 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-10 10:09:42,643 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 10:09:42,644 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-10 10:09:42,644 - INFO - API sequence 12/12 generated
2025-03-10 10:09:42,645 - INFO - API sequences serialized to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py/serialized_llm_agents.json
2025-03-10 10:09:42,645 - INFO - Generating simulated traffic data set...
2025-03-10 10:09:42,645 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 10:09:42,645 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 10:09:42,645 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 10:09:42,645 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-10 10:09:42,645 - INFO - Simulated traffic data for 1/12 user collected：user: normaluser malicious: True
2025-03-10 10:09:42,645 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 10:09:42,645 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 10:09:42,646 - INFO - Simulated traffic data for 2/12 user collected：user: normaluser malicious: False
2025-03-10 10:09:42,646 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 10:09:42,646 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 10:09:42,646 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 10:09:42,646 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-10 10:09:42,646 - INFO - Simulated traffic data for 3/12 user collected：user: unloggeduser malicious: True
2025-03-10 10:09:42,646 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 10:09:42,646 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 10:09:42,646 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/memo/21 {}
2025-03-10 10:09:42,646 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-10 10:09:42,646 - INFO - Simulated traffic data for 4/12 user collected：user: unloggeduser malicious: True
2025-03-10 10:09:42,647 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 10:09:42,647 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 10:09:42,647 - INFO - Simulated traffic data for 5/12 user collected：user: normaluser malicious: False
2025-03-10 10:09:42,647 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/resource/16 {}
2025-03-10 10:09:42,647 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 10:09:42,647 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/resource/16 {}
2025-03-10 10:09:42,647 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-10 10:09:42,647 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 10:09:42,647 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：False
2025-03-10 10:09:42,647 - INFO - Simulated traffic data for 6/12 user collected：user: normaluser malicious: True
2025-03-10 10:09:42,647 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 10:09:42,647 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 10:09:42,648 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 10:09:42,648 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-10 10:09:42,648 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 10:09:42,648 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：False
2025-03-10 10:09:42,648 - INFO - Simulated traffic data for 7/12 user collected：user: normaluser malicious: True
2025-03-10 10:09:42,648 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 10:09:42,648 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 10:09:42,648 - INFO - Simulated traffic data for 8/12 user collected：user: normaluser malicious: False
2025-03-10 10:09:42,648 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 10:09:42,648 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 10:09:42,649 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 10:09:42,649 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-10 10:09:42,649 - INFO - Simulated traffic data for 9/12 user collected：user: unloggeduser malicious: True
2025-03-10 10:09:42,649 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 10:09:42,649 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 10:09:42,649 - INFO - Simulated traffic data for 10/12 user collected：user: adminuser malicious: False
2025-03-10 10:09:42,649 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 10:09:42,649 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 10:09:42,649 - INFO - Simulated traffic data for 11/12 user collected：user: normaluser malicious: False
2025-03-10 10:09:42,649 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 10:09:42,649 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 10:09:42,649 - INFO - Simulated traffic data for 12/12 user collected：user: adminuser malicious: False
2025-03-10 10:09:42,652 - INFO - All simulated traffic data collected：/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/simulated_traffic_data.csv
2025-03-10 10:11:17,771 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 6
2025-03-10 10:22:25,012 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-10 10:22:25,060 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-10 10:22:25,092 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-10 10:22:25,092 - INFO - Starting data generation...
2025-03-10 10:22:25,092 - INFO - API_KNOWLEDGE: [{'number': 'API_1721', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_1722', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}]
2025-03-10 10:22:25,092 - INFO - APP_KNOWLEDGE: {'func_description': 'This is an updated test applicationaaa', 'normal_seqs': ['Role: admin; API_1721(Call 1); API_1722(Call 2)', 'Role: oridinary_user; API_1721(); API_1722()'], 'malicious_seqs': ['Role: admin; API_1721(); API_1722()', 'Role: ordinary_user; API_1721(); API_1722()'], 'roles': ['admin', 'ordinary_user', 'unlogged_in_user']}
2025-03-10 10:22:25,295 - INFO - Generating simulated API sequences...
2025-03-10 10:22:25,296 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 10:22:26,719 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 10:22:26,724 - INFO - ========== Method gen_api_seq() returned: seq=['API_1721', 'API_1722'], malicious_sign_seq=[0, 0] ==========
2025-03-10 10:22:26,724 - INFO - API sequence 1/12 generated
2025-03-10 10:22:26,724 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-10 10:22:29,349 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 10:22:29,350 - INFO - ========== Method gen_api_seq() returned: seq=['API_1721', 'API_1722'], malicious_sign_seq=[0, 1] ==========
2025-03-10 10:22:29,350 - INFO - API sequence 2/12 generated
2025-03-10 10:22:29,350 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 10:22:41,508 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 10:22:41,509 - INFO - ========== Method gen_api_seq() returned: seq=['API_1721', 'API_1722'], malicious_sign_seq=[0, 0] ==========
2025-03-10 10:22:41,509 - INFO - API sequence 3/12 generated
2025-03-10 10:22:41,509 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-10 10:22:44,615 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 10:22:44,616 - INFO - ========== Method gen_api_seq() returned: seq=['API_1721', 'API_1722'], malicious_sign_seq=[0, 0] ==========
2025-03-10 10:22:44,616 - INFO - API sequence 4/12 generated
2025-03-10 10:22:44,616 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-10 10:22:46,226 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 10:22:46,227 - INFO - ========== Method gen_api_seq() returned: seq=['API_1721', 'API_1722'], malicious_sign_seq=[0, 1] ==========
2025-03-10 10:22:46,227 - INFO - API sequence 5/12 generated
2025-03-10 10:22:46,228 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 10:22:47,804 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 10:22:47,805 - INFO - ========== Method gen_api_seq() returned: seq=['API_1721', 'API_1722'], malicious_sign_seq=[0, 0] ==========
2025-03-10 10:22:47,805 - INFO - API sequence 6/12 generated
2025-03-10 10:22:47,805 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-10 10:22:49,989 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 10:22:49,989 - INFO - ========== Method gen_api_seq() returned: seq=['API_1721', 'API_1722'], malicious_sign_seq=[0, 1] ==========
2025-03-10 10:22:49,989 - INFO - API sequence 7/12 generated
2025-03-10 10:22:49,990 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-10 10:22:52,382 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 10:22:52,383 - INFO - ========== Method gen_api_seq() returned: seq=['API_1721', 'API_1722'], malicious_sign_seq=[0, 1] ==========
2025-03-10 10:22:52,383 - INFO - API sequence 8/12 generated
2025-03-10 10:22:52,383 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 10:22:55,299 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 10:22:55,299 - INFO - ========== Method gen_api_seq() returned: seq=['API_1721', 'API_1722'], malicious_sign_seq=[0, 0] ==========
2025-03-10 10:22:55,300 - INFO - API sequence 9/12 generated
2025-03-10 10:22:55,300 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-10 10:22:56,635 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 10:22:56,636 - INFO - ========== Method gen_api_seq() returned: seq=['API_1721', 'API_1722'], malicious_sign_seq=[0, 1] ==========
2025-03-10 10:22:56,636 - INFO - API sequence 10/12 generated
2025-03-10 10:22:56,636 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-10 10:22:59,854 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 10:22:59,855 - INFO - ========== Method gen_api_seq() returned: seq=['API_1721', 'API_1722'], malicious_sign_seq=[0, 1] ==========
2025-03-10 10:22:59,855 - INFO - API sequence 11/12 generated
2025-03-10 10:22:59,855 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-10 10:23:02,241 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 10:23:02,242 - INFO - ========== Method gen_api_seq() returned: seq=['API_1721', 'API_1722'], malicious_sign_seq=[0, 0] ==========
2025-03-10 10:23:02,242 - INFO - API sequence 12/12 generated
2025-03-10 10:23:02,243 - INFO - API sequences serialized to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py/serialized_llm_agents.json
2025-03-10 10:23:02,243 - INFO - Generating simulated traffic data set...
2025-03-10 10:23:02,244 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 10:23:02,244 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 10:23:02,245 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 10:23:02,245 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 10:23:02,245 - INFO - Simulated traffic data for 1/12 user collected：user: normaluser malicious: False
2025-03-10 10:23:02,245 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 10:23:02,246 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 10:23:02,246 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 10:23:02,246 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-10 10:23:02,246 - INFO - Simulated traffic data for 2/12 user collected：user: unloggeduser malicious: True
2025-03-10 10:23:02,247 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 10:23:02,247 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 10:23:02,247 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/memo/21 {}
2025-03-10 10:23:02,248 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 10:23:02,248 - INFO - Simulated traffic data for 3/12 user collected：user: normaluser malicious: False
2025-03-10 10:23:02,248 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/resource/16 {}
2025-03-10 10:23:02,249 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 10:23:02,249 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 10:23:02,249 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 10:23:02,250 - INFO - Simulated traffic data for 4/12 user collected：user: adminuser malicious: False
2025-03-10 10:23:02,250 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 10:23:02,250 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 10:23:02,250 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 10:23:02,251 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-10 10:23:02,251 - INFO - Simulated traffic data for 5/12 user collected：user: normaluser malicious: True
2025-03-10 10:23:02,251 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 10:23:02,251 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 10:23:02,252 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 10:23:02,252 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 10:23:02,252 - INFO - Simulated traffic data for 6/12 user collected：user: normaluser malicious: False
2025-03-10 10:23:02,252 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 10:23:02,252 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 10:23:02,252 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 10:23:02,252 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-10 10:23:02,252 - INFO - Simulated traffic data for 7/12 user collected：user: unloggeduser malicious: True
2025-03-10 10:23:02,252 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/resource/16 {}
2025-03-10 10:23:02,252 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 10:23:02,253 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/memo/21 {}
2025-03-10 10:23:02,253 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-10 10:23:02,253 - INFO - Simulated traffic data for 8/12 user collected：user: unloggeduser malicious: True
2025-03-10 10:23:02,253 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 10:23:02,253 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 10:23:02,253 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 10:23:02,253 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 10:23:02,253 - INFO - Simulated traffic data for 9/12 user collected：user: normaluser malicious: False
2025-03-10 10:23:02,253 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 10:23:02,253 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 10:23:02,253 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 10:23:02,254 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-10 10:23:02,254 - INFO - Simulated traffic data for 10/12 user collected：user: normaluser malicious: True
2025-03-10 10:23:02,254 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 10:23:02,254 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 10:23:02,254 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 10:23:02,254 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-10 10:23:02,254 - INFO - Simulated traffic data for 11/12 user collected：user: normaluser malicious: True
2025-03-10 10:23:02,254 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 10:23:02,254 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 10:23:02,254 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 10:23:02,254 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 10:23:02,254 - INFO - Simulated traffic data for 12/12 user collected：user: adminuser malicious: False
2025-03-10 10:23:02,257 - INFO - All simulated traffic data collected：/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/simulated_traffic_data.csv
2025-03-10 10:23:50,647 - INFO - Trying to construct model...
2025-03-10 10:23:50,647 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-10 10:23:50,693 - INFO - Training model... Size of feature_list: 6
2025-03-10 10:23:50,707 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 10:23:50,710 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 10:23:50,711 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 10:23:50,712 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 10:23:50,713 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 10:23:50,714 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 10:23:50,715 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 10:23:50,716 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 10:23:50,820 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 10:23:50,821 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 10:23:50,822 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 10:23:50,823 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 10:23:50,838 - INFO - Model constructed.
2025-03-10 16:42:20,237 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-10 16:42:20,336 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-10 16:42:20,336 - INFO - Extracting API list with API discovery algorithm...
2025-03-10 16:42:20,401 - INFO - Starting Drain3 template miner
2025-03-10 16:42:20,405 - INFO - Starting Drain3 template miner
2025-03-10 16:42:20,406 - INFO - Starting Drain3 template miner
2025-03-10 16:42:20,407 - INFO - Starting Drain3 template miner
2025-03-10 16:42:20,407 - INFO - Starting Drain3 template miner
2025-03-10 16:42:21,826 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-10 16:42:39,545 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-10 16:42:39,588 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-10 16:42:39,588 - INFO - Extracting API list with API discovery algorithm...
2025-03-10 16:42:39,649 - INFO - Starting Drain3 template miner
2025-03-10 16:42:39,652 - INFO - Starting Drain3 template miner
2025-03-10 16:42:39,654 - INFO - Starting Drain3 template miner
2025-03-10 16:42:39,655 - INFO - Starting Drain3 template miner
2025-03-10 16:42:39,655 - INFO - Starting Drain3 template miner
2025-03-10 16:42:41,099 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-10 16:42:49,535 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-10 16:42:49,577 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-10 16:42:49,578 - INFO - Extracting API list with API discovery algorithm...
2025-03-10 16:42:49,638 - INFO - Starting Drain3 template miner
2025-03-10 16:42:49,641 - INFO - Starting Drain3 template miner
2025-03-10 16:42:49,642 - INFO - Starting Drain3 template miner
2025-03-10 16:42:49,643 - INFO - Starting Drain3 template miner
2025-03-10 16:42:49,643 - INFO - Starting Drain3 template miner
2025-03-10 16:42:51,074 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-10 16:43:01,353 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-10 16:43:01,394 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-10 16:43:01,395 - INFO - Extracting API list with API discovery algorithm...
2025-03-10 16:43:01,455 - INFO - Starting Drain3 template miner
2025-03-10 16:43:01,458 - INFO - Starting Drain3 template miner
2025-03-10 16:43:01,459 - INFO - Starting Drain3 template miner
2025-03-10 16:43:01,460 - INFO - Starting Drain3 template miner
2025-03-10 16:43:01,460 - INFO - Starting Drain3 template miner
2025-03-10 16:43:02,913 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-10 16:50:13,368 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-10 16:50:13,412 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-10 16:50:13,465 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-10 16:50:13,465 - INFO - Starting data generation...
2025-03-10 16:50:13,465 - INFO - API_KNOWLEDGE: [{'number': 'API_1837', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_1838', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}]
2025-03-10 16:50:13,465 - INFO - APP_KNOWLEDGE: {'func_description': 'This is an updated test applicationaaa', 'normal_seqs': ['Role: admin; API_1837(Call 1); API_1838(Call 2)', 'Role: oridinary_user; API_1837(); API_1838()'], 'malicious_seqs': ['Role: admin; API_1837(); API_1838()', 'Role: ordinary_user; API_1837(); API_1838()'], 'roles': ['admin', 'ordinary_user', 'unlogged_in_user']}
2025-03-10 16:50:13,515 - INFO - Generating simulated API sequences...
2025-03-10 16:50:13,515 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-10 16:50:15,141 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 16:50:15,159 - INFO - ========== Method gen_api_seq() returned: seq=['API_1837', 'API_1838'], malicious_sign_seq=[0, 1] ==========
2025-03-10 16:50:15,160 - INFO - API sequence 1/12 generated
2025-03-10 16:50:15,160 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-10 16:50:16,145 - INFO - Trying to construct model...
2025-03-10 16:50:16,145 - INFO - DATA_COLLECTION_STATUS: IN_PROGRESS
2025-03-10 16:50:16,982 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 16:50:16,983 - INFO - ========== Method gen_api_seq() returned: seq=['API_1837', 'API_1838'], malicious_sign_seq=[0, 0] ==========
2025-03-10 16:50:16,983 - INFO - API sequence 2/12 generated
2025-03-10 16:50:16,983 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 16:50:19,224 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 16:50:19,224 - INFO - ========== Method gen_api_seq() returned: seq=['API_1837', 'API_1838'], malicious_sign_seq=[0, 0] ==========
2025-03-10 16:50:19,225 - INFO - API sequence 3/12 generated
2025-03-10 16:50:19,225 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-10 16:50:24,749 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 16:50:24,750 - INFO - ========== Method gen_api_seq() returned: seq=['API_1837', 'API_1838'], malicious_sign_seq=[0, 1] ==========
2025-03-10 16:50:24,751 - INFO - API sequence 4/12 generated
2025-03-10 16:50:24,751 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-10 16:50:27,529 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 16:50:27,530 - INFO - ========== Method gen_api_seq() returned: seq=['API_1837', 'API_1838'], malicious_sign_seq=[0, 1] ==========
2025-03-10 16:50:27,530 - INFO - API sequence 5/12 generated
2025-03-10 16:50:27,530 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-10 16:50:32,811 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 16:50:32,812 - INFO - ========== Method gen_api_seq() returned: seq=['API_1837', 'API_1838'], malicious_sign_seq=[0, 1] ==========
2025-03-10 16:50:32,812 - INFO - API sequence 6/12 generated
2025-03-10 16:50:32,812 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 16:50:36,910 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 16:50:36,911 - INFO - ========== Method gen_api_seq() returned: seq=['API_1837', 'API_1838'], malicious_sign_seq=[0, 0] ==========
2025-03-10 16:50:36,911 - INFO - API sequence 7/12 generated
2025-03-10 16:50:36,911 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 16:50:39,731 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 16:50:39,732 - INFO - ========== Method gen_api_seq() returned: seq=['API_1837', 'API_1838'], malicious_sign_seq=[0, 0] ==========
2025-03-10 16:50:39,732 - INFO - API sequence 8/12 generated
2025-03-10 16:50:39,732 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-10 16:50:41,738 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 16:50:41,739 - INFO - ========== Method gen_api_seq() returned: seq=['API_1837', 'API_1838'], malicious_sign_seq=[0, 1] ==========
2025-03-10 16:50:41,739 - INFO - API sequence 9/12 generated
2025-03-10 16:50:41,740 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 16:50:44,347 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 16:50:44,347 - INFO - ========== Method gen_api_seq() returned: seq=['API_1837', 'API_1838'], malicious_sign_seq=[0, 0] ==========
2025-03-10 16:50:44,348 - INFO - API sequence 10/12 generated
2025-03-10 16:50:44,348 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-10 16:50:47,963 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 16:50:47,964 - INFO - ========== Method gen_api_seq() returned: seq=['API_1837', 'API_1838'], malicious_sign_seq=[0, 0] ==========
2025-03-10 16:50:47,964 - INFO - API sequence 11/12 generated
2025-03-10 16:50:47,965 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-10 16:50:52,132 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 16:50:52,133 - INFO - ========== Method gen_api_seq() returned: seq=['API_1837', 'API_1838'], malicious_sign_seq=[0, 1] ==========
2025-03-10 16:50:52,134 - INFO - API sequence 12/12 generated
2025-03-10 16:50:52,134 - INFO - API sequences serialized to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py/serialized_llm_agents.json
2025-03-10 16:50:52,134 - INFO - Generating simulated traffic data set...
2025-03-10 16:50:52,137 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 16:50:52,137 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 16:50:52,140 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 16:50:52,140 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-10 16:50:52,140 - INFO - Simulated traffic data for 1/12 user collected：user: normaluser malicious: True
2025-03-10 16:50:52,142 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 16:50:52,142 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 16:50:52,145 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 16:50:52,145 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 16:50:52,145 - INFO - Simulated traffic data for 2/12 user collected：user: adminuser malicious: False
2025-03-10 16:50:52,147 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 16:50:52,147 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 16:50:52,150 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 16:50:52,150 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 16:50:52,150 - INFO - Simulated traffic data for 3/12 user collected：user: normaluser malicious: False
2025-03-10 16:50:52,152 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 16:50:52,152 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 16:50:52,155 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 16:50:52,155 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-10 16:50:52,155 - INFO - Simulated traffic data for 4/12 user collected：user: normaluser malicious: True
2025-03-10 16:50:52,157 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 16:50:52,157 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 16:50:52,160 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/memo/21 {}
2025-03-10 16:50:52,160 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-10 16:50:52,160 - INFO - Simulated traffic data for 5/12 user collected：user: unloggeduser malicious: True
2025-03-10 16:50:52,162 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/resource/16 {}
2025-03-10 16:50:52,162 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 16:50:52,165 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 16:50:52,165 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-10 16:50:52,165 - INFO - Simulated traffic data for 6/12 user collected：user: unloggeduser malicious: True
2025-03-10 16:50:52,167 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 16:50:52,168 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 16:50:52,170 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 16:50:52,170 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 16:50:52,170 - INFO - Simulated traffic data for 7/12 user collected：user: normaluser malicious: False
2025-03-10 16:50:52,172 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 16:50:52,173 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 16:50:52,175 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 16:50:52,175 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 16:50:52,175 - INFO - Simulated traffic data for 8/12 user collected：user: normaluser malicious: False
2025-03-10 16:50:52,177 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 16:50:52,177 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 16:50:52,180 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 16:50:52,180 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-10 16:50:52,180 - INFO - Simulated traffic data for 9/12 user collected：user: unloggeduser malicious: True
2025-03-10 16:50:52,182 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 16:50:52,182 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 16:50:52,185 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 16:50:52,185 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 16:50:52,185 - INFO - Simulated traffic data for 10/12 user collected：user: normaluser malicious: False
2025-03-10 16:50:52,187 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 16:50:52,188 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 16:50:52,190 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 16:50:52,190 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 16:50:52,190 - INFO - Simulated traffic data for 11/12 user collected：user: adminuser malicious: False
2025-03-10 16:50:52,192 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 16:50:52,193 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 16:50:52,195 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 16:50:52,195 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-10 16:50:52,195 - INFO - Simulated traffic data for 12/12 user collected：user: normaluser malicious: True
2025-03-10 16:50:52,202 - INFO - All simulated traffic data collected：/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/simulated_traffic_data.csv
2025-03-10 16:51:11,818 - INFO - Trying to construct model...
2025-03-10 16:51:11,818 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-10 16:51:11,866 - INFO - Training model... Size of feature_list: 6
2025-03-10 16:51:11,883 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 16:51:11,889 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 16:51:11,890 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 16:51:11,891 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 16:51:11,892 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 16:51:11,893 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 16:51:11,895 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 16:51:11,896 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 16:51:12,022 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 16:51:12,023 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 16:51:12,024 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 16:51:12,025 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 16:51:12,040 - INFO - Model constructed.
2025-03-10 16:51:43,083 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-10 16:51:43,126 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-10 16:51:43,126 - INFO - Extracting API list with API discovery algorithm...
2025-03-10 16:51:43,187 - INFO - Starting Drain3 template miner
2025-03-10 16:51:43,190 - INFO - Starting Drain3 template miner
2025-03-10 16:51:43,191 - INFO - Starting Drain3 template miner
2025-03-10 16:51:43,192 - INFO - Starting Drain3 template miner
2025-03-10 16:51:43,192 - INFO - Starting Drain3 template miner
2025-03-10 16:51:44,669 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-10 16:52:10,958 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-10 16:52:11,012 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-10 16:52:11,012 - INFO - Extracting API list with API discovery algorithm...
2025-03-10 16:52:11,075 - INFO - Starting Drain3 template miner
2025-03-10 16:52:11,078 - INFO - Starting Drain3 template miner
2025-03-10 16:52:11,079 - INFO - Starting Drain3 template miner
2025-03-10 16:52:11,080 - INFO - Starting Drain3 template miner
2025-03-10 16:52:11,080 - INFO - Starting Drain3 template miner
2025-03-10 16:52:12,528 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-10 16:53:28,045 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-10 16:53:28,088 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-10 16:53:28,088 - INFO - Extracting API list with API discovery algorithm...
2025-03-10 16:53:28,149 - INFO - Starting Drain3 template miner
2025-03-10 16:53:28,152 - INFO - Starting Drain3 template miner
2025-03-10 16:53:28,154 - INFO - Starting Drain3 template miner
2025-03-10 16:53:28,154 - INFO - Starting Drain3 template miner
2025-03-10 16:53:28,155 - INFO - Starting Drain3 template miner
2025-03-10 16:53:29,598 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-10 16:53:30,032 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-10 16:53:30,075 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-10 16:53:30,075 - INFO - Extracting API list with API discovery algorithm...
2025-03-10 16:53:30,135 - INFO - Starting Drain3 template miner
2025-03-10 16:53:30,137 - INFO - Starting Drain3 template miner
2025-03-10 16:53:30,139 - INFO - Starting Drain3 template miner
2025-03-10 16:53:30,140 - INFO - Starting Drain3 template miner
2025-03-10 16:53:30,140 - INFO - Starting Drain3 template miner
2025-03-10 16:53:31,597 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-10 16:53:32,624 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-10 16:53:32,672 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-10 16:53:32,672 - INFO - Extracting API list with API discovery algorithm...
2025-03-10 16:53:32,735 - INFO - Starting Drain3 template miner
2025-03-10 16:53:32,739 - INFO - Starting Drain3 template miner
2025-03-10 16:53:32,740 - INFO - Starting Drain3 template miner
2025-03-10 16:53:32,741 - INFO - Starting Drain3 template miner
2025-03-10 16:53:32,742 - INFO - Starting Drain3 template miner
2025-03-10 16:53:34,237 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-10 16:53:34,775 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-10 16:53:34,817 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-10 16:53:34,817 - INFO - Extracting API list with API discovery algorithm...
2025-03-10 16:53:34,878 - INFO - Starting Drain3 template miner
2025-03-10 16:53:34,880 - INFO - Starting Drain3 template miner
2025-03-10 16:53:34,882 - INFO - Starting Drain3 template miner
2025-03-10 16:53:34,882 - INFO - Starting Drain3 template miner
2025-03-10 16:53:34,883 - INFO - Starting Drain3 template miner
2025-03-10 16:53:36,363 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-10 16:55:52,077 - INFO - Trying to construct model...
2025-03-10 16:55:52,077 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-10 16:55:52,108 - INFO - Training model... Size of feature_list: 6
2025-03-10 16:55:52,119 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 16:55:52,120 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 16:55:52,121 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 16:55:52,122 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 16:55:52,123 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 16:55:52,124 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 16:55:52,125 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 16:55:52,127 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 16:55:52,167 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 16:55:52,168 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 16:55:52,169 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 16:55:52,170 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 16:55:52,181 - INFO - Model constructed.
2025-03-10 17:09:18,945 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-10 17:09:18,988 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-10 17:09:19,075 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-10 17:09:19,075 - INFO - Starting data generation...
2025-03-10 17:09:19,075 - INFO - API_KNOWLEDGE: [{'number': 'API_1953', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_1954', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}]
2025-03-10 17:09:19,075 - INFO - APP_KNOWLEDGE: {'func_description': 'This is an updated test applicationaaa', 'normal_seqs': ['Role: admin; API_1953(Call 1); API_1954(Call 2)', 'Role: oridinary_user; API_1953(); API_1954()'], 'malicious_seqs': ['Role: admin; API_1953(); API_1954()', 'Role: ordinary_user; API_1953(); API_1954()'], 'roles': ['admin', 'ordinary_user', 'unlogged_in_user']}
2025-03-10 17:09:19,125 - INFO - Generating simulated API sequences...
2025-03-10 17:09:19,125 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-10 17:09:22,088 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 17:09:22,089 - INFO - ========== Method gen_api_seq() returned: seq=['API_1953', 'API_1954'], malicious_sign_seq=[0, 1] ==========
2025-03-10 17:09:22,089 - INFO - API sequence 1/12 generated
2025-03-10 17:09:22,089 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-10 17:09:25,896 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 17:09:25,897 - INFO - ========== Method gen_api_seq() returned: seq=['API_1953', 'API_1954'], malicious_sign_seq=[0, 1] ==========
2025-03-10 17:09:25,897 - INFO - API sequence 2/12 generated
2025-03-10 17:09:25,897 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 17:09:29,113 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 17:09:29,114 - INFO - ========== Method gen_api_seq() returned: seq=['API_1953', 'API_1954'], malicious_sign_seq=[0, 0] ==========
2025-03-10 17:09:29,114 - INFO - API sequence 3/12 generated
2025-03-10 17:09:29,114 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-10 17:09:32,411 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 17:09:32,411 - INFO - ========== Method gen_api_seq() returned: seq=['API_1953', 'API_1954'], malicious_sign_seq=[0, 0] ==========
2025-03-10 17:09:32,412 - INFO - API sequence 4/12 generated
2025-03-10 17:09:32,412 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-10 17:09:36,177 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 17:09:36,178 - INFO - ========== Method gen_api_seq() returned: seq=['API_1953', 'API_1954'], malicious_sign_seq=[0, 0] ==========
2025-03-10 17:09:36,179 - INFO - API sequence 5/12 generated
2025-03-10 17:09:36,179 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-10 17:09:39,440 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 17:09:39,441 - INFO - ========== Method gen_api_seq() returned: seq=['API_1953', 'API_1954'], malicious_sign_seq=[0, 1] ==========
2025-03-10 17:09:39,441 - INFO - API sequence 6/12 generated
2025-03-10 17:09:39,441 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 17:09:41,191 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 17:09:41,192 - INFO - ========== Method gen_api_seq() returned: seq=['API_1953', 'API_1954'], malicious_sign_seq=[0, 0] ==========
2025-03-10 17:09:41,192 - INFO - API sequence 7/12 generated
2025-03-10 17:09:41,192 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 17:09:43,864 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 17:09:43,865 - INFO - ========== Method gen_api_seq() returned: seq=['API_1953', 'API_1954'], malicious_sign_seq=[0, 0] ==========
2025-03-10 17:09:43,865 - INFO - API sequence 8/12 generated
2025-03-10 17:09:43,865 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-10 17:09:45,749 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 17:09:45,750 - INFO - ========== Method gen_api_seq() returned: seq=['API_1953', 'API_1954'], malicious_sign_seq=[0, 1] ==========
2025-03-10 17:09:45,750 - INFO - API sequence 9/12 generated
2025-03-10 17:09:45,750 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-10 17:09:49,317 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 17:09:49,317 - INFO - ========== Method gen_api_seq() returned: seq=['API_1953', 'API_1954'], malicious_sign_seq=[0, 1] ==========
2025-03-10 17:09:49,318 - INFO - API sequence 10/12 generated
2025-03-10 17:09:49,318 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 17:09:51,190 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 17:09:51,191 - INFO - ========== Method gen_api_seq() returned: seq=['API_1953', 'API_1954'], malicious_sign_seq=[0, 0] ==========
2025-03-10 17:09:51,191 - INFO - API sequence 11/12 generated
2025-03-10 17:09:51,191 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-10 17:09:54,040 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 17:09:54,041 - INFO - ========== Method gen_api_seq() returned: seq=['API_1953', 'API_1954'], malicious_sign_seq=[0, 1] ==========
2025-03-10 17:09:54,041 - INFO - API sequence 12/12 generated
2025-03-10 17:09:54,042 - INFO - API sequences serialized to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py/serialized_llm_agents.json
2025-03-10 17:09:54,042 - INFO - Generating simulated traffic data set...
2025-03-10 17:09:54,049 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 17:09:54,049 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 17:09:54,055 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 17:09:54,055 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-10 17:09:54,055 - INFO - Simulated traffic data for 1/12 user collected：user: normaluser malicious: True
2025-03-10 17:09:54,061 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/resource/16 {}
2025-03-10 17:09:54,061 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 17:09:54,066 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 17:09:54,066 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-10 17:09:54,067 - INFO - Simulated traffic data for 2/12 user collected：user: unloggeduser malicious: True
2025-03-10 17:09:54,072 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 17:09:54,072 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 17:09:54,078 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 17:09:54,078 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 17:09:54,078 - INFO - Simulated traffic data for 3/12 user collected：user: normaluser malicious: False
2025-03-10 17:09:54,085 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 17:09:54,085 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 17:09:54,090 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 17:09:54,091 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 17:09:54,091 - INFO - Simulated traffic data for 4/12 user collected：user: adminuser malicious: False
2025-03-10 17:09:54,096 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 17:09:54,096 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 17:09:54,102 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 17:09:54,102 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 17:09:54,102 - INFO - Simulated traffic data for 5/12 user collected：user: adminuser malicious: False
2025-03-10 17:09:54,108 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 17:09:54,108 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 17:09:54,114 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 17:09:54,114 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-10 17:09:54,114 - INFO - Simulated traffic data for 6/12 user collected：user: normaluser malicious: True
2025-03-10 17:09:54,120 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 17:09:54,120 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 17:09:54,126 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 17:09:54,126 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 17:09:54,126 - INFO - Simulated traffic data for 7/12 user collected：user: normaluser malicious: False
2025-03-10 17:09:54,132 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 17:09:54,132 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 17:09:54,138 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 17:09:54,138 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 17:09:54,138 - INFO - Simulated traffic data for 8/12 user collected：user: normaluser malicious: False
2025-03-10 17:09:54,144 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 17:09:54,144 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 17:09:54,149 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 17:09:54,150 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-10 17:09:54,150 - INFO - Simulated traffic data for 9/12 user collected：user: normaluser malicious: True
2025-03-10 17:09:54,155 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 17:09:54,155 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 17:09:54,161 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 17:09:54,161 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-10 17:09:54,161 - INFO - Simulated traffic data for 10/12 user collected：user: unloggeduser malicious: True
2025-03-10 17:09:54,167 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 17:09:54,167 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 17:09:54,173 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 17:09:54,173 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 17:09:54,173 - INFO - Simulated traffic data for 11/12 user collected：user: normaluser malicious: False
2025-03-10 17:09:54,377 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 17:09:54,377 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 17:09:54,383 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 17:09:54,383 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-10 17:09:54,383 - INFO - Simulated traffic data for 12/12 user collected：user: unloggeduser malicious: True
2025-03-10 17:09:54,386 - INFO - All simulated traffic data collected：/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/simulated_traffic_data.csv
2025-03-10 23:53:42,290 - INFO - Trying to construct model...
2025-03-10 23:53:42,291 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-10 23:53:42,322 - INFO - Training model... Size of feature_list: 6
2025-03-10 23:53:42,332 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 23:53:42,333 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 23:53:42,334 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 23:53:42,335 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 23:53:42,336 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 23:53:42,337 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 23:53:42,338 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 23:53:42,339 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 23:53:42,369 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 23:53:42,371 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 23:53:42,372 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 23:53:42,373 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 23:53:42,383 - INFO - Model constructed.
2025-03-11 00:20:35,724 - INFO - Detection started. Combined data duration: 10
2025-03-11 00:44:59,705 - INFO - Detection paused.
2025-03-11 00:57:17,554 - INFO - Detection started. Combined data duration: 10
2025-03-11 00:57:18,786 - INFO - Detection paused.
2025-03-11 00:57:19,410 - INFO - Detection started. Combined data duration: 10
2025-03-11 00:57:19,988 - INFO - Detection paused.
2025-03-11 10:44:55,533 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 6
2025-03-11 10:50:23,728 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-11 10:50:23,794 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-11 10:50:23,794 - INFO - Extracting API list with API discovery algorithm...
2025-03-11 10:50:23,860 - INFO - Starting Drain3 template miner
2025-03-11 10:50:23,863 - INFO - Starting Drain3 template miner
2025-03-11 10:50:23,864 - INFO - Starting Drain3 template miner
2025-03-11 10:50:23,865 - INFO - Starting Drain3 template miner
2025-03-11 10:50:23,865 - INFO - Starting Drain3 template miner
2025-03-11 10:50:25,295 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-11 17:26:20,738 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 6
2025-03-12 08:52:50,756 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 6
2025-03-12 15:05:46,212 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 5
2025-03-12 15:05:48,054 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 5
2025-03-12 15:07:23,533 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-12 15:07:23,613 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-12 15:07:23,613 - INFO - Extracting API list with API discovery algorithm...
2025-03-12 15:07:23,678 - INFO - Starting Drain3 template miner
2025-03-12 15:07:23,681 - INFO - Starting Drain3 template miner
2025-03-12 15:07:23,683 - INFO - Starting Drain3 template miner
2025-03-12 15:07:23,683 - INFO - Starting Drain3 template miner
2025-03-12 15:07:23,684 - INFO - Starting Drain3 template miner
2025-03-12 15:07:25,107 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-12 15:07:25,273 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-12 15:07:25,344 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-12 15:07:25,344 - INFO - Extracting API list with API discovery algorithm...
2025-03-12 15:07:25,424 - INFO - Starting Drain3 template miner
2025-03-12 15:07:25,427 - INFO - Starting Drain3 template miner
2025-03-12 15:07:25,429 - INFO - Starting Drain3 template miner
2025-03-12 15:07:25,429 - INFO - Starting Drain3 template miner
2025-03-12 15:07:25,430 - INFO - Starting Drain3 template miner
2025-03-12 15:07:26,930 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-12 15:07:28,047 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-12 15:07:28,091 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-12 15:07:28,091 - INFO - Extracting API list with API discovery algorithm...
2025-03-12 15:07:28,150 - INFO - Starting Drain3 template miner
2025-03-12 15:07:28,153 - INFO - Starting Drain3 template miner
2025-03-12 15:07:28,155 - INFO - Starting Drain3 template miner
2025-03-12 15:07:28,155 - INFO - Starting Drain3 template miner
2025-03-12 15:07:28,156 - INFO - Starting Drain3 template miner
2025-03-12 15:07:29,585 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-12 15:08:34,944 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-12 15:08:34,986 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-12 15:08:34,986 - INFO - Extracting API list with API discovery algorithm...
2025-03-12 15:08:35,045 - INFO - Starting Drain3 template miner
2025-03-12 15:08:35,047 - INFO - Starting Drain3 template miner
2025-03-12 15:08:35,049 - INFO - Starting Drain3 template miner
2025-03-12 15:08:35,050 - INFO - Starting Drain3 template miner
2025-03-12 15:08:35,050 - INFO - Starting Drain3 template miner
2025-03-12 15:08:36,493 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-12 15:09:50,550 - INFO - Detection started. Combined data duration: 10
2025-03-12 15:09:52,232 - INFO - Detection paused.
2025-03-12 17:45:25,529 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-12 17:45:25,710 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-12 17:45:25,711 - INFO - Extracting API list with API discovery algorithm...
2025-03-12 17:45:25,776 - INFO - Starting Drain3 template miner
2025-03-12 17:45:25,779 - INFO - Starting Drain3 template miner
2025-03-12 17:45:25,780 - INFO - Starting Drain3 template miner
2025-03-12 17:45:25,781 - INFO - Starting Drain3 template miner
2025-03-12 17:45:25,781 - INFO - Starting Drain3 template miner
2025-03-12 17:45:27,222 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-13 11:33:18,365 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-13 11:33:18,406 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-13 11:33:18,406 - INFO - Extracting API list with API discovery algorithm...
2025-03-13 11:33:18,465 - INFO - Starting Drain3 template miner
2025-03-13 11:33:18,467 - INFO - Starting Drain3 template miner
2025-03-13 11:33:18,469 - INFO - Starting Drain3 template miner
2025-03-13 11:33:18,469 - INFO - Starting Drain3 template miner
2025-03-13 11:33:18,470 - INFO - Starting Drain3 template miner
2025-03-13 11:33:19,911 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-13 11:34:51,363 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-13 11:34:51,400 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-13 11:34:51,400 - INFO - Extracting API list with API discovery algorithm...
2025-03-13 11:34:51,460 - INFO - Starting Drain3 template miner
2025-03-13 11:34:51,463 - INFO - Starting Drain3 template miner
2025-03-13 11:34:51,464 - INFO - Starting Drain3 template miner
2025-03-13 11:34:51,465 - INFO - Starting Drain3 template miner
2025-03-13 11:34:51,465 - INFO - Starting Drain3 template miner
2025-03-13 11:34:52,894 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-13 11:38:58,582 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-13 11:38:58,628 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-13 11:38:58,629 - INFO - Extracting API list with API discovery algorithm...
2025-03-13 11:38:58,688 - INFO - Starting Drain3 template miner
2025-03-13 11:38:58,691 - INFO - Starting Drain3 template miner
2025-03-13 11:38:58,692 - INFO - Starting Drain3 template miner
2025-03-13 11:38:58,693 - INFO - Starting Drain3 template miner
2025-03-13 11:38:58,693 - INFO - Starting Drain3 template miner
2025-03-13 11:39:00,170 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-13 11:39:35,587 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-13 11:39:35,630 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-13 11:39:35,630 - INFO - Extracting API list with API discovery algorithm...
2025-03-13 11:39:35,690 - INFO - Starting Drain3 template miner
2025-03-13 11:39:35,693 - INFO - Starting Drain3 template miner
2025-03-13 11:39:35,695 - INFO - Starting Drain3 template miner
2025-03-13 11:39:35,695 - INFO - Starting Drain3 template miner
2025-03-13 11:39:35,696 - INFO - Starting Drain3 template miner
2025-03-13 11:39:37,508 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-13 11:40:19,306 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-13 11:40:19,352 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-13 11:40:19,352 - INFO - Extracting API list with API discovery algorithm...
2025-03-13 11:40:19,416 - INFO - Starting Drain3 template miner
2025-03-13 11:40:19,418 - INFO - Starting Drain3 template miner
2025-03-13 11:40:19,420 - INFO - Starting Drain3 template miner
2025-03-13 11:40:19,420 - INFO - Starting Drain3 template miner
2025-03-13 11:40:19,421 - INFO - Starting Drain3 template miner
2025-03-13 11:40:21,061 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-13 11:42:01,930 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-13 11:42:01,973 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-13 11:42:01,974 - INFO - Extracting API list with API discovery algorithm...
2025-03-13 11:42:02,034 - INFO - Starting Drain3 template miner
2025-03-13 11:42:02,037 - INFO - Starting Drain3 template miner
2025-03-13 11:42:02,038 - INFO - Starting Drain3 template miner
2025-03-13 11:42:02,039 - INFO - Starting Drain3 template miner
2025-03-13 11:42:02,039 - INFO - Starting Drain3 template miner
2025-03-13 11:42:03,681 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-13 11:59:17,665 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-13 11:59:17,709 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-13 11:59:17,804 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-13 11:59:17,804 - INFO - Starting data generation...
2025-03-13 11:59:17,805 - INFO - API_KNOWLEDGE: [{'number': 'API_2069', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_2070', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}]
2025-03-13 11:59:17,805 - INFO - APP_KNOWLEDGE: {'func_description': 'This is an updated test applicationaaaaaaa', 'normal_seqs': ['Role: admin; API_2069(Call 1); API_2070(Call 2)', 'Role: oridinary_user; API_2069(); API_2070()'], 'malicious_seqs': ['Role: admin; API_2069(); API_2070()', 'Role: ordinary_user; API_2069(); API_2070()'], 'roles': ['admin', 'ordinary_user', 'unlogged_in_user']}
2025-03-13 11:59:18,044 - INFO - Generating simulated API sequences...
2025-03-13 11:59:18,044 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-13 11:59:19,538 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 11:59:19,577 - INFO - ========== Method gen_api_seq() returned: seq=['API_2069'], malicious_sign_seq=[0] ==========
2025-03-13 11:59:19,577 - INFO - API sequence 1/12 generated
2025-03-13 11:59:19,577 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-13 11:59:22,430 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 11:59:22,431 - INFO - ========== Method gen_api_seq() returned: seq=['API_2069', 'API_2070'], malicious_sign_seq=[0, 1] ==========
2025-03-13 11:59:22,432 - INFO - API sequence 2/12 generated
2025-03-13 11:59:22,432 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-13 11:59:24,077 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 11:59:24,078 - INFO - ========== Method gen_api_seq() returned: seq=['API_2069', 'API_2070'], malicious_sign_seq=[0, 1] ==========
2025-03-13 11:59:24,078 - INFO - API sequence 3/12 generated
2025-03-13 11:59:24,078 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-13 11:59:25,404 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 11:59:25,405 - INFO - ========== Method gen_api_seq() returned: seq=['API_2069', 'API_2070'], malicious_sign_seq=[0, 1] ==========
2025-03-13 11:59:25,415 - INFO - API sequence 4/12 generated
2025-03-13 11:59:25,415 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-13 11:59:26,913 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 11:59:26,914 - INFO - ========== Method gen_api_seq() returned: seq=['API_2069', 'API_2070'], malicious_sign_seq=[0, 1] ==========
2025-03-13 11:59:26,914 - INFO - API sequence 5/12 generated
2025-03-13 11:59:26,914 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-13 11:59:28,475 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 11:59:28,476 - INFO - ========== Method gen_api_seq() returned: seq=['API_2069', 'API_2070'], malicious_sign_seq=[0, 0] ==========
2025-03-13 11:59:28,476 - INFO - API sequence 6/12 generated
2025-03-13 11:59:28,476 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-13 11:59:30,212 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-13 11:59:30,254 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-13 11:59:30,254 - INFO - Extracting API list with API discovery algorithm...
2025-03-13 11:59:30,313 - INFO - Starting Drain3 template miner
2025-03-13 11:59:30,316 - INFO - Starting Drain3 template miner
2025-03-13 11:59:30,317 - INFO - Starting Drain3 template miner
2025-03-13 11:59:30,318 - INFO - Starting Drain3 template miner
2025-03-13 11:59:30,318 - INFO - Starting Drain3 template miner
2025-03-13 11:59:31,636 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 11:59:31,642 - INFO - ========== Method gen_api_seq() returned: seq=['API_2069', 'API_2070'], malicious_sign_seq=[0, 1] ==========
2025-03-13 11:59:31,653 - INFO - API sequence 7/12 generated
2025-03-13 11:59:31,658 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-13 11:59:31,820 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-13 11:59:32,877 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 11:59:32,878 - INFO - ========== Method gen_api_seq() returned: seq=['API_2069'], malicious_sign_seq=[0] ==========
2025-03-13 11:59:32,878 - INFO - API sequence 8/12 generated
2025-03-13 11:59:32,878 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-13 11:59:34,205 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 11:59:34,206 - INFO - ========== Method gen_api_seq() returned: seq=['API_2069', 'API_2070'], malicious_sign_seq=[0, 0] ==========
2025-03-13 11:59:34,206 - INFO - API sequence 9/12 generated
2025-03-13 11:59:34,206 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-13 11:59:35,862 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 11:59:35,863 - INFO - ========== Method gen_api_seq() returned: seq=['API_2069', 'API_2070'], malicious_sign_seq=[0, 0] ==========
2025-03-13 11:59:35,863 - INFO - API sequence 10/12 generated
2025-03-13 11:59:35,863 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-13 11:59:38,723 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 11:59:38,724 - INFO - ========== Method gen_api_seq() returned: seq=['API_2069', 'API_2070'], malicious_sign_seq=[0, 1] ==========
2025-03-13 11:59:38,724 - INFO - API sequence 11/12 generated
2025-03-13 11:59:38,724 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-13 11:59:41,193 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 11:59:41,194 - INFO - ========== Method gen_api_seq() returned: seq=['API_2069', 'API_2070'], malicious_sign_seq=[0, 0] ==========
2025-03-13 11:59:41,194 - INFO - API sequence 12/12 generated
2025-03-13 11:59:41,194 - INFO - API sequences serialized to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py/serialized_llm_agents.json
2025-03-13 11:59:41,194 - INFO - Generating simulated traffic data set...
2025-03-13 11:59:41,203 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-13 11:59:41,203 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 11:59:41,203 - INFO - Simulated traffic data for 1/12 user collected：user: normaluser malicious: False
2025-03-13 11:59:41,210 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-13 11:59:41,210 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 11:59:41,217 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-13 11:59:41,217 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-13 11:59:41,217 - INFO - Simulated traffic data for 2/12 user collected：user: normaluser malicious: True
2025-03-13 11:59:41,224 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-13 11:59:41,224 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 11:59:41,231 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-13 11:59:41,231 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-13 11:59:41,231 - INFO - Simulated traffic data for 3/12 user collected：user: unloggeduser malicious: True
2025-03-13 11:59:41,238 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-13 11:59:41,238 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 11:59:41,245 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-13 11:59:41,245 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-13 11:59:41,245 - INFO - Simulated traffic data for 4/12 user collected：user: normaluser malicious: True
2025-03-13 11:59:41,251 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-13 11:59:41,252 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 11:59:41,259 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-13 11:59:41,259 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-13 11:59:41,259 - INFO - Simulated traffic data for 5/12 user collected：user: normaluser malicious: True
2025-03-13 11:59:41,266 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-13 11:59:41,266 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 11:59:41,273 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-13 11:59:41,273 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 11:59:41,273 - INFO - Simulated traffic data for 6/12 user collected：user: adminuser malicious: False
2025-03-13 11:59:41,280 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-13 11:59:41,280 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 11:59:41,287 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-13 11:59:41,287 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-13 11:59:41,288 - INFO - Simulated traffic data for 7/12 user collected：user: unloggeduser malicious: True
2025-03-13 11:59:41,294 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-13 11:59:41,294 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 11:59:41,295 - INFO - Simulated traffic data for 8/12 user collected：user: adminuser malicious: False
2025-03-13 11:59:41,434 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-13 11:59:41,434 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 11:59:41,441 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-13 11:59:41,441 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 11:59:41,441 - INFO - Simulated traffic data for 9/12 user collected：user: normaluser malicious: False
2025-03-13 11:59:41,448 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-13 11:59:41,448 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 11:59:41,456 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-13 11:59:41,456 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 11:59:41,456 - INFO - Simulated traffic data for 10/12 user collected：user: normaluser malicious: False
2025-03-13 11:59:41,463 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-13 11:59:41,463 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 11:59:41,470 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-13 11:59:41,470 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-13 11:59:41,470 - INFO - Simulated traffic data for 11/12 user collected：user: unloggeduser malicious: True
2025-03-13 11:59:41,477 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-13 11:59:41,477 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 11:59:41,484 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-13 11:59:41,484 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 11:59:41,484 - INFO - Simulated traffic data for 12/12 user collected：user: normaluser malicious: False
2025-03-13 11:59:41,497 - INFO - All simulated traffic data collected：/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/simulated_traffic_data.csv
2025-03-13 15:22:28,916 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-13 15:22:28,954 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-13 15:22:28,954 - INFO - Extracting API list with API discovery algorithm...
2025-03-13 15:22:29,013 - INFO - Starting Drain3 template miner
2025-03-13 15:22:29,016 - INFO - Starting Drain3 template miner
2025-03-13 15:22:29,017 - INFO - Starting Drain3 template miner
2025-03-13 15:22:29,018 - INFO - Starting Drain3 template miner
2025-03-13 15:22:29,018 - INFO - Starting Drain3 template miner
2025-03-13 15:22:30,492 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-13 15:23:06,755 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-13 15:23:06,795 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-13 15:23:06,795 - INFO - Extracting API list with API discovery algorithm...
2025-03-13 15:23:06,856 - INFO - Starting Drain3 template miner
2025-03-13 15:23:06,858 - INFO - Starting Drain3 template miner
2025-03-13 15:23:06,860 - INFO - Starting Drain3 template miner
2025-03-13 15:23:06,860 - INFO - Starting Drain3 template miner
2025-03-13 15:23:06,861 - INFO - Starting Drain3 template miner
2025-03-13 15:23:08,366 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-13 15:24:46,302 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-13 15:24:46,340 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-13 15:24:46,340 - INFO - Extracting API list with API discovery algorithm...
2025-03-13 15:24:46,405 - INFO - Starting Drain3 template miner
2025-03-13 15:24:46,408 - INFO - Starting Drain3 template miner
2025-03-13 15:24:46,410 - INFO - Starting Drain3 template miner
2025-03-13 15:24:46,410 - INFO - Starting Drain3 template miner
2025-03-13 15:24:46,411 - INFO - Starting Drain3 template miner
2025-03-13 15:24:47,912 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-13 17:29:03,638 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-13 17:29:03,676 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-13 17:29:03,780 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-13 17:29:03,780 - INFO - Starting data generation...
2025-03-13 17:29:03,780 - INFO - API_KNOWLEDGE: [{'number': 'API_2071', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_2072', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}]
2025-03-13 17:29:03,780 - INFO - APP_KNOWLEDGE: {'func_description': 'This is an updated test applicationaaaaaaa', 'normal_seqs': ['There are no example normal seqs'], 'malicious_seqs': ['There are no example malicious seqs'], 'roles': ['admin', 'ordinary_user', 'unlogged_in_user']}
2025-03-13 17:29:03,845 - INFO - Generating simulated API sequences...
2025-03-13 17:29:03,845 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-13 17:29:07,660 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 17:29:07,661 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-13 17:29:07,661 - INFO - API sequence 1/12 generated
2025-03-13 17:29:07,661 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-13 17:29:08,992 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 17:29:08,993 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-13 17:29:08,994 - INFO - API sequence 2/12 generated
2025-03-13 17:29:08,994 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-13 17:29:10,833 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 17:29:10,834 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-13 17:29:10,834 - INFO - API sequence 3/12 generated
2025-03-13 17:29:10,834 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-13 17:29:12,091 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 17:29:12,092 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-13 17:29:12,092 - INFO - API sequence 4/12 generated
2025-03-13 17:29:12,092 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-13 17:29:13,251 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 17:29:13,252 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-13 17:29:13,252 - INFO - API sequence 5/12 generated
2025-03-13 17:29:13,252 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-13 17:29:15,532 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 17:29:15,533 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-13 17:29:15,533 - INFO - API sequence 6/12 generated
2025-03-13 17:29:15,533 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-13 17:29:17,884 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 17:29:17,884 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-13 17:29:17,884 - INFO - API sequence 7/12 generated
2025-03-13 17:29:17,885 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-13 17:29:19,585 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 17:29:19,586 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-13 17:29:19,586 - INFO - API sequence 8/12 generated
2025-03-13 17:29:19,586 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-13 17:29:20,767 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 17:29:20,768 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-13 17:29:20,768 - INFO - API sequence 9/12 generated
2025-03-13 17:29:20,768 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-13 17:29:22,629 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 17:29:22,630 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-13 17:29:22,630 - INFO - API sequence 10/12 generated
2025-03-13 17:29:22,630 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-13 17:29:30,354 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 17:29:30,355 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-13 17:29:30,355 - INFO - API sequence 11/12 generated
2025-03-13 17:29:30,355 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-13 17:29:31,839 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 17:29:31,840 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-13 17:29:31,840 - INFO - API sequence 12/12 generated
2025-03-13 17:29:31,840 - INFO - API sequences serialized to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py/serialized_llm_agents.json
2025-03-13 17:29:31,840 - INFO - Generating simulated traffic data set...
2025-03-13 17:29:31,849 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-13 17:29:31,850 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 17:29:31,858 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-13 17:29:31,858 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-13 17:29:31,858 - INFO - Simulated traffic data for 1/12 user collected：user: normaluser malicious: True
2025-03-13 17:29:31,867 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/resource/16 {}
2025-03-13 17:29:31,867 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 17:29:31,867 - INFO - Simulated traffic data for 2/12 user collected：user: adminuser malicious: False
2025-03-13 17:29:31,876 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-13 17:29:31,877 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 17:29:31,877 - INFO - Simulated traffic data for 3/12 user collected：user: normaluser malicious: False
2025-03-13 17:29:31,886 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-13 17:29:31,886 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 17:29:31,886 - INFO - Simulated traffic data for 4/12 user collected：user: normaluser malicious: False
2025-03-13 17:29:31,895 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-13 17:29:31,895 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 17:29:31,895 - INFO - Simulated traffic data for 5/12 user collected：user: adminuser malicious: False
2025-03-13 17:29:31,903 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-13 17:29:31,903 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 17:29:31,912 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-13 17:29:31,912 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-13 17:29:31,912 - INFO - Simulated traffic data for 6/12 user collected：user: normaluser malicious: True
2025-03-13 17:29:31,920 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-13 17:29:31,920 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 17:29:31,929 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-13 17:29:31,929 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-13 17:29:31,937 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-13 17:29:31,937 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：False
2025-03-13 17:29:31,937 - INFO - Simulated traffic data for 7/12 user collected：user: unloggeduser malicious: True
2025-03-13 17:29:32,026 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-13 17:29:32,026 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 17:29:32,034 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/resource/16 {}
2025-03-13 17:29:32,035 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-13 17:29:32,035 - INFO - Simulated traffic data for 8/12 user collected：user: unloggeduser malicious: True
2025-03-13 17:29:32,043 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/resource/16 {}
2025-03-13 17:29:32,044 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 17:29:32,044 - INFO - Simulated traffic data for 9/12 user collected：user: normaluser malicious: False
2025-03-13 17:29:32,052 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-13 17:29:32,052 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 17:29:32,053 - INFO - Simulated traffic data for 10/12 user collected：user: normaluser malicious: False
2025-03-13 17:29:32,061 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-13 17:29:32,061 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 17:29:32,070 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-13 17:29:32,071 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-13 17:29:32,071 - INFO - Simulated traffic data for 11/12 user collected：user: normaluser malicious: True
2025-03-13 17:29:32,080 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-13 17:29:32,080 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 17:29:32,088 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-13 17:29:32,088 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-13 17:29:32,088 - INFO - Simulated traffic data for 12/12 user collected：user: unloggeduser malicious: True
2025-03-13 17:29:32,091 - INFO - All simulated traffic data collected：/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/simulated_traffic_data.csv
2025-03-13 17:31:27,675 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-13 17:31:27,713 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-13 17:31:27,816 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-13 17:31:27,816 - INFO - Starting data generation...
2025-03-13 17:31:27,816 - INFO - API_KNOWLEDGE: [{'number': 'API_2073', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_2074', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}]
2025-03-13 17:31:27,817 - INFO - APP_KNOWLEDGE: {'func_description': 'This is an updated test applicationaaaaaaa', 'normal_seqs': ['There are no example normal seqs'], 'malicious_seqs': ['There are no example malicious seqs'], 'roles': ['admin', 'ordinary_user', 'unlogged_in_user']}
2025-03-13 17:31:27,866 - INFO - Generating simulated API sequences...
2025-03-13 17:31:27,866 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-13 17:31:30,310 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 17:31:30,311 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-13 17:31:30,311 - INFO - API sequence 1/12 generated
2025-03-13 17:31:30,311 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-13 17:31:32,687 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 17:31:32,688 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-13 17:31:32,688 - INFO - API sequence 2/12 generated
2025-03-13 17:31:32,688 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-13 17:31:34,471 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 17:31:34,472 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-13 17:31:34,472 - INFO - API sequence 3/12 generated
2025-03-13 17:31:34,472 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-13 17:31:35,781 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 17:31:35,782 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-13 17:31:35,782 - INFO - API sequence 4/12 generated
2025-03-13 17:31:35,782 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-13 17:31:37,327 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 17:31:37,327 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-13 17:31:37,327 - INFO - API sequence 5/12 generated
2025-03-13 17:31:37,327 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-13 17:31:39,548 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 17:31:39,549 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-13 17:31:39,549 - INFO - API sequence 6/12 generated
2025-03-13 17:31:39,549 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-13 17:31:41,044 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 17:31:41,045 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-13 17:31:41,045 - INFO - API sequence 7/12 generated
2025-03-13 17:31:41,045 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-13 17:31:42,924 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 17:31:42,925 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-13 17:31:42,925 - INFO - API sequence 8/12 generated
2025-03-13 17:31:42,925 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-13 17:31:45,283 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 17:31:45,284 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-13 17:31:45,284 - INFO - API sequence 9/12 generated
2025-03-13 17:31:45,284 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-13 17:31:46,843 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 17:31:46,844 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-13 17:31:46,844 - INFO - API sequence 10/12 generated
2025-03-13 17:31:46,844 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-13 17:31:49,296 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 17:31:49,297 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-13 17:31:49,297 - INFO - API sequence 11/12 generated
2025-03-13 17:31:49,297 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-13 17:32:00,249 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 17:32:00,249 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-13 17:32:00,250 - INFO - API sequence 12/12 generated
2025-03-13 17:32:00,250 - INFO - API sequences serialized to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py/serialized_llm_agents.json
2025-03-13 17:32:00,250 - INFO - Generating simulated traffic data set...
2025-03-13 17:32:00,259 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-13 17:32:00,259 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 19:51:35,721 - INFO - Detection started. Combined data duration: 10
2025-03-13 19:51:36,459 - INFO - Detection paused.
2025-03-13 19:56:15,865 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-13 19:56:16,016 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-13 19:56:16,016 - INFO - Extracting API list with API discovery algorithm...
2025-03-13 19:56:16,083 - INFO - Starting Drain3 template miner
2025-03-13 19:56:16,085 - INFO - Starting Drain3 template miner
2025-03-13 19:56:16,087 - INFO - Starting Drain3 template miner
2025-03-13 19:56:16,088 - INFO - Starting Drain3 template miner
2025-03-13 19:56:16,088 - INFO - Starting Drain3 template miner
2025-03-13 19:56:17,622 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-13 19:56:22,884 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-13 19:56:22,939 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-13 19:56:22,939 - INFO - Extracting API list with API discovery algorithm...
2025-03-13 19:56:23,004 - INFO - Starting Drain3 template miner
2025-03-13 19:56:23,008 - INFO - Starting Drain3 template miner
2025-03-13 19:56:23,009 - INFO - Starting Drain3 template miner
2025-03-13 19:56:23,010 - INFO - Starting Drain3 template miner
2025-03-13 19:56:23,011 - INFO - Starting Drain3 template miner
2025-03-13 19:56:24,560 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-13 19:57:27,846 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-13 19:57:27,891 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-13 19:57:27,892 - INFO - Extracting API list with API discovery algorithm...
2025-03-13 19:57:27,954 - INFO - Starting Drain3 template miner
2025-03-13 19:57:27,956 - INFO - Starting Drain3 template miner
2025-03-13 19:57:27,958 - INFO - Starting Drain3 template miner
2025-03-13 19:57:27,958 - INFO - Starting Drain3 template miner
2025-03-13 19:57:27,959 - INFO - Starting Drain3 template miner
2025-03-13 19:57:29,506 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-13 20:04:34,352 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
2025-03-13 20:04:36,397 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
2025-03-13 20:05:10,500 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
2025-03-13 20:05:37,483 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test applicationaaaaaaa', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-12 07:10:52', 'is_draft': False, 'last_API_discovery_at': '2025-03-13 07:23:08', 'last_model_construction_at': '2025-03-10 15:53:42', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': '              precision    recall  f1-score   support\n\n           0       0.50      1.00      0.67         2\n           1       0.00      0.00      0.00         2\n\n    accuracy                           0.50         4\n   macro avg       0.25      0.50      0.33         4\nweighted avg       0.25      0.50      0.33         4\n', 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-13 20:05:37,484 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
2025-03-13 20:05:52,240 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test applicationaaaaaaa', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-12 07:10:52', 'is_draft': False, 'last_API_discovery_at': '2025-03-13 07:23:08', 'last_model_construction_at': '2025-03-10 15:53:42', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': '              precision    recall  f1-score   support\n\n           0       0.50      1.00      0.67         2\n           1       0.00      0.00      0.00         2\n\n    accuracy                           0.50         4\n   macro avg       0.25      0.50      0.33         4\nweighted avg       0.25      0.50      0.33         4\n', 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-13 20:05:52,240 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
2025-03-13 20:19:58,976 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test applicationaaaaaaa', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-12 07:10:52', 'is_draft': False, 'last_API_discovery_at': '2025-03-13 07:23:08', 'last_model_construction_at': '2025-03-10 15:53:42', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': '              precision    recall  f1-score   support\n\n           0       0.50      1.00      0.67         2\n           1       0.00      0.00      0.00         2\n\n    accuracy                           0.50         4\n   macro avg       0.25      0.50      0.33         4\nweighted avg       0.25      0.50      0.33         4\n', 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-13 20:19:58,977 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
2025-03-13 20:20:00,876 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test applicationaaaaaaa', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-12 07:10:52', 'is_draft': False, 'last_API_discovery_at': '2025-03-13 07:23:08', 'last_model_construction_at': '2025-03-10 15:53:42', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': '              precision    recall  f1-score   support\n\n           0       0.50      1.00      0.67         2\n           1       0.00      0.00      0.00         2\n\n    accuracy                           0.50         4\n   macro avg       0.25      0.50      0.33         4\nweighted avg       0.25      0.50      0.33         4\n', 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-13 20:20:00,876 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
2025-03-13 20:34:41,681 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-13 20:34:41,874 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-13 20:34:41,874 - INFO - Extracting API list with API discovery algorithm...
2025-03-13 20:34:41,947 - INFO - Starting Drain3 template miner
2025-03-13 20:34:41,951 - INFO - Starting Drain3 template miner
2025-03-13 20:34:41,952 - INFO - Starting Drain3 template miner
2025-03-13 20:34:41,953 - INFO - Starting Drain3 template miner
2025-03-13 20:34:41,953 - INFO - Starting Drain3 template miner
2025-03-13 20:34:43,397 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-13 20:40:08,319 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-13 20:40:08,372 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-13 20:40:08,372 - INFO - Extracting API list with API discovery algorithm...
2025-03-13 20:40:08,434 - INFO - Starting Drain3 template miner
2025-03-13 20:40:08,437 - INFO - Starting Drain3 template miner
2025-03-13 20:40:08,438 - INFO - Starting Drain3 template miner
2025-03-13 20:40:08,439 - INFO - Starting Drain3 template miner
2025-03-13 20:40:08,439 - INFO - Starting Drain3 template miner
2025-03-13 20:40:09,854 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-13 20:42:34,523 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-13 20:42:34,566 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-13 20:42:34,567 - INFO - Extracting API list with API discovery algorithm...
2025-03-13 20:42:34,625 - INFO - Starting Drain3 template miner
2025-03-13 20:42:34,627 - INFO - Starting Drain3 template miner
2025-03-13 20:42:34,629 - INFO - Starting Drain3 template miner
2025-03-13 20:42:34,629 - INFO - Starting Drain3 template miner
2025-03-13 20:42:34,630 - INFO - Starting Drain3 template miner
2025-03-13 20:42:36,033 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-13 20:43:53,971 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-13 20:43:54,014 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-13 20:43:54,014 - INFO - Extracting API list with API discovery algorithm...
2025-03-13 20:43:54,073 - INFO - Starting Drain3 template miner
2025-03-13 20:43:54,076 - INFO - Starting Drain3 template miner
2025-03-13 20:43:54,077 - INFO - Starting Drain3 template miner
2025-03-13 20:43:54,078 - INFO - Starting Drain3 template miner
2025-03-13 20:43:54,078 - INFO - Starting Drain3 template miner
2025-03-13 20:43:55,509 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-13 20:43:58,683 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-13 20:43:58,741 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-13 20:43:58,742 - INFO - Extracting API list with API discovery algorithm...
2025-03-13 20:43:58,809 - INFO - Starting Drain3 template miner
2025-03-13 20:43:58,812 - INFO - Starting Drain3 template miner
2025-03-13 20:43:58,813 - INFO - Starting Drain3 template miner
2025-03-13 20:43:58,814 - INFO - Starting Drain3 template miner
2025-03-13 20:43:58,815 - INFO - Starting Drain3 template miner
2025-03-13 20:44:00,245 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-13 20:44:00,707 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-13 20:44:00,750 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-13 20:44:00,750 - INFO - Extracting API list with API discovery algorithm...
2025-03-13 20:44:00,809 - INFO - Starting Drain3 template miner
2025-03-13 20:44:00,812 - INFO - Starting Drain3 template miner
2025-03-13 20:44:00,813 - INFO - Starting Drain3 template miner
2025-03-13 20:44:00,814 - INFO - Starting Drain3 template miner
2025-03-13 20:44:00,815 - INFO - Starting Drain3 template miner
2025-03-13 20:44:02,269 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-13 20:44:02,705 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-13 20:44:02,746 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-13 20:44:02,746 - INFO - Extracting API list with API discovery algorithm...
2025-03-13 20:44:02,806 - INFO - Starting Drain3 template miner
2025-03-13 20:44:02,808 - INFO - Starting Drain3 template miner
2025-03-13 20:44:02,810 - INFO - Starting Drain3 template miner
2025-03-13 20:44:02,810 - INFO - Starting Drain3 template miner
2025-03-13 20:44:02,811 - INFO - Starting Drain3 template miner
2025-03-13 20:44:04,248 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-13 22:29:04,540 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-13 22:29:04,585 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-13 22:29:04,585 - INFO - Extracting API list with API discovery algorithm...
2025-03-13 22:29:04,645 - INFO - Starting Drain3 template miner
2025-03-13 22:29:04,648 - INFO - Starting Drain3 template miner
2025-03-13 22:29:04,650 - INFO - Starting Drain3 template miner
2025-03-13 22:29:04,651 - INFO - Starting Drain3 template miner
2025-03-13 22:29:04,651 - INFO - Starting Drain3 template miner
2025-03-13 22:29:06,092 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-13 23:28:10,786 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test applicationaaaaaaa', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-12 07:10:52', 'is_draft': False, 'last_API_discovery_at': '2025-03-13 14:29:06', 'last_model_construction_at': '2025-03-10 15:53:42', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': '              precision    recall  f1-score   support\n\n           0       0.50      1.00      0.67         2\n           1       0.00      0.00      0.00         2\n\n    accuracy                           0.50         4\n   macro avg       0.25      0.50      0.33         4\nweighted avg       0.25      0.50      0.33         4\n', 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-13 23:28:10,787 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
2025-03-13 23:28:13,902 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test applicationaaaaaaa', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-12 07:10:52', 'is_draft': False, 'last_API_discovery_at': '2025-03-13 14:29:06', 'last_model_construction_at': '2025-03-10 15:53:42', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': '              precision    recall  f1-score   support\n\n           0       0.50      1.00      0.67         2\n           1       0.00      0.00      0.00         2\n\n    accuracy                           0.50         4\n   macro avg       0.25      0.50      0.33         4\nweighted avg       0.25      0.50      0.33         4\n', 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-13 23:28:13,902 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
2025-03-13 23:44:33,167 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-13 23:44:33,341 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-13 23:44:33,373 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-13 23:44:33,374 - INFO - Starting data generation...
2025-03-13 23:44:33,375 - INFO - API_KNOWLEDGE: [{'number': 'API_2417', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_2418', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}]
2025-03-13 23:44:33,375 - INFO - APP_KNOWLEDGE: {'func_description': 'This is an updated test applicationaaaaaaa', 'normal_seqs': ['Role: admin; API_2417(Call 1); API_2418(Call 2)', 'Role: oridinary_user; API_2417(); API_2418()'], 'malicious_seqs': ['Role: admin; API_2417(); API_2418()', 'Role: ordinary_user; API_2417(); API_2418()'], 'roles': ['admin', 'ordinary_user', 'unlogged_in_user']}
2025-03-13 23:44:33,751 - INFO - Generating simulated API sequences...
2025-03-13 23:44:33,751 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-13 23:44:35,286 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 23:44:35,324 - INFO - ========== Method gen_api_seq() returned: seq=['API_2417', 'API_2418'], malicious_sign_seq=[0, 0] ==========
2025-03-13 23:44:35,324 - INFO - API sequence 1/12 generated
2025-03-13 23:44:35,324 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-13 23:44:38,656 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 23:44:38,657 - INFO - ========== Method gen_api_seq() returned: seq=['API_2417', 'API_2418'], malicious_sign_seq=[0, 0] ==========
2025-03-13 23:44:38,657 - INFO - API sequence 2/12 generated
2025-03-13 23:44:38,657 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-13 23:44:40,021 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 23:44:40,022 - INFO - ========== Method gen_api_seq() returned: seq=['API_2417', 'API_2418'], malicious_sign_seq=[0, 0] ==========
2025-03-13 23:44:40,022 - INFO - API sequence 3/12 generated
2025-03-13 23:44:40,022 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-13 23:44:42,676 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 23:44:42,677 - INFO - ========== Method gen_api_seq() returned: seq=['API_2417', 'API_2418'], malicious_sign_seq=[0, 1] ==========
2025-03-13 23:44:42,677 - INFO - API sequence 4/12 generated
2025-03-13 23:44:42,677 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-13 23:44:43,936 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 23:44:43,937 - INFO - ========== Method gen_api_seq() returned: seq=['API_2417', 'API_2418'], malicious_sign_seq=[0, 1] ==========
2025-03-13 23:44:43,937 - INFO - API sequence 5/12 generated
2025-03-13 23:44:43,938 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-13 23:44:45,100 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 23:44:45,101 - INFO - ========== Method gen_api_seq() returned: seq=['API_2417', 'API_2418'], malicious_sign_seq=[0, 1] ==========
2025-03-13 23:44:45,101 - INFO - API sequence 6/12 generated
2025-03-13 23:44:45,101 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-13 23:44:46,911 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 23:44:46,912 - INFO - ========== Method gen_api_seq() returned: seq=['API_2417', 'API_2418'], malicious_sign_seq=[0, 1] ==========
2025-03-13 23:44:46,912 - INFO - API sequence 7/12 generated
2025-03-13 23:44:46,912 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-13 23:44:48,224 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 23:44:48,225 - INFO - ========== Method gen_api_seq() returned: seq=['API_2417', 'API_2418'], malicious_sign_seq=[0, 0] ==========
2025-03-13 23:44:48,225 - INFO - API sequence 8/12 generated
2025-03-13 23:44:48,225 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-13 23:44:49,878 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 23:44:49,879 - INFO - ========== Method gen_api_seq() returned: seq=['API_2417', 'API_2418'], malicious_sign_seq=[0, 0] ==========
2025-03-13 23:44:49,879 - INFO - API sequence 9/12 generated
2025-03-13 23:44:49,879 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-13 23:44:52,293 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 23:44:52,294 - INFO - ========== Method gen_api_seq() returned: seq=['API_2417', 'API_2418'], malicious_sign_seq=[0, 1] ==========
2025-03-13 23:44:52,294 - INFO - API sequence 10/12 generated
2025-03-13 23:44:52,294 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-13 23:44:54,825 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 23:44:54,826 - INFO - ========== Method gen_api_seq() returned: seq=['API_2417', 'API_2418'], malicious_sign_seq=[0, 1] ==========
2025-03-13 23:44:54,826 - INFO - API sequence 11/12 generated
2025-03-13 23:44:54,827 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-13 23:44:57,265 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 23:44:57,266 - INFO - ========== Method gen_api_seq() returned: seq=['API_2417', 'API_2418'], malicious_sign_seq=[0, 0] ==========
2025-03-13 23:44:57,266 - INFO - API sequence 12/12 generated
2025-03-13 23:44:57,266 - INFO - API sequences serialized to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py/serialized_llm_agents.json
2025-03-13 23:44:57,266 - INFO - Generating simulated traffic data set...
2025-03-13 23:44:57,267 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-13 23:44:57,267 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 23:44:57,267 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/memo/21 {}
2025-03-13 23:44:57,267 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 23:44:57,267 - INFO - Simulated traffic data for 1/12 user collected：user: normaluser malicious: False
2025-03-13 23:44:57,267 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-13 23:44:57,267 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 23:44:57,267 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-13 23:44:57,267 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 23:44:57,268 - INFO - Simulated traffic data for 2/12 user collected：user: normaluser malicious: False
2025-03-13 23:44:57,268 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-13 23:44:57,268 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 23:44:57,268 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-13 23:44:57,268 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 23:44:57,268 - INFO - Simulated traffic data for 3/12 user collected：user: adminuser malicious: False
2025-03-13 23:44:57,268 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-13 23:44:57,268 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 23:44:57,268 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-13 23:44:57,268 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-13 23:44:57,268 - INFO - Simulated traffic data for 4/12 user collected：user: unloggeduser malicious: True
2025-03-13 23:44:57,269 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-13 23:44:57,269 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 23:44:57,269 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-13 23:44:57,269 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-13 23:44:57,269 - INFO - Simulated traffic data for 5/12 user collected：user: unloggeduser malicious: True
2025-03-13 23:44:57,269 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/resource/16 {}
2025-03-13 23:44:57,269 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 23:44:57,269 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-13 23:44:57,269 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-13 23:44:57,269 - INFO - Simulated traffic data for 6/12 user collected：user: normaluser malicious: True
2025-03-13 23:44:57,269 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-13 23:44:57,269 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 23:44:57,270 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-13 23:44:57,270 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-13 23:44:57,270 - INFO - Simulated traffic data for 7/12 user collected：user: normaluser malicious: True
2025-03-13 23:44:57,270 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-13 23:44:57,270 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 23:44:57,270 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-13 23:44:57,270 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 23:44:57,270 - INFO - Simulated traffic data for 8/12 user collected：user: normaluser malicious: False
2025-03-13 23:44:57,270 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-13 23:44:57,270 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 23:44:57,270 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-13 23:44:57,271 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 23:44:57,271 - INFO - Simulated traffic data for 9/12 user collected：user: adminuser malicious: False
2025-03-13 23:44:57,271 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-13 23:44:57,271 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 23:44:57,271 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-13 23:44:57,271 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-13 23:44:57,271 - INFO - Simulated traffic data for 10/12 user collected：user: unloggeduser malicious: True
2025-03-13 23:44:57,271 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-13 23:44:57,271 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 23:44:57,271 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/memo/21 {}
2025-03-13 23:44:57,271 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-13 23:44:57,271 - INFO - Simulated traffic data for 11/12 user collected：user: normaluser malicious: True
2025-03-13 23:44:57,272 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-13 23:44:57,272 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 23:44:57,272 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-13 23:44:57,272 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 23:44:57,272 - INFO - Simulated traffic data for 12/12 user collected：user: normaluser malicious: False
2025-03-13 23:44:57,283 - INFO - All simulated traffic data collected：/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/simulated_traffic_data.csv
2025-03-13 23:57:22,240 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-13 23:57:22,284 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-13 23:57:22,284 - INFO - Extracting API list with API discovery algorithm...
2025-03-13 23:57:22,353 - INFO - Starting Drain3 template miner
2025-03-13 23:57:22,356 - INFO - Starting Drain3 template miner
2025-03-13 23:57:22,358 - INFO - Starting Drain3 template miner
2025-03-13 23:57:22,359 - INFO - Starting Drain3 template miner
2025-03-13 23:57:22,359 - INFO - Starting Drain3 template miner
2025-03-13 23:57:23,752 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-14 09:02:07,686 - INFO - Trying to construct model...
2025-03-14 09:02:07,687 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-14 09:02:07,740 - INFO - Training model... Size of feature_list: 8
2025-03-14 09:02:07,755 - INFO - Extracting features... Size of feature_list: 8
2025-03-14 09:02:07,762 - INFO - Extracting features... Size of feature_list: 8
2025-03-14 09:02:07,764 - INFO - Extracting features... Size of feature_list: 8
2025-03-14 09:02:07,766 - INFO - Extracting features... Size of feature_list: 8
2025-03-14 09:02:07,767 - INFO - Extracting features... Size of feature_list: 8
2025-03-14 09:02:07,769 - INFO - Extracting features... Size of feature_list: 8
2025-03-14 09:02:07,771 - INFO - Extracting features... Size of feature_list: 8
2025-03-14 09:02:07,772 - INFO - Extracting features... Size of feature_list: 8
2025-03-14 09:02:07,901 - INFO - Extracting features... Size of feature_list: 8
2025-03-14 09:02:07,903 - INFO - Extracting features... Size of feature_list: 8
2025-03-14 09:02:07,906 - INFO - Extracting features... Size of feature_list: 8
2025-03-14 09:02:07,908 - INFO - Extracting features... Size of feature_list: 8
2025-03-14 09:02:07,950 - INFO - Model constructed.
2025-03-14 09:06:29,022 - INFO - Trying to construct model...
2025-03-14 09:06:29,024 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-14 09:06:29,058 - INFO - Training model... Size of feature_list: 8
2025-03-14 09:06:29,069 - INFO - Extracting features... Size of feature_list: 8
2025-03-14 09:06:29,071 - INFO - Extracting features... Size of feature_list: 8
2025-03-14 09:06:29,073 - INFO - Extracting features... Size of feature_list: 8
2025-03-14 09:06:29,074 - INFO - Extracting features... Size of feature_list: 8
2025-03-14 09:06:29,076 - INFO - Extracting features... Size of feature_list: 8
2025-03-14 09:06:29,078 - INFO - Extracting features... Size of feature_list: 8
2025-03-14 09:06:29,079 - INFO - Extracting features... Size of feature_list: 8
2025-03-14 09:06:29,081 - INFO - Extracting features... Size of feature_list: 8
2025-03-14 09:06:29,112 - INFO - Extracting features... Size of feature_list: 8
2025-03-14 09:06:29,115 - INFO - Extracting features... Size of feature_list: 8
2025-03-14 09:06:29,116 - INFO - Extracting features... Size of feature_list: 8
2025-03-14 09:06:29,118 - INFO - Extracting features... Size of feature_list: 8
2025-03-14 09:06:29,131 - INFO - Model constructed.
2025-03-14 10:07:02,030 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-13 15:57:24', 'last_model_construction_at': '2025-03-14 01:06:29', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.5, 1.0, 0.67, 2.0, 0.0, 0.0, 0.0, 2.0, 0.5, 4.0, 0.25, 0.5, 0.33, 4.0, 0.25, 0.5, 0.33, 4.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-14 10:07:02,031 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 6
2025-03-14 10:07:04,785 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-13 15:57:24', 'last_model_construction_at': '2025-03-14 01:06:29', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.5, 1.0, 0.67, 2.0, 0.0, 0.0, 0.0, 2.0, 0.5, 4.0, 0.25, 0.5, 0.33, 4.0, 0.25, 0.5, 0.33, 4.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-14 10:07:04,785 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 6
2025-03-14 10:08:30,127 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-13 15:57:24', 'last_model_construction_at': '2025-03-14 01:06:29', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.5, 1.0, 0.67, 2.0, 0.0, 0.0, 0.0, 2.0, 0.5, 4.0, 0.25, 0.5, 0.33, 4.0, 0.25, 0.5, 0.33, 4.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-14 10:08:30,127 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 6
2025-03-14 10:08:32,337 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-13 15:57:24', 'last_model_construction_at': '2025-03-14 01:06:29', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.5, 1.0, 0.67, 2.0, 0.0, 0.0, 0.0, 2.0, 0.5, 4.0, 0.25, 0.5, 0.33, 4.0, 0.25, 0.5, 0.33, 4.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-14 10:08:32,337 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 6
2025-03-14 10:11:30,319 - INFO - Trying to construct model...
2025-03-14 10:11:30,320 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-14 10:11:30,394 - INFO - Training model... Size of feature_list: 6
2025-03-14 10:11:30,415 - INFO - Extracting features... Size of feature_list: 6
2025-03-14 10:11:30,421 - INFO - Extracting features... Size of feature_list: 6
2025-03-14 10:11:30,422 - INFO - Extracting features... Size of feature_list: 6
2025-03-14 10:11:30,423 - INFO - Extracting features... Size of feature_list: 6
2025-03-14 10:11:30,424 - INFO - Extracting features... Size of feature_list: 6
2025-03-14 10:11:30,425 - INFO - Extracting features... Size of feature_list: 6
2025-03-14 10:11:30,427 - INFO - Extracting features... Size of feature_list: 6
2025-03-14 10:11:30,428 - INFO - Extracting features... Size of feature_list: 6
2025-03-14 10:11:30,564 - INFO - Extracting features... Size of feature_list: 6
2025-03-14 10:11:30,566 - INFO - Extracting features... Size of feature_list: 6
2025-03-14 10:11:30,567 - INFO - Extracting features... Size of feature_list: 6
2025-03-14 10:11:30,568 - INFO - Extracting features... Size of feature_list: 6
2025-03-14 10:11:30,584 - INFO - Model constructed.
2025-03-14 11:38:09,104 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-14 11:38:09,197 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-14 11:38:09,227 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-14 11:38:09,227 - INFO - Starting data generation...
2025-03-14 11:38:09,227 - INFO - API_KNOWLEDGE: [{'number': 'API_2476', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_2477', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}]
2025-03-14 11:38:09,227 - INFO - APP_KNOWLEDGE: {'func_description': 'This is an updated test application', 'normal_seqs': ['Role: admin; API_2476(Call 1); API_2477(Call 2)', 'Role: oridinary_user; API_2476(); API_2477()'], 'malicious_seqs': ['Role: admin; API_2476(); API_2477()', 'Role: ordinary_user; API_2476(); API_2477()'], 'roles': ['admin', 'ordinary_user', 'unlogged_in_user']}
2025-03-14 11:38:09,543 - INFO - Generating simulated API sequences...
2025-03-14 11:38:09,543 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 11:38:14,657 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 11:38:14,661 - INFO - ========== Method gen_api_seq() returned: seq=['API_2476', 'API_2477'], malicious_sign_seq=[0, 0] ==========
2025-03-14 11:38:14,661 - INFO - API sequence 1/12 generated
2025-03-14 11:38:14,662 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 11:38:16,488 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 11:38:16,489 - INFO - ========== Method gen_api_seq() returned: seq=['API_2476', 'API_2477'], malicious_sign_seq=[0, 0] ==========
2025-03-14 11:38:16,489 - INFO - API sequence 2/12 generated
2025-03-14 11:38:16,489 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 11:38:17,860 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 11:38:17,861 - INFO - ========== Method gen_api_seq() returned: seq=['API_2476', 'API_2477'], malicious_sign_seq=[0, 1] ==========
2025-03-14 11:38:17,861 - INFO - API sequence 3/12 generated
2025-03-14 11:38:17,861 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 11:38:19,927 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 11:38:19,930 - INFO - ========== Method gen_api_seq() returned: seq=['API_2476', 'API_2477'], malicious_sign_seq=[0, 0] ==========
2025-03-14 11:38:19,932 - INFO - API sequence 4/12 generated
2025-03-14 11:38:19,932 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 11:38:22,950 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 11:38:22,951 - INFO - ========== Method gen_api_seq() returned: seq=['API_2476', 'API_2477'], malicious_sign_seq=[0, 1] ==========
2025-03-14 11:38:22,951 - INFO - API sequence 5/12 generated
2025-03-14 11:38:22,951 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 11:38:25,665 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 11:38:25,666 - INFO - ========== Method gen_api_seq() returned: seq=['API_2476', 'API_2477'], malicious_sign_seq=[0, 1] ==========
2025-03-14 11:38:25,666 - INFO - API sequence 6/12 generated
2025-03-14 11:38:25,666 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 11:38:26,663 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 11:38:26,664 - INFO - ========== Method gen_api_seq() returned: seq=['API_2476'], malicious_sign_seq=[0] ==========
2025-03-14 11:38:26,664 - INFO - API sequence 7/12 generated
2025-03-14 11:38:26,664 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 11:38:28,992 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 11:38:28,993 - INFO - ========== Method gen_api_seq() returned: seq=['API_2476', 'API_2477'], malicious_sign_seq=[0, 0] ==========
2025-03-14 11:38:28,993 - INFO - API sequence 8/12 generated
2025-03-14 11:38:28,993 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 11:38:30,794 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 11:38:30,794 - INFO - ========== Method gen_api_seq() returned: seq=['API_2476', 'API_2477'], malicious_sign_seq=[0, 1] ==========
2025-03-14 11:38:30,795 - INFO - API sequence 9/12 generated
2025-03-14 11:38:30,795 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 11:38:33,403 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 11:38:33,404 - INFO - ========== Method gen_api_seq() returned: seq=['API_2476'], malicious_sign_seq=[0] ==========
2025-03-14 11:38:33,404 - INFO - API sequence 10/12 generated
2025-03-14 11:38:33,404 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 11:38:36,134 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 11:38:36,135 - INFO - ========== Method gen_api_seq() returned: seq=['API_2476', 'API_2477'], malicious_sign_seq=[0, 1] ==========
2025-03-14 11:38:36,135 - INFO - API sequence 11/12 generated
2025-03-14 11:38:36,135 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 11:38:37,726 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 11:38:37,727 - INFO - ========== Method gen_api_seq() returned: seq=['API_2476', 'API_2477'], malicious_sign_seq=[0, 1] ==========
2025-03-14 11:38:37,728 - INFO - API sequence 12/12 generated
2025-03-14 11:38:37,728 - INFO - API sequences serialized to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py/serialized_llm_agents.json
2025-03-14 11:38:37,728 - INFO - Generating simulated traffic data set...
2025-03-14 11:43:03,387 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-13 15:57:24', 'last_model_construction_at': '2025-03-14 02:11:30', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.5, 1.0, 0.67, 2.0, 0.0, 0.0, 0.0, 2.0, 0.5, 4.0, 0.25, 0.5, 0.33, 4.0, 0.25, 0.5, 0.33, 4.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-14 11:43:03,388 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
2025-03-14 11:50:14,366 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-13 15:57:24', 'last_model_construction_at': '2025-03-14 02:11:30', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.5, 1.0, 0.67, 2.0, 0.0, 0.0, 0.0, 2.0, 0.5, 4.0, 0.25, 0.5, 0.33, 4.0, 0.25, 0.5, 0.33, 4.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-14 11:50:14,368 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
2025-03-14 11:51:04,061 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-13 15:57:24', 'last_model_construction_at': '2025-03-14 02:11:30', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.5, 1.0, 0.67, 2.0, 0.0, 0.0, 0.0, 2.0, 0.5, 4.0, 0.25, 0.5, 0.33, 4.0, 0.25, 0.5, 0.33, 4.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-14 11:51:04,061 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
2025-03-14 11:52:21,878 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-13 15:57:24', 'last_model_construction_at': '2025-03-14 02:11:30', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.5, 1.0, 0.67, 2.0, 0.0, 0.0, 0.0, 2.0, 0.5, 4.0, 0.25, 0.5, 0.33, 4.0, 0.25, 0.5, 0.33, 4.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-14 11:52:21,879 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
2025-03-14 11:53:48,783 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-13 15:57:24', 'last_model_construction_at': '2025-03-14 02:11:30', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.5, 1.0, 0.67, 2.0, 0.0, 0.0, 0.0, 2.0, 0.5, 4.0, 0.25, 0.5, 0.33, 4.0, 0.25, 0.5, 0.33, 4.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-14 11:53:48,784 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
2025-03-14 11:54:56,773 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-13 15:57:24', 'last_model_construction_at': '2025-03-14 02:11:30', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.5, 1.0, 0.67, 2.0, 0.0, 0.0, 0.0, 2.0, 0.5, 4.0, 0.25, 0.5, 0.33, 4.0, 0.25, 0.5, 0.33, 4.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-14 11:54:56,773 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
2025-03-14 11:55:06,729 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-13 15:57:24', 'last_model_construction_at': '2025-03-14 02:11:30', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.5, 1.0, 0.67, 2.0, 0.0, 0.0, 0.0, 2.0, 0.5, 4.0, 0.25, 0.5, 0.33, 4.0, 0.25, 0.5, 0.33, 4.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-14 11:55:06,729 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
2025-03-14 11:55:20,803 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-13 15:57:24', 'last_model_construction_at': '2025-03-14 02:11:30', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.5, 1.0, 0.67, 2.0, 0.0, 0.0, 0.0, 2.0, 0.5, 4.0, 0.25, 0.5, 0.33, 4.0, 0.25, 0.5, 0.33, 4.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-14 11:55:20,803 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
2025-03-14 11:55:52,210 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-13 15:57:24', 'last_model_construction_at': '2025-03-14 02:11:30', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.5, 1.0, 0.67, 2.0, 0.0, 0.0, 0.0, 2.0, 0.5, 4.0, 0.25, 0.5, 0.33, 4.0, 0.25, 0.5, 0.33, 4.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-14 11:55:52,210 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
2025-03-14 11:55:52,391 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-14 11:55:52,480 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-14 11:55:52,512 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-14 11:55:52,512 - INFO - Starting data generation...
2025-03-14 11:55:52,512 - INFO - API_KNOWLEDGE: [{'number': 'API_2478', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_2479', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}]
2025-03-14 11:55:52,512 - INFO - APP_KNOWLEDGE: {'func_description': 'This is an updated test application', 'normal_seqs': ['Role: admin; API_2478(Call 1); API_2479(Call 2)', 'Role: oridinary_user; API_2478(); API_2479()'], 'malicious_seqs': ['Role: admin; API_2478(); API_2479()', 'Role: ordinary_user; API_2478(); API_2479()'], 'roles': ['admin', 'ordinary_user', 'unlogged_in_user']}
2025-03-14 11:55:52,820 - INFO - Generating simulated API sequences...
2025-03-14 11:55:52,820 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 11:55:55,372 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 11:55:55,376 - INFO - ========== Method gen_api_seq() returned: seq=['API_2478', 'API_2479'], malicious_sign_seq=[0, 1] ==========
2025-03-14 11:55:55,376 - INFO - API sequence 1/12 generated
2025-03-14 11:55:55,376 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 11:55:58,931 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 11:55:58,932 - INFO - ========== Method gen_api_seq() returned: seq=['API_2478', 'API_2479'], malicious_sign_seq=[0, 1] ==========
2025-03-14 11:55:58,932 - INFO - API sequence 2/12 generated
2025-03-14 11:55:58,932 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 11:56:00,334 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 11:56:00,334 - INFO - ========== Method gen_api_seq() returned: seq=['API_2478', 'API_2479'], malicious_sign_seq=[0, 0] ==========
2025-03-14 11:56:00,335 - INFO - API sequence 3/12 generated
2025-03-14 11:56:00,335 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 11:56:02,722 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 11:56:02,723 - INFO - ========== Method gen_api_seq() returned: seq=['API_2478', 'API_2479'], malicious_sign_seq=[0, 1] ==========
2025-03-14 11:56:02,723 - INFO - API sequence 4/12 generated
2025-03-14 11:56:02,723 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 11:56:04,643 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 11:56:04,644 - INFO - ========== Method gen_api_seq() returned: seq=['API_2478', 'API_2479'], malicious_sign_seq=[0, 1] ==========
2025-03-14 11:56:04,644 - INFO - API sequence 5/12 generated
2025-03-14 11:56:04,645 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 11:56:07,165 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 11:56:07,166 - INFO - ========== Method gen_api_seq() returned: seq=['API_2478', 'API_2479'], malicious_sign_seq=[0, 0] ==========
2025-03-14 11:56:07,166 - INFO - API sequence 6/12 generated
2025-03-14 11:56:07,166 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 11:56:08,662 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 11:56:08,663 - INFO - ========== Method gen_api_seq() returned: seq=['API_2478', 'API_2479'], malicious_sign_seq=[0, 1] ==========
2025-03-14 11:56:08,663 - INFO - API sequence 7/12 generated
2025-03-14 11:56:08,663 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 11:56:10,302 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 11:56:10,303 - INFO - ========== Method gen_api_seq() returned: seq=['API_2478', 'API_2479'], malicious_sign_seq=[0, 1] ==========
2025-03-14 11:56:10,303 - INFO - API sequence 8/12 generated
2025-03-14 11:56:10,304 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 11:56:12,187 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 11:56:12,188 - INFO - ========== Method gen_api_seq() returned: seq=['API_2478'], malicious_sign_seq=[0] ==========
2025-03-14 11:56:12,188 - INFO - API sequence 9/12 generated
2025-03-14 11:56:12,188 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 11:56:14,747 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 11:56:14,748 - INFO - ========== Method gen_api_seq() returned: seq=['API_2478', 'API_2479'], malicious_sign_seq=[0, 0] ==========
2025-03-14 11:56:14,749 - INFO - API sequence 10/12 generated
2025-03-14 11:56:14,749 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 11:56:17,078 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 11:56:17,079 - INFO - ========== Method gen_api_seq() returned: seq=['API_2478', 'API_2479'], malicious_sign_seq=[0, 0] ==========
2025-03-14 11:56:17,079 - INFO - API sequence 11/12 generated
2025-03-14 11:56:17,080 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 11:56:18,761 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 11:56:18,762 - INFO - ========== Method gen_api_seq() returned: seq=['API_2478', 'API_2479'], malicious_sign_seq=[0, 0] ==========
2025-03-14 11:56:18,762 - INFO - API sequence 12/12 generated
2025-03-14 11:56:18,762 - INFO - API sequences serialized to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py/serialized_llm_agents.json
2025-03-14 11:56:18,762 - INFO - Generating simulated traffic data set...
2025-03-14 11:56:18,762 - INFO - Error when injecting params for API_2478
2025-03-14 11:56:18,763 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 11:56:18,763 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 11:56:18,763 - INFO - Simulated traffic data for 1/12 user collected：user: normaluser malicious: True
2025-03-14 11:56:18,763 - INFO - Error when injecting params for API_2478
2025-03-14 11:56:18,763 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/memo/21 {}
2025-03-14 11:56:18,763 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 11:56:18,763 - INFO - Simulated traffic data for 2/12 user collected：user: unloggeduser malicious: True
2025-03-14 11:56:18,763 - INFO - Error when injecting params for API_2478
2025-03-14 11:56:18,763 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 11:56:18,764 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 11:56:18,764 - INFO - Simulated traffic data for 3/12 user collected：user: normaluser malicious: False
2025-03-14 11:56:18,764 - INFO - Error when injecting params for API_2478
2025-03-14 11:56:18,764 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 11:56:18,764 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 11:56:18,764 - INFO - Simulated traffic data for 4/12 user collected：user: normaluser malicious: True
2025-03-14 11:56:18,764 - INFO - Error when injecting params for API_2478
2025-03-14 11:56:18,764 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/memo/21 {}
2025-03-14 11:56:18,764 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 11:56:18,764 - INFO - Simulated traffic data for 5/12 user collected：user: unloggeduser malicious: True
2025-03-14 11:56:18,765 - INFO - Error when injecting params for API_2478
2025-03-14 11:56:18,765 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 11:56:18,765 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 11:56:18,765 - INFO - Simulated traffic data for 6/12 user collected：user: normaluser malicious: False
2025-03-14 11:56:18,765 - INFO - Error when injecting params for API_2478
2025-03-14 11:56:18,765 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 11:56:18,765 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 11:56:18,765 - INFO - Simulated traffic data for 7/12 user collected：user: normaluser malicious: True
2025-03-14 11:56:18,765 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/resource/16 {}
2025-03-14 11:56:18,765 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 11:56:18,765 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 11:56:18,765 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 11:56:18,766 - INFO - Simulated traffic data for 8/12 user collected：user: unloggeduser malicious: True
2025-03-14 11:56:18,766 - INFO - Error when injecting params for API_2478
2025-03-14 11:56:18,766 - INFO - Simulated traffic data for 9/12 user collected：user: adminuser malicious: False
2025-03-14 11:56:18,766 - INFO - Error when injecting params for API_2478
2025-03-14 11:56:18,766 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 11:56:18,766 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 11:56:18,766 - INFO - Simulated traffic data for 10/12 user collected：user: normaluser malicious: False
2025-03-14 11:56:18,766 - INFO - Error when injecting params for API_2478
2025-03-14 11:56:18,766 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 11:56:18,766 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 11:56:18,766 - INFO - Simulated traffic data for 11/12 user collected：user: normaluser malicious: False
2025-03-14 11:56:18,767 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/resource/16 {}
2025-03-14 11:56:18,767 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 11:56:18,767 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 11:56:18,767 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 11:56:18,767 - INFO - Simulated traffic data for 12/12 user collected：user: adminuser malicious: False
2025-03-14 11:56:18,771 - INFO - All simulated traffic data collected：/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/simulated_traffic_data.csv
2025-03-14 11:56:42,431 - INFO - Trying to construct model...
2025-03-14 11:56:42,432 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-14 11:56:42,476 - INFO - Training model... Size of feature_list: 7
2025-03-14 11:56:42,492 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 11:56:42,497 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 11:56:42,498 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 11:56:42,499 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 11:56:42,500 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 11:56:42,502 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 11:56:42,503 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 11:56:42,504 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 11:56:42,671 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 11:56:42,673 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 11:56:42,674 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 11:56:42,690 - INFO - Model constructed.
2025-03-14 11:57:04,141 - INFO - Trying to construct model...
2025-03-14 11:57:04,142 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-14 11:57:04,169 - INFO - Training model... Size of feature_list: 7
2025-03-14 11:57:04,179 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 11:57:04,180 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 11:57:04,181 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 11:57:04,183 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 11:57:04,184 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 11:57:04,185 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 11:57:04,187 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 11:57:04,188 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 11:57:04,216 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 11:57:04,218 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 11:57:04,220 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 11:57:04,231 - INFO - Model constructed.
2025-03-14 12:01:25,840 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-13 15:57:24', 'last_model_construction_at': '2025-03-14 03:57:04', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.33, 1.0, 0.5, 1.0, 0.0, 0.0, 0.0, 2.0, 0.33, 3.0, 0.17, 0.5, 0.25, 3.0, 0.11, 0.33, 0.17, 3.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-14 12:01:25,840 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
2025-03-14 12:01:27,596 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-13 15:57:24', 'last_model_construction_at': '2025-03-14 03:57:04', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.33, 1.0, 0.5, 1.0, 0.0, 0.0, 0.0, 2.0, 0.33, 3.0, 0.17, 0.5, 0.25, 3.0, 0.11, 0.33, 0.17, 3.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-14 12:01:27,596 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
2025-03-14 12:01:27,741 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-14 12:01:27,795 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-14 12:01:27,827 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-14 12:01:27,827 - INFO - Starting data generation...
2025-03-14 12:01:27,827 - INFO - API_KNOWLEDGE: [{'number': 'API_2484', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_2485', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}]
2025-03-14 12:01:27,828 - INFO - APP_KNOWLEDGE: {'func_description': 'This is an updated test application', 'normal_seqs': ['Role: admin; API_2484(Call 1); API_2485(Call 2)', 'Role: oridinary_user; API_2484(); API_2485()'], 'malicious_seqs': ['Role: admin; API_2484(); API_2485()', 'Role: ordinary_user; API_2484(); API_2485()'], 'roles': ['admin', 'ordinary_user', 'unlogged_in_user']}
2025-03-14 12:01:28,025 - INFO - Generating simulated API sequences...
2025-03-14 12:01:28,025 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:01:30,863 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:01:30,867 - INFO - ========== Method gen_api_seq() returned: seq=['API_2484', 'API_2485'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:01:30,867 - INFO - API sequence 1/12 generated
2025-03-14 12:01:30,867 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:01:32,404 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:01:32,405 - INFO - ========== Method gen_api_seq() returned: seq=['API_2484', 'API_2485'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:01:32,405 - INFO - API sequence 2/12 generated
2025-03-14 12:01:32,405 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 12:01:34,424 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:01:34,424 - INFO - ========== Method gen_api_seq() returned: seq=['API_2484'], malicious_sign_seq=[0] ==========
2025-03-14 12:01:34,425 - INFO - API sequence 3/12 generated
2025-03-14 12:01:34,425 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:01:35,854 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:01:35,855 - INFO - ========== Method gen_api_seq() returned: seq=['API_2484', 'API_2485'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:01:35,855 - INFO - API sequence 4/12 generated
2025-03-14 12:01:35,855 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:01:37,173 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:01:37,173 - INFO - ========== Method gen_api_seq() returned: seq=['API_2484', 'API_2485'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:01:37,174 - INFO - API sequence 5/12 generated
2025-03-14 12:01:37,174 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:01:38,507 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:01:38,508 - INFO - ========== Method gen_api_seq() returned: seq=['API_2484', 'API_2485'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:01:38,508 - INFO - API sequence 6/12 generated
2025-03-14 12:01:38,508 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:01:39,874 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:01:39,874 - INFO - ========== Method gen_api_seq() returned: seq=['API_2484', 'API_2485'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:01:39,875 - INFO - API sequence 7/12 generated
2025-03-14 12:01:39,875 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:01:41,003 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:01:41,004 - INFO - ========== Method gen_api_seq() returned: seq=['API_2484'], malicious_sign_seq=[0] ==========
2025-03-14 12:01:41,004 - INFO - API sequence 8/12 generated
2025-03-14 12:01:41,004 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 12:01:43,703 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:01:43,704 - INFO - ========== Method gen_api_seq() returned: seq=['API_2484', 'API_2485'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:01:43,704 - INFO - API sequence 9/12 generated
2025-03-14 12:01:43,704 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:01:44,900 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:01:44,902 - INFO - ========== Method gen_api_seq() returned: seq=['API_2484', 'API_2485'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:01:44,902 - INFO - API sequence 10/12 generated
2025-03-14 12:01:44,902 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:01:46,135 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:01:46,136 - INFO - ========== Method gen_api_seq() returned: seq=['API_2484', 'API_2485'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:01:46,136 - INFO - API sequence 11/12 generated
2025-03-14 12:01:46,136 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:01:47,565 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:01:47,566 - INFO - ========== Method gen_api_seq() returned: seq=['API_2484', 'API_2485'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:01:47,566 - INFO - API sequence 12/12 generated
2025-03-14 12:01:47,567 - INFO - API sequences serialized to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py/serialized_llm_agents.json
2025-03-14 12:01:47,567 - INFO - Generating simulated traffic data set...
2025-03-14 12:01:47,568 - INFO - Error when injecting params for API_2484
2025-03-14 12:01:47,568 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:01:47,569 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:01:47,569 - INFO - Simulated traffic data for 1/12 user collected：user: normaluser malicious: False
2025-03-14 12:01:47,569 - INFO - Error when injecting params for API_2484
2025-03-14 12:01:47,569 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:01:47,570 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:01:47,570 - INFO - Simulated traffic data for 2/12 user collected：user: normaluser malicious: True
2025-03-14 12:01:47,570 - INFO - Error when injecting params for API_2484
2025-03-14 12:01:47,570 - INFO - Simulated traffic data for 3/12 user collected：user: adminuser malicious: False
2025-03-14 12:01:47,571 - INFO - Error when injecting params for API_2484
2025-03-14 12:01:47,571 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:01:47,571 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:01:47,571 - INFO - Simulated traffic data for 4/12 user collected：user: normaluser malicious: False
2025-03-14 12:01:47,572 - INFO - Error when injecting params for API_2484
2025-03-14 12:01:47,572 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:01:47,572 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:01:47,572 - INFO - Simulated traffic data for 5/12 user collected：user: unloggeduser malicious: True
2025-03-14 12:01:47,573 - INFO - Error when injecting params for API_2484
2025-03-14 12:01:47,573 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:01:47,573 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:01:47,573 - INFO - Simulated traffic data for 6/12 user collected：user: normaluser malicious: False
2025-03-14 12:01:47,574 - INFO - Error when injecting params for API_2484
2025-03-14 12:01:47,574 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/memo/21 {}
2025-03-14 12:01:47,574 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:01:47,574 - INFO - Simulated traffic data for 7/12 user collected：user: unloggeduser malicious: True
2025-03-14 12:01:47,575 - INFO - Error when injecting params for API_2484
2025-03-14 12:01:47,575 - INFO - Simulated traffic data for 8/12 user collected：user: normaluser malicious: False
2025-03-14 12:01:47,575 - INFO - Error when injecting params for API_2484
2025-03-14 12:01:47,576 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:01:47,576 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:01:47,576 - INFO - Simulated traffic data for 9/12 user collected：user: adminuser malicious: False
2025-03-14 12:01:47,576 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/resource/16 {}
2025-03-14 12:01:47,577 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:01:47,577 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:01:47,577 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:01:47,577 - INFO - Simulated traffic data for 10/12 user collected：user: normaluser malicious: True
2025-03-14 12:01:47,578 - INFO - Error when injecting params for API_2484
2025-03-14 12:01:47,578 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:01:47,578 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:01:47,578 - INFO - Simulated traffic data for 11/12 user collected：user: unloggeduser malicious: True
2025-03-14 12:01:47,579 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/resource/16 {}
2025-03-14 12:01:47,579 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:01:47,579 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:01:47,579 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:01:47,579 - INFO - Simulated traffic data for 12/12 user collected：user: normaluser malicious: True
2025-03-14 12:01:47,582 - INFO - All simulated traffic data collected：/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/simulated_traffic_data.csv
2025-03-14 12:01:47,582 - INFO - error_apis: []
2025-03-14 12:03:28,492 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-13 15:57:24', 'last_model_construction_at': '2025-03-14 03:57:04', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.33, 1.0, 0.5, 1.0, 0.0, 0.0, 0.0, 2.0, 0.33, 3.0, 0.17, 0.5, 0.25, 3.0, 0.11, 0.33, 0.17, 3.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-14 12:03:28,492 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
2025-03-14 12:03:31,543 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-14 12:03:31,593 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-14 12:03:31,624 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-14 12:03:31,625 - INFO - Starting data generation...
2025-03-14 12:03:31,625 - INFO - API_KNOWLEDGE: [{'number': 'API_2486', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_2487', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}]
2025-03-14 12:03:31,625 - INFO - APP_KNOWLEDGE: {'func_description': 'This is an updated test application', 'normal_seqs': ['Role: admin; API_2486(Call 1); API_2487(Call 2)', 'Role: oridinary_user; API_2486(); API_2487()'], 'malicious_seqs': ['Role: admin; API_2486(); API_2487()', 'Role: ordinary_user; API_2486(); API_2487()'], 'roles': ['admin', 'ordinary_user', 'unlogged_in_user']}
2025-03-14 12:03:31,840 - INFO - Generating simulated API sequences...
2025-03-14 12:03:31,840 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:03:33,239 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:03:33,243 - INFO - ========== Method gen_api_seq() returned: seq=['API_2486', 'API_2487'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:03:33,243 - INFO - API sequence 1/12 generated
2025-03-14 12:03:33,243 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:03:35,815 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:03:35,816 - INFO - ========== Method gen_api_seq() returned: seq=['API_2486', 'API_2487'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:03:35,816 - INFO - API sequence 2/12 generated
2025-03-14 12:03:35,816 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:03:38,062 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:03:38,063 - INFO - ========== Method gen_api_seq() returned: seq=['API_2486', 'API_2487'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:03:38,063 - INFO - API sequence 3/12 generated
2025-03-14 12:03:38,064 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 12:03:40,597 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:03:40,598 - INFO - ========== Method gen_api_seq() returned: seq=['API_2486', 'API_2487'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:03:40,598 - INFO - API sequence 4/12 generated
2025-03-14 12:03:40,598 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:03:43,614 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:03:43,614 - INFO - ========== Method gen_api_seq() returned: seq=['API_2486', 'API_2487'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:03:43,615 - INFO - API sequence 5/12 generated
2025-03-14 12:03:43,615 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:03:44,957 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:03:44,958 - INFO - ========== Method gen_api_seq() returned: seq=['API_2486', 'API_2487'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:03:44,958 - INFO - API sequence 6/12 generated
2025-03-14 12:03:44,958 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:03:47,372 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:03:47,373 - INFO - ========== Method gen_api_seq() returned: seq=['API_2486', 'API_2487'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:03:47,373 - INFO - API sequence 7/12 generated
2025-03-14 12:03:47,373 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:03:48,698 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:03:48,699 - INFO - ========== Method gen_api_seq() returned: seq=['API_2486', 'API_2487'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:03:48,699 - INFO - API sequence 8/12 generated
2025-03-14 12:03:48,699 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 12:03:50,643 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:03:50,644 - INFO - ========== Method gen_api_seq() returned: seq=['API_2486'], malicious_sign_seq=[0] ==========
2025-03-14 12:03:50,644 - INFO - API sequence 9/12 generated
2025-03-14 12:03:50,644 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:03:51,910 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:03:51,911 - INFO - ========== Method gen_api_seq() returned: seq=['API_2486', 'API_2487'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:03:51,911 - INFO - API sequence 10/12 generated
2025-03-14 12:03:51,911 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:03:54,297 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:03:54,298 - INFO - ========== Method gen_api_seq() returned: seq=['API_2486', 'API_2487'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:03:54,298 - INFO - API sequence 11/12 generated
2025-03-14 12:03:54,298 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:03:55,569 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:03:55,570 - INFO - ========== Method gen_api_seq() returned: seq=['API_2486', 'API_2487'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:03:55,570 - INFO - API sequence 12/12 generated
2025-03-14 12:03:55,571 - INFO - API sequences serialized to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py/serialized_llm_agents.json
2025-03-14 12:03:55,571 - INFO - Generating simulated traffic data set...
2025-03-14 12:03:55,571 - INFO - Error when injecting params for API_2486
2025-03-14 12:03:55,572 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:03:55,572 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:03:55,572 - INFO - error_apis: [<algorithm.entity.api.API object at 0x7f1b3714ef20>]
2025-03-14 12:03:55,572 - INFO - Simulated traffic data for 1/12 user collected：user: normaluser malicious: True
2025-03-14 12:03:55,572 - INFO - Error when injecting params for API_2486
2025-03-14 12:03:55,572 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:03:55,572 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:03:55,572 - INFO - error_apis: [<algorithm.entity.api.API object at 0x7f1b3714ef20>]
2025-03-14 12:03:55,572 - INFO - Simulated traffic data for 2/12 user collected：user: normaluser malicious: True
2025-03-14 12:03:55,572 - INFO - Error when injecting params for API_2486
2025-03-14 12:03:55,573 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:03:55,573 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:03:55,573 - INFO - error_apis: [<algorithm.entity.api.API object at 0x7f1b3714ef20>]
2025-03-14 12:03:55,573 - INFO - Simulated traffic data for 3/12 user collected：user: unloggeduser malicious: True
2025-03-14 12:03:55,573 - INFO - Error when injecting params for API_2486
2025-03-14 12:03:55,573 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:03:55,573 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:03:55,573 - INFO - error_apis: [<algorithm.entity.api.API object at 0x7f1b3714ef20>]
2025-03-14 12:03:55,573 - INFO - Simulated traffic data for 4/12 user collected：user: adminuser malicious: False
2025-03-14 12:03:55,573 - INFO - Error when injecting params for API_2486
2025-03-14 12:03:55,573 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:03:55,573 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:03:55,573 - INFO - error_apis: [<algorithm.entity.api.API object at 0x7f1b3714ef20>]
2025-03-14 12:03:55,573 - INFO - Simulated traffic data for 5/12 user collected：user: normaluser malicious: False
2025-03-14 12:03:55,574 - INFO - Error when injecting params for API_2486
2025-03-14 12:03:55,574 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:03:55,574 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:03:55,574 - INFO - error_apis: [<algorithm.entity.api.API object at 0x7f1b3714ef20>]
2025-03-14 12:03:55,574 - INFO - Simulated traffic data for 6/12 user collected：user: unloggeduser malicious: True
2025-03-14 12:03:55,574 - INFO - Error when injecting params for API_2486
2025-03-14 12:03:55,574 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:03:55,574 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:03:55,574 - INFO - error_apis: [<algorithm.entity.api.API object at 0x7f1b3714ef20>]
2025-03-14 12:03:55,574 - INFO - Simulated traffic data for 7/12 user collected：user: normaluser malicious: False
2025-03-14 12:03:55,574 - INFO - Error when injecting params for API_2486
2025-03-14 12:03:55,574 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:03:55,575 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:03:55,575 - INFO - error_apis: [<algorithm.entity.api.API object at 0x7f1b3714ef20>]
2025-03-14 12:03:55,575 - INFO - Simulated traffic data for 8/12 user collected：user: unloggeduser malicious: True
2025-03-14 12:03:55,575 - INFO - Error when injecting params for API_2486
2025-03-14 12:03:55,575 - INFO - error_apis: [<algorithm.entity.api.API object at 0x7f1b3714ef20>]
2025-03-14 12:03:55,575 - INFO - Simulated traffic data for 9/12 user collected：user: adminuser malicious: False
2025-03-14 12:03:55,575 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/resource/16 {}
2025-03-14 12:03:55,575 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:03:55,575 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:03:55,575 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:03:55,575 - INFO - error_apis: []
2025-03-14 12:03:55,576 - INFO - Simulated traffic data for 10/12 user collected：user: normaluser malicious: False
2025-03-14 12:03:55,576 - INFO - Error when injecting params for API_2486
2025-03-14 12:03:55,576 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:03:55,576 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:03:55,576 - INFO - error_apis: [<algorithm.entity.api.API object at 0x7f1b3714ef20>]
2025-03-14 12:03:55,576 - INFO - Simulated traffic data for 11/12 user collected：user: normaluser malicious: True
2025-03-14 12:03:55,576 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/resource/16 {}
2025-03-14 12:03:55,576 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:03:55,576 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:03:55,576 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:03:55,576 - INFO - error_apis: []
2025-03-14 12:03:55,576 - INFO - Simulated traffic data for 12/12 user collected：user: normaluser malicious: False
2025-03-14 12:03:55,579 - INFO - All simulated traffic data collected：/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/simulated_traffic_data.csv
2025-03-14 12:03:55,579 - INFO - error_apis: []
2025-03-14 12:12:27,925 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-14 12:12:28,636 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-14 12:12:28,981 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-14 12:12:28,984 - INFO - Starting data generation...
2025-03-14 12:12:28,985 - INFO - API_KNOWLEDGE: [{'number': 'API_2488', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_2489', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}]
2025-03-14 12:12:28,985 - INFO - APP_KNOWLEDGE: {'func_description': 'This is an updated test application', 'normal_seqs': ['Role: admin; API_2488(Call 1); API_2489(Call 2)', 'Role: oridinary_user; API_2488(); API_2489()'], 'malicious_seqs': ['Role: admin; API_2488(); API_2489()', 'Role: ordinary_user; API_2488(); API_2489()'], 'roles': ['admin', 'ordinary_user', 'unlogged_in_user']}
2025-03-14 12:12:29,116 - INFO - Generating simulated API sequences...
2025-03-14 12:12:29,141 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:12:30,790 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:12:30,812 - INFO - ========== Method gen_api_seq() returned: seq=['API_2488', 'API_2489'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:12:30,813 - INFO - API sequence 1/12 generated
2025-03-14 12:12:30,813 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:12:32,613 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:12:34,772 - INFO - ========== Method gen_api_seq() returned: seq=['API_2488', 'API_2489'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:12:35,271 - INFO - API sequence 2/12 generated
2025-03-14 12:12:35,281 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:12:39,334 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:12:40,846 - INFO - ========== Method gen_api_seq() returned: seq=['API_2488', 'API_2489'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:12:40,933 - INFO - API sequence 3/12 generated
2025-03-14 12:12:40,934 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 12:12:44,315 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:12:44,871 - INFO - ========== Method gen_api_seq() returned: seq=['API_2488'], malicious_sign_seq=[0] ==========
2025-03-14 12:12:44,968 - INFO - API sequence 4/12 generated
2025-03-14 12:12:44,990 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:12:46,908 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:12:47,604 - INFO - ========== Method gen_api_seq() returned: seq=['API_2488', 'API_2489'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:12:51,470 - INFO - API sequence 5/12 generated
2025-03-14 12:12:52,615 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 12:16:25,097 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-13 15:57:24', 'last_model_construction_at': '2025-03-14 03:57:04', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.33, 1.0, 0.5, 1.0, 0.0, 0.0, 0.0, 2.0, 0.33, 3.0, 0.17, 0.5, 0.25, 3.0, 0.11, 0.33, 0.17, 3.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-14 12:16:25,099 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
2025-03-14 12:16:27,621 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-13 15:57:24', 'last_model_construction_at': '2025-03-14 03:57:04', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.33, 1.0, 0.5, 1.0, 0.0, 0.0, 0.0, 2.0, 0.33, 3.0, 0.17, 0.5, 0.25, 3.0, 0.11, 0.33, 0.17, 3.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-14 12:16:27,621 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
2025-03-14 12:19:42,152 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-13 15:57:24', 'last_model_construction_at': '2025-03-14 03:57:04', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.33, 1.0, 0.5, 1.0, 0.0, 0.0, 0.0, 2.0, 0.33, 3.0, 0.17, 0.5, 0.25, 3.0, 0.11, 0.33, 0.17, 3.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-14 12:19:42,152 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
2025-03-14 12:19:52,818 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-13 15:57:24', 'last_model_construction_at': '2025-03-14 03:57:04', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.33, 1.0, 0.5, 1.0, 0.0, 0.0, 0.0, 2.0, 0.33, 3.0, 0.17, 0.5, 0.25, 3.0, 0.11, 0.33, 0.17, 3.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-14 12:19:52,819 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
2025-03-14 12:20:49,962 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-13 15:57:24', 'last_model_construction_at': '2025-03-14 03:57:04', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.33, 1.0, 0.5, 1.0, 0.0, 0.0, 0.0, 2.0, 0.33, 3.0, 0.17, 0.5, 0.25, 3.0, 0.11, 0.33, 0.17, 3.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-14 12:20:49,962 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
2025-03-14 12:21:22,617 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-13 15:57:24', 'last_model_construction_at': '2025-03-14 03:57:04', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.33, 1.0, 0.5, 1.0, 0.0, 0.0, 0.0, 2.0, 0.33, 3.0, 0.17, 0.5, 0.25, 3.0, 0.11, 0.33, 0.17, 3.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-14 12:21:22,618 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
2025-03-14 12:22:22,701 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-14 12:22:22,780 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-14 12:22:22,811 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-14 12:22:22,811 - INFO - Starting data generation...
2025-03-14 12:22:22,811 - INFO - API_KNOWLEDGE: [{'number': 'API_2490', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_2491', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}]
2025-03-14 12:22:22,811 - INFO - APP_KNOWLEDGE: {'func_description': 'This is an updated test application', 'normal_seqs': ['Role: admin; API_2490(Call 1); API_2491(Call 2)', 'Role: oridinary_user; API_2490(); API_2491()'], 'malicious_seqs': ['Role: admin; API_2490(); API_2491()', 'Role: ordinary_user; API_2490(); API_2491()'], 'roles': ['admin', 'ordinary_user', 'unlogged_in_user']}
2025-03-14 12:22:23,118 - INFO - Generating simulated API sequences...
2025-03-14 12:22:23,118 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:22:24,869 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:22:24,873 - INFO - ========== Method gen_api_seq() returned: seq=['API_2490', 'API_2491'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:22:24,873 - INFO - API sequence 1/12 generated
2025-03-14 12:22:24,873 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 12:22:27,745 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:22:27,746 - INFO - ========== Method gen_api_seq() returned: seq=['API_2490'], malicious_sign_seq=[0] ==========
2025-03-14 12:22:27,747 - INFO - API sequence 2/12 generated
2025-03-14 12:22:27,747 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:22:30,019 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:22:30,020 - INFO - ========== Method gen_api_seq() returned: seq=['API_2490', 'API_2491'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:22:30,020 - INFO - API sequence 3/12 generated
2025-03-14 12:22:30,020 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:22:32,538 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:22:32,539 - INFO - ========== Method gen_api_seq() returned: seq=['API_2490', 'API_2491'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:22:32,540 - INFO - API sequence 4/12 generated
2025-03-14 12:22:32,540 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 12:22:33,644 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:22:33,646 - INFO - ========== Method gen_api_seq() returned: seq=['API_2490'], malicious_sign_seq=[0] ==========
2025-03-14 12:22:33,646 - INFO - API sequence 5/12 generated
2025-03-14 12:22:33,646 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:22:34,910 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:22:34,912 - INFO - ========== Method gen_api_seq() returned: seq=['API_2490', 'API_2491'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:22:34,912 - INFO - API sequence 6/12 generated
2025-03-14 12:22:34,912 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:22:37,919 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:22:37,920 - INFO - ========== Method gen_api_seq() returned: seq=['API_2490', 'API_2491'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:22:37,920 - INFO - API sequence 7/12 generated
2025-03-14 12:22:37,920 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:22:40,236 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:22:40,237 - INFO - ========== Method gen_api_seq() returned: seq=['API_2490', 'API_2491'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:22:40,237 - INFO - API sequence 8/12 generated
2025-03-14 12:22:40,237 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:22:42,499 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:22:42,500 - INFO - ========== Method gen_api_seq() returned: seq=['API_2490', 'API_2491'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:22:42,500 - INFO - API sequence 9/12 generated
2025-03-14 12:22:42,500 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:22:43,771 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:22:43,772 - INFO - ========== Method gen_api_seq() returned: seq=['API_2490', 'API_2491'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:22:43,772 - INFO - API sequence 10/12 generated
2025-03-14 12:22:43,772 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:22:46,778 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:22:46,779 - INFO - ========== Method gen_api_seq() returned: seq=['API_2490', 'API_2491'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:22:46,779 - INFO - API sequence 11/12 generated
2025-03-14 12:22:46,779 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:22:48,347 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:22:48,348 - INFO - ========== Method gen_api_seq() returned: seq=['API_2490', 'API_2491'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:22:48,348 - INFO - API sequence 12/12 generated
2025-03-14 12:22:48,349 - INFO - API sequences serialized to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py/serialized_llm_agents.json
2025-03-14 12:22:48,349 - INFO - Generating simulated traffic data set...
2025-03-14 12:22:48,349 - INFO - Error when injecting params for API_2490
2025-03-14 12:24:15,735 - INFO - Trying to construct model...
2025-03-14 12:24:15,735 - INFO - DATA_COLLECTION_STATUS: IN_PROGRESS
2025-03-14 12:24:55,316 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-13 15:57:24', 'last_model_construction_at': '2025-03-14 03:57:04', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.33, 1.0, 0.5, 1.0, 0.0, 0.0, 0.0, 2.0, 0.33, 3.0, 0.17, 0.5, 0.25, 3.0, 0.11, 0.33, 0.17, 3.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-14 12:24:55,316 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
2025-03-14 12:25:04,789 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-13 15:57:24', 'last_model_construction_at': '2025-03-14 03:57:04', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.33, 1.0, 0.5, 1.0, 0.0, 0.0, 0.0, 2.0, 0.33, 3.0, 0.17, 0.5, 0.25, 3.0, 0.11, 0.33, 0.17, 3.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-14 12:25:04,789 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
2025-03-14 12:25:44,330 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-14 12:25:44,378 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-14 12:25:44,408 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-14 12:25:44,409 - INFO - Starting data generation...
2025-03-14 12:25:44,409 - INFO - API_KNOWLEDGE: [{'number': 'API_2492', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_2493', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}]
2025-03-14 12:25:44,409 - INFO - APP_KNOWLEDGE: {'func_description': 'This is an updated test application', 'normal_seqs': ['Role: admin; API_2492(Call 1); API_2493(Call 2)', 'Role: oridinary_user; API_2492(); API_2493()'], 'malicious_seqs': ['Role: admin; API_2492(); API_2493()', 'Role: ordinary_user; API_2492(); API_2493()'], 'roles': ['admin', 'ordinary_user', 'unlogged_in_user']}
2025-03-14 12:25:44,609 - INFO - Generating simulated API sequences...
2025-03-14 12:25:44,609 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 12:25:47,355 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:25:47,360 - INFO - ========== Method gen_api_seq() returned: seq=['API_2492', 'API_2493'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:25:47,360 - INFO - API sequence 1/12 generated
2025-03-14 12:25:47,360 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:25:51,077 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:25:51,078 - INFO - ========== Method gen_api_seq() returned: seq=['API_2492', 'API_2493'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:25:51,078 - INFO - API sequence 2/12 generated
2025-03-14 12:25:51,078 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 12:25:52,382 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:25:52,383 - INFO - ========== Method gen_api_seq() returned: seq=['API_2492'], malicious_sign_seq=[0] ==========
2025-03-14 12:25:52,383 - INFO - API sequence 3/12 generated
2025-03-14 12:25:52,383 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:25:53,815 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:25:53,816 - INFO - ========== Method gen_api_seq() returned: seq=['API_2492'], malicious_sign_seq=[0] ==========
2025-03-14 12:25:53,816 - INFO - API sequence 4/12 generated
2025-03-14 12:25:53,816 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:25:55,288 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:25:55,289 - INFO - ========== Method gen_api_seq() returned: seq=['API_2492'], malicious_sign_seq=[0] ==========
2025-03-14 12:25:55,289 - INFO - API sequence 5/12 generated
2025-03-14 12:25:55,289 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:25:57,644 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:25:57,645 - INFO - ========== Method gen_api_seq() returned: seq=['API_2492', 'API_2493'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:25:57,645 - INFO - API sequence 6/12 generated
2025-03-14 12:25:57,645 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:26:00,178 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:26:00,179 - INFO - ========== Method gen_api_seq() returned: seq=['API_2492', 'API_2493'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:26:00,179 - INFO - API sequence 7/12 generated
2025-03-14 12:26:00,179 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:26:02,882 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:26:02,883 - INFO - ========== Method gen_api_seq() returned: seq=['API_2492', 'API_2493'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:26:02,883 - INFO - API sequence 8/12 generated
2025-03-14 12:26:02,883 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:26:04,459 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:26:04,460 - INFO - ========== Method gen_api_seq() returned: seq=['API_2492', 'API_2493'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:26:04,460 - INFO - API sequence 9/12 generated
2025-03-14 12:26:04,460 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:26:06,593 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:26:06,595 - INFO - ========== Method gen_api_seq() returned: seq=['API_2492', 'API_2493'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:26:06,595 - INFO - API sequence 10/12 generated
2025-03-14 12:26:06,595 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:26:07,850 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:26:07,851 - INFO - ========== Method gen_api_seq() returned: seq=['API_2492', 'API_2493'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:26:07,851 - INFO - API sequence 11/12 generated
2025-03-14 12:26:07,851 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:26:09,086 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:26:09,087 - INFO - ========== Method gen_api_seq() returned: seq=['API_2492', 'API_2493'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:26:09,087 - INFO - API sequence 12/12 generated
2025-03-14 12:26:09,087 - INFO - API sequences serialized to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py/serialized_llm_agents.json
2025-03-14 12:26:09,087 - INFO - Generating simulated traffic data set...
2025-03-14 12:26:09,088 - INFO - Error when injecting params for API_2492
2025-03-14 12:26:09,088 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/memo/21 {}
2025-03-14 12:26:09,088 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:26:09,088 - INFO - error_apis: ['2492']
2025-03-14 12:26:09,088 - INFO - Simulated traffic data for 1/12 user collected：user: adminuser malicious: False
2025-03-14 12:26:09,088 - INFO - Error when injecting params for API_2492
2025-03-14 12:26:09,088 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:26:09,088 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:26:09,088 - INFO - error_apis: ['2492']
2025-03-14 12:26:09,088 - INFO - Simulated traffic data for 2/12 user collected：user: normaluser malicious: True
2025-03-14 12:26:09,088 - INFO - Error when injecting params for API_2492
2025-03-14 12:26:09,089 - INFO - error_apis: ['2492']
2025-03-14 12:26:09,089 - INFO - Simulated traffic data for 3/12 user collected：user: adminuser malicious: False
2025-03-14 12:26:09,089 - INFO - Error when injecting params for API_2492
2025-03-14 12:26:09,089 - INFO - error_apis: ['2492']
2025-03-14 12:26:09,089 - INFO - Simulated traffic data for 4/12 user collected：user: normaluser malicious: False
2025-03-14 12:26:09,089 - INFO - Error when injecting params for API_2492
2025-03-14 12:26:09,089 - INFO - error_apis: ['2492']
2025-03-14 12:26:09,089 - INFO - Simulated traffic data for 5/12 user collected：user: normaluser malicious: False
2025-03-14 12:26:09,089 - INFO - Error when injecting params for API_2492
2025-03-14 12:26:09,089 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:26:09,089 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:26:09,089 - INFO - error_apis: ['2492']
2025-03-14 12:26:09,089 - INFO - Simulated traffic data for 6/12 user collected：user: normaluser malicious: False
2025-03-14 12:26:09,090 - INFO - Error when injecting params for API_2492
2025-03-14 12:26:09,090 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:26:09,090 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:26:09,090 - INFO - error_apis: ['2492']
2025-03-14 12:26:09,090 - INFO - Simulated traffic data for 7/12 user collected：user: unloggeduser malicious: True
2025-03-14 12:26:09,090 - INFO - Error when injecting params for API_2492
2025-03-14 12:26:09,090 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:26:09,090 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:26:09,090 - INFO - error_apis: ['2492']
2025-03-14 12:26:09,090 - INFO - Simulated traffic data for 8/12 user collected：user: normaluser malicious: False
2025-03-14 12:26:09,090 - INFO - Error when injecting params for API_2492
2025-03-14 12:26:09,091 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:26:09,091 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:26:09,091 - INFO - error_apis: ['2492']
2025-03-14 12:26:09,091 - INFO - Simulated traffic data for 9/12 user collected：user: normaluser malicious: True
2025-03-14 12:26:09,091 - INFO - Error when injecting params for API_2492
2025-03-14 12:26:09,091 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:26:09,091 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:26:09,091 - INFO - error_apis: ['2492']
2025-03-14 12:26:09,091 - INFO - Simulated traffic data for 10/12 user collected：user: normaluser malicious: True
2025-03-14 12:26:09,091 - INFO - Error when injecting params for API_2492
2025-03-14 12:26:09,091 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:26:09,091 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:26:09,091 - INFO - error_apis: ['2492']
2025-03-14 12:26:09,092 - INFO - Simulated traffic data for 11/12 user collected：user: unloggeduser malicious: True
2025-03-14 12:26:09,092 - INFO - Error when injecting params for API_2492
2025-03-14 12:26:09,092 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:26:09,092 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:26:09,092 - INFO - error_apis: ['2492']
2025-03-14 12:26:09,092 - INFO - Simulated traffic data for 12/12 user collected：user: unloggeduser malicious: True
2025-03-14 12:26:09,097 - INFO - All simulated traffic data collected：/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/simulated_traffic_data.csv
2025-03-14 12:26:09,097 - INFO - error_apis: ['2492']
2025-03-14 12:26:20,321 - INFO - Trying to construct model...
2025-03-14 12:26:20,321 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-14 12:26:20,363 - INFO - Training model... Size of feature_list: 7
2025-03-14 12:26:20,376 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 12:26:20,380 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 12:26:20,381 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 12:26:20,382 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 12:26:20,383 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 12:26:20,385 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 12:26:20,487 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 12:26:20,489 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 12:26:20,490 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 12:26:20,511 - INFO - Model constructed.
2025-03-14 12:28:01,690 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-14 12:28:01,735 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-14 12:28:01,765 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-14 12:28:01,765 - INFO - Starting data generation...
2025-03-14 12:28:01,766 - INFO - API_KNOWLEDGE: [{'number': 'API_2494', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_2495', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}]
2025-03-14 12:28:01,766 - INFO - APP_KNOWLEDGE: {'func_description': 'This is an updated test application', 'normal_seqs': ['Role: admin; API_2494(Call 1); API_2495(Call 2)', 'Role: oridinary_user; API_2494(); API_2495()'], 'malicious_seqs': ['Role: admin; API_2494(); API_2495()', 'Role: ordinary_user; API_2494(); API_2495()'], 'roles': ['admin', 'ordinary_user', 'unlogged_in_user']}
2025-03-14 12:28:01,816 - INFO - Generating simulated API sequences...
2025-03-14 12:28:01,816 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:28:03,999 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:28:03,999 - INFO - ========== Method gen_api_seq() returned: seq=['API_2494', 'API_2495'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:28:04,000 - INFO - API sequence 1/12 generated
2025-03-14 12:28:04,000 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 12:28:06,422 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:28:06,423 - INFO - ========== Method gen_api_seq() returned: seq=['API_2494', 'API_2495'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:28:06,423 - INFO - API sequence 2/12 generated
2025-03-14 12:28:06,423 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:28:07,699 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:28:07,700 - INFO - ========== Method gen_api_seq() returned: seq=['API_2494', 'API_2495'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:28:07,700 - INFO - API sequence 3/12 generated
2025-03-14 12:28:07,700 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:28:10,042 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:28:10,043 - INFO - ========== Method gen_api_seq() returned: seq=['API_2494', 'API_2495'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:28:10,043 - INFO - API sequence 4/12 generated
2025-03-14 12:28:10,043 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:28:12,190 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:28:12,191 - INFO - ========== Method gen_api_seq() returned: seq=['API_2494', 'API_2495'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:28:12,191 - INFO - API sequence 5/12 generated
2025-03-14 12:28:12,191 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:28:14,406 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:28:14,407 - INFO - ========== Method gen_api_seq() returned: seq=['API_2494', 'API_2495'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:28:14,407 - INFO - API sequence 6/12 generated
2025-03-14 12:28:14,407 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:28:16,982 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:28:16,983 - INFO - ========== Method gen_api_seq() returned: seq=['API_2494', 'API_2495'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:28:16,983 - INFO - API sequence 7/12 generated
2025-03-14 12:28:16,983 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:28:19,271 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:28:19,272 - INFO - ========== Method gen_api_seq() returned: seq=['API_2494', 'API_2495'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:28:19,272 - INFO - API sequence 8/12 generated
2025-03-14 12:28:19,272 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:28:21,422 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:28:21,423 - INFO - ========== Method gen_api_seq() returned: seq=['API_2494', 'API_2495'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:28:21,423 - INFO - API sequence 9/12 generated
2025-03-14 12:28:21,423 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 12:28:22,638 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:28:22,639 - INFO - ========== Method gen_api_seq() returned: seq=['API_2494'], malicious_sign_seq=[0] ==========
2025-03-14 12:28:22,640 - INFO - API sequence 10/12 generated
2025-03-14 12:28:22,640 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:28:24,930 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:28:24,931 - INFO - ========== Method gen_api_seq() returned: seq=['API_2494', 'API_2495'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:28:24,931 - INFO - API sequence 11/12 generated
2025-03-14 12:28:24,931 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:28:27,769 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:28:27,770 - INFO - ========== Method gen_api_seq() returned: seq=['API_2494', 'API_2495'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:28:27,770 - INFO - API sequence 12/12 generated
2025-03-14 12:28:27,771 - INFO - API sequences serialized to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py/serialized_llm_agents.json
2025-03-14 12:28:27,771 - INFO - Generating simulated traffic data set...
2025-03-14 12:28:27,771 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-14 12:28:27,771 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:28:27,772 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:28:27,772 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:28:27,772 - INFO - error_apis: []
2025-03-14 12:28:27,772 - INFO - Simulated traffic data for 1/12 user collected：user: normaluser malicious: False
2025-03-14 12:28:27,772 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-14 12:28:27,772 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:28:27,772 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:28:27,772 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:28:27,772 - INFO - error_apis: []
2025-03-14 12:28:27,772 - INFO - Simulated traffic data for 2/12 user collected：user: adminuser malicious: False
2025-03-14 12:28:27,772 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/resource/16 {}
2025-03-14 12:28:27,772 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:28:27,773 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:28:27,773 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:28:27,773 - INFO - error_apis: []
2025-03-14 12:28:27,773 - INFO - Simulated traffic data for 3/12 user collected：user: normaluser malicious: False
2025-03-14 12:28:27,773 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-14 12:28:27,773 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:28:27,773 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:28:27,773 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:28:27,773 - INFO - error_apis: []
2025-03-14 12:28:27,773 - INFO - Simulated traffic data for 4/12 user collected：user: normaluser malicious: True
2025-03-14 12:28:27,773 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-14 12:28:27,773 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:28:27,774 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:28:27,774 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:28:27,774 - INFO - error_apis: []
2025-03-14 12:28:27,774 - INFO - Simulated traffic data for 5/12 user collected：user: unloggeduser malicious: True
2025-03-14 12:28:27,774 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-14 12:28:27,774 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:28:27,774 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:28:27,774 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:28:27,774 - INFO - error_apis: []
2025-03-14 12:28:27,774 - INFO - Simulated traffic data for 6/12 user collected：user: normaluser malicious: True
2025-03-14 12:28:27,774 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-14 12:28:27,774 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:28:27,775 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:28:27,775 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:28:27,775 - INFO - error_apis: []
2025-03-14 12:28:27,775 - INFO - Simulated traffic data for 7/12 user collected：user: normaluser malicious: True
2025-03-14 12:28:27,775 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-14 12:28:27,775 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:28:27,775 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:28:27,775 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:28:27,775 - INFO - error_apis: []
2025-03-14 12:28:27,775 - INFO - Simulated traffic data for 8/12 user collected：user: normaluser malicious: False
2025-03-14 12:28:27,775 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-14 12:28:27,775 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:28:27,776 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:28:27,776 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:28:27,776 - INFO - error_apis: []
2025-03-14 12:28:27,776 - INFO - Simulated traffic data for 9/12 user collected：user: unloggeduser malicious: True
2025-03-14 12:28:27,776 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-14 12:28:27,776 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:28:27,776 - INFO - error_apis: []
2025-03-14 12:28:27,776 - INFO - Simulated traffic data for 10/12 user collected：user: adminuser malicious: False
2025-03-14 12:28:27,776 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-14 12:28:27,776 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:28:27,776 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:28:27,777 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:28:27,777 - INFO - error_apis: []
2025-03-14 12:28:27,777 - INFO - Simulated traffic data for 11/12 user collected：user: unloggeduser malicious: True
2025-03-14 12:28:27,777 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-14 12:28:27,777 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:28:27,777 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/memo/21 {}
2025-03-14 12:28:27,777 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:28:27,777 - INFO - error_apis: []
2025-03-14 12:28:27,777 - INFO - Simulated traffic data for 12/12 user collected：user: normaluser malicious: False
2025-03-14 12:28:27,780 - INFO - All simulated traffic data collected：/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/simulated_traffic_data.csv
2025-03-14 12:28:27,780 - INFO - error_apis: []
2025-03-14 12:28:37,515 - INFO - Trying to construct model...
2025-03-14 12:28:37,516 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-14 12:28:37,547 - INFO - Training model... Size of feature_list: 7
2025-03-14 12:28:37,557 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 12:28:37,559 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 12:28:37,560 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 12:28:37,562 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 12:28:37,563 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 12:28:37,565 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 12:28:37,566 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 12:28:37,568 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 12:28:37,597 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 12:28:37,599 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 12:28:37,601 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 12:28:37,602 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 12:28:37,614 - INFO - Model constructed.
2025-03-14 12:55:10,022 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-14 12:55:10,065 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-14 12:55:10,137 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-14 12:55:10,138 - INFO - Starting data generation...
2025-03-14 12:55:10,138 - INFO - API_KNOWLEDGE: [{'number': 'API_2496', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_2497', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_2498', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}]
2025-03-14 12:55:10,138 - INFO - APP_KNOWLEDGE: {'func_description': 'This is an updated test application', 'normal_seqs': ['Role: admin; API_2496(Call 1); API_2498(Call 2)', 'Role: oridinary_user; API_2496(); API_2498()'], 'malicious_seqs': ['Role: admin; API_2496(); API_2498()', 'Role: ordinary_user; API_2496(); API_2498()'], 'roles': ['admin', 'ordinary_user', 'unlogged_in_user']}
2025-03-14 12:55:10,187 - INFO - Generating simulated API sequences...
2025-03-14 12:55:10,188 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:55:13,074 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:55:13,075 - INFO - ========== Method gen_api_seq() returned: seq=['API_2496', 'API_2498'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:55:13,075 - INFO - API sequence 1/12 generated
2025-03-14 12:55:13,076 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 12:55:15,566 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:55:15,567 - INFO - ========== Method gen_api_seq() returned: seq=['API_2496'], malicious_sign_seq=[0] ==========
2025-03-14 12:55:15,567 - INFO - API sequence 2/12 generated
2025-03-14 12:55:15,567 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:55:17,259 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:55:17,260 - INFO - ========== Method gen_api_seq() returned: seq=['API_2496', 'API_2498'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:55:17,260 - INFO - API sequence 3/12 generated
2025-03-14 12:55:17,260 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:55:18,370 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:55:18,371 - INFO - ========== Method gen_api_seq() returned: seq=['API_2496'], malicious_sign_seq=[0] ==========
2025-03-14 12:55:18,371 - INFO - API sequence 4/12 generated
2025-03-14 12:55:18,371 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:55:20,669 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:55:20,671 - INFO - ========== Method gen_api_seq() returned: seq=['API_2496', 'API_2498'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:55:20,671 - INFO - API sequence 5/12 generated
2025-03-14 12:55:20,671 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 12:55:23,285 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:55:23,286 - INFO - ========== Method gen_api_seq() returned: seq=['API_2496', 'API_2498'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:55:23,286 - INFO - API sequence 6/12 generated
2025-03-14 12:55:23,286 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:55:24,509 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:55:24,510 - INFO - ========== Method gen_api_seq() returned: seq=['API_2496', 'API_2498'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:55:24,510 - INFO - API sequence 7/12 generated
2025-03-14 12:55:24,510 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:55:26,788 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:55:26,789 - INFO - ========== Method gen_api_seq() returned: seq=['API_2496', 'API_2498'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:55:26,789 - INFO - API sequence 8/12 generated
2025-03-14 12:55:26,789 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:55:29,080 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:55:29,081 - INFO - ========== Method gen_api_seq() returned: seq=['API_2496', 'API_2498'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:55:29,081 - INFO - API sequence 9/12 generated
2025-03-14 12:55:29,081 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:55:30,190 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:55:30,191 - INFO - ========== Method gen_api_seq() returned: seq=['API_2496'], malicious_sign_seq=[0] ==========
2025-03-14 12:55:30,192 - INFO - API sequence 10/12 generated
2025-03-14 12:55:30,192 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:55:31,476 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:55:31,477 - INFO - ========== Method gen_api_seq() returned: seq=['API_2496', 'API_2498'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:55:31,477 - INFO - API sequence 11/12 generated
2025-03-14 12:55:31,477 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:55:32,759 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:55:32,760 - INFO - ========== Method gen_api_seq() returned: seq=['API_2496', 'API_2498'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:55:32,760 - INFO - API sequence 12/12 generated
2025-03-14 12:55:32,761 - INFO - API sequences serialized to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py/serialized_llm_agents.json
2025-03-14 12:55:32,761 - INFO - Generating simulated traffic data set...
2025-03-14 12:55:32,761 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-14 12:55:32,761 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:55:32,762 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:55:32,762 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:55:32,762 - INFO - error_apis: []
2025-03-14 12:55:32,762 - INFO - Simulated traffic data for 1/12 user collected：user: normaluser malicious: False
2025-03-14 12:55:32,762 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-14 12:55:32,762 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:55:32,762 - INFO - error_apis: []
2025-03-14 12:55:32,762 - INFO - Simulated traffic data for 2/12 user collected：user: adminuser malicious: False
2025-03-14 12:55:32,762 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/resource/16 {}
2025-03-14 12:55:32,762 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:55:32,762 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/memo/21 {}
2025-03-14 12:55:32,762 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:55:32,762 - INFO - error_apis: []
2025-03-14 12:55:32,763 - INFO - Simulated traffic data for 3/12 user collected：user: normaluser malicious: True
2025-03-14 12:55:32,763 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-14 12:55:32,763 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:55:32,763 - INFO - error_apis: []
2025-03-14 12:55:32,763 - INFO - Simulated traffic data for 4/12 user collected：user: normaluser malicious: False
2025-03-14 12:55:32,763 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-14 12:55:32,763 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:55:32,763 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:55:32,763 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:55:32,763 - INFO - error_apis: []
2025-03-14 12:55:32,763 - INFO - Simulated traffic data for 5/12 user collected：user: normaluser malicious: False
2025-03-14 12:55:32,764 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-14 12:55:32,764 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:55:32,764 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:55:32,764 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:55:32,764 - INFO - error_apis: []
2025-03-14 12:55:32,764 - INFO - Simulated traffic data for 6/12 user collected：user: adminuser malicious: False
2025-03-14 12:55:32,764 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/resource/16 {}
2025-03-14 12:55:32,764 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:55:32,764 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:55:32,764 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:55:32,764 - INFO - error_apis: []
2025-03-14 12:55:32,764 - INFO - Simulated traffic data for 7/12 user collected：user: unloggeduser malicious: True
2025-03-14 12:55:32,765 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-14 12:55:32,765 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:55:32,765 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:55:32,765 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:55:32,765 - INFO - error_apis: []
2025-03-14 12:55:32,765 - INFO - Simulated traffic data for 8/12 user collected：user: normaluser malicious: True
2025-03-14 12:55:32,765 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-14 12:55:32,765 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:55:32,765 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:55:32,765 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:55:32,765 - INFO - error_apis: []
2025-03-14 12:55:32,765 - INFO - Simulated traffic data for 9/12 user collected：user: unloggeduser malicious: True
2025-03-14 12:55:32,766 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-14 12:55:32,766 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:55:32,766 - INFO - error_apis: []
2025-03-14 12:55:32,766 - INFO - Simulated traffic data for 10/12 user collected：user: normaluser malicious: False
2025-03-14 12:55:32,766 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-14 12:55:32,766 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:55:32,766 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:55:32,766 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:55:32,766 - INFO - error_apis: []
2025-03-14 12:55:32,766 - INFO - Simulated traffic data for 11/12 user collected：user: unloggeduser malicious: True
2025-03-14 12:55:32,766 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-14 12:55:32,766 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:55:32,767 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:55:32,767 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:55:32,767 - INFO - error_apis: []
2025-03-14 12:55:32,767 - INFO - Simulated traffic data for 12/12 user collected：user: normaluser malicious: True
2025-03-14 12:55:32,769 - INFO - All simulated traffic data collected：/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/simulated_traffic_data.csv
2025-03-14 12:55:32,769 - INFO - error_apis: []
2025-03-14 12:58:04,081 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-14 12:58:04,123 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-14 12:58:04,194 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-14 12:58:04,194 - INFO - Starting data generation...
2025-03-14 12:58:04,194 - INFO - API_KNOWLEDGE: [{'number': 'API_2499', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_2500', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_2501', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}]
2025-03-14 12:58:04,194 - INFO - APP_KNOWLEDGE: {'func_description': 'This is an updated test application', 'normal_seqs': ['Role: admin; API_2499(Call 1); API_2501(Call 2)', 'Role: oridinary_user; API_2501(); API_2500()'], 'malicious_seqs': ['Role: admin; API_2499(); API_2500()', 'Role: ordinary_user; API_2500(); API_2501()'], 'roles': ['admin', 'ordinary_user', 'unlogged_in_user']}
2025-03-14 12:58:04,247 - INFO - Generating simulated API sequences...
2025-03-14 12:58:04,248 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:58:06,111 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:58:06,112 - INFO - ========== Method gen_api_seq() returned: seq=['API_2501'], malicious_sign_seq=[0] ==========
2025-03-14 12:58:06,112 - INFO - API sequence 1/12 generated
2025-03-14 12:58:06,112 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:58:08,007 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:58:08,008 - INFO - ========== Method gen_api_seq() returned: seq=['API_2501'], malicious_sign_seq=[0] ==========
2025-03-14 12:58:08,008 - INFO - API sequence 2/12 generated
2025-03-14 12:58:08,008 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:58:10,173 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:58:10,173 - INFO - ========== Method gen_api_seq() returned: seq=['API_2501'], malicious_sign_seq=[0] ==========
2025-03-14 12:58:10,174 - INFO - API sequence 3/12 generated
2025-03-14 12:58:10,174 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:58:12,669 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:58:12,670 - INFO - ========== Method gen_api_seq() returned: seq=['API_2501', 'API_2500'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:58:12,670 - INFO - API sequence 4/12 generated
2025-03-14 12:58:12,670 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:58:14,945 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:58:14,946 - INFO - ========== Method gen_api_seq() returned: seq=['API_2501', 'API_2500'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:58:14,946 - INFO - API sequence 5/12 generated
2025-03-14 12:58:14,947 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:58:17,242 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:58:17,243 - INFO - ========== Method gen_api_seq() returned: seq=['API_2501', 'API_2500'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:58:17,243 - INFO - API sequence 6/12 generated
2025-03-14 12:58:17,243 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 12:58:19,055 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:58:19,056 - INFO - ========== Method gen_api_seq() returned: seq=['API_2499'], malicious_sign_seq=[0] ==========
2025-03-14 12:58:19,056 - INFO - API sequence 7/12 generated
2025-03-14 12:58:19,056 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:58:20,165 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:58:20,166 - INFO - ========== Method gen_api_seq() returned: seq=['API_2501'], malicious_sign_seq=[0] ==========
2025-03-14 12:58:20,166 - INFO - API sequence 8/12 generated
2025-03-14 12:58:20,166 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:58:21,636 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:58:21,637 - INFO - ========== Method gen_api_seq() returned: seq=['API_2501', 'API_2500'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:58:21,638 - INFO - API sequence 9/12 generated
2025-03-14 12:58:21,638 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:58:22,779 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:58:22,780 - INFO - ========== Method gen_api_seq() returned: seq=['API_2501', 'API_2500'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:58:22,780 - INFO - API sequence 10/12 generated
2025-03-14 12:58:22,780 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 12:58:24,655 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:58:24,656 - INFO - ========== Method gen_api_seq() returned: seq=['API_2499'], malicious_sign_seq=[0] ==========
2025-03-14 12:58:24,656 - INFO - API sequence 11/12 generated
2025-03-14 12:58:24,656 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:58:26,081 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:58:26,082 - INFO - ========== Method gen_api_seq() returned: seq=['API_2501', 'API_2500'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:58:26,083 - INFO - API sequence 12/12 generated
2025-03-14 12:58:26,084 - INFO - API sequences serialized to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py/serialized_llm_agents.json
2025-03-14 12:58:26,084 - INFO - Generating simulated traffic data set...
2025-03-14 12:58:26,084 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/memo/21 {}
2025-03-14 12:58:26,084 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:58:26,084 - INFO - error_apis: []
2025-03-14 12:58:26,085 - INFO - Simulated traffic data for 1/12 user collected：user: normaluser malicious: False
2025-03-14 12:58:26,085 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:58:26,085 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:58:26,085 - INFO - error_apis: []
2025-03-14 12:58:26,085 - INFO - Simulated traffic data for 2/12 user collected：user: normaluser malicious: False
2025-03-14 12:58:26,085 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/memo/21 {}
2025-03-14 12:58:26,085 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:58:26,085 - INFO - error_apis: []
2025-03-14 12:58:26,085 - INFO - Simulated traffic data for 3/12 user collected：user: normaluser malicious: False
2025-03-14 12:58:26,085 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:58:26,085 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:58:26,086 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/user/9 {}
2025-03-14 12:58:26,086 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:58:26,086 - INFO - error_apis: []
2025-03-14 12:58:26,086 - INFO - Simulated traffic data for 4/12 user collected：user: normaluser malicious: True
2025-03-14 12:58:26,086 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:58:26,086 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:58:26,086 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/user/9 {}
2025-03-14 12:58:26,086 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:58:26,086 - INFO - error_apis: []
2025-03-14 12:58:26,086 - INFO - Simulated traffic data for 5/12 user collected：user: unloggeduser malicious: True
2025-03-14 12:58:26,086 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:58:26,086 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:58:26,087 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/user/9 {}
2025-03-14 12:58:26,087 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:58:26,087 - INFO - error_apis: []
2025-03-14 12:58:26,087 - INFO - Simulated traffic data for 6/12 user collected：user: normaluser malicious: True
2025-03-14 12:58:26,087 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/resource/16 {}
2025-03-14 12:58:26,087 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:58:26,087 - INFO - error_apis: []
2025-03-14 12:58:26,087 - INFO - Simulated traffic data for 7/12 user collected：user: adminuser malicious: False
2025-03-14 12:58:26,087 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:58:26,087 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:58:26,087 - INFO - error_apis: []
2025-03-14 12:58:26,087 - INFO - Simulated traffic data for 8/12 user collected：user: normaluser malicious: False
2025-03-14 12:58:26,087 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:58:26,088 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:58:26,088 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/user/9 {}
2025-03-14 12:58:26,088 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:58:26,088 - INFO - error_apis: []
2025-03-14 12:58:26,088 - INFO - Simulated traffic data for 9/12 user collected：user: unloggeduser malicious: True
2025-03-14 12:58:26,088 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:58:26,088 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:58:26,088 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/user/9 {}
2025-03-14 12:58:26,088 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:58:26,088 - INFO - error_apis: []
2025-03-14 12:58:26,088 - INFO - Simulated traffic data for 10/12 user collected：user: unloggeduser malicious: True
2025-03-14 12:58:26,088 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-14 12:58:26,089 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:58:26,089 - INFO - error_apis: []
2025-03-14 12:58:26,089 - INFO - Simulated traffic data for 11/12 user collected：user: adminuser malicious: False
2025-03-14 12:58:26,089 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:58:26,089 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:58:26,089 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/user/9 {}
2025-03-14 12:58:26,089 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:58:26,089 - INFO - error_apis: []
2025-03-14 12:58:26,089 - INFO - Simulated traffic data for 12/12 user collected：user: normaluser malicious: True
2025-03-14 12:58:26,091 - INFO - All simulated traffic data collected：/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/simulated_traffic_data.csv
2025-03-14 12:58:26,091 - INFO - error_apis: []
2025-03-14 12:58:47,350 - INFO - Trying to construct model...
2025-03-14 12:58:47,350 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-14 12:58:47,380 - INFO - Training model... Size of feature_list: 7
2025-03-14 12:58:47,390 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 12:58:47,391 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 12:58:47,393 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 12:58:47,394 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 12:58:47,395 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 12:58:47,397 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 12:58:47,398 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 12:58:47,400 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 12:58:47,431 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 12:58:47,433 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 12:58:47,434 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 12:58:47,436 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 12:58:47,447 - INFO - Model constructed.
2025-03-14 17:54:15,661 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-14 17:54:15,714 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-14 17:54:15,714 - INFO - Extracting API list with API discovery algorithm...
2025-03-14 17:54:15,778 - INFO - Starting Drain3 template miner
2025-03-14 17:54:15,781 - INFO - Starting Drain3 template miner
2025-03-14 17:54:15,782 - INFO - Starting Drain3 template miner
2025-03-14 17:54:15,783 - INFO - Starting Drain3 template miner
2025-03-14 17:54:15,783 - INFO - Starting Drain3 template miner
2025-03-14 17:54:17,377 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-14 18:42:54,174 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-14 09:54:17', 'last_model_construction_at': '2025-03-14 04:58:47', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [1.0, 1.0, 1.0, 2.0, 1.0, 1.0, 1.0, 2.0, 1.0, 4.0, 1.0, 1.0, 1.0, 4.0, 1.0, 1.0, 1.0, 4.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-14 18:42:54,175 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
2025-03-14 18:42:56,123 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-14 09:54:17', 'last_model_construction_at': '2025-03-14 04:58:47', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [1.0, 1.0, 1.0, 2.0, 1.0, 1.0, 1.0, 2.0, 1.0, 4.0, 1.0, 1.0, 1.0, 4.0, 1.0, 1.0, 1.0, 4.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-14 18:42:56,123 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
2025-03-15 09:12:54,610 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-14 09:54:17', 'last_model_construction_at': '2025-03-14 04:58:47', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [1.0, 1.0, 1.0, 2.0, 1.0, 1.0, 1.0, 2.0, 1.0, 4.0, 1.0, 1.0, 1.0, 4.0, 1.0, 1.0, 1.0, 4.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-15 09:12:54,612 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
2025-03-15 09:13:00,349 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-14 09:54:17', 'last_model_construction_at': '2025-03-14 04:58:47', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [1.0, 1.0, 1.0, 2.0, 1.0, 1.0, 1.0, 2.0, 1.0, 4.0, 1.0, 1.0, 1.0, 4.0, 1.0, 1.0, 1.0, 4.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-15 09:13:00,349 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
2025-03-15 09:13:42,916 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-14 09:54:17', 'last_model_construction_at': '2025-03-14 04:58:47', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [1.0, 1.0, 1.0, 2.0, 1.0, 1.0, 1.0, 2.0, 1.0, 4.0, 1.0, 1.0, 1.0, 4.0, 1.0, 1.0, 1.0, 4.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-15 09:13:42,917 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
2025-03-15 09:13:46,557 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-14 09:54:17', 'last_model_construction_at': '2025-03-14 04:58:47', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [1.0, 1.0, 1.0, 2.0, 1.0, 1.0, 1.0, 2.0, 1.0, 4.0, 1.0, 1.0, 1.0, 4.0, 1.0, 1.0, 1.0, 4.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-15 09:13:46,561 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
2025-03-15 09:16:56,095 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-15 09:16:56,200 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-15 09:16:56,200 - INFO - Extracting API list with API discovery algorithm...
2025-03-15 09:16:56,277 - INFO - Starting Drain3 template miner
2025-03-15 09:16:56,280 - INFO - Starting Drain3 template miner
2025-03-15 09:16:56,282 - INFO - Starting Drain3 template miner
2025-03-15 09:16:56,282 - INFO - Starting Drain3 template miner
2025-03-15 09:16:56,283 - INFO - Starting Drain3 template miner
2025-03-15 09:16:57,799 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-15 09:22:11,556 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-15 09:22:11,612 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-15 09:22:11,612 - INFO - Extracting API list with API discovery algorithm...
2025-03-15 09:22:11,682 - INFO - Starting Drain3 template miner
2025-03-15 09:22:11,686 - INFO - Starting Drain3 template miner
2025-03-15 09:22:11,688 - INFO - Starting Drain3 template miner
2025-03-15 09:22:11,698 - INFO - Starting Drain3 template miner
2025-03-15 09:22:11,699 - INFO - Starting Drain3 template miner
2025-03-15 09:22:13,611 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-15 09:40:09,030 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-15 01:22:13', 'last_model_construction_at': '2025-03-14 04:58:47', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [1.0, 1.0, 1.0, 2.0, 1.0, 1.0, 1.0, 2.0, 1.0, 4.0, 1.0, 1.0, 1.0, 4.0, 1.0, 1.0, 1.0, 4.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-15 09:40:09,034 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
2025-03-15 09:40:11,942 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-15 01:22:13', 'last_model_construction_at': '2025-03-14 04:58:47', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [1.0, 1.0, 1.0, 2.0, 1.0, 1.0, 1.0, 2.0, 1.0, 4.0, 1.0, 1.0, 1.0, 4.0, 1.0, 1.0, 1.0, 4.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-15 09:40:11,943 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
2025-03-15 09:41:43,142 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-15 09:41:43,240 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-15 09:41:43,241 - INFO - Extracting API list with API discovery algorithm...
2025-03-15 09:41:43,316 - INFO - Starting Drain3 template miner
2025-03-15 09:41:43,319 - INFO - Starting Drain3 template miner
2025-03-15 09:41:43,322 - INFO - Starting Drain3 template miner
2025-03-15 09:41:43,323 - INFO - Starting Drain3 template miner
2025-03-15 09:41:43,323 - INFO - Starting Drain3 template miner
2025-03-15 09:41:45,399 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-15 09:43:45,516 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-15 09:43:45,560 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-15 09:43:45,560 - INFO - Extracting API list with API discovery algorithm...
2025-03-15 09:43:45,627 - INFO - Starting Drain3 template miner
2025-03-15 09:43:45,630 - INFO - Starting Drain3 template miner
2025-03-15 09:43:45,632 - INFO - Starting Drain3 template miner
2025-03-15 09:43:45,633 - INFO - Starting Drain3 template miner
2025-03-15 09:43:45,634 - INFO - Starting Drain3 template miner
2025-03-15 09:43:47,774 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-15 09:47:05,532 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-15 09:47:05,581 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-15 09:47:05,582 - INFO - Extracting API list with API discovery algorithm...
2025-03-15 09:47:05,654 - INFO - Starting Drain3 template miner
2025-03-15 09:47:05,657 - INFO - Starting Drain3 template miner
2025-03-15 09:47:05,659 - INFO - Starting Drain3 template miner
2025-03-15 09:47:05,660 - INFO - Starting Drain3 template miner
2025-03-15 09:47:05,660 - INFO - Starting Drain3 template miner
2025-03-15 09:47:07,719 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-15 09:47:52,536 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-15 01:47:07', 'last_model_construction_at': '2025-03-14 04:58:47', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [1.0, 1.0, 1.0, 2.0, 1.0, 1.0, 1.0, 2.0, 1.0, 4.0, 1.0, 1.0, 1.0, 4.0, 1.0, 1.0, 1.0, 4.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-15 09:47:52,537 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
2025-03-15 09:49:53,299 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-15 09:49:53,391 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-15 09:49:53,391 - INFO - Extracting API list with API discovery algorithm...
2025-03-15 09:49:53,464 - INFO - Starting Drain3 template miner
2025-03-15 09:49:53,468 - INFO - Starting Drain3 template miner
2025-03-15 09:49:53,470 - INFO - Starting Drain3 template miner
2025-03-15 09:49:53,470 - INFO - Starting Drain3 template miner
2025-03-15 09:49:53,471 - INFO - Starting Drain3 template miner
2025-03-15 09:49:55,607 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-15 09:51:57,072 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-15 09:51:57,120 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-15 09:51:57,120 - INFO - Extracting API list with API discovery algorithm...
2025-03-15 09:51:57,255 - INFO - Starting Drain3 template miner
2025-03-15 09:51:57,258 - INFO - Starting Drain3 template miner
2025-03-15 09:51:57,261 - INFO - Starting Drain3 template miner
2025-03-15 09:51:57,262 - INFO - Starting Drain3 template miner
2025-03-15 09:51:57,262 - INFO - Starting Drain3 template miner
2025-03-15 09:51:59,314 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-15 09:54:26,938 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-15 09:54:26,986 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-15 09:54:26,986 - INFO - Extracting API list with API discovery algorithm...
2025-03-15 09:54:27,057 - INFO - Starting Drain3 template miner
2025-03-15 09:54:27,060 - INFO - Starting Drain3 template miner
2025-03-15 09:54:27,062 - INFO - Starting Drain3 template miner
2025-03-15 09:54:27,063 - INFO - Starting Drain3 template miner
2025-03-15 09:54:27,064 - INFO - Starting Drain3 template miner
2025-03-15 09:54:29,158 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-15 09:57:31,073 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-15 01:54:29', 'last_model_construction_at': '2025-03-14 04:58:47', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [1.0, 1.0, 1.0, 2.0, 1.0, 1.0, 1.0, 2.0, 1.0, 4.0, 1.0, 1.0, 1.0, 4.0, 1.0, 1.0, 1.0, 4.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-15 09:57:31,073 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
2025-03-15 09:57:33,559 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-15 01:54:29', 'last_model_construction_at': '2025-03-14 04:58:47', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [1.0, 1.0, 1.0, 2.0, 1.0, 1.0, 1.0, 2.0, 1.0, 4.0, 1.0, 1.0, 1.0, 4.0, 1.0, 1.0, 1.0, 4.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-15 09:57:33,560 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
2025-03-15 09:57:39,312 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-15 09:57:39,369 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-15 09:57:39,370 - INFO - Extracting API list with API discovery algorithm...
2025-03-15 09:57:39,452 - INFO - Starting Drain3 template miner
2025-03-15 09:57:39,455 - INFO - Starting Drain3 template miner
2025-03-15 09:57:39,458 - INFO - Starting Drain3 template miner
2025-03-15 09:57:39,458 - INFO - Starting Drain3 template miner
2025-03-15 09:57:39,459 - INFO - Starting Drain3 template miner
2025-03-15 09:57:41,481 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-15 09:59:09,850 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-15 09:59:09,899 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-15 09:59:09,899 - INFO - Extracting API list with API discovery algorithm...
2025-03-15 09:59:09,966 - INFO - Starting Drain3 template miner
2025-03-15 09:59:09,969 - INFO - Starting Drain3 template miner
2025-03-15 09:59:09,971 - INFO - Starting Drain3 template miner
2025-03-15 09:59:09,972 - INFO - Starting Drain3 template miner
2025-03-15 09:59:09,972 - INFO - Starting Drain3 template miner
2025-03-15 09:59:12,037 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-15 10:01:10,993 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-15 10:01:11,038 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-15 10:01:11,038 - INFO - Extracting API list with API discovery algorithm...
2025-03-15 10:01:11,097 - INFO - Starting Drain3 template miner
2025-03-15 10:01:11,101 - INFO - Starting Drain3 template miner
2025-03-15 10:01:11,103 - INFO - Starting Drain3 template miner
2025-03-15 10:01:11,104 - INFO - Starting Drain3 template miner
2025-03-15 10:01:11,104 - INFO - Starting Drain3 template miner
2025-03-15 10:01:12,139 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-15 10:01:42,438 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-15 10:01:42,482 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-15 10:01:42,482 - INFO - Extracting API list with API discovery algorithm...
2025-03-15 10:01:42,541 - INFO - Starting Drain3 template miner
2025-03-15 10:01:42,544 - INFO - Starting Drain3 template miner
2025-03-15 10:01:42,545 - INFO - Starting Drain3 template miner
2025-03-15 10:01:42,546 - INFO - Starting Drain3 template miner
2025-03-15 10:01:42,546 - INFO - Starting Drain3 template miner
2025-03-15 10:01:43,608 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-15 10:04:16,272 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-15 10:04:16,314 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-15 10:04:16,314 - INFO - Extracting API list with API discovery algorithm...
2025-03-15 10:04:16,372 - INFO - Starting Drain3 template miner
2025-03-15 10:04:16,375 - INFO - Starting Drain3 template miner
2025-03-15 10:04:16,376 - INFO - Starting Drain3 template miner
2025-03-15 10:04:16,377 - INFO - Starting Drain3 template miner
2025-03-15 10:04:16,377 - INFO - Starting Drain3 template miner
2025-03-15 10:04:17,503 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-15 10:05:46,899 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-15 10:05:46,942 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-15 10:05:46,942 - INFO - Extracting API list with API discovery algorithm...
2025-03-15 10:05:47,008 - INFO - Starting Drain3 template miner
2025-03-15 10:05:47,011 - INFO - Starting Drain3 template miner
2025-03-15 10:05:47,013 - INFO - Starting Drain3 template miner
2025-03-15 10:05:47,014 - INFO - Starting Drain3 template miner
2025-03-15 10:05:47,014 - INFO - Starting Drain3 template miner
2025-03-15 10:05:48,630 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-15 10:09:17,890 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-15 10:09:17,932 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-15 10:09:17,932 - INFO - Extracting API list with API discovery algorithm...
2025-03-15 10:09:17,994 - INFO - Starting Drain3 template miner
2025-03-15 10:09:17,996 - INFO - Starting Drain3 template miner
2025-03-15 10:09:17,998 - INFO - Starting Drain3 template miner
2025-03-15 10:09:17,999 - INFO - Starting Drain3 template miner
2025-03-15 10:09:17,999 - INFO - Starting Drain3 template miner
2025-03-15 10:09:19,605 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-15 10:10:32,766 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-15 10:10:32,810 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-15 10:10:32,810 - INFO - Extracting API list with API discovery algorithm...
2025-03-15 10:10:32,870 - INFO - Starting Drain3 template miner
2025-03-15 10:10:32,873 - INFO - Starting Drain3 template miner
2025-03-15 10:10:32,874 - INFO - Starting Drain3 template miner
2025-03-15 10:10:32,875 - INFO - Starting Drain3 template miner
2025-03-15 10:10:32,876 - INFO - Starting Drain3 template miner
2025-03-15 10:10:34,512 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-15 10:11:30,531 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-15 10:11:30,573 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-15 10:11:30,573 - INFO - Extracting API list with API discovery algorithm...
2025-03-15 10:11:30,634 - INFO - Starting Drain3 template miner
2025-03-15 10:11:30,637 - INFO - Starting Drain3 template miner
2025-03-15 10:11:30,639 - INFO - Starting Drain3 template miner
2025-03-15 10:11:30,640 - INFO - Starting Drain3 template miner
2025-03-15 10:11:30,640 - INFO - Starting Drain3 template miner
2025-03-15 10:11:32,265 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-15 10:12:09,333 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-15 10:12:09,375 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-15 10:12:09,375 - INFO - Extracting API list with API discovery algorithm...
2025-03-15 10:12:09,441 - INFO - Starting Drain3 template miner
2025-03-15 10:12:09,444 - INFO - Starting Drain3 template miner
2025-03-15 10:12:09,446 - INFO - Starting Drain3 template miner
2025-03-15 10:12:09,446 - INFO - Starting Drain3 template miner
2025-03-15 10:12:09,447 - INFO - Starting Drain3 template miner
2025-03-15 10:12:11,128 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-15 10:14:17,859 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-15 10:14:17,918 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-15 10:14:17,919 - INFO - Extracting API list with API discovery algorithm...
2025-03-15 10:14:17,981 - INFO - Starting Drain3 template miner
2025-03-15 10:14:17,984 - INFO - Starting Drain3 template miner
2025-03-15 10:14:17,986 - INFO - Starting Drain3 template miner
2025-03-15 10:14:17,987 - INFO - Starting Drain3 template miner
2025-03-15 10:14:17,987 - INFO - Starting Drain3 template miner
2025-03-15 10:14:19,631 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-15 10:16:36,476 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-15 10:16:36,518 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-15 10:16:36,519 - INFO - Extracting API list with API discovery algorithm...
2025-03-15 10:16:36,581 - INFO - Starting Drain3 template miner
2025-03-15 10:16:36,583 - INFO - Starting Drain3 template miner
2025-03-15 10:16:36,586 - INFO - Starting Drain3 template miner
2025-03-15 10:16:36,586 - INFO - Starting Drain3 template miner
2025-03-15 10:16:36,587 - INFO - Starting Drain3 template miner
2025-03-15 10:16:38,428 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-15 10:21:19,085 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-15 10:21:19,131 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-15 10:21:19,302 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-15 10:21:19,302 - INFO - Starting data generation...
2025-03-15 10:21:19,302 - INFO - API_KNOWLEDGE: [{'number': 'API_2935', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_2936', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}]
2025-03-15 10:21:19,302 - INFO - APP_KNOWLEDGE: {'func_description': 'This is an updated test application', 'normal_seqs': ['Role: admin; API_2935(Call 1); API_2936(Call 2)', 'Role: oridinary_user; API_2935(); API_2936()'], 'malicious_seqs': ['Role: admin; API_2935(); API_2936()', 'Role: ordinary_user; API_2936(); API_2935()'], 'roles': ['admin', 'ordinary_user', 'unlogged_in_user']}
2025-03-15 10:21:19,553 - INFO - Generating simulated API sequences...
2025-03-15 10:21:19,553 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-15 10:21:20,942 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 10:21:20,977 - INFO - ========== Method gen_api_seq() returned: seq=['API_2935', 'API_2936'], malicious_sign_seq=[0, 1] ==========
2025-03-15 10:21:20,977 - INFO - API sequence 1/12 generated
2025-03-15 10:21:20,977 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-15 10:21:23,174 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 10:21:23,175 - INFO - ========== Method gen_api_seq() returned: seq=['API_2935', 'API_2936'], malicious_sign_seq=[0, 0] ==========
2025-03-15 10:21:23,175 - INFO - API sequence 2/12 generated
2025-03-15 10:21:23,175 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-15 10:21:25,384 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 10:21:25,385 - INFO - ========== Method gen_api_seq() returned: seq=['API_2935', 'API_2936'], malicious_sign_seq=[0, 1] ==========
2025-03-15 10:21:25,386 - INFO - API sequence 3/12 generated
2025-03-15 10:21:25,386 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-15 10:21:27,608 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 10:21:27,609 - INFO - ========== Method gen_api_seq() returned: seq=['API_2935', 'API_2936'], malicious_sign_seq=[0, 0] ==========
2025-03-15 10:21:27,609 - INFO - API sequence 4/12 generated
2025-03-15 10:21:27,609 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-15 10:21:28,850 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 10:21:28,851 - INFO - ========== Method gen_api_seq() returned: seq=['API_2935', 'API_2936'], malicious_sign_seq=[0, 1] ==========
2025-03-15 10:21:28,851 - INFO - API sequence 5/12 generated
2025-03-15 10:21:28,851 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-15 10:21:30,930 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 10:21:30,931 - INFO - ========== Method gen_api_seq() returned: seq=['API_2935', 'API_2936'], malicious_sign_seq=[0, 0] ==========
2025-03-15 10:21:30,931 - INFO - API sequence 6/12 generated
2025-03-15 10:21:30,931 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-15 10:21:33,191 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 10:21:33,192 - INFO - ========== Method gen_api_seq() returned: seq=['API_2935', 'API_2936'], malicious_sign_seq=[0, 1] ==========
2025-03-15 10:21:33,192 - INFO - API sequence 7/12 generated
2025-03-15 10:21:33,193 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-15 10:21:34,302 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 10:21:34,303 - INFO - ========== Method gen_api_seq() returned: seq=['API_2935'], malicious_sign_seq=[0] ==========
2025-03-15 10:21:34,303 - INFO - API sequence 8/12 generated
2025-03-15 10:21:34,303 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-15 10:21:35,278 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 10:21:35,279 - INFO - ========== Method gen_api_seq() returned: seq=['API_2935'], malicious_sign_seq=[0] ==========
2025-03-15 10:21:35,279 - INFO - API sequence 9/12 generated
2025-03-15 10:21:35,280 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-15 10:21:37,789 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 10:21:37,790 - INFO - ========== Method gen_api_seq() returned: seq=['API_2935', 'API_2936'], malicious_sign_seq=[0, 1] ==========
2025-03-15 10:21:37,790 - INFO - API sequence 10/12 generated
2025-03-15 10:21:37,791 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-15 10:21:40,160 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 10:21:40,161 - INFO - ========== Method gen_api_seq() returned: seq=['API_2935', 'API_2936'], malicious_sign_seq=[0, 1] ==========
2025-03-15 10:21:40,162 - INFO - API sequence 11/12 generated
2025-03-15 10:21:40,162 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-15 10:21:41,246 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 10:21:41,247 - INFO - ========== Method gen_api_seq() returned: seq=['API_2935'], malicious_sign_seq=[0] ==========
2025-03-15 10:21:41,247 - INFO - API sequence 12/12 generated
2025-03-15 10:21:41,248 - INFO - API sequences serialized to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py/serialized_llm_agents.json
2025-03-15 10:21:41,248 - INFO - Generating simulated traffic data set...
2025-03-15 10:21:41,257 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 10:21:41,257 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 10:21:41,265 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 10:21:41,265 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-15 10:21:41,265 - INFO - error_apis: []
2025-03-15 10:21:41,265 - INFO - Simulated traffic data for 1/12 user collected：user: unloggeduser malicious: True
2025-03-15 10:21:41,272 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 10:21:41,272 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 10:21:41,279 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 10:21:41,280 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 10:21:41,280 - INFO - error_apis: []
2025-03-15 10:21:41,280 - INFO - Simulated traffic data for 2/12 user collected：user: normaluser malicious: False
2025-03-15 10:21:41,287 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 10:21:41,287 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 10:21:41,294 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 10:21:41,294 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-15 10:21:41,294 - INFO - error_apis: []
2025-03-15 10:21:41,294 - INFO - Simulated traffic data for 3/12 user collected：user: unloggeduser malicious: True
2025-03-15 10:21:41,302 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 10:21:41,302 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 10:21:41,310 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 10:21:41,310 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 10:21:41,310 - INFO - error_apis: []
2025-03-15 10:21:41,310 - INFO - Simulated traffic data for 4/12 user collected：user: normaluser malicious: False
2025-03-15 10:21:41,317 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 10:21:41,317 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 10:21:41,325 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 10:21:41,325 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-15 10:21:41,325 - INFO - error_apis: []
2025-03-15 10:21:41,325 - INFO - Simulated traffic data for 5/12 user collected：user: normaluser malicious: True
2025-03-15 10:21:41,414 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 10:21:41,414 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 10:21:41,422 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 10:21:41,422 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 10:21:41,422 - INFO - error_apis: []
2025-03-15 10:21:41,422 - INFO - Simulated traffic data for 6/12 user collected：user: adminuser malicious: False
2025-03-15 10:21:41,429 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 10:21:41,429 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 10:21:41,437 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 10:21:41,437 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-15 10:21:41,437 - INFO - error_apis: []
2025-03-15 10:21:41,437 - INFO - Simulated traffic data for 7/12 user collected：user: normaluser malicious: True
2025-03-15 10:21:41,445 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 10:21:41,445 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 10:21:41,445 - INFO - error_apis: []
2025-03-15 10:21:41,445 - INFO - Simulated traffic data for 8/12 user collected：user: normaluser malicious: False
2025-03-15 10:21:41,453 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 10:21:41,453 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 10:21:41,453 - INFO - error_apis: []
2025-03-15 10:21:41,453 - INFO - Simulated traffic data for 9/12 user collected：user: normaluser malicious: False
2025-03-15 10:21:41,460 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 10:21:41,460 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 10:21:41,468 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 10:21:41,468 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-15 10:21:41,468 - INFO - error_apis: []
2025-03-15 10:21:41,468 - INFO - Simulated traffic data for 10/12 user collected：user: normaluser malicious: True
2025-03-15 10:21:41,475 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 10:21:41,475 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 10:21:41,483 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 10:21:41,483 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-15 10:21:41,483 - INFO - error_apis: []
2025-03-15 10:21:41,483 - INFO - Simulated traffic data for 11/12 user collected：user: unloggeduser malicious: True
2025-03-15 10:21:41,491 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 10:21:41,491 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 10:21:41,491 - INFO - error_apis: []
2025-03-15 10:21:41,492 - INFO - Simulated traffic data for 12/12 user collected：user: adminuser malicious: False
2025-03-15 10:21:41,509 - INFO - All simulated traffic data collected：/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/simulated_traffic_data.csv
2025-03-15 10:21:41,509 - INFO - error_apis: []
2025-03-15 10:21:59,846 - INFO - Trying to construct model...
2025-03-15 10:21:59,846 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-15 10:21:59,904 - INFO - Training model... Size of feature_list: 7
2025-03-15 10:21:59,925 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 10:21:59,931 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 10:21:59,933 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 10:21:59,934 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 10:21:59,935 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 10:21:59,937 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 10:21:59,938 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 10:21:59,940 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 10:22:00,106 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 10:22:00,108 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 10:22:00,110 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 10:22:00,112 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 10:22:00,133 - INFO - Model constructed.
2025-03-15 10:22:24,132 - INFO - Detection started. Combined data duration: 10
2025-03-15 10:22:35,513 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 7
2025-03-15 10:22:35,520 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 10:22:35,528 - INFO - [{'MeanUrlParamsCount': 0.0, 'RepeatUrlVisitCount': 3.0, 'DeepPageVisitRate': 0.0, 'MeanUrlPathDepth': 1.0, 'MeanUrlLength': 63.0, 'UniquePageVisitCount': 6, 'SeqOccurTime_559aead08264d5795d3909718cdd05abd49572e84fe55590eef31a88a08fdffd': 3}]
2025-03-15 10:22:35,528 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 10:22:35,550 - INFO - A new detect record generated; Traffic data size: 13
2025-03-15 10:22:45,565 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 7
2025-03-15 10:22:45,567 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 10:22:45,571 - INFO - [{'MeanUrlParamsCount': 0.0, 'RepeatUrlVisitCount': 4.0, 'DeepPageVisitRate': 0.0, 'MeanUrlPathDepth': 1.0, 'MeanUrlLength': 62.07692307692308, 'UniquePageVisitCount': 7, 'SeqOccurTime_559aead08264d5795d3909718cdd05abd49572e84fe55590eef31a88a08fdffd': 2}]
2025-03-15 10:22:45,572 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 10:22:45,591 - INFO - A new detect record generated; Traffic data size: 13
2025-03-15 10:22:55,607 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 7
2025-03-15 10:22:55,609 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 10:22:55,614 - INFO - [{'MeanUrlParamsCount': 0.0, 'RepeatUrlVisitCount': 6.0, 'DeepPageVisitRate': 0.0, 'MeanUrlPathDepth': 1.0, 'MeanUrlLength': 70.0625, 'UniquePageVisitCount': 8, 'SeqOccurTime_559aead08264d5795d3909718cdd05abd49572e84fe55590eef31a88a08fdffd': 5}]
2025-03-15 10:22:55,614 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 10:22:55,635 - INFO - A new detect record generated; Traffic data size: 16
2025-03-15 10:23:05,653 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 7
2025-03-15 10:23:05,655 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 10:23:05,662 - INFO - [{'MeanUrlParamsCount': 0.0, 'RepeatUrlVisitCount': 6.0, 'DeepPageVisitRate': 0.0, 'MeanUrlPathDepth': 1.0, 'MeanUrlLength': 65.83333333333333, 'UniquePageVisitCount': 13, 'SeqOccurTime_559aead08264d5795d3909718cdd05abd49572e84fe55590eef31a88a08fdffd': 8}]
2025-03-15 10:23:05,663 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 10:23:05,687 - INFO - A new detect record generated; Traffic data size: 24
2025-03-15 10:23:15,704 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 7
2025-03-15 10:23:15,706 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 10:23:15,712 - INFO - [{'MeanUrlParamsCount': 0.0, 'RepeatUrlVisitCount': 2.0, 'DeepPageVisitRate': 0.0, 'MeanUrlPathDepth': 1.0, 'MeanUrlLength': 61.1578947368421, 'UniquePageVisitCount': 5, 'SeqOccurTime_559aead08264d5795d3909718cdd05abd49572e84fe55590eef31a88a08fdffd': 1}]
2025-03-15 10:23:15,712 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 10:23:15,741 - INFO - A new detect record generated; Traffic data size: 19
2025-03-15 10:23:22,778 - INFO - Detection paused.
2025-03-15 10:32:11,269 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-15 02:16:38', 'last_model_construction_at': '2025-03-15 02:22:00', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.5, 1.0, 0.67, 2.0, 0.0, 0.0, 0.0, 2.0, 0.5, 4.0, 0.25, 0.5, 0.33, 4.0, 0.25, 0.5, 0.33, 4.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-15 10:32:11,269 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
2025-03-15 10:32:13,964 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-15 02:16:38', 'last_model_construction_at': '2025-03-15 02:22:00', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.5, 1.0, 0.67, 2.0, 0.0, 0.0, 0.0, 2.0, 0.5, 4.0, 0.25, 0.5, 0.33, 4.0, 0.25, 0.5, 0.33, 4.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-15 10:32:13,966 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
2025-03-15 10:33:12,654 - INFO - Detection started. Combined data duration: 10
2025-03-15 10:33:16,215 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 7
2025-03-15 10:33:16,264 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 10:33:16,291 - INFO - [{'MeanUrlParamsCount': 0.0, 'RepeatUrlVisitCount': 0.0, 'DeepPageVisitRate': 0.0, 'MeanUrlPathDepth': 1.0, 'MeanUrlLength': 70.0, 'UniquePageVisitCount': 1, 'SeqOccurTime_559aead08264d5795d3909718cdd05abd49572e84fe55590eef31a88a08fdffd': 1}]
2025-03-15 10:33:16,291 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 10:33:16,318 - INFO - A new detect record generated; Traffic data size: 1
2025-03-15 10:33:19,623 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 7
2025-03-15 10:33:19,624 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 10:33:19,628 - INFO - [{'MeanUrlParamsCount': 0.0, 'RepeatUrlVisitCount': 1.0, 'DeepPageVisitRate': 0.0, 'MeanUrlPathDepth': 1.0, 'MeanUrlLength': 72.6, 'UniquePageVisitCount': 4, 'SeqOccurTime_559aead08264d5795d3909718cdd05abd49572e84fe55590eef31a88a08fdffd': 1}]
2025-03-15 10:33:19,628 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 10:33:19,647 - INFO - A new detect record generated; Traffic data size: 5
2025-03-15 10:33:26,338 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 7
2025-03-15 10:33:26,340 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 10:33:26,348 - INFO - [{'MeanUrlParamsCount': 0.0, 'RepeatUrlVisitCount': 6.0, 'DeepPageVisitRate': 0.0, 'MeanUrlPathDepth': 1.0, 'MeanUrlLength': 70.77777777777777, 'UniquePageVisitCount': 8, 'SeqOccurTime_559aead08264d5795d3909718cdd05abd49572e84fe55590eef31a88a08fdffd': 9}]
2025-03-15 10:33:26,348 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 10:33:26,392 - INFO - A new detect record generated; Traffic data size: 18
2025-03-15 10:33:29,661 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 7
2025-03-15 10:33:29,663 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 10:33:29,666 - INFO - [{'MeanUrlParamsCount': 0.0, 'RepeatUrlVisitCount': 2.0, 'DeepPageVisitRate': 0.0, 'MeanUrlPathDepth': 1.0, 'MeanUrlLength': 61.625, 'UniquePageVisitCount': 5, 'SeqOccurTime_559aead08264d5795d3909718cdd05abd49572e84fe55590eef31a88a08fdffd': 0}]
2025-03-15 10:33:29,666 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 10:33:29,686 - INFO - A new detect record generated; Traffic data size: 8
2025-03-15 10:33:36,411 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 7
2025-03-15 10:33:36,412 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 10:33:36,419 - INFO - [{'MeanUrlParamsCount': 0.0, 'RepeatUrlVisitCount': 2.0, 'DeepPageVisitRate': 0.0, 'MeanUrlPathDepth': 1.0, 'MeanUrlLength': 60.38095238095238, 'UniquePageVisitCount': 2, 'SeqOccurTime_559aead08264d5795d3909718cdd05abd49572e84fe55590eef31a88a08fdffd': 0}]
2025-03-15 10:33:36,419 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 10:33:36,444 - INFO - A new detect record generated; Traffic data size: 21
2025-03-15 10:33:39,700 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 7
2025-03-15 10:33:39,702 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 10:33:39,704 - INFO - [{'MeanUrlParamsCount': 0.0, 'RepeatUrlVisitCount': 0.0, 'DeepPageVisitRate': 0.0, 'MeanUrlPathDepth': 1.0, 'MeanUrlLength': 62.8, 'UniquePageVisitCount': 5, 'SeqOccurTime_559aead08264d5795d3909718cdd05abd49572e84fe55590eef31a88a08fdffd': 1}]
2025-03-15 10:33:39,704 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 10:33:39,724 - INFO - A new detect record generated; Traffic data size: 5
2025-03-15 10:33:46,459 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 7
2025-03-15 10:33:46,461 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 10:33:46,467 - INFO - [{'MeanUrlParamsCount': 0.0, 'RepeatUrlVisitCount': 6.0, 'DeepPageVisitRate': 0.0, 'MeanUrlPathDepth': 1.0, 'MeanUrlLength': 70.125, 'UniquePageVisitCount': 8, 'SeqOccurTime_559aead08264d5795d3909718cdd05abd49572e84fe55590eef31a88a08fdffd': 5}]
2025-03-15 10:33:46,467 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 10:33:46,496 - INFO - A new detect record generated; Traffic data size: 16
2025-03-15 10:33:49,737 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 7
2025-03-15 10:33:49,739 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 10:33:49,743 - INFO - [{'MeanUrlParamsCount': 0.0, 'RepeatUrlVisitCount': 4.0, 'DeepPageVisitRate': 0.0, 'MeanUrlPathDepth': 1.0, 'MeanUrlLength': 72.25, 'UniquePageVisitCount': 6, 'SeqOccurTime_559aead08264d5795d3909718cdd05abd49572e84fe55590eef31a88a08fdffd': 4}]
2025-03-15 10:33:49,743 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 10:33:49,767 - INFO - A new detect record generated; Traffic data size: 12
2025-03-15 10:33:56,510 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 7
2025-03-15 10:33:56,511 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 10:33:56,513 - INFO - [{'MeanUrlParamsCount': 0.0, 'RepeatUrlVisitCount': 0.0, 'DeepPageVisitRate': 0.0, 'MeanUrlPathDepth': 1.0, 'MeanUrlLength': 70.5, 'UniquePageVisitCount': 2, 'SeqOccurTime_559aead08264d5795d3909718cdd05abd49572e84fe55590eef31a88a08fdffd': 2}]
2025-03-15 10:33:56,513 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 10:33:56,532 - INFO - A new detect record generated; Traffic data size: 2
2025-03-15 10:33:58,749 - INFO - Detection paused.
2025-03-15 11:03:19,846 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-15 02:16:38', 'last_model_construction_at': '2025-03-15 02:22:00', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.5, 1.0, 0.67, 2.0, 0.0, 0.0, 0.0, 2.0, 0.5, 4.0, 0.25, 0.5, 0.33, 4.0, 0.25, 0.5, 0.33, 4.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-15 11:03:19,848 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
2025-03-15 11:03:22,625 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-15 02:16:38', 'last_model_construction_at': '2025-03-15 02:22:00', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.5, 1.0, 0.67, 2.0, 0.0, 0.0, 0.0, 2.0, 0.5, 4.0, 0.25, 0.5, 0.33, 4.0, 0.25, 0.5, 0.33, 4.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-15 11:03:22,626 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
2025-03-15 21:00:55,238 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-15 02:16:38', 'last_model_construction_at': '2025-03-15 02:22:00', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.5, 1.0, 0.67, 2.0, 0.0, 0.0, 0.0, 2.0, 0.5, 4.0, 0.25, 0.5, 0.33, 4.0, 0.25, 0.5, 0.33, 4.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-15 21:00:55,240 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
2025-03-15 21:00:57,865 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-15 02:16:38', 'last_model_construction_at': '2025-03-15 02:22:00', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.5, 1.0, 0.67, 2.0, 0.0, 0.0, 0.0, 2.0, 0.5, 4.0, 0.25, 0.5, 0.33, 4.0, 0.25, 0.5, 0.33, 4.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-15 21:00:57,866 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
2025-03-15 21:06:02,145 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-15 21:06:02,242 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-15 21:06:02,352 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-15 21:06:02,352 - INFO - Starting data generation...
2025-03-15 21:06:02,352 - INFO - API_KNOWLEDGE: [{'number': 'API_2939', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_2940', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}]
2025-03-15 21:06:02,352 - INFO - APP_KNOWLEDGE: {'func_description': 'This is an updated test application', 'normal_seqs': ['Role: admin; API_2939(Call 1); API_2940(Call 2)', 'Role: oridinary_user; API_2940(); API_2939()'], 'malicious_seqs': ['Role: admin; API_2939(); API_2940()', 'Role: ordinary_user; API_2940(); API_2939()'], 'roles': ['admin', 'ordinary_user', 'unlogged_in_user']}
2025-03-15 21:06:02,645 - INFO - Generating simulated API sequences...
2025-03-15 21:06:02,646 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-15 21:06:04,141 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:06:04,145 - INFO - ========== Method gen_api_seq() returned: seq=['API_2940', 'API_2939'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:06:04,145 - INFO - User configured API_ROLE:{'admin': ['API_2', 'API_5', 'API_6', 'API_8', 'API_10', 'API_13', 'API_14', 'API_15', 'API_18', 'API_19', 'API_23', 'API_28', 'API_34', 'API_35', 'API_36', 'API_37', 'API_39', 'API_40', 'API_41', 'API_42', 'API_43', 'API_47', 'API_50', 'API_55', 'API_56', 'API_63', 'API_64', 'API_65', 'API_84', 'API_100', 'API_107', 'API_117', 'API_120', 'API_121', 'API_122', 'API_123', 'API_126', 'API_129', 'API_131', 'API_134', 'API_155'], 'ordinary_user': ['API_2', 'API_5', 'API_6', 'API_8', 'API_10', 'API_13', 'API_14', 'API_15', 'API_28', 'API_34', 'API_35', 'API_36', 'API_37', 'API_39', 'API_43', 'API_47', 'API_63', 'API_64', 'API_65', 'API_84', 'API_100', 'API_107', 'API_117', 'API_120', 'API_121', 'API_122', 'API_123', 'API_126', 'API_129', 'API_131', 'API_134', 'API_155'], 'unlogged_in_user': []}
2025-03-15 21:06:04,146 - INFO - API sequence 1/12 generated
2025-03-15 21:06:04,146 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-15 21:06:05,421 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:06:05,422 - INFO - ========== Method gen_api_seq() returned: seq=['API_2940', 'API_2939'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:06:05,422 - INFO - User configured API_ROLE:{'admin': ['API_2', 'API_5', 'API_6', 'API_8', 'API_10', 'API_13', 'API_14', 'API_15', 'API_18', 'API_19', 'API_23', 'API_28', 'API_34', 'API_35', 'API_36', 'API_37', 'API_39', 'API_40', 'API_41', 'API_42', 'API_43', 'API_47', 'API_50', 'API_55', 'API_56', 'API_63', 'API_64', 'API_65', 'API_84', 'API_100', 'API_107', 'API_117', 'API_120', 'API_121', 'API_122', 'API_123', 'API_126', 'API_129', 'API_131', 'API_134', 'API_155'], 'ordinary_user': ['API_2', 'API_5', 'API_6', 'API_8', 'API_10', 'API_13', 'API_14', 'API_15', 'API_28', 'API_34', 'API_35', 'API_36', 'API_37', 'API_39', 'API_43', 'API_47', 'API_63', 'API_64', 'API_65', 'API_84', 'API_100', 'API_107', 'API_117', 'API_120', 'API_121', 'API_122', 'API_123', 'API_126', 'API_129', 'API_131', 'API_134', 'API_155'], 'unlogged_in_user': []}
2025-03-15 21:06:05,422 - INFO - API sequence 2/12 generated
2025-03-15 21:06:05,422 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-15 21:06:06,394 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:06:06,395 - INFO - ========== Method gen_api_seq() returned: seq=['API_2940'], malicious_sign_seq=[0] ==========
2025-03-15 21:06:06,395 - INFO - User configured API_ROLE:{'admin': ['API_2', 'API_5', 'API_6', 'API_8', 'API_10', 'API_13', 'API_14', 'API_15', 'API_18', 'API_19', 'API_23', 'API_28', 'API_34', 'API_35', 'API_36', 'API_37', 'API_39', 'API_40', 'API_41', 'API_42', 'API_43', 'API_47', 'API_50', 'API_55', 'API_56', 'API_63', 'API_64', 'API_65', 'API_84', 'API_100', 'API_107', 'API_117', 'API_120', 'API_121', 'API_122', 'API_123', 'API_126', 'API_129', 'API_131', 'API_134', 'API_155'], 'ordinary_user': ['API_2', 'API_5', 'API_6', 'API_8', 'API_10', 'API_13', 'API_14', 'API_15', 'API_28', 'API_34', 'API_35', 'API_36', 'API_37', 'API_39', 'API_43', 'API_47', 'API_63', 'API_64', 'API_65', 'API_84', 'API_100', 'API_107', 'API_117', 'API_120', 'API_121', 'API_122', 'API_123', 'API_126', 'API_129', 'API_131', 'API_134', 'API_155'], 'unlogged_in_user': []}
2025-03-15 21:06:06,396 - INFO - API sequence 3/12 generated
2025-03-15 21:06:06,396 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-15 21:06:07,544 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:06:07,545 - INFO - ========== Method gen_api_seq() returned: seq=['API_2939'], malicious_sign_seq=[0] ==========
2025-03-15 21:06:07,545 - INFO - User configured API_ROLE:{'admin': ['API_2', 'API_5', 'API_6', 'API_8', 'API_10', 'API_13', 'API_14', 'API_15', 'API_18', 'API_19', 'API_23', 'API_28', 'API_34', 'API_35', 'API_36', 'API_37', 'API_39', 'API_40', 'API_41', 'API_42', 'API_43', 'API_47', 'API_50', 'API_55', 'API_56', 'API_63', 'API_64', 'API_65', 'API_84', 'API_100', 'API_107', 'API_117', 'API_120', 'API_121', 'API_122', 'API_123', 'API_126', 'API_129', 'API_131', 'API_134', 'API_155'], 'ordinary_user': ['API_2', 'API_5', 'API_6', 'API_8', 'API_10', 'API_13', 'API_14', 'API_15', 'API_28', 'API_34', 'API_35', 'API_36', 'API_37', 'API_39', 'API_43', 'API_47', 'API_63', 'API_64', 'API_65', 'API_84', 'API_100', 'API_107', 'API_117', 'API_120', 'API_121', 'API_122', 'API_123', 'API_126', 'API_129', 'API_131', 'API_134', 'API_155'], 'unlogged_in_user': []}
2025-03-15 21:06:07,545 - INFO - API sequence 4/12 generated
2025-03-15 21:06:07,545 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-15 21:06:09,209 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:06:09,210 - INFO - ========== Method gen_api_seq() returned: seq=['API_2940'], malicious_sign_seq=[0] ==========
2025-03-15 21:06:09,211 - INFO - User configured API_ROLE:{'admin': ['API_2', 'API_5', 'API_6', 'API_8', 'API_10', 'API_13', 'API_14', 'API_15', 'API_18', 'API_19', 'API_23', 'API_28', 'API_34', 'API_35', 'API_36', 'API_37', 'API_39', 'API_40', 'API_41', 'API_42', 'API_43', 'API_47', 'API_50', 'API_55', 'API_56', 'API_63', 'API_64', 'API_65', 'API_84', 'API_100', 'API_107', 'API_117', 'API_120', 'API_121', 'API_122', 'API_123', 'API_126', 'API_129', 'API_131', 'API_134', 'API_155'], 'ordinary_user': ['API_2', 'API_5', 'API_6', 'API_8', 'API_10', 'API_13', 'API_14', 'API_15', 'API_28', 'API_34', 'API_35', 'API_36', 'API_37', 'API_39', 'API_43', 'API_47', 'API_63', 'API_64', 'API_65', 'API_84', 'API_100', 'API_107', 'API_117', 'API_120', 'API_121', 'API_122', 'API_123', 'API_126', 'API_129', 'API_131', 'API_134', 'API_155'], 'unlogged_in_user': []}
2025-03-15 21:06:09,211 - INFO - API sequence 5/12 generated
2025-03-15 21:06:09,211 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-15 21:06:10,509 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:06:10,510 - INFO - ========== Method gen_api_seq() returned: seq=['API_2940', 'API_2939'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:06:10,511 - INFO - User configured API_ROLE:{'admin': ['API_2', 'API_5', 'API_6', 'API_8', 'API_10', 'API_13', 'API_14', 'API_15', 'API_18', 'API_19', 'API_23', 'API_28', 'API_34', 'API_35', 'API_36', 'API_37', 'API_39', 'API_40', 'API_41', 'API_42', 'API_43', 'API_47', 'API_50', 'API_55', 'API_56', 'API_63', 'API_64', 'API_65', 'API_84', 'API_100', 'API_107', 'API_117', 'API_120', 'API_121', 'API_122', 'API_123', 'API_126', 'API_129', 'API_131', 'API_134', 'API_155'], 'ordinary_user': ['API_2', 'API_5', 'API_6', 'API_8', 'API_10', 'API_13', 'API_14', 'API_15', 'API_28', 'API_34', 'API_35', 'API_36', 'API_37', 'API_39', 'API_43', 'API_47', 'API_63', 'API_64', 'API_65', 'API_84', 'API_100', 'API_107', 'API_117', 'API_120', 'API_121', 'API_122', 'API_123', 'API_126', 'API_129', 'API_131', 'API_134', 'API_155'], 'unlogged_in_user': []}
2025-03-15 21:06:10,511 - INFO - API sequence 6/12 generated
2025-03-15 21:06:10,511 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-15 21:06:12,273 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:06:12,274 - INFO - ========== Method gen_api_seq() returned: seq=['API_2940'], malicious_sign_seq=[0] ==========
2025-03-15 21:06:12,274 - INFO - User configured API_ROLE:{'admin': ['API_2', 'API_5', 'API_6', 'API_8', 'API_10', 'API_13', 'API_14', 'API_15', 'API_18', 'API_19', 'API_23', 'API_28', 'API_34', 'API_35', 'API_36', 'API_37', 'API_39', 'API_40', 'API_41', 'API_42', 'API_43', 'API_47', 'API_50', 'API_55', 'API_56', 'API_63', 'API_64', 'API_65', 'API_84', 'API_100', 'API_107', 'API_117', 'API_120', 'API_121', 'API_122', 'API_123', 'API_126', 'API_129', 'API_131', 'API_134', 'API_155'], 'ordinary_user': ['API_2', 'API_5', 'API_6', 'API_8', 'API_10', 'API_13', 'API_14', 'API_15', 'API_28', 'API_34', 'API_35', 'API_36', 'API_37', 'API_39', 'API_43', 'API_47', 'API_63', 'API_64', 'API_65', 'API_84', 'API_100', 'API_107', 'API_117', 'API_120', 'API_121', 'API_122', 'API_123', 'API_126', 'API_129', 'API_131', 'API_134', 'API_155'], 'unlogged_in_user': []}
2025-03-15 21:06:12,274 - INFO - API sequence 7/12 generated
2025-03-15 21:06:12,274 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-15 21:06:13,605 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:06:13,606 - INFO - ========== Method gen_api_seq() returned: seq=['API_2940', 'API_2939'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:06:13,606 - INFO - User configured API_ROLE:{'admin': ['API_2', 'API_5', 'API_6', 'API_8', 'API_10', 'API_13', 'API_14', 'API_15', 'API_18', 'API_19', 'API_23', 'API_28', 'API_34', 'API_35', 'API_36', 'API_37', 'API_39', 'API_40', 'API_41', 'API_42', 'API_43', 'API_47', 'API_50', 'API_55', 'API_56', 'API_63', 'API_64', 'API_65', 'API_84', 'API_100', 'API_107', 'API_117', 'API_120', 'API_121', 'API_122', 'API_123', 'API_126', 'API_129', 'API_131', 'API_134', 'API_155'], 'ordinary_user': ['API_2', 'API_5', 'API_6', 'API_8', 'API_10', 'API_13', 'API_14', 'API_15', 'API_28', 'API_34', 'API_35', 'API_36', 'API_37', 'API_39', 'API_43', 'API_47', 'API_63', 'API_64', 'API_65', 'API_84', 'API_100', 'API_107', 'API_117', 'API_120', 'API_121', 'API_122', 'API_123', 'API_126', 'API_129', 'API_131', 'API_134', 'API_155'], 'unlogged_in_user': []}
2025-03-15 21:06:13,606 - INFO - API sequence 8/12 generated
2025-03-15 21:06:13,606 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-15 21:06:15,860 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:06:15,861 - INFO - ========== Method gen_api_seq() returned: seq=['API_2940', 'API_2939'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:06:15,861 - INFO - User configured API_ROLE:{'admin': ['API_2', 'API_5', 'API_6', 'API_8', 'API_10', 'API_13', 'API_14', 'API_15', 'API_18', 'API_19', 'API_23', 'API_28', 'API_34', 'API_35', 'API_36', 'API_37', 'API_39', 'API_40', 'API_41', 'API_42', 'API_43', 'API_47', 'API_50', 'API_55', 'API_56', 'API_63', 'API_64', 'API_65', 'API_84', 'API_100', 'API_107', 'API_117', 'API_120', 'API_121', 'API_122', 'API_123', 'API_126', 'API_129', 'API_131', 'API_134', 'API_155'], 'ordinary_user': ['API_2', 'API_5', 'API_6', 'API_8', 'API_10', 'API_13', 'API_14', 'API_15', 'API_28', 'API_34', 'API_35', 'API_36', 'API_37', 'API_39', 'API_43', 'API_47', 'API_63', 'API_64', 'API_65', 'API_84', 'API_100', 'API_107', 'API_117', 'API_120', 'API_121', 'API_122', 'API_123', 'API_126', 'API_129', 'API_131', 'API_134', 'API_155'], 'unlogged_in_user': []}
2025-03-15 21:06:15,861 - INFO - API sequence 9/12 generated
2025-03-15 21:06:15,861 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-15 21:06:17,386 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:06:17,387 - INFO - ========== Method gen_api_seq() returned: seq=['API_2940'], malicious_sign_seq=[0] ==========
2025-03-15 21:06:17,387 - INFO - User configured API_ROLE:{'admin': ['API_2', 'API_5', 'API_6', 'API_8', 'API_10', 'API_13', 'API_14', 'API_15', 'API_18', 'API_19', 'API_23', 'API_28', 'API_34', 'API_35', 'API_36', 'API_37', 'API_39', 'API_40', 'API_41', 'API_42', 'API_43', 'API_47', 'API_50', 'API_55', 'API_56', 'API_63', 'API_64', 'API_65', 'API_84', 'API_100', 'API_107', 'API_117', 'API_120', 'API_121', 'API_122', 'API_123', 'API_126', 'API_129', 'API_131', 'API_134', 'API_155'], 'ordinary_user': ['API_2', 'API_5', 'API_6', 'API_8', 'API_10', 'API_13', 'API_14', 'API_15', 'API_28', 'API_34', 'API_35', 'API_36', 'API_37', 'API_39', 'API_43', 'API_47', 'API_63', 'API_64', 'API_65', 'API_84', 'API_100', 'API_107', 'API_117', 'API_120', 'API_121', 'API_122', 'API_123', 'API_126', 'API_129', 'API_131', 'API_134', 'API_155'], 'unlogged_in_user': []}
2025-03-15 21:06:17,388 - INFO - API sequence 10/12 generated
2025-03-15 21:06:17,388 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-15 21:06:19,069 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:06:19,070 - INFO - ========== Method gen_api_seq() returned: seq=['API_2939'], malicious_sign_seq=[0] ==========
2025-03-15 21:06:19,071 - INFO - User configured API_ROLE:{'admin': ['API_2', 'API_5', 'API_6', 'API_8', 'API_10', 'API_13', 'API_14', 'API_15', 'API_18', 'API_19', 'API_23', 'API_28', 'API_34', 'API_35', 'API_36', 'API_37', 'API_39', 'API_40', 'API_41', 'API_42', 'API_43', 'API_47', 'API_50', 'API_55', 'API_56', 'API_63', 'API_64', 'API_65', 'API_84', 'API_100', 'API_107', 'API_117', 'API_120', 'API_121', 'API_122', 'API_123', 'API_126', 'API_129', 'API_131', 'API_134', 'API_155'], 'ordinary_user': ['API_2', 'API_5', 'API_6', 'API_8', 'API_10', 'API_13', 'API_14', 'API_15', 'API_28', 'API_34', 'API_35', 'API_36', 'API_37', 'API_39', 'API_43', 'API_47', 'API_63', 'API_64', 'API_65', 'API_84', 'API_100', 'API_107', 'API_117', 'API_120', 'API_121', 'API_122', 'API_123', 'API_126', 'API_129', 'API_131', 'API_134', 'API_155'], 'unlogged_in_user': []}
2025-03-15 21:06:19,071 - INFO - API sequence 11/12 generated
2025-03-15 21:06:19,071 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-15 21:06:21,336 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:06:21,337 - INFO - ========== Method gen_api_seq() returned: seq=['API_2940', 'API_2939'], malicious_sign_seq=[1, 0] ==========
2025-03-15 21:06:21,337 - INFO - User configured API_ROLE:{'admin': ['API_2', 'API_5', 'API_6', 'API_8', 'API_10', 'API_13', 'API_14', 'API_15', 'API_18', 'API_19', 'API_23', 'API_28', 'API_34', 'API_35', 'API_36', 'API_37', 'API_39', 'API_40', 'API_41', 'API_42', 'API_43', 'API_47', 'API_50', 'API_55', 'API_56', 'API_63', 'API_64', 'API_65', 'API_84', 'API_100', 'API_107', 'API_117', 'API_120', 'API_121', 'API_122', 'API_123', 'API_126', 'API_129', 'API_131', 'API_134', 'API_155'], 'ordinary_user': ['API_2', 'API_5', 'API_6', 'API_8', 'API_10', 'API_13', 'API_14', 'API_15', 'API_28', 'API_34', 'API_35', 'API_36', 'API_37', 'API_39', 'API_43', 'API_47', 'API_63', 'API_64', 'API_65', 'API_84', 'API_100', 'API_107', 'API_117', 'API_120', 'API_121', 'API_122', 'API_123', 'API_126', 'API_129', 'API_131', 'API_134', 'API_155'], 'unlogged_in_user': []}
2025-03-15 21:06:21,337 - INFO - API sequence 12/12 generated
2025-03-15 21:06:21,338 - INFO - API sequences serialized to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py/serialized_llm_agents.json
2025-03-15 21:06:21,338 - INFO - Generating simulated traffic data set...
2025-03-15 21:06:21,338 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:06:21,338 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:06:21,338 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:06:21,338 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-15 21:06:21,339 - INFO - error_apis: []
2025-03-15 21:06:21,339 - INFO - Simulated traffic data for 1/12 user collected：user: normaluser malicious: True
2025-03-15 21:06:21,339 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:06:21,339 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:06:21,339 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:06:21,339 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-15 21:06:21,339 - INFO - error_apis: []
2025-03-15 21:06:21,339 - INFO - Simulated traffic data for 2/12 user collected：user: normaluser malicious: True
2025-03-15 21:06:21,339 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:06:21,339 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:06:21,339 - INFO - error_apis: []
2025-03-15 21:06:21,339 - INFO - Simulated traffic data for 3/12 user collected：user: normaluser malicious: False
2025-03-15 21:06:21,340 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:06:21,340 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:06:21,340 - INFO - error_apis: []
2025-03-15 21:06:21,340 - INFO - Simulated traffic data for 4/12 user collected：user: adminuser malicious: False
2025-03-15 21:06:21,340 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:06:21,340 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:06:21,340 - INFO - error_apis: []
2025-03-15 21:06:21,340 - INFO - Simulated traffic data for 5/12 user collected：user: normaluser malicious: False
2025-03-15 21:06:21,340 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:06:21,340 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:06:21,340 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:06:21,340 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-15 21:06:21,340 - INFO - error_apis: []
2025-03-15 21:06:21,341 - INFO - Simulated traffic data for 6/12 user collected：user: unloggeduser malicious: True
2025-03-15 21:06:21,341 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:06:21,341 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:06:21,341 - INFO - error_apis: []
2025-03-15 21:06:21,341 - INFO - Simulated traffic data for 7/12 user collected：user: normaluser malicious: False
2025-03-15 21:06:21,341 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:06:21,341 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:06:21,341 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:06:21,341 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-15 21:06:21,341 - INFO - error_apis: []
2025-03-15 21:06:21,341 - INFO - Simulated traffic data for 8/12 user collected：user: unloggeduser malicious: True
2025-03-15 21:06:21,342 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:06:21,342 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:06:21,342 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:06:21,342 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-15 21:06:21,342 - INFO - error_apis: []
2025-03-15 21:06:21,342 - INFO - Simulated traffic data for 9/12 user collected：user: normaluser malicious: True
2025-03-15 21:06:21,342 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:06:21,342 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:06:21,342 - INFO - error_apis: []
2025-03-15 21:06:21,343 - INFO - Simulated traffic data for 10/12 user collected：user: normaluser malicious: False
2025-03-15 21:06:21,343 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:06:21,343 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:06:21,343 - INFO - error_apis: []
2025-03-15 21:06:21,343 - INFO - Simulated traffic data for 11/12 user collected：user: adminuser malicious: False
2025-03-15 21:06:21,343 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:06:21,343 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-15 21:06:21,343 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:06:21,343 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：False
2025-03-15 21:06:21,343 - INFO - error_apis: []
2025-03-15 21:06:21,343 - INFO - Simulated traffic data for 12/12 user collected：user: unloggeduser malicious: True
2025-03-15 21:06:21,349 - INFO - All simulated traffic data collected：/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/simulated_traffic_data.csv
2025-03-15 21:06:21,349 - INFO - error_apis: []
2025-03-15 21:07:20,807 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-15 02:16:38', 'last_model_construction_at': '2025-03-15 02:22:00', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.5, 1.0, 0.67, 2.0, 0.0, 0.0, 0.0, 2.0, 0.5, 4.0, 0.25, 0.5, 0.33, 4.0, 0.25, 0.5, 0.33, 4.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-15 21:07:20,807 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
2025-03-15 21:07:50,731 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-15 02:16:38', 'last_model_construction_at': '2025-03-15 02:22:00', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.5, 1.0, 0.67, 2.0, 0.0, 0.0, 0.0, 2.0, 0.5, 4.0, 0.25, 0.5, 0.33, 4.0, 0.25, 0.5, 0.33, 4.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-15 21:07:50,731 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
2025-03-15 21:09:07,498 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-15 02:16:38', 'last_model_construction_at': '2025-03-15 02:22:00', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.5, 1.0, 0.67, 2.0, 0.0, 0.0, 0.0, 2.0, 0.5, 4.0, 0.25, 0.5, 0.33, 4.0, 0.25, 0.5, 0.33, 4.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-15 21:09:07,499 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
2025-03-15 21:09:16,381 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-15 21:09:16,433 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-15 21:09:16,542 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-15 21:09:16,543 - INFO - Starting data generation...
2025-03-15 21:09:16,543 - INFO - API_KNOWLEDGE: [{'number': 'API_2941', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_2942', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}]
2025-03-15 21:09:16,543 - INFO - APP_KNOWLEDGE: {'func_description': 'This is an updated test application', 'normal_seqs': ['Role: admin; API_2941(Call 1); API_2942(Call 2)', 'Role: oridinary_user; API_2942(); API_2941()'], 'malicious_seqs': ['Role: admin; API_2941(); API_2942()', 'Role: ordinary_user; API_2942(); API_2941()'], 'roles': ['admin', 'ordinary_user', 'unlogged_in_user']}
2025-03-15 21:09:16,739 - INFO - Generating simulated API sequences...
2025-03-15 21:09:16,739 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-15 21:09:18,530 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:09:18,535 - INFO - ========== Method gen_api_seq() returned: seq=['API_2941'], malicious_sign_seq=[0] ==========
2025-03-15 21:09:18,535 - INFO - User configured API_ROLE:{}
2025-03-15 21:09:18,535 - INFO - API sequence 1/12 generated
2025-03-15 21:09:18,535 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-15 21:09:20,178 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:09:20,179 - INFO - ========== Method gen_api_seq() returned: seq=['API_2942'], malicious_sign_seq=[0] ==========
2025-03-15 21:09:20,180 - INFO - User configured API_ROLE:{}
2025-03-15 21:09:20,180 - INFO - API sequence 2/12 generated
2025-03-15 21:09:20,180 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-15 21:09:22,422 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:09:22,423 - INFO - ========== Method gen_api_seq() returned: seq=['API_2942', 'API_2941'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:09:22,423 - INFO - User configured API_ROLE:{}
2025-03-15 21:10:40,030 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-15 02:16:38', 'last_model_construction_at': '2025-03-15 02:22:00', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.5, 1.0, 0.67, 2.0, 0.0, 0.0, 0.0, 2.0, 0.5, 4.0, 0.25, 0.5, 0.33, 4.0, 0.25, 0.5, 0.33, 4.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-15 21:10:40,031 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
2025-03-15 21:10:40,149 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-15 21:10:40,271 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-15 21:10:40,451 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-15 21:10:40,451 - INFO - Starting data generation...
2025-03-15 21:10:40,452 - INFO - API_KNOWLEDGE: [{'number': 'API_2943', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_2944', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}]
2025-03-15 21:10:40,452 - INFO - APP_KNOWLEDGE: {'func_description': 'This is an updated test application', 'normal_seqs': ['Role: admin; API_2943(Call 1); API_2944(Call 2)', 'Role: oridinary_user; API_2944(); API_2943()'], 'malicious_seqs': ['Role: admin; API_2943(); API_2944()', 'Role: ordinary_user; API_2944(); API_2943()'], 'roles': ['admin', 'ordinary_user', 'unlogged_in_user']}
2025-03-15 21:10:40,706 - INFO - Generating simulated API sequences...
2025-03-15 21:10:40,706 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-15 21:10:42,016 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:10:42,022 - INFO - ========== Method gen_api_seq() returned: seq=['API_2944', 'API_2943'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:10:42,023 - INFO - User configured API_ROLE:{'unlogged_in_user': []}
2025-03-15 21:12:24,541 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-15 02:16:38', 'last_model_construction_at': '2025-03-15 02:22:00', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.5, 1.0, 0.67, 2.0, 0.0, 0.0, 0.0, 2.0, 0.5, 4.0, 0.25, 0.5, 0.33, 4.0, 0.25, 0.5, 0.33, 4.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-15 21:12:24,542 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
2025-03-15 21:12:24,654 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-15 21:12:24,776 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-15 21:12:24,953 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-15 21:12:24,954 - INFO - Starting data generation...
2025-03-15 21:12:24,954 - INFO - API_KNOWLEDGE: [{'number': 'API_2945', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_2946', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}]
2025-03-15 21:12:24,954 - INFO - APP_KNOWLEDGE: {'func_description': 'This is an updated test application', 'normal_seqs': ['Role: admin; API_2945(Call 1); API_2946(Call 2)', 'Role: oridinary_user; API_2946(); API_2945()'], 'malicious_seqs': ['Role: admin; API_2945(); API_2946()', 'Role: ordinary_user; API_2946(); API_2945()'], 'roles': ['admin', 'ordinary_user', 'unlogged_in_user']}
2025-03-15 21:12:25,229 - INFO - Generating simulated API sequences...
2025-03-15 21:12:25,229 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-15 21:12:26,395 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:12:26,400 - INFO - ========== Method gen_api_seq() returned: seq=['API_2946', 'API_2945'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:12:26,400 - INFO - User configured API_ROLE:{'unlogged_in_user': [], 'ordinary_user': [], 'admin': []}
2025-03-15 21:12:26,400 - INFO - API sequence 1/12 generated
2025-03-15 21:12:26,400 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-15 21:12:27,538 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:12:27,539 - INFO - ========== Method gen_api_seq() returned: seq=['API_2946'], malicious_sign_seq=[0] ==========
2025-03-15 21:12:27,539 - INFO - User configured API_ROLE:{'unlogged_in_user': [], 'ordinary_user': [], 'admin': []}
2025-03-15 21:12:27,539 - INFO - API sequence 2/12 generated
2025-03-15 21:12:27,539 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-15 21:12:29,740 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:12:29,741 - INFO - ========== Method gen_api_seq() returned: seq=['API_2946', 'API_2945'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:12:29,741 - INFO - User configured API_ROLE:{'unlogged_in_user': [], 'ordinary_user': [], 'admin': []}
2025-03-15 21:12:29,741 - INFO - API sequence 3/12 generated
2025-03-15 21:12:29,741 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-15 21:12:30,645 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:12:30,646 - INFO - ========== Method gen_api_seq() returned: seq=['API_2945'], malicious_sign_seq=[0] ==========
2025-03-15 21:12:30,646 - INFO - User configured API_ROLE:{'unlogged_in_user': [], 'ordinary_user': [], 'admin': []}
2025-03-15 21:12:30,646 - INFO - API sequence 4/12 generated
2025-03-15 21:12:30,646 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-15 21:12:31,792 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:12:31,793 - INFO - ========== Method gen_api_seq() returned: seq=['API_2946', 'API_2945'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:12:31,793 - INFO - User configured API_ROLE:{'unlogged_in_user': [], 'ordinary_user': [], 'admin': []}
2025-03-15 21:12:31,793 - INFO - API sequence 5/12 generated
2025-03-15 21:12:31,793 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-15 21:12:33,512 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:12:33,513 - INFO - ========== Method gen_api_seq() returned: seq=['API_2946'], malicious_sign_seq=[0] ==========
2025-03-15 21:12:33,513 - INFO - User configured API_ROLE:{'unlogged_in_user': [], 'ordinary_user': [], 'admin': []}
2025-03-15 21:12:33,513 - INFO - API sequence 6/12 generated
2025-03-15 21:12:33,513 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-15 21:12:34,372 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:12:34,373 - INFO - ========== Method gen_api_seq() returned: seq=['API_2946'], malicious_sign_seq=[0] ==========
2025-03-15 21:12:34,373 - INFO - User configured API_ROLE:{'unlogged_in_user': [], 'ordinary_user': [], 'admin': []}
2025-03-15 21:12:34,373 - INFO - API sequence 7/12 generated
2025-03-15 21:12:34,373 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-15 21:12:36,450 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:12:36,451 - INFO - ========== Method gen_api_seq() returned: seq=['API_2946', 'API_2945'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:12:36,451 - INFO - User configured API_ROLE:{'unlogged_in_user': [], 'ordinary_user': [], 'admin': []}
2025-03-15 21:12:36,451 - INFO - API sequence 8/12 generated
2025-03-15 21:12:36,451 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-15 21:12:37,689 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:12:37,690 - INFO - ========== Method gen_api_seq() returned: seq=['API_2946', 'API_2945'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:12:37,690 - INFO - User configured API_ROLE:{'unlogged_in_user': [], 'ordinary_user': [], 'admin': []}
2025-03-15 21:12:37,690 - INFO - API sequence 9/12 generated
2025-03-15 21:12:37,690 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-15 21:12:39,852 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:12:39,853 - INFO - ========== Method gen_api_seq() returned: seq=['API_2946', 'API_2945'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:12:39,853 - INFO - User configured API_ROLE:{'unlogged_in_user': [], 'ordinary_user': [], 'admin': []}
2025-03-15 21:12:39,853 - INFO - API sequence 10/12 generated
2025-03-15 21:12:39,853 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-15 21:12:41,504 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:12:41,505 - INFO - ========== Method gen_api_seq() returned: seq=['API_2946'], malicious_sign_seq=[0] ==========
2025-03-15 21:12:41,505 - INFO - User configured API_ROLE:{'unlogged_in_user': [], 'ordinary_user': [], 'admin': []}
2025-03-15 21:12:41,506 - INFO - API sequence 11/12 generated
2025-03-15 21:12:41,506 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-15 21:12:43,231 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:12:43,232 - INFO - ========== Method gen_api_seq() returned: seq=['API_2945'], malicious_sign_seq=[0] ==========
2025-03-15 21:12:43,232 - INFO - User configured API_ROLE:{'unlogged_in_user': [], 'ordinary_user': [], 'admin': []}
2025-03-15 21:12:43,232 - INFO - API sequence 12/12 generated
2025-03-15 21:12:43,233 - INFO - API sequences serialized to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py/serialized_llm_agents.json
2025-03-15 21:12:43,233 - INFO - Generating simulated traffic data set...
2025-03-15 21:12:43,233 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:12:43,233 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:12:43,233 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:12:43,233 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-15 21:12:43,234 - INFO - error_apis: []
2025-03-15 21:12:43,234 - INFO - Simulated traffic data for 1/12 user collected：user: unloggeduser malicious: True
2025-03-15 21:12:43,234 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:12:43,234 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:12:43,234 - INFO - error_apis: []
2025-03-15 21:12:43,234 - INFO - Simulated traffic data for 2/12 user collected：user: normaluser malicious: False
2025-03-15 21:12:43,234 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:12:43,234 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:12:43,234 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:12:43,234 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-15 21:12:43,234 - INFO - error_apis: []
2025-03-15 21:12:43,234 - INFO - Simulated traffic data for 3/12 user collected：user: unloggeduser malicious: True
2025-03-15 21:12:43,235 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:12:43,235 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:12:43,235 - INFO - error_apis: []
2025-03-15 21:12:43,235 - INFO - Simulated traffic data for 4/12 user collected：user: adminuser malicious: False
2025-03-15 21:12:43,235 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:12:43,235 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:12:43,235 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:12:43,235 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-15 21:12:43,235 - INFO - error_apis: []
2025-03-15 21:12:43,235 - INFO - Simulated traffic data for 5/12 user collected：user: normaluser malicious: True
2025-03-15 21:12:43,235 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:12:43,236 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:12:43,236 - INFO - error_apis: []
2025-03-15 21:12:43,236 - INFO - Simulated traffic data for 6/12 user collected：user: normaluser malicious: False
2025-03-15 21:12:43,236 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:12:43,236 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:12:43,236 - INFO - error_apis: []
2025-03-15 21:12:43,236 - INFO - Simulated traffic data for 7/12 user collected：user: normaluser malicious: False
2025-03-15 21:12:43,236 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:12:43,236 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:12:43,236 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:12:43,236 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-15 21:12:43,236 - INFO - error_apis: []
2025-03-15 21:12:43,236 - INFO - Simulated traffic data for 8/12 user collected：user: unloggeduser malicious: True
2025-03-15 21:12:43,237 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:12:43,237 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:12:43,237 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:12:43,237 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-15 21:12:43,237 - INFO - error_apis: []
2025-03-15 21:12:43,237 - INFO - Simulated traffic data for 9/12 user collected：user: normaluser malicious: True
2025-03-15 21:12:43,237 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:12:43,237 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:12:43,237 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:12:43,237 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-15 21:12:43,237 - INFO - error_apis: []
2025-03-15 21:12:43,237 - INFO - Simulated traffic data for 10/12 user collected：user: normaluser malicious: True
2025-03-15 21:12:43,238 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:12:43,238 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:12:43,238 - INFO - error_apis: []
2025-03-15 21:12:43,238 - INFO - Simulated traffic data for 11/12 user collected：user: normaluser malicious: False
2025-03-15 21:12:43,238 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:12:43,238 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:12:43,238 - INFO - error_apis: []
2025-03-15 21:12:43,238 - INFO - Simulated traffic data for 12/12 user collected：user: adminuser malicious: False
2025-03-15 21:12:43,241 - INFO - All simulated traffic data collected：/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/simulated_traffic_data.csv
2025-03-15 21:12:43,241 - INFO - error_apis: []
2025-03-15 21:16:31,958 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-15 02:16:38', 'last_model_construction_at': '2025-03-15 02:22:00', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.5, 1.0, 0.67, 2.0, 0.0, 0.0, 0.0, 2.0, 0.5, 4.0, 0.25, 0.5, 0.33, 4.0, 0.25, 0.5, 0.33, 4.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-15 21:16:31,958 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
2025-03-15 21:16:33,006 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-15 21:16:33,085 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-15 21:16:33,303 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-15 21:16:33,303 - INFO - Starting data generation...
2025-03-15 21:16:33,303 - INFO - API_KNOWLEDGE: [{'number': 'API_2947', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_2948', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}]
2025-03-15 21:16:33,304 - INFO - APP_KNOWLEDGE: {'func_description': 'This is an updated test application', 'normal_seqs': ['Role: admin; API_2947(Call 1); API_2948(Call 2)', 'Role: oridinary_user; API_2948(); API_2947()'], 'malicious_seqs': ['Role: admin; API_2947(); API_2948()', 'Role: ordinary_user; API_2948(); API_2947()'], 'roles': ['admin', 'ordinary_user', 'unlogged_in_user']}
2025-03-15 21:16:33,625 - INFO - Generating simulated API sequences...
2025-03-15 21:16:33,625 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-15 21:16:35,265 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:16:35,270 - INFO - ========== Method gen_api_seq() returned: seq=['API_2948'], malicious_sign_seq=[0] ==========
2025-03-15 21:16:35,270 - INFO - User configured API_ROLE:{'unlogged_in_user': [], 'ordinary_user': [], 'admin': []}
2025-03-15 21:16:35,270 - INFO - API sequence 1/12 generated
2025-03-15 21:16:35,270 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-15 21:16:36,337 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:16:36,340 - INFO - ========== Method gen_api_seq() returned: seq=['API_2948', 'API_2947'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:16:36,340 - INFO - User configured API_ROLE:{'unlogged_in_user': [], 'ordinary_user': [], 'admin': []}
2025-03-15 21:16:36,340 - INFO - API sequence 2/12 generated
2025-03-15 21:16:36,340 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-15 21:16:38,559 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:16:38,560 - INFO - ========== Method gen_api_seq() returned: seq=['API_2948', 'API_2947'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:16:38,560 - INFO - User configured API_ROLE:{'unlogged_in_user': [], 'ordinary_user': [], 'admin': []}
2025-03-15 21:16:38,560 - INFO - API sequence 3/12 generated
2025-03-15 21:16:38,560 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-15 21:16:39,597 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:16:39,598 - INFO - ========== Method gen_api_seq() returned: seq=['API_2948', 'API_2947'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:16:39,598 - INFO - User configured API_ROLE:{'unlogged_in_user': [], 'ordinary_user': [], 'admin': []}
2025-03-15 21:16:39,598 - INFO - API sequence 4/12 generated
2025-03-15 21:16:39,598 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-15 21:16:40,681 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:16:40,682 - INFO - ========== Method gen_api_seq() returned: seq=['API_2948'], malicious_sign_seq=[0] ==========
2025-03-15 21:16:40,682 - INFO - User configured API_ROLE:{'unlogged_in_user': [], 'ordinary_user': [], 'admin': []}
2025-03-15 21:16:40,682 - INFO - API sequence 5/12 generated
2025-03-15 21:16:40,682 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-15 21:16:42,307 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:16:42,308 - INFO - ========== Method gen_api_seq() returned: seq=['API_2948'], malicious_sign_seq=[0] ==========
2025-03-15 21:16:42,308 - INFO - User configured API_ROLE:{'unlogged_in_user': [], 'ordinary_user': [], 'admin': []}
2025-03-15 21:16:42,308 - INFO - API sequence 6/12 generated
2025-03-15 21:16:42,308 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-15 21:16:43,365 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:16:43,366 - INFO - ========== Method gen_api_seq() returned: seq=['API_2947'], malicious_sign_seq=[0] ==========
2025-03-15 21:16:43,366 - INFO - User configured API_ROLE:{'unlogged_in_user': [], 'ordinary_user': [], 'admin': []}
2025-03-15 21:16:43,366 - INFO - API sequence 7/12 generated
2025-03-15 21:16:43,367 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-15 21:16:44,861 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:16:44,862 - INFO - ========== Method gen_api_seq() returned: seq=['API_2948', 'API_2947'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:16:44,862 - INFO - User configured API_ROLE:{'unlogged_in_user': [], 'ordinary_user': [], 'admin': []}
2025-03-15 21:16:44,862 - INFO - API sequence 8/12 generated
2025-03-15 21:16:44,862 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-15 21:16:47,253 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:16:47,254 - INFO - ========== Method gen_api_seq() returned: seq=['API_2948', 'API_2947'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:16:47,254 - INFO - User configured API_ROLE:{'unlogged_in_user': [], 'ordinary_user': [], 'admin': []}
2025-03-15 21:16:47,254 - INFO - API sequence 9/12 generated
2025-03-15 21:16:47,254 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-15 21:16:48,485 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:16:48,486 - INFO - ========== Method gen_api_seq() returned: seq=['API_2948', 'API_2947'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:16:48,486 - INFO - User configured API_ROLE:{'unlogged_in_user': [], 'ordinary_user': [], 'admin': []}
2025-03-15 21:16:48,486 - INFO - API sequence 10/12 generated
2025-03-15 21:16:48,486 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-15 21:16:50,137 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:16:50,139 - INFO - ========== Method gen_api_seq() returned: seq=['API_2947'], malicious_sign_seq=[0] ==========
2025-03-15 21:16:50,139 - INFO - User configured API_ROLE:{'unlogged_in_user': [], 'ordinary_user': [], 'admin': []}
2025-03-15 21:16:50,139 - INFO - API sequence 11/12 generated
2025-03-15 21:16:50,139 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-15 21:16:51,285 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:16:51,286 - INFO - ========== Method gen_api_seq() returned: seq=['API_2948'], malicious_sign_seq=[0] ==========
2025-03-15 21:16:51,286 - INFO - User configured API_ROLE:{'unlogged_in_user': [], 'ordinary_user': [], 'admin': []}
2025-03-15 21:16:51,286 - INFO - API sequence 12/12 generated
2025-03-15 21:16:51,286 - INFO - API sequences serialized to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py/serialized_llm_agents.json
2025-03-15 21:16:51,287 - INFO - Generating simulated traffic data set...
2025-03-15 21:16:51,287 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:16:51,287 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:16:51,287 - INFO - error_apis: []
2025-03-15 21:16:51,287 - INFO - Simulated traffic data for 1/12 user collected：user: normaluser malicious: False
2025-03-15 21:16:51,287 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:16:51,287 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:16:51,288 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:16:51,288 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-15 21:16:51,288 - INFO - error_apis: []
2025-03-15 21:16:51,288 - INFO - Simulated traffic data for 2/12 user collected：user: normaluser malicious: True
2025-03-15 21:16:51,288 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:16:51,288 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:16:51,288 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:16:51,288 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-15 21:16:51,288 - INFO - error_apis: []
2025-03-15 21:16:51,288 - INFO - Simulated traffic data for 3/12 user collected：user: normaluser malicious: True
2025-03-15 21:16:51,288 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:16:51,288 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:16:51,289 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:16:51,289 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-15 21:16:51,289 - INFO - error_apis: []
2025-03-15 21:16:51,289 - INFO - Simulated traffic data for 4/12 user collected：user: normaluser malicious: True
2025-03-15 21:16:51,289 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:16:51,289 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:16:51,289 - INFO - error_apis: []
2025-03-15 21:16:51,289 - INFO - Simulated traffic data for 5/12 user collected：user: normaluser malicious: False
2025-03-15 21:16:51,289 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:16:51,289 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:16:51,289 - INFO - error_apis: []
2025-03-15 21:16:51,289 - INFO - Simulated traffic data for 6/12 user collected：user: normaluser malicious: False
2025-03-15 21:16:51,289 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:16:51,289 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:16:51,290 - INFO - error_apis: []
2025-03-15 21:16:51,290 - INFO - Simulated traffic data for 7/12 user collected：user: adminuser malicious: False
2025-03-15 21:16:51,290 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:16:51,290 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:16:51,290 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:16:51,290 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-15 21:16:51,290 - INFO - error_apis: []
2025-03-15 21:16:51,290 - INFO - Simulated traffic data for 8/12 user collected：user: unloggeduser malicious: True
2025-03-15 21:16:51,290 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:16:51,290 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:16:51,291 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:16:51,291 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-15 21:16:51,291 - INFO - error_apis: []
2025-03-15 21:16:51,291 - INFO - Simulated traffic data for 9/12 user collected：user: unloggeduser malicious: True
2025-03-15 21:16:51,291 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:16:51,291 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:16:51,291 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:16:51,291 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-15 21:16:51,291 - INFO - error_apis: []
2025-03-15 21:16:51,291 - INFO - Simulated traffic data for 10/12 user collected：user: unloggeduser malicious: True
2025-03-15 21:16:51,291 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:16:51,291 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:16:51,291 - INFO - error_apis: []
2025-03-15 21:16:51,291 - INFO - Simulated traffic data for 11/12 user collected：user: adminuser malicious: False
2025-03-15 21:16:51,292 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:16:51,292 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:16:51,292 - INFO - error_apis: []
2025-03-15 21:16:51,292 - INFO - Simulated traffic data for 12/12 user collected：user: normaluser malicious: False
2025-03-15 21:16:51,294 - INFO - All simulated traffic data collected：/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/simulated_traffic_data.csv
2025-03-15 21:16:51,295 - INFO - error_apis: []
2025-03-15 21:19:00,276 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-15 21:19:00,323 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-15 21:19:00,437 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-15 21:19:00,437 - INFO - Starting data generation...
2025-03-15 21:19:00,437 - INFO - API_KNOWLEDGE: [{'number': 'API_2949', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_2950', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}]
2025-03-15 21:19:00,437 - INFO - APP_KNOWLEDGE: {'func_description': 'This is an updated test application', 'normal_seqs': ['Role: admin; API_2949(Call 1); API_2950(Call 2)', 'Role: oridinary_user; API_2949(); API_2950()'], 'malicious_seqs': ['Role: admin; API_2949(); API_2950()', 'Role: ordinary_user; API_2949(); API_2950()'], 'roles': ['admin', 'ordinary_user', 'unlogged_in_user']}
2025-03-15 21:19:00,489 - INFO - Generating simulated API sequences...
2025-03-15 21:19:00,489 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-15 21:19:02,633 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:19:02,634 - INFO - ========== Method gen_api_seq() returned: seq=['API_2949', 'API_2950'], malicious_sign_seq=[0, 0] ==========
2025-03-15 21:19:02,634 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2949', 'API_2950'], 'ordinary_user': [], 'admin': ['API_2949', 'API_2950'], 'oridinary_user': ['API_2949', 'API_2950']}
2025-03-15 21:19:02,634 - INFO - API sequence 1/12 generated
2025-03-15 21:19:02,635 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-15 21:19:03,818 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:19:03,819 - INFO - ========== Method gen_api_seq() returned: seq=['API_2949', 'API_2950'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:19:03,819 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2949', 'API_2950'], 'ordinary_user': [], 'admin': ['API_2949', 'API_2950'], 'oridinary_user': ['API_2949', 'API_2950']}
2025-03-15 21:19:03,819 - INFO - API sequence 2/12 generated
2025-03-15 21:19:03,819 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-15 21:19:05,843 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:19:05,844 - INFO - ========== Method gen_api_seq() returned: seq=['API_2949', 'API_2950'], malicious_sign_seq=[0, 0] ==========
2025-03-15 21:19:05,844 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2949', 'API_2950'], 'ordinary_user': [], 'admin': ['API_2949', 'API_2950'], 'oridinary_user': ['API_2949', 'API_2950']}
2025-03-15 21:19:05,845 - INFO - API sequence 3/12 generated
2025-03-15 21:19:05,845 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-15 21:19:07,961 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:19:07,962 - INFO - ========== Method gen_api_seq() returned: seq=['API_2949', 'API_2950'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:19:07,962 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2949', 'API_2950'], 'ordinary_user': [], 'admin': ['API_2949', 'API_2950'], 'oridinary_user': ['API_2949', 'API_2950']}
2025-03-15 21:19:07,962 - INFO - API sequence 4/12 generated
2025-03-15 21:19:07,962 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-15 21:19:10,074 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:19:10,075 - INFO - ========== Method gen_api_seq() returned: seq=['API_2949', 'API_2950'], malicious_sign_seq=[0, 0] ==========
2025-03-15 21:19:10,076 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2949', 'API_2950'], 'ordinary_user': [], 'admin': ['API_2949', 'API_2950'], 'oridinary_user': ['API_2949', 'API_2950']}
2025-03-15 21:19:10,076 - INFO - API sequence 5/12 generated
2025-03-15 21:19:10,076 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-15 21:19:12,239 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:19:12,240 - INFO - ========== Method gen_api_seq() returned: seq=['API_2949', 'API_2950'], malicious_sign_seq=[0, 0] ==========
2025-03-15 21:19:12,240 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2949', 'API_2950'], 'ordinary_user': [], 'admin': ['API_2949', 'API_2950'], 'oridinary_user': ['API_2949', 'API_2950']}
2025-03-15 21:19:12,240 - INFO - API sequence 6/12 generated
2025-03-15 21:19:12,240 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-15 21:19:13,535 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:19:13,537 - INFO - ========== Method gen_api_seq() returned: seq=['API_2949', 'API_2950'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:19:13,537 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2949', 'API_2950'], 'ordinary_user': [], 'admin': ['API_2949', 'API_2950'], 'oridinary_user': ['API_2949', 'API_2950']}
2025-03-15 21:19:13,537 - INFO - API sequence 7/12 generated
2025-03-15 21:19:13,537 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-15 21:19:15,799 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:19:15,800 - INFO - ========== Method gen_api_seq() returned: seq=['API_2949', 'API_2950'], malicious_sign_seq=[0, 0] ==========
2025-03-15 21:19:15,800 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2949', 'API_2950'], 'ordinary_user': [], 'admin': ['API_2949', 'API_2950'], 'oridinary_user': ['API_2949', 'API_2950']}
2025-03-15 21:19:15,800 - INFO - API sequence 8/12 generated
2025-03-15 21:19:15,800 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-15 21:19:17,164 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:19:17,165 - INFO - ========== Method gen_api_seq() returned: seq=['API_2949', 'API_2950'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:19:17,165 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2949', 'API_2950'], 'ordinary_user': [], 'admin': ['API_2949', 'API_2950'], 'oridinary_user': ['API_2949', 'API_2950']}
2025-03-15 21:19:17,165 - INFO - API sequence 9/12 generated
2025-03-15 21:19:17,165 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-15 21:19:18,265 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:19:18,266 - INFO - ========== Method gen_api_seq() returned: seq=['API_2949', 'API_2950'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:19:18,266 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2949', 'API_2950'], 'ordinary_user': [], 'admin': ['API_2949', 'API_2950'], 'oridinary_user': ['API_2949', 'API_2950']}
2025-03-15 21:19:18,266 - INFO - API sequence 10/12 generated
2025-03-15 21:19:18,266 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-15 21:19:20,456 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:19:20,457 - INFO - ========== Method gen_api_seq() returned: seq=['API_2949', 'API_2950'], malicious_sign_seq=[0, 0] ==========
2025-03-15 21:19:20,457 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2949', 'API_2950'], 'ordinary_user': [], 'admin': ['API_2949', 'API_2950'], 'oridinary_user': ['API_2949', 'API_2950']}
2025-03-15 21:19:20,457 - INFO - API sequence 11/12 generated
2025-03-15 21:19:20,457 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-15 21:19:21,803 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:19:21,804 - INFO - ========== Method gen_api_seq() returned: seq=['API_2949', 'API_2950'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:19:21,804 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2949', 'API_2950'], 'ordinary_user': [], 'admin': ['API_2949', 'API_2950'], 'oridinary_user': ['API_2949', 'API_2950']}
2025-03-15 21:19:21,804 - INFO - API sequence 12/12 generated
2025-03-15 21:19:21,804 - INFO - API sequences serialized to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py/serialized_llm_agents.json
2025-03-15 21:19:21,804 - INFO - Generating simulated traffic data set...
2025-03-15 21:19:21,805 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:19:21,805 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:19:21,805 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:19:21,805 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:19:21,805 - INFO - error_apis: []
2025-03-15 21:19:21,805 - INFO - Simulated traffic data for 1/12 user collected：user: normaluser malicious: False
2025-03-15 21:19:21,805 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:19:21,805 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:19:21,805 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:19:21,806 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-15 21:19:21,806 - INFO - error_apis: []
2025-03-15 21:19:21,806 - INFO - Simulated traffic data for 2/12 user collected：user: unloggeduser malicious: True
2025-03-15 21:19:21,806 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:19:21,806 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:19:21,806 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:19:21,806 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:19:21,806 - INFO - error_apis: []
2025-03-15 21:19:21,806 - INFO - Simulated traffic data for 3/12 user collected：user: normaluser malicious: False
2025-03-15 21:19:21,806 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:19:21,806 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:19:21,806 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:19:21,807 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-15 21:19:21,807 - INFO - error_apis: []
2025-03-15 21:19:21,807 - INFO - Simulated traffic data for 4/12 user collected：user: unloggeduser malicious: True
2025-03-15 21:19:21,807 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:19:21,807 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:19:21,807 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:19:21,807 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:19:21,807 - INFO - error_apis: []
2025-03-15 21:19:21,807 - INFO - Simulated traffic data for 5/12 user collected：user: normaluser malicious: False
2025-03-15 21:19:21,807 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:19:21,807 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:19:21,807 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:19:21,807 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:19:21,808 - INFO - error_apis: []
2025-03-15 21:19:21,808 - INFO - Simulated traffic data for 6/12 user collected：user: adminuser malicious: False
2025-03-15 21:19:21,808 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:19:21,808 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:19:21,808 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:19:21,808 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-15 21:19:21,808 - INFO - error_apis: []
2025-03-15 21:19:21,808 - INFO - Simulated traffic data for 7/12 user collected：user: unloggeduser malicious: True
2025-03-15 21:19:21,808 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:19:21,808 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:19:21,808 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:19:21,808 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:19:21,808 - INFO - error_apis: []
2025-03-15 21:19:21,809 - INFO - Simulated traffic data for 8/12 user collected：user: normaluser malicious: False
2025-03-15 21:19:21,809 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:19:21,809 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:19:21,809 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:19:21,809 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-15 21:19:21,809 - INFO - error_apis: []
2025-03-15 21:19:21,809 - INFO - Simulated traffic data for 9/12 user collected：user: normaluser malicious: True
2025-03-15 21:19:21,809 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:19:21,809 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:19:21,809 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:19:21,809 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-15 21:19:21,809 - INFO - error_apis: []
2025-03-15 21:19:21,810 - INFO - Simulated traffic data for 10/12 user collected：user: normaluser malicious: True
2025-03-15 21:19:21,810 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:19:21,810 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:19:21,810 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:19:21,810 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:19:21,810 - INFO - error_apis: []
2025-03-15 21:19:21,810 - INFO - Simulated traffic data for 11/12 user collected：user: adminuser malicious: False
2025-03-15 21:19:21,810 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:19:21,810 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:19:21,810 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:19:21,810 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-15 21:19:21,810 - INFO - error_apis: []
2025-03-15 21:19:21,811 - INFO - Simulated traffic data for 12/12 user collected：user: normaluser malicious: True
2025-03-15 21:19:21,813 - INFO - All simulated traffic data collected：/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/simulated_traffic_data.csv
2025-03-15 21:19:21,813 - INFO - error_apis: []
2025-03-15 21:20:46,012 - INFO - Trying to construct model...
2025-03-15 21:20:46,013 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-15 21:20:46,070 - INFO - Training model... Size of feature_list: 7
2025-03-15 21:20:46,086 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 21:20:46,092 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 21:20:46,094 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 21:20:46,095 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 21:20:46,097 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 21:20:46,098 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 21:20:46,100 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 21:20:46,101 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 21:20:46,195 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 21:20:46,196 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 21:20:46,198 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 21:20:46,199 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 21:20:46,216 - INFO - Model constructed.
