None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-03-06 20:25:29,318 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 30, Feature size: 7
 * Serving Flask app 'app'
 * Debug mode: on
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-03-06 20:25:31,118 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 30, Feature size: 7
2025-03-06 20:25:33,962 - INFO - Trying to construct model...
2025-03-06 20:25:33,963 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-06 20:25:34,012 - INFO - Training model... Size of feature_list: 7
2025-03-06 20:25:34,025 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:34,028 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:34,029 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:34,030 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:34,032 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:34,033 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:34,034 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:34,035 - INFO - Extracting features... Size of feature_list: 7
[20:25:34] WARNING: /workspace/src/learner.cc:740: 
Parameters: { "use_label_encoder" } are not used.

2025-03-06 20:25:34,123 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:34,125 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:34,126 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:34,127 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:34,140 - INFO - Model constructed.
2025-03-06 20:25:37,679 - INFO - Trying to construct model...
2025-03-06 20:25:37,679 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-06 20:25:37,707 - INFO - Training model... Size of feature_list: 7
2025-03-06 20:25:37,715 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:37,716 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:37,717 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:37,718 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:37,720 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:37,721 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:37,722 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:37,723 - INFO - Extracting features... Size of feature_list: 7
[20:25:37] WARNING: /workspace/src/learner.cc:740: 
Parameters: { "use_label_encoder" } are not used.

2025-03-06 20:25:37,750 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:37,751 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:37,753 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:37,754 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:37,765 - INFO - Model constructed.
2025-03-06 20:25:47,719 - INFO - Trying to construct model...
2025-03-06 20:25:47,719 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-06 20:25:47,749 - INFO - Training model... Size of feature_list: 7
2025-03-06 20:25:47,756 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:47,758 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:47,759 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:47,760 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:47,762 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:47,763 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:47,764 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:47,765 - INFO - Extracting features... Size of feature_list: 7
[20:25:47] WARNING: /workspace/src/learner.cc:740: 
Parameters: { "use_label_encoder" } are not used.

2025-03-06 20:25:47,826 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:47,828 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:47,829 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:47,831 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:25:47,856 - INFO - Model constructed.
2025-03-06 20:25:51,217 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-06 20:25:51,277 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-06 20:25:51,308 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-06 20:25:51,308 - INFO - Generating simulated API sequences...
2025-03-06 20:25:51,308 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-06 20:25:51,308 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-06 20:25:52,692 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_8'], malicious_sign_seq=[0, 1] ==========
2025-03-06 20:25:52,692 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_8'], malicious_sign_seq=[0, 1] ==========
2025-03-06 20:25:52,692 - INFO - API sequence 1/12 generated
2025-03-06 20:25:52,692 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-06 20:25:52,692 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-06 20:25:53,813 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-06 20:25:53,813 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-06 20:25:53,813 - INFO - API sequence 2/12 generated
2025-03-06 20:25:53,813 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-06 20:25:53,813 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-06 20:25:54,112 - INFO - Trying to construct model...
2025-03-06 20:25:54,113 - INFO - DATA_COLLECTION_STATUS: IN_PROGRESS
2025-03-06 20:25:55,033 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[1] ==========
2025-03-06 20:25:55,033 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[1] ==========
2025-03-06 20:25:55,033 - INFO - API sequence 3/12 generated
2025-03-06 20:25:55,033 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-06 20:25:55,033 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-06 20:25:56,199 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[1] ==========
2025-03-06 20:25:56,199 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[1] ==========
2025-03-06 20:25:56,199 - INFO - API sequence 4/12 generated
2025-03-06 20:25:56,199 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-06 20:25:56,199 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-06 20:25:57,332 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-06 20:25:57,332 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-06 20:25:57,332 - INFO - API sequence 5/12 generated
2025-03-06 20:25:57,332 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-06 20:25:57,332 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-06 20:25:58,466 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-06 20:25:58,466 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-06 20:25:58,466 - INFO - API sequence 6/12 generated
2025-03-06 20:25:58,466 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-06 20:25:58,466 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-06 20:25:59,866 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_8'], malicious_sign_seq=[0, 1] ==========
2025-03-06 20:25:59,866 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_8'], malicious_sign_seq=[0, 1] ==========
2025-03-06 20:25:59,866 - INFO - API sequence 7/12 generated
2025-03-06 20:25:59,867 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-06 20:25:59,867 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-06 20:26:01,248 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_8'], malicious_sign_seq=[0, 1] ==========
2025-03-06 20:26:01,248 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_8'], malicious_sign_seq=[0, 1] ==========
2025-03-06 20:26:01,249 - INFO - API sequence 8/12 generated
2025-03-06 20:26:01,249 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-06 20:26:01,249 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-06 20:26:02,459 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[1] ==========
2025-03-06 20:26:02,459 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[1] ==========
2025-03-06 20:26:02,459 - INFO - API sequence 9/12 generated
2025-03-06 20:26:02,459 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-06 20:26:02,459 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-06 20:26:03,588 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-06 20:26:03,588 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-06 20:26:03,588 - INFO - API sequence 10/12 generated
2025-03-06 20:26:03,589 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-06 20:26:03,589 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-06 20:26:04,835 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-06 20:26:04,835 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-06 20:26:04,835 - INFO - API sequence 11/12 generated
2025-03-06 20:26:04,835 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-06 20:26:04,835 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-06 20:26:05,960 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-06 20:26:05,960 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-06 20:26:05,960 - INFO - API sequence 12/12 generated
2025-03-06 20:26:05,961 - INFO - API sequences serialized to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py/serialized_llm_agents.json
2025-03-06 20:26:05,961 - INFO - Generating simulated traffic data set...
2025-03-06 20:26:05,961 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-06 20:26:05,961 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-06 20:26:05,961 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-06 20:26:05,961 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-06 20:26:05,961 - INFO - Simulated traffic data for 1/12 user collected：user: normaluser malicious: True
2025-03-06 20:26:05,961 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-06 20:26:05,961 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-06 20:26:05,962 - INFO - Simulated traffic data for 2/12 user collected：user: adminuser malicious: False
2025-03-06 20:26:05,962 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-06 20:26:05,962 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-06 20:26:05,962 - INFO - Simulated traffic data for 3/12 user collected：user: unloggeduser malicious: True
2025-03-06 20:26:05,962 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-06 20:26:05,962 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-06 20:26:05,962 - INFO - Simulated traffic data for 4/12 user collected：user: unloggeduser malicious: True
2025-03-06 20:26:05,962 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-06 20:26:05,962 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-06 20:26:05,962 - INFO - Simulated traffic data for 5/12 user collected：user: normaluser malicious: False
2025-03-06 20:26:05,962 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-06 20:26:05,962 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-06 20:26:05,963 - INFO - Simulated traffic data for 6/12 user collected：user: normaluser malicious: False
2025-03-06 20:26:05,963 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-06 20:26:05,963 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-06 20:26:05,963 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-06 20:26:05,963 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-06 20:26:05,963 - INFO - Simulated traffic data for 7/12 user collected：user: normaluser malicious: True
2025-03-06 20:26:05,963 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-06 20:26:05,963 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-06 20:26:05,963 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-06 20:26:05,963 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-06 20:26:05,963 - INFO - Simulated traffic data for 8/12 user collected：user: normaluser malicious: True
2025-03-06 20:26:05,964 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-06 20:26:05,964 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-06 20:26:05,964 - INFO - Simulated traffic data for 9/12 user collected：user: unloggeduser malicious: True
2025-03-06 20:26:05,964 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-06 20:26:05,964 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-06 20:26:05,964 - INFO - Simulated traffic data for 10/12 user collected：user: normaluser malicious: False
2025-03-06 20:26:05,964 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-06 20:26:05,964 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-06 20:26:05,964 - INFO - Simulated traffic data for 11/12 user collected：user: adminuser malicious: False
2025-03-06 20:26:05,964 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-06 20:26:05,964 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-06 20:26:05,964 - INFO - Simulated traffic data for 12/12 user collected：user: normaluser malicious: False
2025-03-06 20:26:05,967 - INFO - All simulated traffic data collected：/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/simulated_traffic_data.csv
2025-03-06 20:28:34,180 - INFO - Trying to construct model...
2025-03-06 20:28:34,180 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-06 20:28:34,208 - INFO - Training model... Size of feature_list: 7
2025-03-06 20:28:34,216 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:28:34,218 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:28:34,218 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:28:34,220 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:28:34,221 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:28:34,222 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:28:34,223 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:28:34,224 - INFO - Extracting features... Size of feature_list: 7
[20:28:34] WARNING: /workspace/src/learner.cc:740: 
Parameters: { "use_label_encoder" } are not used.

2025-03-06 20:28:34,325 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:28:34,326 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:28:34,327 - INFO - Extracting features... Size of feature_list: 7
2025-03-06 20:28:34,328 - INFO - Extracting features... Size of feature_list: 7
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
2025-03-06 20:28:34,342 - INFO - Model constructed.
2025-03-08 16:50:21,253 - INFO - Trying to construct model...
2025-03-08 16:50:21,253 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-08 16:50:21,282 - INFO - Training model... Size of feature_list: 6
2025-03-08 16:50:21,290 - INFO - Extracting features... Size of feature_list: 6
2025-03-08 16:50:21,291 - INFO - Extracting features... Size of feature_list: 6
2025-03-08 16:50:21,292 - INFO - Extracting features... Size of feature_list: 6
2025-03-08 16:50:21,293 - INFO - Extracting features... Size of feature_list: 6
2025-03-08 16:50:21,294 - INFO - Extracting features... Size of feature_list: 6
2025-03-08 16:50:21,295 - INFO - Extracting features... Size of feature_list: 6
2025-03-08 16:50:21,296 - INFO - Extracting features... Size of feature_list: 6
2025-03-08 16:50:21,297 - INFO - Extracting features... Size of feature_list: 6
[16:50:21] WARNING: /workspace/src/learner.cc:740: 
Parameters: { "use_label_encoder" } are not used.

2025-03-08 16:50:21,332 - INFO - Extracting features... Size of feature_list: 6
2025-03-08 16:50:21,334 - INFO - Extracting features... Size of feature_list: 6
2025-03-08 16:50:21,335 - INFO - Extracting features... Size of feature_list: 6
2025-03-08 16:50:21,336 - INFO - Extracting features... Size of feature_list: 6
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
2025-03-08 16:50:21,347 - INFO - Model constructed.
2025-03-09 12:13:47,157 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-09 12:13:47,222 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-09 12:13:47,222 - INFO - Extracting API list with API discovery algorithm...
2025-03-09 12:13:47,286 - INFO - Starting Drain3 template miner
2025-03-09 12:13:47,289 - INFO - Starting Drain3 template miner
2025-03-09 12:13:47,290 - INFO - Starting Drain3 template miner
2025-03-09 12:13:47,291 - INFO - Starting Drain3 template miner
2025-03-09 12:13:47,292 - INFO - Starting Drain3 template miner
2025-03-09 12:13:48,680 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-09 12:59:20,569 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-09 12:59:20,618 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-09 12:59:20,618 - INFO - Extracting API list with API discovery algorithm...
2025-03-09 12:59:20,679 - INFO - Starting Drain3 template miner
2025-03-09 12:59:20,682 - INFO - Starting Drain3 template miner
2025-03-09 12:59:20,684 - INFO - Starting Drain3 template miner
2025-03-09 12:59:20,684 - INFO - Starting Drain3 template miner
2025-03-09 12:59:20,685 - INFO - Starting Drain3 template miner
2025-03-09 12:59:22,154 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-09 12:59:22,738 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-09 12:59:22,781 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-09 12:59:22,781 - INFO - Extracting API list with API discovery algorithm...
2025-03-09 12:59:22,842 - INFO - Starting Drain3 template miner
2025-03-09 12:59:22,845 - INFO - Starting Drain3 template miner
2025-03-09 12:59:22,847 - INFO - Starting Drain3 template miner
2025-03-09 12:59:22,847 - INFO - Starting Drain3 template miner
2025-03-09 12:59:22,848 - INFO - Starting Drain3 template miner
2025-03-09 12:59:24,331 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-09 14:04:56,858 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-09 14:04:56,912 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-09 14:04:56,961 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-09 14:04:56,962 - INFO - Generating simulated API sequences...
2025-03-09 14:04:56,962 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-09 14:04:56,962 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-09 14:04:56,962 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-09 14:04:58,384 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_8'], malicious_sign_seq=[0, 1] ==========
2025-03-09 14:04:58,384 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_8'], malicious_sign_seq=[0, 1] ==========
2025-03-09 14:04:58,384 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_8'], malicious_sign_seq=[0, 1] ==========
2025-03-09 14:04:58,385 - INFO - API sequence 1/12 generated
2025-03-09 14:04:58,385 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-09 14:04:58,385 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-09 14:04:58,385 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-09 14:04:59,695 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-09 14:04:59,695 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-09 14:04:59,695 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-09 14:04:59,695 - INFO - API sequence 2/12 generated
2025-03-09 14:04:59,695 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-09 14:04:59,695 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-09 14:04:59,695 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-09 14:05:00,907 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-09 14:05:00,907 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-09 14:05:00,907 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-09 14:05:00,907 - INFO - API sequence 3/12 generated
2025-03-09 14:05:00,907 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-09 14:05:00,907 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-09 14:05:00,907 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-09 14:05:02,174 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[1] ==========
2025-03-09 14:05:02,174 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[1] ==========
2025-03-09 14:05:02,174 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[1] ==========
2025-03-09 14:05:02,174 - INFO - API sequence 4/12 generated
2025-03-09 14:05:02,174 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-09 14:05:02,174 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-09 14:05:02,174 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-09 14:05:03,323 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-09 14:05:03,323 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-09 14:05:03,323 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-09 14:05:03,324 - INFO - API sequence 5/12 generated
2025-03-09 14:05:03,324 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-09 14:05:03,324 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-09 14:05:03,324 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-09 14:05:04,840 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_8'], malicious_sign_seq=[0, 1] ==========
2025-03-09 14:05:04,840 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_8'], malicious_sign_seq=[0, 1] ==========
2025-03-09 14:05:04,840 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_8'], malicious_sign_seq=[0, 1] ==========
2025-03-09 14:05:04,840 - INFO - API sequence 6/12 generated
2025-03-09 14:05:04,840 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-09 14:05:04,840 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-09 14:05:04,840 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-09 14:05:05,966 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-09 14:05:05,966 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-09 14:05:05,966 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-09 14:05:05,967 - INFO - API sequence 7/12 generated
2025-03-09 14:05:05,967 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-09 14:05:05,967 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-09 14:05:05,967 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-09 14:05:06,950 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-09 14:05:06,996 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-09 14:05:06,996 - INFO - Extracting API list with API discovery algorithm...
2025-03-09 14:05:07,062 - INFO - Starting Drain3 template miner
2025-03-09 14:05:07,064 - INFO - Starting Drain3 template miner
2025-03-09 14:05:07,066 - INFO - Starting Drain3 template miner
2025-03-09 14:05:07,067 - INFO - Starting Drain3 template miner
2025-03-09 14:05:07,067 - INFO - Starting Drain3 template miner
2025-03-09 14:05:07,256 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-09 14:05:07,256 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-09 14:05:07,256 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-09 14:05:07,256 - INFO - API sequence 8/12 generated
2025-03-09 14:05:07,256 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-09 14:05:07,256 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-09 14:05:07,256 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-09 14:05:08,429 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[1] ==========
2025-03-09 14:05:08,429 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[1] ==========
2025-03-09 14:05:08,429 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[1] ==========
2025-03-09 14:05:08,429 - INFO - API sequence 9/12 generated
2025-03-09 14:05:08,429 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-09 14:05:08,429 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-09 14:05:08,429 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-09 14:05:08,541 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-09 14:05:09,584 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-09 14:05:09,584 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-09 14:05:09,584 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-09 14:05:09,584 - INFO - API sequence 10/12 generated
2025-03-09 14:05:09,584 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-09 14:05:09,584 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-09 14:05:09,584 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-09 14:05:10,751 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[1] ==========
2025-03-09 14:05:10,751 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[1] ==========
2025-03-09 14:05:10,751 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[1] ==========
2025-03-09 14:05:10,752 - INFO - API sequence 11/12 generated
2025-03-09 14:05:10,752 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-09 14:05:10,752 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-09 14:05:10,752 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-09 14:05:12,245 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_8'], malicious_sign_seq=[0, 1] ==========
2025-03-09 14:05:12,245 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_8'], malicious_sign_seq=[0, 1] ==========
2025-03-09 14:05:12,245 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_8'], malicious_sign_seq=[0, 1] ==========
2025-03-09 14:05:12,245 - INFO - API sequence 12/12 generated
2025-03-09 14:05:12,247 - INFO - API sequences serialized to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py/serialized_llm_agents.json
2025-03-09 14:05:12,247 - INFO - Generating simulated traffic data set...
2025-03-09 14:05:12,250 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-09 14:05:12,250 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-09 14:05:12,252 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-09 14:05:12,253 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-09 14:05:12,253 - INFO - Simulated traffic data for 1/12 user collected：user: normaluser malicious: True
2025-03-09 14:05:12,255 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-09 14:05:12,256 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-09 14:05:12,256 - INFO - Simulated traffic data for 2/12 user collected：user: adminuser malicious: False
2025-03-09 14:05:12,258 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/resource/16 {}
2025-03-09 14:05:12,259 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-09 14:05:12,259 - INFO - Simulated traffic data for 3/12 user collected：user: normaluser malicious: False
2025-03-09 14:05:12,262 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-09 14:05:12,262 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-09 14:05:12,262 - INFO - Simulated traffic data for 4/12 user collected：user: unloggeduser malicious: True
2025-03-09 14:05:12,265 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-09 14:05:12,265 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-09 14:05:12,265 - INFO - Simulated traffic data for 5/12 user collected：user: normaluser malicious: False
2025-03-09 14:05:12,268 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-09 14:05:12,268 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-09 14:05:12,270 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-09 14:05:12,271 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-09 14:05:12,271 - INFO - Simulated traffic data for 6/12 user collected：user: normaluser malicious: True
2025-03-09 14:05:12,273 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-09 14:05:12,274 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-09 14:05:12,274 - INFO - Simulated traffic data for 7/12 user collected：user: adminuser malicious: False
2025-03-09 14:05:12,277 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-09 14:05:12,277 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-09 14:05:12,277 - INFO - Simulated traffic data for 8/12 user collected：user: normaluser malicious: False
2025-03-09 14:05:12,279 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-09 14:05:12,280 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-09 14:05:12,280 - INFO - Simulated traffic data for 9/12 user collected：user: unloggeduser malicious: True
2025-03-09 14:05:12,283 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-09 14:05:12,283 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-09 14:05:12,283 - INFO - Simulated traffic data for 10/12 user collected：user: normaluser malicious: False
2025-03-09 14:05:12,286 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-09 14:05:12,286 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-09 14:05:12,286 - INFO - Simulated traffic data for 11/12 user collected：user: unloggeduser malicious: True
2025-03-09 14:05:12,289 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/resource/16 {}
2025-03-09 14:05:12,289 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-09 14:05:12,292 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-09 14:05:12,292 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-09 14:05:12,292 - INFO - Simulated traffic data for 12/12 user collected：user: normaluser malicious: True
2025-03-09 14:05:12,302 - INFO - All simulated traffic data collected：/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/simulated_traffic_data.csv
2025-03-09 14:05:24,702 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-09 14:05:24,745 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-09 14:05:24,745 - INFO - Extracting API list with API discovery algorithm...
2025-03-09 14:05:24,806 - INFO - Starting Drain3 template miner
2025-03-09 14:05:24,809 - INFO - Starting Drain3 template miner
2025-03-09 14:05:24,810 - INFO - Starting Drain3 template miner
2025-03-09 14:05:24,811 - INFO - Starting Drain3 template miner
2025-03-09 14:05:24,811 - INFO - Starting Drain3 template miner
2025-03-09 14:05:26,252 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-09 14:06:13,466 - INFO - Trying to construct model...
2025-03-09 14:06:13,467 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-09 14:06:13,503 - INFO - Training model... Size of feature_list: 6
2025-03-09 14:06:13,511 - INFO - Extracting features... Size of feature_list: 6
2025-03-09 14:06:13,512 - INFO - Extracting features... Size of feature_list: 6
2025-03-09 14:06:13,513 - INFO - Extracting features... Size of feature_list: 6
2025-03-09 14:06:13,514 - INFO - Extracting features... Size of feature_list: 6
2025-03-09 14:06:13,515 - INFO - Extracting features... Size of feature_list: 6
2025-03-09 14:06:13,516 - INFO - Extracting features... Size of feature_list: 6
2025-03-09 14:06:13,518 - INFO - Extracting features... Size of feature_list: 6
2025-03-09 14:06:13,519 - INFO - Extracting features... Size of feature_list: 6
[14:06:13] WARNING: /workspace/src/learner.cc:740: 
Parameters: { "use_label_encoder" } are not used.

2025-03-09 14:06:13,557 - INFO - Extracting features... Size of feature_list: 6
2025-03-09 14:06:13,558 - INFO - Extracting features... Size of feature_list: 6
2025-03-09 14:06:13,560 - INFO - Extracting features... Size of feature_list: 6
2025-03-09 14:06:13,561 - INFO - Extracting features... Size of feature_list: 6
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
2025-03-09 14:06:13,572 - INFO - Model constructed.
2025-03-09 14:06:23,335 - INFO - Trying to construct model...
2025-03-09 14:06:23,336 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-09 14:06:23,373 - INFO - Training model... Size of feature_list: 6
2025-03-09 14:06:23,382 - INFO - Extracting features... Size of feature_list: 6
2025-03-09 14:06:23,383 - INFO - Extracting features... Size of feature_list: 6
2025-03-09 14:06:23,385 - INFO - Extracting features... Size of feature_list: 6
2025-03-09 14:06:23,386 - INFO - Extracting features... Size of feature_list: 6
2025-03-09 14:06:23,387 - INFO - Extracting features... Size of feature_list: 6
2025-03-09 14:06:23,389 - INFO - Extracting features... Size of feature_list: 6
2025-03-09 14:06:23,390 - INFO - Extracting features... Size of feature_list: 6
2025-03-09 14:06:23,391 - INFO - Extracting features... Size of feature_list: 6
[14:06:23] WARNING: /workspace/src/learner.cc:740: 
Parameters: { "use_label_encoder" } are not used.

2025-03-09 14:06:23,441 - INFO - Extracting features... Size of feature_list: 6
2025-03-09 14:06:23,442 - INFO - Extracting features... Size of feature_list: 6
2025-03-09 14:06:23,444 - INFO - Extracting features... Size of feature_list: 6
2025-03-09 14:06:23,445 - INFO - Extracting features... Size of feature_list: 6
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
2025-03-09 14:06:23,457 - INFO - Model constructed.
2025-03-09 14:07:12,514 - INFO - Detection started. Combined data duration: 30
2025-03-09 14:07:20,383 - INFO - Detection paused.
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-03-09 15:58:06,622 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 30, Feature size: 7
2025-03-09 15:58:48,151 - INFO - Trying to construct model...
2025-03-09 15:58:48,152 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-09 15:58:48,210 - INFO - Training model... Size of feature_list: 7
2025-03-09 15:58:48,225 - INFO - Extracting features... Size of feature_list: 7
2025-03-09 15:58:48,233 - INFO - Extracting features... Size of feature_list: 7
2025-03-09 15:58:48,235 - INFO - Extracting features... Size of feature_list: 7
2025-03-09 15:58:48,236 - INFO - Extracting features... Size of feature_list: 7
2025-03-09 15:58:48,237 - INFO - Extracting features... Size of feature_list: 7
2025-03-09 15:58:48,238 - INFO - Extracting features... Size of feature_list: 7
2025-03-09 15:58:48,239 - INFO - Extracting features... Size of feature_list: 7
2025-03-09 15:58:48,240 - INFO - Extracting features... Size of feature_list: 7
[15:58:48] WARNING: /workspace/src/learner.cc:740: 
Parameters: { "use_label_encoder" } are not used.

2025-03-09 15:58:48,304 - INFO - Extracting features... Size of feature_list: 7
2025-03-09 15:58:48,305 - INFO - Extracting features... Size of feature_list: 7
2025-03-09 15:58:48,307 - INFO - Extracting features... Size of feature_list: 7
2025-03-09 15:58:48,308 - INFO - Extracting features... Size of feature_list: 7
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
2025-03-09 15:58:48,323 - INFO - Model constructed.
2025-03-09 15:59:09,531 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-09 15:59:09,610 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-09 15:59:09,644 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-09 15:59:09,645 - INFO - Generating simulated API sequences...
2025-03-09 15:59:09,646 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-09 15:59:09,646 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-09 15:59:11,001 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-09 15:59:11,001 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-09 15:59:11,001 - INFO - API sequence 1/12 generated
2025-03-09 15:59:11,002 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-09 15:59:11,002 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-09 15:59:12,198 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-09 15:59:12,198 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-09 15:59:12,198 - INFO - API sequence 2/12 generated
2025-03-09 15:59:12,198 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-09 15:59:12,198 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-09 15:59:13,347 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[1] ==========
2025-03-09 15:59:13,347 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[1] ==========
2025-03-09 15:59:13,347 - INFO - API sequence 3/12 generated
2025-03-09 15:59:13,347 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-09 15:59:13,347 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-09 15:59:14,634 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[1] ==========
2025-03-09 15:59:14,634 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[1] ==========
2025-03-09 15:59:14,634 - INFO - API sequence 4/12 generated
2025-03-09 15:59:14,634 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-09 15:59:14,634 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-09 15:59:14,730 - INFO - Trying to construct model...
2025-03-09 15:59:14,730 - INFO - DATA_COLLECTION_STATUS: IN_PROGRESS
2025-03-09 15:59:16,078 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_8'], malicious_sign_seq=[0, 1] ==========
2025-03-09 15:59:16,078 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_8'], malicious_sign_seq=[0, 1] ==========
2025-03-09 15:59:16,078 - INFO - API sequence 5/12 generated
2025-03-09 15:59:16,078 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-09 15:59:16,078 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-09 15:59:17,272 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-09 15:59:17,272 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-09 15:59:17,272 - INFO - API sequence 6/12 generated
2025-03-09 15:59:17,272 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-09 15:59:17,272 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-09 15:59:18,799 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_8'], malicious_sign_seq=[0, 1] ==========
2025-03-09 15:59:18,799 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_8'], malicious_sign_seq=[0, 1] ==========
2025-03-09 15:59:18,799 - INFO - API sequence 7/12 generated
2025-03-09 15:59:18,799 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-09 15:59:18,799 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-09 15:59:19,968 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[1] ==========
2025-03-09 15:59:19,968 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[1] ==========
2025-03-09 15:59:19,968 - INFO - API sequence 8/12 generated
2025-03-09 15:59:19,969 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-09 15:59:19,969 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-09 15:59:21,259 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-09 15:59:21,259 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-09 15:59:21,260 - INFO - API sequence 9/12 generated
2025-03-09 15:59:21,260 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-09 15:59:21,260 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-09 15:59:22,664 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_8'], malicious_sign_seq=[0, 1] ==========
2025-03-09 15:59:22,664 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_8'], malicious_sign_seq=[0, 1] ==========
2025-03-09 15:59:22,664 - INFO - API sequence 10/12 generated
2025-03-09 15:59:22,665 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-09 15:59:22,665 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-09 15:59:53,196 - ERROR - JSON decoding error: Expecting value: line 1 column 1 (char 0)
Raw response: thinking failure...
Traceback (most recent call last):
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/brain.py", line 107, in _parse_llm_response_for_api_seq
    parsed_data = json.loads(json_str)
  File "/usr/lib/python3.10/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
  File "/usr/lib/python3.10/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
  File "/usr/lib/python3.10/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
2025-03-09 15:59:53,196 - ERROR - JSON decoding error: Expecting value: line 1 column 1 (char 0)
Raw response: thinking failure...
Traceback (most recent call last):
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/brain.py", line 107, in _parse_llm_response_for_api_seq
    parsed_data = json.loads(json_str)
  File "/usr/lib/python3.10/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
  File "/usr/lib/python3.10/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
  File "/usr/lib/python3.10/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
2025-03-09 15:59:53,198 - INFO - ========== Method gen_api_seq() returned: seq=[], malicious_sign_seq=[] ==========
2025-03-09 15:59:53,198 - INFO - ========== Method gen_api_seq() returned: seq=[], malicious_sign_seq=[] ==========
2025-03-09 15:59:53,198 - INFO - API sequence 11/12 generated
2025-03-09 15:59:53,198 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-09 15:59:53,198 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-09 16:00:08,840 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-09 16:00:08,840 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-09 16:00:08,840 - INFO - API sequence 12/12 generated
2025-03-09 16:00:08,841 - INFO - API sequences serialized to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py/serialized_llm_agents.json
2025-03-09 16:00:08,841 - INFO - Generating simulated traffic data set...
2025-03-09 16:00:08,841 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-09 16:00:08,841 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-09 16:00:08,841 - INFO - Simulated traffic data for 1/12 user collected：user: normaluser malicious: False
2025-03-09 16:00:08,841 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-09 16:00:08,841 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-09 16:00:08,841 - INFO - Simulated traffic data for 2/12 user collected：user: normaluser malicious: False
2025-03-09 16:00:08,842 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-09 16:00:08,842 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-09 16:00:08,842 - INFO - Simulated traffic data for 3/12 user collected：user: unloggeduser malicious: True
2025-03-09 16:00:08,842 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-09 16:00:08,842 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-09 16:00:08,842 - INFO - Simulated traffic data for 4/12 user collected：user: unloggeduser malicious: True
2025-03-09 16:00:08,842 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-09 16:00:08,842 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-09 16:00:08,842 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-09 16:00:08,842 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-09 16:00:08,842 - INFO - Simulated traffic data for 5/12 user collected：user: normaluser malicious: True
2025-03-09 16:00:08,843 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-09 16:00:08,843 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-09 16:00:08,843 - INFO - Simulated traffic data for 6/12 user collected：user: adminuser malicious: False
2025-03-09 16:00:08,843 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/resource/16 {}
2025-03-09 16:00:08,843 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-09 16:00:08,843 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/resource/16 {}
2025-03-09 16:00:08,843 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-09 16:00:08,843 - INFO - Simulated traffic data for 7/12 user collected：user: normaluser malicious: True
2025-03-09 16:00:08,843 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-09 16:00:08,843 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-09 16:00:08,843 - INFO - Simulated traffic data for 8/12 user collected：user: unloggeduser malicious: True
2025-03-09 16:00:08,844 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-09 16:00:08,844 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-09 16:00:08,844 - INFO - Simulated traffic data for 9/12 user collected：user: normaluser malicious: False
2025-03-09 16:00:08,844 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-09 16:00:08,844 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-09 16:00:08,844 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-09 16:00:08,844 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-09 16:00:08,844 - INFO - Simulated traffic data for 10/12 user collected：user: normaluser malicious: True
2025-03-09 16:00:08,844 - INFO - Simulated traffic data for 11/12 user collected：user: adminuser malicious: False
2025-03-09 16:00:08,844 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-09 16:00:08,844 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-09 16:00:08,844 - INFO - Simulated traffic data for 12/12 user collected：user: normaluser malicious: False
2025-03-09 16:00:08,847 - INFO - All simulated traffic data collected：/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/simulated_traffic_data.csv
 
 -------------- celery@VM-16-2-ubuntu v5.4.0 (opalescent)
--- ***** ----- 
-- ******* ---- Linux-5.15.0-130-generic-x86_64-with-glibc2.35 2025-03-09 16:24:11
- *** --- * --- 
- ** ---------- [config]
- ** ---------- .> app:         tasks:0x7f9ecdd47fa0
- ** ---------- .> transport:   redis://localhost:6379/0
- ** ---------- .> results:     disabled://
- *** --- * --- .> concurrency: 2 (prefork)
-- ******* ---- .> task events: OFF (enable -E to monitor tasks in this worker)
--- ***** ----- 
 -------------- [queues]
                .> celery           exchange=celery(direct) key=celery
                

[tasks]
  . traffic_collector.consume_traffic_periodically

[2025-03-09 16:24:11,623: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

[2025-03-09 16:24:11,683: INFO/MainProcess] Connected to redis://localhost:6379/0
[2025-03-09 16:24:11,683: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

[2025-03-09 16:24:11,686: INFO/MainProcess] mingle: searching for neighbors
[2025-03-09 16:24:12,690: INFO/MainProcess] mingle: all alone
[2025-03-09 16:24:12,697: INFO/MainProcess] celery@VM-16-2-ubuntu ready.
[2025-03-09 16:24:12,698: INFO/MainProcess] Task traffic_collector.consume_traffic_periodically[5c7c17fa-0893-4d75-99e4-c4b82255f14e] received
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/usr/local/lib/python3.10/dist-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/usr/local/lib/python3.10/dist-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/usr/local/lib/python3.10/dist-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/usr/local/lib/python3.10/dist-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/usr/local/lib/python3.10/dist-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/usr/local/lib/python3.10/dist-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f0e53b158d0>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/requests/adapters.py", line 667, in send
    resp = conn.urlopen(
  File "/usr/local/lib/python3.10/dist-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/usr/local/lib/python3.10/dist-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='49.234.6.241', port=8000): Max retries exceeded with url: /api/load_target_app/?app_id=1 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f0e53b158d0>: Failed to establish a new connection: [Errno 111] Connection refused'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/./app.py", line 635, in <module>
    load_target_app()
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/./app.py", line 603, in load_target_app
    response = requests.get(f'http://49.234.6.241:8000/api/load_target_app/?app_id={app_id}')
  File "/usr/local/lib/python3.10/dist-packages/requests/api.py", line 73, in get
    return request("get", url, params=params, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/usr/local/lib/python3.10/dist-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/requests/adapters.py", line 700, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='49.234.6.241', port=8000): Max retries exceeded with url: /api/load_target_app/?app_id=1 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f0e53b158d0>: Failed to establish a new connection: [Errno 111] Connection refused'))
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-03-09 16:26:31,180 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 30, Feature size: 7
 * Serving Flask app 'app'
 * Debug mode: on
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-03-09 16:26:33,028 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 30, Feature size: 7
2025-03-09 16:28:08,370 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-09 16:28:08,455 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-09 16:28:08,486 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-09 16:28:08,486 - INFO - Generating simulated API sequences...
2025-03-09 16:28:08,486 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-09 16:28:08,486 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-09 16:28:09,993 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_8'], malicious_sign_seq=[0, 1] ==========
2025-03-09 16:28:09,993 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_8'], malicious_sign_seq=[0, 1] ==========
2025-03-09 16:28:09,993 - INFO - API sequence 1/12 generated
2025-03-09 16:28:09,993 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-09 16:28:09,993 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-09 16:28:11,537 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_8'], malicious_sign_seq=[0, 1] ==========
2025-03-09 16:28:11,537 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_8'], malicious_sign_seq=[0, 1] ==========
2025-03-09 16:28:11,538 - INFO - API sequence 2/12 generated
2025-03-09 16:28:11,538 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-09 16:28:11,538 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-09 16:28:12,740 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[1] ==========
2025-03-09 16:28:12,740 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[1] ==========
2025-03-09 16:28:12,740 - INFO - API sequence 3/12 generated
2025-03-09 16:28:12,740 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-09 16:28:12,740 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-09 16:28:14,017 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-09 16:28:14,017 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-09 16:28:14,017 - INFO - API sequence 4/12 generated
2025-03-09 16:28:14,018 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-09 16:28:14,018 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-09 16:28:15,535 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_8'], malicious_sign_seq=[0, 1] ==========
2025-03-09 16:28:15,535 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_8'], malicious_sign_seq=[0, 1] ==========
2025-03-09 16:28:15,535 - INFO - API sequence 5/12 generated
2025-03-09 16:28:15,535 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-09 16:28:15,535 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-09 16:28:15,805 - INFO - Trying to construct model...
2025-03-09 16:28:15,805 - INFO - DATA_COLLECTION_STATUS: IN_PROGRESS
2025-03-09 16:28:16,785 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-09 16:28:16,785 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-09 16:28:16,785 - INFO - API sequence 6/12 generated
2025-03-09 16:28:16,785 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-09 16:28:16,785 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-09 16:28:17,979 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-09 16:28:17,979 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-09 16:28:17,980 - INFO - API sequence 7/12 generated
2025-03-09 16:28:17,980 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-09 16:28:17,980 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-09 16:28:19,167 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-09 16:28:19,167 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-09 16:28:19,168 - INFO - API sequence 8/12 generated
2025-03-09 16:28:19,168 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-09 16:28:19,168 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-09 16:28:20,350 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-09 16:28:20,350 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-09 16:28:20,350 - INFO - API sequence 9/12 generated
2025-03-09 16:28:20,350 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-09 16:28:20,350 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-09 16:28:21,488 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-09 16:28:21,488 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-09 16:28:21,488 - INFO - API sequence 10/12 generated
2025-03-09 16:28:21,488 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-09 16:28:21,488 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-09 16:28:52,012 - ERROR - JSON decoding error: Expecting value: line 1 column 1 (char 0)
Raw response: thinking failure...
Traceback (most recent call last):
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/brain.py", line 107, in _parse_llm_response_for_api_seq
    parsed_data = json.loads(json_str)
  File "/usr/lib/python3.10/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
  File "/usr/lib/python3.10/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
  File "/usr/lib/python3.10/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
2025-03-09 16:28:52,012 - ERROR - JSON decoding error: Expecting value: line 1 column 1 (char 0)
Raw response: thinking failure...
Traceback (most recent call last):
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/brain.py", line 107, in _parse_llm_response_for_api_seq
    parsed_data = json.loads(json_str)
  File "/usr/lib/python3.10/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
  File "/usr/lib/python3.10/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
  File "/usr/lib/python3.10/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
2025-03-09 16:28:52,014 - INFO - ========== Method gen_api_seq() returned: seq=[], malicious_sign_seq=[] ==========
2025-03-09 16:28:52,014 - INFO - ========== Method gen_api_seq() returned: seq=[], malicious_sign_seq=[] ==========
2025-03-09 16:28:52,014 - INFO - API sequence 11/12 generated
2025-03-09 16:28:52,014 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-09 16:28:52,014 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-09 16:29:07,590 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[1] ==========
2025-03-09 16:29:07,590 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[1] ==========
2025-03-09 16:29:07,590 - INFO - API sequence 12/12 generated
2025-03-09 16:29:07,590 - INFO - API sequences serialized to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py/serialized_llm_agents.json
2025-03-09 16:29:07,590 - INFO - Generating simulated traffic data set...
2025-03-09 16:29:07,591 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-09 16:29:07,591 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-09 16:29:07,591 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-09 16:29:07,591 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-09 16:29:07,591 - INFO - Simulated traffic data for 1/12 user collected：user: normaluser malicious: True
2025-03-09 16:29:07,591 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/memo/21 {}
2025-03-09 16:29:07,591 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-09 16:29:07,591 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-09 16:29:07,592 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-09 16:29:07,592 - INFO - Simulated traffic data for 2/12 user collected：user: normaluser malicious: True
2025-03-09 16:29:07,592 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-09 16:29:07,592 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-09 16:29:07,592 - INFO - Simulated traffic data for 3/12 user collected：user: unloggeduser malicious: True
2025-03-09 16:29:07,592 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-09 16:29:07,592 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-09 16:29:07,592 - INFO - Simulated traffic data for 4/12 user collected：user: normaluser malicious: False
2025-03-09 16:29:07,592 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-09 16:29:07,592 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-09 16:29:07,592 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-09 16:29:07,592 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-09 16:29:07,592 - INFO - Simulated traffic data for 5/12 user collected：user: normaluser malicious: True
2025-03-09 16:29:07,593 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-09 16:29:07,593 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-09 16:29:07,593 - INFO - Simulated traffic data for 6/12 user collected：user: normaluser malicious: False
2025-03-09 16:29:07,593 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-09 16:29:07,593 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-09 16:29:07,593 - INFO - Simulated traffic data for 7/12 user collected：user: adminuser malicious: False
2025-03-09 16:29:07,593 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-09 16:29:07,593 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-09 16:29:07,593 - INFO - Simulated traffic data for 8/12 user collected：user: adminuser malicious: False
2025-03-09 16:29:07,593 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-09 16:29:07,593 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-09 16:29:07,593 - INFO - Simulated traffic data for 9/12 user collected：user: normaluser malicious: False
2025-03-09 16:29:07,594 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-09 16:29:07,594 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-09 16:29:07,594 - INFO - Simulated traffic data for 10/12 user collected：user: normaluser malicious: False
2025-03-09 16:29:07,594 - INFO - Simulated traffic data for 11/12 user collected：user: unloggeduser malicious: True
2025-03-09 16:29:07,594 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-09 16:29:07,594 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-09 16:29:07,594 - INFO - Simulated traffic data for 12/12 user collected：user: unloggeduser malicious: True
2025-03-09 16:29:07,596 - INFO - All simulated traffic data collected：/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/simulated_traffic_data.csv
2025-03-09 17:36:08,844 - INFO - Trying to construct model...
2025-03-09 17:36:08,845 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-09 17:36:08,897 - INFO - Training model... Size of feature_list: 7
2025-03-09 17:36:08,913 - INFO - Extracting features... Size of feature_list: 7
2025-03-09 17:36:08,918 - INFO - Extracting features... Size of feature_list: 7
2025-03-09 17:36:08,919 - INFO - Extracting features... Size of feature_list: 7
2025-03-09 17:36:08,920 - INFO - Extracting features... Size of feature_list: 7
2025-03-09 17:36:08,922 - INFO - Extracting features... Size of feature_list: 7
2025-03-09 17:36:08,923 - INFO - Extracting features... Size of feature_list: 7
2025-03-09 17:36:08,924 - INFO - Extracting features... Size of feature_list: 7
2025-03-09 17:36:08,925 - INFO - Extracting features... Size of feature_list: 7
[17:36:09] WARNING: /workspace/src/learner.cc:740: 
Parameters: { "use_label_encoder" } are not used.

2025-03-09 17:36:09,037 - INFO - Extracting features... Size of feature_list: 7
2025-03-09 17:36:09,039 - INFO - Extracting features... Size of feature_list: 7
2025-03-09 17:36:09,040 - INFO - Extracting features... Size of feature_list: 7
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
2025-03-09 17:36:09,058 - INFO - Model constructed.
2025-03-09 21:29:53,113 - INFO - Trying to construct model...
2025-03-09 21:29:53,114 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-09 21:29:53,261 - INFO - Training model... Size of feature_list: 7
2025-03-09 21:29:53,282 - INFO - Extracting features... Size of feature_list: 7
2025-03-09 21:29:53,285 - INFO - Extracting features... Size of feature_list: 7
2025-03-09 21:29:53,286 - INFO - Extracting features... Size of feature_list: 7
2025-03-09 21:29:53,287 - INFO - Extracting features... Size of feature_list: 7
2025-03-09 21:29:53,288 - INFO - Extracting features... Size of feature_list: 7
2025-03-09 21:29:53,289 - INFO - Extracting features... Size of feature_list: 7
2025-03-09 21:29:53,290 - INFO - Extracting features... Size of feature_list: 7
2025-03-09 21:29:53,291 - INFO - Extracting features... Size of feature_list: 7
[21:29:53] WARNING: /workspace/src/learner.cc:740: 
Parameters: { "use_label_encoder" } are not used.

2025-03-09 21:29:53,447 - INFO - Extracting features... Size of feature_list: 7
2025-03-09 21:29:53,449 - INFO - Extracting features... Size of feature_list: 7
2025-03-09 21:29:53,450 - INFO - Extracting features... Size of feature_list: 7
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
2025-03-09 21:29:53,465 - INFO - Model constructed.

Restarting celery worker (/home/ubuntu/.local/bin/celery -A traffic_collector.celery worker --loglevel=info)
[2025-03-09 21:31:42,928: ERROR/MainProcess] Process 'ForkPoolWorker-1' pid:3007 exited with 'exitcode 70'
[2025-03-09 21:31:42,992: ERROR/MainProcess] Task handler raised error: WorkerLostError('Worker exited prematurely: exitcode 70 Job: 0.')
Traceback (most recent call last):
  File "/home/ubuntu/.local/lib/python3.10/site-packages/billiard/pool.py", line 1265, in mark_as_worker_lost
    raise WorkerLostError(
billiard.einfo.ExceptionWithTraceback: 
"""
Traceback (most recent call last):
  File "/home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/worker.py", line 202, in start
    self.blueprint.start(self)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/celery/bootsteps.py", line 365, in start
    return self.obj.start()
  File "/home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py", line 340, in start
    blueprint.start(self)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py", line 746, in start
    c.loop(*c.loop_args())
  File "/home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/loops.py", line 86, in asynloop
    state.maybe_shutdown()
  File "/home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/state.py", line 93, in maybe_shutdown
    raise WorkerShutdown(should_stop)
celery.exceptions.WorkerShutdown: 0

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ubuntu/.local/lib/python3.10/site-packages/billiard/pool.py", line 1265, in mark_as_worker_lost
    raise WorkerLostError(
billiard.exceptions.WorkerLostError: Worker exited prematurely: exitcode 70 Job: 0.
"""
[2025-03-09 21:31:42,993: ERROR/MainProcess] Process 'ForkPoolWorker-2' pid:3008 exited with 'exitcode 70'
 
 -------------- celery@VM-16-2-ubuntu v5.4.0 (opalescent)
--- ***** ----- 
-- ******* ---- Linux-5.15.0-130-generic-x86_64-with-glibc2.35 2025-03-09 21:31:50
- *** --- * --- 
- ** ---------- [config]
- ** ---------- .> app:         tasks:0x7f4f42c6f1f0
- ** ---------- .> transport:   redis://localhost:6379/0
- ** ---------- .> results:     disabled://
- *** --- * --- .> concurrency: 2 (prefork)
-- ******* ---- .> task events: OFF (enable -E to monitor tasks in this worker)
--- ***** ----- 
 -------------- [queues]
                .> celery           exchange=celery(direct) key=celery
                

[tasks]
  . traffic_collector.consume_traffic_periodically

[2025-03-09 21:31:50,772: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

[2025-03-09 21:31:50,777: INFO/MainProcess] Connected to redis://localhost:6379/0
[2025-03-09 21:31:50,778: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

[2025-03-09 21:31:50,781: INFO/MainProcess] mingle: searching for neighbors
[2025-03-09 21:31:51,788: INFO/MainProcess] mingle: all alone
[2025-03-09 21:31:51,794: INFO/MainProcess] celery@VM-16-2-ubuntu ready.
2025-03-09 22:15:19,535 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-09 22:15:19,598 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-09 22:15:19,598 - INFO - Extracting API list with API discovery algorithm...
2025-03-09 22:15:19,663 - INFO - Starting Drain3 template miner
2025-03-09 22:15:19,740 - INFO - Starting Drain3 template miner
2025-03-09 22:15:19,742 - INFO - Starting Drain3 template miner
2025-03-09 22:15:19,742 - INFO - Starting Drain3 template miner
2025-03-09 22:15:19,743 - INFO - Starting Drain3 template miner
2025-03-09 22:15:21,145 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
[2025-03-09 22:15:21,253: ERROR/MainProcess] Received unregistered task of type 'SFWAP.views.handle_api_discovery_notification'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[["1", {"discovered_API_list": [{"function_description": "Please fill in the function description", "permission_info": "Please fill in the permission info", "sample_url": "http://47.97.114.24:5230/api/v1/memo/20", "sample_request_data": {}, "request_method": "GET", "path_segments": [{"name": "api", "is_path_variable": false}, {"name": "v1", "is_path_variable": false}, {"name": "memo", "is_path_variable": false}, {"name": "<NUM>", "is_path_variable": true}], "request_param_list": [], "request_data_fields": []}, {"function_description": "Please fill in the function description", "permission_info": "Please fill in the permission info", "sample_url": "http://47.97.114.24:5230/o/r/15?thumbnail=1", "sample_request_data": {}, "request_method": "GET", "path_segments": [{"name": "o", "is_path_variable": false}, {"name": "r", "is_path_variable": false}, {"name": "<NUM>", "is_path_variable": true}], "request_param_list": [{"name": "thumbnail", "is_necessary": true}], "request_data_fields": []},... (29391b)

The full contents of the message headers:
{'lang': 'py', 'task': 'SFWAP.views.handle_api_discovery_notification', 'id': '74df58e2-d9f1-4ccf-9eee-0f7314682bc0', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': '74df58e2-d9f1-4ccf-9eee-0f7314682bc0', 'parent_id': None, 'argsrepr': "('1', {'discovered_API_list': [{...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}]})", 'kwargsrepr': '{}', 'origin': 'gen22166@VM-16-2-ubuntu', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "/home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
KeyError: 'SFWAP.views.handle_api_discovery_notification'
2025-03-09 22:15:29,563 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-09 22:15:29,617 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-09 22:15:29,617 - INFO - Extracting API list with API discovery algorithm...
2025-03-09 22:15:29,679 - INFO - Starting Drain3 template miner
2025-03-09 22:15:29,681 - INFO - Starting Drain3 template miner
2025-03-09 22:15:29,683 - INFO - Starting Drain3 template miner
2025-03-09 22:15:29,684 - INFO - Starting Drain3 template miner
2025-03-09 22:15:29,684 - INFO - Starting Drain3 template miner
2025-03-09 22:15:31,101 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-09 22:15:41,391 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-09 22:15:41,436 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-09 22:15:41,436 - INFO - Extracting API list with API discovery algorithm...
2025-03-09 22:15:41,496 - INFO - Starting Drain3 template miner
2025-03-09 22:15:41,499 - INFO - Starting Drain3 template miner
2025-03-09 22:15:41,500 - INFO - Starting Drain3 template miner
2025-03-09 22:15:41,501 - INFO - Starting Drain3 template miner
2025-03-09 22:15:41,501 - INFO - Starting Drain3 template miner
2025-03-09 22:15:42,929 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-10 00:40:52,397 - INFO - Trying to construct model...
2025-03-10 00:40:52,398 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-10 00:40:52,425 - INFO - Training model... Size of feature_list: 6
2025-03-10 00:40:52,434 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 00:40:52,436 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 00:40:52,437 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 00:40:52,438 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 00:40:52,439 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 00:40:52,440 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 00:40:52,441 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 00:40:52,441 - INFO - Extracting features... Size of feature_list: 6
[00:40:52] WARNING: /workspace/src/learner.cc:740: 
Parameters: { "use_label_encoder" } are not used.

2025-03-10 00:40:52,471 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 00:40:52,472 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 00:40:52,473 - INFO - Extracting features... Size of feature_list: 6
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
2025-03-10 00:40:52,485 - INFO - Model constructed.
2025-03-10 00:41:02,438 - INFO - Trying to construct model...
2025-03-10 00:41:02,438 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-10 00:41:02,474 - INFO - Training model... Size of feature_list: 6
2025-03-10 00:41:02,483 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 00:41:02,484 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 00:41:02,485 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 00:41:02,486 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 00:41:02,487 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 00:41:02,488 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 00:41:02,489 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 00:41:02,490 - INFO - Extracting features... Size of feature_list: 6
[00:41:02] WARNING: /workspace/src/learner.cc:740: 
Parameters: { "use_label_encoder" } are not used.

2025-03-10 00:41:02,525 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 00:41:02,527 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 00:41:02,528 - INFO - Extracting features... Size of feature_list: 6
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
2025-03-10 00:41:02,538 - INFO - Model constructed.
Failed attempting 1 times，Error: Failed to request LLM: 429, Error code: Throttling.RateQuota, Error message: Requests rate limit exceeded, please try again later.，Retrying 2 seconds later...
Failed attempting 2 times，Error: Failed to request LLM: 429, Error code: Throttling.RateQuota, Error message: Requests rate limit exceeded, please try again later.，Retrying 4 seconds later...
Failed attempting 3 times，Error: Failed to request LLM: 429, Error code: Throttling.RateQuota, Error message: Requests rate limit exceeded, please try again later.，Retrying 8 seconds later...
Failed attempting 4 times，Error: Failed to request LLM: 429, Error code: Throttling.RateQuota, Error message: Requests rate limit exceeded, please try again later.，Retrying 16 seconds later...
thinking failure...
Failed attempting 1 times，Error: Failed to request LLM: 429, Error code: Throttling.RateQuota, Error message: Requests rate limit exceeded, please try again later.，Retrying 2 seconds later...
Failed attempting 2 times，Error: Failed to request LLM: 429, Error code: Throttling.RateQuota, Error message: Requests rate limit exceeded, please try again later.，Retrying 4 seconds later...
Failed attempting 3 times，Error: Failed to request LLM: 429, Error code: Throttling.RateQuota, Error message: Requests rate limit exceeded, please try again later.，Retrying 8 seconds later...
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-03-10 10:04:44,512 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 6
2025-03-10 10:06:24,793 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-10 10:06:24,967 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-10 10:06:24,968 - INFO - Extracting API list with API discovery algorithm...
2025-03-10 10:06:25,042 - INFO - Starting Drain3 template miner
2025-03-10 10:06:25,045 - INFO - Starting Drain3 template miner
2025-03-10 10:06:25,046 - INFO - Starting Drain3 template miner
2025-03-10 10:06:25,047 - INFO - Starting Drain3 template miner
2025-03-10 10:06:25,048 - INFO - Starting Drain3 template miner
2025-03-10 10:06:26,506 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-10 10:07:18,554 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-10 10:07:18,599 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-10 10:07:18,635 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-10 10:07:18,635 - INFO - Starting data generation...
2025-03-10 10:07:18,635 - INFO - API_KNOWLEDGE: [{'number': 'API_1707', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_1708', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}]
2025-03-10 10:07:18,635 - INFO - APP_KNOWLEDGE: {'func_description': 'This is an updated test applicationaaa', 'normal_seqs': ['There are no example normal seqs'], 'malicious_seqs': ['There are no example malicious seqs'], 'roles': ['admin', 'ordinary_user', 'unlogged_in_user']}
2025-03-10 10:07:18,635 - INFO - Generating simulated API sequences...
2025-03-10 10:07:18,635 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-10 10:07:18,635 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-10 10:07:19,004 - ERROR - JSON decoding error: Expecting value: line 1 column 1 (char 0)
Raw response: 
Traceback (most recent call last):
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/brain.py", line 107, in _parse_llm_response_for_api_seq
    parsed_data = json.loads(json_str)
  File "/usr/lib/python3.10/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
  File "/usr/lib/python3.10/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
  File "/usr/lib/python3.10/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
2025-03-10 10:07:19,004 - ERROR - JSON decoding error: Expecting value: line 1 column 1 (char 0)
Raw response: 
Traceback (most recent call last):
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/brain.py", line 107, in _parse_llm_response_for_api_seq
    parsed_data = json.loads(json_str)
  File "/usr/lib/python3.10/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
  File "/usr/lib/python3.10/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
  File "/usr/lib/python3.10/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
2025-03-10 10:07:19,006 - INFO - ========== Method gen_api_seq() returned: seq=[], malicious_sign_seq=[] ==========
2025-03-10 10:07:19,006 - INFO - ========== Method gen_api_seq() returned: seq=[], malicious_sign_seq=[] ==========
2025-03-10 10:07:19,006 - INFO - API sequence 1/12 generated
2025-03-10 10:07:19,006 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 10:07:19,006 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 10:07:19,363 - ERROR - JSON decoding error: Expecting value: line 1 column 1 (char 0)
Raw response: 
Traceback (most recent call last):
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/brain.py", line 107, in _parse_llm_response_for_api_seq
    parsed_data = json.loads(json_str)
  File "/usr/lib/python3.10/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
  File "/usr/lib/python3.10/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
  File "/usr/lib/python3.10/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
2025-03-10 10:07:19,363 - ERROR - JSON decoding error: Expecting value: line 1 column 1 (char 0)
Raw response: 
Traceback (most recent call last):
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/brain.py", line 107, in _parse_llm_response_for_api_seq
    parsed_data = json.loads(json_str)
  File "/usr/lib/python3.10/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
  File "/usr/lib/python3.10/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
  File "/usr/lib/python3.10/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
2025-03-10 10:07:19,363 - INFO - ========== Method gen_api_seq() returned: seq=[], malicious_sign_seq=[] ==========
2025-03-10 10:07:19,363 - INFO - ========== Method gen_api_seq() returned: seq=[], malicious_sign_seq=[] ==========
2025-03-10 10:07:19,363 - INFO - API sequence 2/12 generated
2025-03-10 10:07:19,363 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-10 10:07:19,363 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-10 10:07:19,705 - ERROR - JSON decoding error: Expecting value: line 1 column 1 (char 0)
Raw response: 
Traceback (most recent call last):
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/brain.py", line 107, in _parse_llm_response_for_api_seq
    parsed_data = json.loads(json_str)
  File "/usr/lib/python3.10/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
  File "/usr/lib/python3.10/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
  File "/usr/lib/python3.10/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
2025-03-10 10:07:19,705 - ERROR - JSON decoding error: Expecting value: line 1 column 1 (char 0)
Raw response: 
Traceback (most recent call last):
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/brain.py", line 107, in _parse_llm_response_for_api_seq
    parsed_data = json.loads(json_str)
  File "/usr/lib/python3.10/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
  File "/usr/lib/python3.10/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
  File "/usr/lib/python3.10/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
2025-03-10 10:07:19,706 - INFO - ========== Method gen_api_seq() returned: seq=[], malicious_sign_seq=[] ==========
2025-03-10 10:07:19,706 - INFO - ========== Method gen_api_seq() returned: seq=[], malicious_sign_seq=[] ==========
2025-03-10 10:07:19,706 - INFO - API sequence 3/12 generated
2025-03-10 10:07:19,706 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-10 10:07:19,706 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-10 10:07:20,046 - ERROR - JSON decoding error: Expecting value: line 1 column 1 (char 0)
Raw response: 
Traceback (most recent call last):
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/brain.py", line 107, in _parse_llm_response_for_api_seq
    parsed_data = json.loads(json_str)
  File "/usr/lib/python3.10/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
  File "/usr/lib/python3.10/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
  File "/usr/lib/python3.10/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
2025-03-10 10:07:20,046 - ERROR - JSON decoding error: Expecting value: line 1 column 1 (char 0)
Raw response: 
Traceback (most recent call last):
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/brain.py", line 107, in _parse_llm_response_for_api_seq
    parsed_data = json.loads(json_str)
  File "/usr/lib/python3.10/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
  File "/usr/lib/python3.10/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
  File "/usr/lib/python3.10/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
2025-03-10 10:07:20,047 - INFO - ========== Method gen_api_seq() returned: seq=[], malicious_sign_seq=[] ==========
2025-03-10 10:07:20,047 - INFO - ========== Method gen_api_seq() returned: seq=[], malicious_sign_seq=[] ==========
2025-03-10 10:07:20,047 - INFO - API sequence 4/12 generated
2025-03-10 10:07:20,047 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-10 10:07:20,047 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-10 10:07:20,401 - ERROR - JSON decoding error: Expecting value: line 1 column 1 (char 0)
Raw response: 
Traceback (most recent call last):
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/brain.py", line 107, in _parse_llm_response_for_api_seq
    parsed_data = json.loads(json_str)
  File "/usr/lib/python3.10/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
  File "/usr/lib/python3.10/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
  File "/usr/lib/python3.10/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
2025-03-10 10:07:20,401 - ERROR - JSON decoding error: Expecting value: line 1 column 1 (char 0)
Raw response: 
Traceback (most recent call last):
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/brain.py", line 107, in _parse_llm_response_for_api_seq
    parsed_data = json.loads(json_str)
  File "/usr/lib/python3.10/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
  File "/usr/lib/python3.10/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
  File "/usr/lib/python3.10/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
2025-03-10 10:07:20,402 - INFO - ========== Method gen_api_seq() returned: seq=[], malicious_sign_seq=[] ==========
2025-03-10 10:07:20,402 - INFO - ========== Method gen_api_seq() returned: seq=[], malicious_sign_seq=[] ==========
2025-03-10 10:07:20,402 - INFO - API sequence 5/12 generated
2025-03-10 10:07:20,402 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-10 10:07:20,402 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-10 10:07:20,771 - ERROR - JSON decoding error: Expecting value: line 1 column 1 (char 0)
Raw response: 
Traceback (most recent call last):
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/brain.py", line 107, in _parse_llm_response_for_api_seq
    parsed_data = json.loads(json_str)
  File "/usr/lib/python3.10/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
  File "/usr/lib/python3.10/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
  File "/usr/lib/python3.10/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
2025-03-10 10:07:20,771 - ERROR - JSON decoding error: Expecting value: line 1 column 1 (char 0)
Raw response: 
Traceback (most recent call last):
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/brain.py", line 107, in _parse_llm_response_for_api_seq
    parsed_data = json.loads(json_str)
  File "/usr/lib/python3.10/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
  File "/usr/lib/python3.10/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
  File "/usr/lib/python3.10/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
2025-03-10 10:07:20,771 - INFO - ========== Method gen_api_seq() returned: seq=[], malicious_sign_seq=[] ==========
2025-03-10 10:07:20,771 - INFO - ========== Method gen_api_seq() returned: seq=[], malicious_sign_seq=[] ==========
2025-03-10 10:07:20,771 - INFO - API sequence 6/12 generated
2025-03-10 10:07:20,771 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-10 10:07:20,771 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-10 10:07:21,081 - ERROR - JSON decoding error: Expecting value: line 1 column 1 (char 0)
Raw response: 
Traceback (most recent call last):
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/brain.py", line 107, in _parse_llm_response_for_api_seq
    parsed_data = json.loads(json_str)
  File "/usr/lib/python3.10/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
  File "/usr/lib/python3.10/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
  File "/usr/lib/python3.10/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
2025-03-10 10:07:21,081 - ERROR - JSON decoding error: Expecting value: line 1 column 1 (char 0)
Raw response: 
Traceback (most recent call last):
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/brain.py", line 107, in _parse_llm_response_for_api_seq
    parsed_data = json.loads(json_str)
  File "/usr/lib/python3.10/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
  File "/usr/lib/python3.10/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
  File "/usr/lib/python3.10/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
2025-03-10 10:07:21,082 - INFO - ========== Method gen_api_seq() returned: seq=[], malicious_sign_seq=[] ==========
2025-03-10 10:07:21,082 - INFO - ========== Method gen_api_seq() returned: seq=[], malicious_sign_seq=[] ==========
2025-03-10 10:07:21,082 - INFO - API sequence 7/12 generated
2025-03-10 10:07:21,082 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-10 10:07:21,082 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-10 10:07:21,435 - ERROR - JSON decoding error: Expecting value: line 1 column 1 (char 0)
Raw response: 
Traceback (most recent call last):
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/brain.py", line 107, in _parse_llm_response_for_api_seq
    parsed_data = json.loads(json_str)
  File "/usr/lib/python3.10/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
  File "/usr/lib/python3.10/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
  File "/usr/lib/python3.10/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
2025-03-10 10:07:21,435 - ERROR - JSON decoding error: Expecting value: line 1 column 1 (char 0)
Raw response: 
Traceback (most recent call last):
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/brain.py", line 107, in _parse_llm_response_for_api_seq
    parsed_data = json.loads(json_str)
  File "/usr/lib/python3.10/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
  File "/usr/lib/python3.10/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
  File "/usr/lib/python3.10/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
2025-03-10 10:07:21,435 - INFO - ========== Method gen_api_seq() returned: seq=[], malicious_sign_seq=[] ==========
2025-03-10 10:07:21,435 - INFO - ========== Method gen_api_seq() returned: seq=[], malicious_sign_seq=[] ==========
2025-03-10 10:07:21,435 - INFO - API sequence 8/12 generated
2025-03-10 10:07:21,436 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-10 10:07:21,436 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-10 10:07:21,771 - ERROR - JSON decoding error: Expecting value: line 1 column 1 (char 0)
Raw response: 
Traceback (most recent call last):
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/brain.py", line 107, in _parse_llm_response_for_api_seq
    parsed_data = json.loads(json_str)
  File "/usr/lib/python3.10/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
  File "/usr/lib/python3.10/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
  File "/usr/lib/python3.10/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
2025-03-10 10:07:21,771 - ERROR - JSON decoding error: Expecting value: line 1 column 1 (char 0)
Raw response: 
Traceback (most recent call last):
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/brain.py", line 107, in _parse_llm_response_for_api_seq
    parsed_data = json.loads(json_str)
  File "/usr/lib/python3.10/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
  File "/usr/lib/python3.10/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
  File "/usr/lib/python3.10/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
2025-03-10 10:07:21,771 - INFO - ========== Method gen_api_seq() returned: seq=[], malicious_sign_seq=[] ==========
2025-03-10 10:07:21,771 - INFO - ========== Method gen_api_seq() returned: seq=[], malicious_sign_seq=[] ==========
2025-03-10 10:07:21,772 - INFO - API sequence 9/12 generated
2025-03-10 10:07:21,772 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 10:07:21,772 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 10:07:22,104 - ERROR - JSON decoding error: Expecting value: line 1 column 1 (char 0)
Raw response: 
Traceback (most recent call last):
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/brain.py", line 107, in _parse_llm_response_for_api_seq
    parsed_data = json.loads(json_str)
  File "/usr/lib/python3.10/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
  File "/usr/lib/python3.10/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
  File "/usr/lib/python3.10/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
2025-03-10 10:07:22,104 - ERROR - JSON decoding error: Expecting value: line 1 column 1 (char 0)
Raw response: 
Traceback (most recent call last):
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/brain.py", line 107, in _parse_llm_response_for_api_seq
    parsed_data = json.loads(json_str)
  File "/usr/lib/python3.10/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
  File "/usr/lib/python3.10/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
  File "/usr/lib/python3.10/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
2025-03-10 10:07:22,104 - INFO - ========== Method gen_api_seq() returned: seq=[], malicious_sign_seq=[] ==========
2025-03-10 10:07:22,104 - INFO - ========== Method gen_api_seq() returned: seq=[], malicious_sign_seq=[] ==========
2025-03-10 10:07:22,105 - INFO - API sequence 10/12 generated
2025-03-10 10:07:22,105 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 10:07:22,105 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 10:07:52,618 - ERROR - JSON decoding error: Expecting value: line 1 column 1 (char 0)
Raw response: thinking failure...
Traceback (most recent call last):
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/brain.py", line 107, in _parse_llm_response_for_api_seq
    parsed_data = json.loads(json_str)
  File "/usr/lib/python3.10/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
  File "/usr/lib/python3.10/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
  File "/usr/lib/python3.10/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
2025-03-10 10:07:52,618 - ERROR - JSON decoding error: Expecting value: line 1 column 1 (char 0)
Raw response: thinking failure...
Traceback (most recent call last):
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/brain.py", line 107, in _parse_llm_response_for_api_seq
    parsed_data = json.loads(json_str)
  File "/usr/lib/python3.10/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
  File "/usr/lib/python3.10/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
  File "/usr/lib/python3.10/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
2025-03-10 10:07:52,619 - INFO - ========== Method gen_api_seq() returned: seq=[], malicious_sign_seq=[] ==========
2025-03-10 10:07:52,619 - INFO - ========== Method gen_api_seq() returned: seq=[], malicious_sign_seq=[] ==========
2025-03-10 10:07:52,619 - INFO - API sequence 11/12 generated
2025-03-10 10:07:52,619 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 10:07:52,619 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 10:08:07,376 - ERROR - JSON decoding error: Expecting value: line 1 column 1 (char 0)
Raw response: 
Traceback (most recent call last):
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/brain.py", line 107, in _parse_llm_response_for_api_seq
    parsed_data = json.loads(json_str)
  File "/usr/lib/python3.10/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
  File "/usr/lib/python3.10/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
  File "/usr/lib/python3.10/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
2025-03-10 10:08:07,376 - ERROR - JSON decoding error: Expecting value: line 1 column 1 (char 0)
Raw response: 
Traceback (most recent call last):
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/brain.py", line 107, in _parse_llm_response_for_api_seq
    parsed_data = json.loads(json_str)
  File "/usr/lib/python3.10/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
  File "/usr/lib/python3.10/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
  File "/usr/lib/python3.10/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
2025-03-10 10:08:07,376 - INFO - ========== Method gen_api_seq() returned: seq=[], malicious_sign_seq=[] ==========
2025-03-10 10:08:07,376 - INFO - ========== Method gen_api_seq() returned: seq=[], malicious_sign_seq=[] ==========
2025-03-10 10:08:07,376 - INFO - API sequence 12/12 generated
2025-03-10 10:08:07,376 - INFO - API sequences serialized to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py/serialized_llm_agents.json
2025-03-10 10:08:07,377 - INFO - Generating simulated traffic data set...
2025-03-10 10:08:07,377 - INFO - Simulated traffic data for 1/12 user collected：user: normaluser malicious: True
2025-03-10 10:08:07,377 - INFO - Simulated traffic data for 2/12 user collected：user: normaluser malicious: False
2025-03-10 10:08:07,377 - INFO - Simulated traffic data for 3/12 user collected：user: adminuser malicious: False
2025-03-10 10:08:07,377 - INFO - Simulated traffic data for 4/12 user collected：user: unloggeduser malicious: True
2025-03-10 10:08:07,377 - INFO - Simulated traffic data for 5/12 user collected：user: normaluser malicious: True
2025-03-10 10:08:07,377 - INFO - Simulated traffic data for 6/12 user collected：user: unloggeduser malicious: True
2025-03-10 10:08:07,377 - INFO - Simulated traffic data for 7/12 user collected：user: unloggeduser malicious: True
2025-03-10 10:08:07,377 - INFO - Simulated traffic data for 8/12 user collected：user: adminuser malicious: False
2025-03-10 10:08:07,377 - INFO - Simulated traffic data for 9/12 user collected：user: normaluser malicious: True
2025-03-10 10:08:07,377 - INFO - Simulated traffic data for 10/12 user collected：user: normaluser malicious: False
2025-03-10 10:08:07,377 - INFO - Simulated traffic data for 11/12 user collected：user: normaluser malicious: False
2025-03-10 10:08:07,377 - INFO - Simulated traffic data for 12/12 user collected：user: normaluser malicious: False
2025-03-10 10:08:07,383 - INFO - All simulated traffic data collected：/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/simulated_traffic_data.csv
Failed attempting 1 times，Error: Failed to request LLM: 429, Error code: Throttling.RateQuota, Error message: Requests rate limit exceeded, please try again later.，Retrying 2 seconds later...
Failed attempting 2 times，Error: Failed to request LLM: 429, Error code: Throttling.RateQuota, Error message: Requests rate limit exceeded, please try again later.，Retrying 4 seconds later...
Failed attempting 3 times，Error: Failed to request LLM: 429, Error code: Throttling.RateQuota, Error message: Requests rate limit exceeded, please try again later.，Retrying 8 seconds later...
Failed attempting 4 times，Error: Failed to request LLM: 429, Error code: Throttling.RateQuota, Error message: Requests rate limit exceeded, please try again later.，Retrying 16 seconds later...
thinking failure...
Failed attempting 1 times，Error: Failed to request LLM: 429, Error code: Throttling.RateQuota, Error message: Requests rate limit exceeded, please try again later.，Retrying 2 seconds later...
Failed attempting 2 times，Error: Failed to request LLM: 429, Error code: Throttling.RateQuota, Error message: Requests rate limit exceeded, please try again later.，Retrying 4 seconds later...
Failed attempting 3 times，Error: Failed to request LLM: 429, Error code: Throttling.RateQuota, Error message: Requests rate limit exceeded, please try again later.，Retrying 8 seconds later...
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-03-10 10:09:21,488 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 6
2025-03-10 10:09:21,927 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-10 10:09:21,976 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-10 10:09:22,008 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-10 10:09:22,008 - INFO - Starting data generation...
2025-03-10 10:09:22,008 - INFO - API_KNOWLEDGE: [{'number': 'API_1709', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_1710', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}]
2025-03-10 10:09:22,008 - INFO - APP_KNOWLEDGE: {'func_description': 'This is an updated test applicationaaa', 'normal_seqs': ['There are no example normal seqs'], 'malicious_seqs': ['There are no example malicious seqs'], 'roles': ['admin', 'ordinary_user', 'unlogged_in_user']}
2025-03-10 10:09:22,307 - INFO - Generating simulated API sequences...
2025-03-10 10:09:22,307 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-10 10:09:22,307 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-10 10:09:23,669 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 10:09:23,674 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-10 10:09:23,674 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-10 10:09:23,675 - INFO - API sequence 1/12 generated
2025-03-10 10:09:23,675 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 10:09:23,675 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 10:09:25,600 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 10:09:25,601 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-10 10:09:25,601 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-10 10:09:25,601 - INFO - API sequence 2/12 generated
2025-03-10 10:09:25,601 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-10 10:09:25,601 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-10 10:09:28,296 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 10:09:28,297 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-10 10:09:28,297 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-10 10:09:28,298 - INFO - API sequence 3/12 generated
2025-03-10 10:09:28,298 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-10 10:09:28,298 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-10 10:09:29,457 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 10:09:29,458 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-10 10:09:29,458 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-10 10:09:29,458 - INFO - API sequence 4/12 generated
2025-03-10 10:09:29,458 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 10:09:29,458 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 10:09:30,537 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 10:09:30,538 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-10 10:09:30,538 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-10 10:09:30,539 - INFO - API sequence 5/12 generated
2025-03-10 10:09:30,539 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-10 10:09:30,539 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-10 10:09:31,868 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 10:09:31,869 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-10 10:09:31,869 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-10 10:09:31,869 - INFO - API sequence 6/12 generated
2025-03-10 10:09:31,869 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-10 10:09:31,869 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-10 10:09:33,488 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 10:09:33,488 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-10 10:09:33,488 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-10 10:09:33,489 - INFO - API sequence 7/12 generated
2025-03-10 10:09:33,489 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 10:09:33,489 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 10:09:35,491 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 10:09:35,492 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-10 10:09:35,492 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-10 10:09:35,492 - INFO - API sequence 8/12 generated
2025-03-10 10:09:35,493 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-10 10:09:35,493 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-10 10:09:37,030 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 10:09:37,031 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-10 10:09:37,031 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-10 10:09:37,031 - INFO - API sequence 9/12 generated
2025-03-10 10:09:37,031 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-10 10:09:37,031 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-10 10:09:38,078 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 10:09:38,079 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-10 10:09:38,079 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-10 10:09:38,079 - INFO - API sequence 10/12 generated
2025-03-10 10:09:38,079 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 10:09:38,079 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 10:09:40,201 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 10:09:40,202 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-10 10:09:40,202 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-10 10:09:40,202 - INFO - API sequence 11/12 generated
2025-03-10 10:09:40,202 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-10 10:09:40,202 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-10 10:09:42,643 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 10:09:42,644 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-10 10:09:42,644 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-10 10:09:42,644 - INFO - API sequence 12/12 generated
2025-03-10 10:09:42,645 - INFO - API sequences serialized to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py/serialized_llm_agents.json
2025-03-10 10:09:42,645 - INFO - Generating simulated traffic data set...
2025-03-10 10:09:42,645 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 10:09:42,645 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 10:09:42,645 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 10:09:42,645 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-10 10:09:42,645 - INFO - Simulated traffic data for 1/12 user collected：user: normaluser malicious: True
2025-03-10 10:09:42,645 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 10:09:42,645 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 10:09:42,646 - INFO - Simulated traffic data for 2/12 user collected：user: normaluser malicious: False
2025-03-10 10:09:42,646 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 10:09:42,646 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 10:09:42,646 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 10:09:42,646 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-10 10:09:42,646 - INFO - Simulated traffic data for 3/12 user collected：user: unloggeduser malicious: True
2025-03-10 10:09:42,646 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 10:09:42,646 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 10:09:42,646 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/memo/21 {}
2025-03-10 10:09:42,646 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-10 10:09:42,646 - INFO - Simulated traffic data for 4/12 user collected：user: unloggeduser malicious: True
2025-03-10 10:09:42,647 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 10:09:42,647 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 10:09:42,647 - INFO - Simulated traffic data for 5/12 user collected：user: normaluser malicious: False
2025-03-10 10:09:42,647 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/resource/16 {}
2025-03-10 10:09:42,647 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 10:09:42,647 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/resource/16 {}
2025-03-10 10:09:42,647 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-10 10:09:42,647 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 10:09:42,647 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：False
2025-03-10 10:09:42,647 - INFO - Simulated traffic data for 6/12 user collected：user: normaluser malicious: True
2025-03-10 10:09:42,647 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 10:09:42,647 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 10:09:42,648 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 10:09:42,648 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-10 10:09:42,648 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 10:09:42,648 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：False
2025-03-10 10:09:42,648 - INFO - Simulated traffic data for 7/12 user collected：user: normaluser malicious: True
2025-03-10 10:09:42,648 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 10:09:42,648 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 10:09:42,648 - INFO - Simulated traffic data for 8/12 user collected：user: normaluser malicious: False
2025-03-10 10:09:42,648 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 10:09:42,648 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 10:09:42,649 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 10:09:42,649 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-10 10:09:42,649 - INFO - Simulated traffic data for 9/12 user collected：user: unloggeduser malicious: True
2025-03-10 10:09:42,649 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 10:09:42,649 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 10:09:42,649 - INFO - Simulated traffic data for 10/12 user collected：user: adminuser malicious: False
2025-03-10 10:09:42,649 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 10:09:42,649 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 10:09:42,649 - INFO - Simulated traffic data for 11/12 user collected：user: normaluser malicious: False
2025-03-10 10:09:42,649 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 10:09:42,649 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 10:09:42,649 - INFO - Simulated traffic data for 12/12 user collected：user: adminuser malicious: False
2025-03-10 10:09:42,652 - INFO - All simulated traffic data collected：/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/simulated_traffic_data.csv
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-03-10 10:11:17,771 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 6
2025-03-10 10:22:25,012 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-10 10:22:25,060 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-10 10:22:25,092 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-10 10:22:25,092 - INFO - Starting data generation...
2025-03-10 10:22:25,092 - INFO - API_KNOWLEDGE: [{'number': 'API_1721', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_1722', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}]
2025-03-10 10:22:25,092 - INFO - APP_KNOWLEDGE: {'func_description': 'This is an updated test applicationaaa', 'normal_seqs': ['Role: admin; API_1721(Call 1); API_1722(Call 2)', 'Role: oridinary_user; API_1721(); API_1722()'], 'malicious_seqs': ['Role: admin; API_1721(); API_1722()', 'Role: ordinary_user; API_1721(); API_1722()'], 'roles': ['admin', 'ordinary_user', 'unlogged_in_user']}
2025-03-10 10:22:25,295 - INFO - Generating simulated API sequences...
2025-03-10 10:22:25,296 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 10:22:25,296 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 10:22:26,719 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 10:22:26,724 - INFO - ========== Method gen_api_seq() returned: seq=['API_1721', 'API_1722'], malicious_sign_seq=[0, 0] ==========
2025-03-10 10:22:26,724 - INFO - ========== Method gen_api_seq() returned: seq=['API_1721', 'API_1722'], malicious_sign_seq=[0, 0] ==========
2025-03-10 10:22:26,724 - INFO - API sequence 1/12 generated
2025-03-10 10:22:26,724 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-10 10:22:26,724 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-10 10:22:29,349 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 10:22:29,350 - INFO - ========== Method gen_api_seq() returned: seq=['API_1721', 'API_1722'], malicious_sign_seq=[0, 1] ==========
2025-03-10 10:22:29,350 - INFO - ========== Method gen_api_seq() returned: seq=['API_1721', 'API_1722'], malicious_sign_seq=[0, 1] ==========
2025-03-10 10:22:29,350 - INFO - API sequence 2/12 generated
2025-03-10 10:22:29,350 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 10:22:29,350 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 10:22:41,508 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 10:22:41,509 - INFO - ========== Method gen_api_seq() returned: seq=['API_1721', 'API_1722'], malicious_sign_seq=[0, 0] ==========
2025-03-10 10:22:41,509 - INFO - ========== Method gen_api_seq() returned: seq=['API_1721', 'API_1722'], malicious_sign_seq=[0, 0] ==========
2025-03-10 10:22:41,509 - INFO - API sequence 3/12 generated
2025-03-10 10:22:41,509 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-10 10:22:41,509 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-10 10:22:44,615 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 10:22:44,616 - INFO - ========== Method gen_api_seq() returned: seq=['API_1721', 'API_1722'], malicious_sign_seq=[0, 0] ==========
2025-03-10 10:22:44,616 - INFO - ========== Method gen_api_seq() returned: seq=['API_1721', 'API_1722'], malicious_sign_seq=[0, 0] ==========
2025-03-10 10:22:44,616 - INFO - API sequence 4/12 generated
2025-03-10 10:22:44,616 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-10 10:22:44,616 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-10 10:22:46,226 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 10:22:46,227 - INFO - ========== Method gen_api_seq() returned: seq=['API_1721', 'API_1722'], malicious_sign_seq=[0, 1] ==========
2025-03-10 10:22:46,227 - INFO - ========== Method gen_api_seq() returned: seq=['API_1721', 'API_1722'], malicious_sign_seq=[0, 1] ==========
2025-03-10 10:22:46,227 - INFO - API sequence 5/12 generated
2025-03-10 10:22:46,228 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 10:22:46,228 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 10:22:47,804 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 10:22:47,805 - INFO - ========== Method gen_api_seq() returned: seq=['API_1721', 'API_1722'], malicious_sign_seq=[0, 0] ==========
2025-03-10 10:22:47,805 - INFO - ========== Method gen_api_seq() returned: seq=['API_1721', 'API_1722'], malicious_sign_seq=[0, 0] ==========
2025-03-10 10:22:47,805 - INFO - API sequence 6/12 generated
2025-03-10 10:22:47,805 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-10 10:22:47,805 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-10 10:22:49,989 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 10:22:49,989 - INFO - ========== Method gen_api_seq() returned: seq=['API_1721', 'API_1722'], malicious_sign_seq=[0, 1] ==========
2025-03-10 10:22:49,989 - INFO - ========== Method gen_api_seq() returned: seq=['API_1721', 'API_1722'], malicious_sign_seq=[0, 1] ==========
2025-03-10 10:22:49,989 - INFO - API sequence 7/12 generated
2025-03-10 10:22:49,990 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-10 10:22:49,990 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-10 10:22:52,382 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 10:22:52,383 - INFO - ========== Method gen_api_seq() returned: seq=['API_1721', 'API_1722'], malicious_sign_seq=[0, 1] ==========
2025-03-10 10:22:52,383 - INFO - ========== Method gen_api_seq() returned: seq=['API_1721', 'API_1722'], malicious_sign_seq=[0, 1] ==========
2025-03-10 10:22:52,383 - INFO - API sequence 8/12 generated
2025-03-10 10:22:52,383 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 10:22:52,383 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 10:22:55,299 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 10:22:55,299 - INFO - ========== Method gen_api_seq() returned: seq=['API_1721', 'API_1722'], malicious_sign_seq=[0, 0] ==========
2025-03-10 10:22:55,299 - INFO - ========== Method gen_api_seq() returned: seq=['API_1721', 'API_1722'], malicious_sign_seq=[0, 0] ==========
2025-03-10 10:22:55,300 - INFO - API sequence 9/12 generated
2025-03-10 10:22:55,300 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-10 10:22:55,300 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-10 10:22:56,635 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 10:22:56,636 - INFO - ========== Method gen_api_seq() returned: seq=['API_1721', 'API_1722'], malicious_sign_seq=[0, 1] ==========
2025-03-10 10:22:56,636 - INFO - ========== Method gen_api_seq() returned: seq=['API_1721', 'API_1722'], malicious_sign_seq=[0, 1] ==========
2025-03-10 10:22:56,636 - INFO - API sequence 10/12 generated
2025-03-10 10:22:56,636 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-10 10:22:56,636 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-10 10:22:59,854 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 10:22:59,855 - INFO - ========== Method gen_api_seq() returned: seq=['API_1721', 'API_1722'], malicious_sign_seq=[0, 1] ==========
2025-03-10 10:22:59,855 - INFO - ========== Method gen_api_seq() returned: seq=['API_1721', 'API_1722'], malicious_sign_seq=[0, 1] ==========
2025-03-10 10:22:59,855 - INFO - API sequence 11/12 generated
2025-03-10 10:22:59,855 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-10 10:22:59,855 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-10 10:23:02,241 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 10:23:02,242 - INFO - ========== Method gen_api_seq() returned: seq=['API_1721', 'API_1722'], malicious_sign_seq=[0, 0] ==========
2025-03-10 10:23:02,242 - INFO - ========== Method gen_api_seq() returned: seq=['API_1721', 'API_1722'], malicious_sign_seq=[0, 0] ==========
2025-03-10 10:23:02,242 - INFO - API sequence 12/12 generated
2025-03-10 10:23:02,243 - INFO - API sequences serialized to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py/serialized_llm_agents.json
2025-03-10 10:23:02,243 - INFO - Generating simulated traffic data set...
2025-03-10 10:23:02,244 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 10:23:02,244 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 10:23:02,245 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 10:23:02,245 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 10:23:02,245 - INFO - Simulated traffic data for 1/12 user collected：user: normaluser malicious: False
2025-03-10 10:23:02,245 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 10:23:02,246 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 10:23:02,246 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 10:23:02,246 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-10 10:23:02,246 - INFO - Simulated traffic data for 2/12 user collected：user: unloggeduser malicious: True
2025-03-10 10:23:02,247 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 10:23:02,247 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 10:23:02,247 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/memo/21 {}
2025-03-10 10:23:02,248 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 10:23:02,248 - INFO - Simulated traffic data for 3/12 user collected：user: normaluser malicious: False
2025-03-10 10:23:02,248 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/resource/16 {}
2025-03-10 10:23:02,249 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 10:23:02,249 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 10:23:02,249 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 10:23:02,250 - INFO - Simulated traffic data for 4/12 user collected：user: adminuser malicious: False
2025-03-10 10:23:02,250 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 10:23:02,250 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 10:23:02,250 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 10:23:02,251 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-10 10:23:02,251 - INFO - Simulated traffic data for 5/12 user collected：user: normaluser malicious: True
2025-03-10 10:23:02,251 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 10:23:02,251 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 10:23:02,252 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 10:23:02,252 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 10:23:02,252 - INFO - Simulated traffic data for 6/12 user collected：user: normaluser malicious: False
2025-03-10 10:23:02,252 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 10:23:02,252 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 10:23:02,252 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 10:23:02,252 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-10 10:23:02,252 - INFO - Simulated traffic data for 7/12 user collected：user: unloggeduser malicious: True
2025-03-10 10:23:02,252 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/resource/16 {}
2025-03-10 10:23:02,252 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 10:23:02,253 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/memo/21 {}
2025-03-10 10:23:02,253 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-10 10:23:02,253 - INFO - Simulated traffic data for 8/12 user collected：user: unloggeduser malicious: True
2025-03-10 10:23:02,253 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 10:23:02,253 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 10:23:02,253 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 10:23:02,253 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 10:23:02,253 - INFO - Simulated traffic data for 9/12 user collected：user: normaluser malicious: False
2025-03-10 10:23:02,253 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 10:23:02,253 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 10:23:02,253 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 10:23:02,254 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-10 10:23:02,254 - INFO - Simulated traffic data for 10/12 user collected：user: normaluser malicious: True
2025-03-10 10:23:02,254 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 10:23:02,254 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 10:23:02,254 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 10:23:02,254 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-10 10:23:02,254 - INFO - Simulated traffic data for 11/12 user collected：user: normaluser malicious: True
2025-03-10 10:23:02,254 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 10:23:02,254 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 10:23:02,254 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 10:23:02,254 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 10:23:02,254 - INFO - Simulated traffic data for 12/12 user collected：user: adminuser malicious: False
2025-03-10 10:23:02,257 - INFO - All simulated traffic data collected：/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/simulated_traffic_data.csv
2025-03-10 10:23:50,647 - INFO - Trying to construct model...
2025-03-10 10:23:50,647 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-10 10:23:50,693 - INFO - Training model... Size of feature_list: 6
2025-03-10 10:23:50,707 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 10:23:50,710 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 10:23:50,711 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 10:23:50,712 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 10:23:50,713 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 10:23:50,714 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 10:23:50,715 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 10:23:50,716 - INFO - Extracting features... Size of feature_list: 6
[10:23:50] WARNING: /workspace/src/learner.cc:740: 
Parameters: { "use_label_encoder" } are not used.

2025-03-10 10:23:50,820 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 10:23:50,821 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 10:23:50,822 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 10:23:50,823 - INFO - Extracting features... Size of feature_list: 6
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
2025-03-10 10:23:50,838 - INFO - Model constructed.
2025-03-10 16:42:20,237 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-10 16:42:20,336 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-10 16:42:20,336 - INFO - Extracting API list with API discovery algorithm...
2025-03-10 16:42:20,401 - INFO - Starting Drain3 template miner
2025-03-10 16:42:20,405 - INFO - Starting Drain3 template miner
2025-03-10 16:42:20,406 - INFO - Starting Drain3 template miner
2025-03-10 16:42:20,407 - INFO - Starting Drain3 template miner
2025-03-10 16:42:20,407 - INFO - Starting Drain3 template miner
2025-03-10 16:42:21,826 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
[2025-03-10 16:42:22,011: ERROR/MainProcess] Received unregistered task of type 'SFWAP.views.handle_api_discovery_notification'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[["1", {"discovered_API_list": [{"function_description": "Please fill in the function description", "permission_info": "Please fill in the permission info", "sample_url": "http://47.97.114.24:5230/api/v1/memo/20", "sample_request_data": {}, "request_method": "GET", "path_segments": [{"name": "api", "is_path_variable": false}, {"name": "v1", "is_path_variable": false}, {"name": "memo", "is_path_variable": false}, {"name": "<NUM>", "is_path_variable": true}], "request_param_list": [], "request_data_fields": []}, {"function_description": "Please fill in the function description", "permission_info": "Please fill in the permission info", "sample_url": "http://47.97.114.24:5230/o/r/15?thumbnail=1", "sample_request_data": {}, "request_method": "GET", "path_segments": [{"name": "o", "is_path_variable": false}, {"name": "r", "is_path_variable": false}, {"name": "<NUM>", "is_path_variable": true}], "request_param_list": [{"name": "thumbnail", "is_necessary": true}], "request_data_fields": []},... (29391b)

The full contents of the message headers:
{'lang': 'py', 'task': 'SFWAP.views.handle_api_discovery_notification', 'id': 'ededf4ca-65a7-46b9-93d9-7358c246219e', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': 'ededf4ca-65a7-46b9-93d9-7358c246219e', 'parent_id': None, 'argsrepr': "('1', {'discovered_API_list': [{...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}]})", 'kwargsrepr': '{}', 'origin': 'gen408589@VM-16-2-ubuntu', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "/home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
KeyError: 'SFWAP.views.handle_api_discovery_notification'
2025-03-10 16:42:39,545 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-10 16:42:39,588 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-10 16:42:39,588 - INFO - Extracting API list with API discovery algorithm...
2025-03-10 16:42:39,649 - INFO - Starting Drain3 template miner
2025-03-10 16:42:39,652 - INFO - Starting Drain3 template miner
2025-03-10 16:42:39,654 - INFO - Starting Drain3 template miner
2025-03-10 16:42:39,655 - INFO - Starting Drain3 template miner
2025-03-10 16:42:39,655 - INFO - Starting Drain3 template miner
2025-03-10 16:42:41,099 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
[2025-03-10 16:42:41,130: ERROR/MainProcess] Received unregistered task of type 'SFWAP.views.handle_api_discovery_notification'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[["1", {"discovered_API_list": [{"function_description": "Please fill in the function description", "permission_info": "Please fill in the permission info", "sample_url": "http://47.97.114.24:5230/api/v1/memo/20", "sample_request_data": {}, "request_method": "GET", "path_segments": [{"name": "api", "is_path_variable": false}, {"name": "v1", "is_path_variable": false}, {"name": "memo", "is_path_variable": false}, {"name": "<NUM>", "is_path_variable": true}], "request_param_list": [], "request_data_fields": []}, {"function_description": "Please fill in the function description", "permission_info": "Please fill in the permission info", "sample_url": "http://47.97.114.24:5230/o/r/15?thumbnail=1", "sample_request_data": {}, "request_method": "GET", "path_segments": [{"name": "o", "is_path_variable": false}, {"name": "r", "is_path_variable": false}, {"name": "<NUM>", "is_path_variable": true}], "request_param_list": [{"name": "thumbnail", "is_necessary": true}], "request_data_fields": []},... (29391b)

The full contents of the message headers:
{'lang': 'py', 'task': 'SFWAP.views.handle_api_discovery_notification', 'id': '3d1eba48-5da5-4926-9d68-16aae411b7b3', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': '3d1eba48-5da5-4926-9d68-16aae411b7b3', 'parent_id': None, 'argsrepr': "('1', {'discovered_API_list': [{...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}]})", 'kwargsrepr': '{}', 'origin': 'gen408589@VM-16-2-ubuntu', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "/home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
KeyError: 'SFWAP.views.handle_api_discovery_notification'
2025-03-10 16:42:49,535 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-10 16:42:49,577 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-10 16:42:49,578 - INFO - Extracting API list with API discovery algorithm...
2025-03-10 16:42:49,638 - INFO - Starting Drain3 template miner
2025-03-10 16:42:49,641 - INFO - Starting Drain3 template miner
2025-03-10 16:42:49,642 - INFO - Starting Drain3 template miner
2025-03-10 16:42:49,643 - INFO - Starting Drain3 template miner
2025-03-10 16:42:49,643 - INFO - Starting Drain3 template miner
2025-03-10 16:42:51,074 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-10 16:43:01,353 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-10 16:43:01,394 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-10 16:43:01,395 - INFO - Extracting API list with API discovery algorithm...
2025-03-10 16:43:01,455 - INFO - Starting Drain3 template miner
2025-03-10 16:43:01,458 - INFO - Starting Drain3 template miner
2025-03-10 16:43:01,459 - INFO - Starting Drain3 template miner
2025-03-10 16:43:01,460 - INFO - Starting Drain3 template miner
2025-03-10 16:43:01,460 - INFO - Starting Drain3 template miner
2025-03-10 16:43:02,913 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-10 16:50:13,368 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-10 16:50:13,412 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-10 16:50:13,465 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-10 16:50:13,465 - INFO - Starting data generation...
2025-03-10 16:50:13,465 - INFO - API_KNOWLEDGE: [{'number': 'API_1837', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_1838', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}]
2025-03-10 16:50:13,465 - INFO - APP_KNOWLEDGE: {'func_description': 'This is an updated test applicationaaa', 'normal_seqs': ['Role: admin; API_1837(Call 1); API_1838(Call 2)', 'Role: oridinary_user; API_1837(); API_1838()'], 'malicious_seqs': ['Role: admin; API_1837(); API_1838()', 'Role: ordinary_user; API_1837(); API_1838()'], 'roles': ['admin', 'ordinary_user', 'unlogged_in_user']}
2025-03-10 16:50:13,515 - INFO - Generating simulated API sequences...
2025-03-10 16:50:13,515 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-10 16:50:13,515 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-10 16:50:13,515 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-10 16:50:15,141 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 16:50:15,159 - INFO - ========== Method gen_api_seq() returned: seq=['API_1837', 'API_1838'], malicious_sign_seq=[0, 1] ==========
2025-03-10 16:50:15,159 - INFO - ========== Method gen_api_seq() returned: seq=['API_1837', 'API_1838'], malicious_sign_seq=[0, 1] ==========
2025-03-10 16:50:15,159 - INFO - ========== Method gen_api_seq() returned: seq=['API_1837', 'API_1838'], malicious_sign_seq=[0, 1] ==========
2025-03-10 16:50:15,160 - INFO - API sequence 1/12 generated
2025-03-10 16:50:15,160 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-10 16:50:15,160 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-10 16:50:15,160 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-10 16:50:16,145 - INFO - Trying to construct model...
2025-03-10 16:50:16,145 - INFO - DATA_COLLECTION_STATUS: IN_PROGRESS
2025-03-10 16:50:16,982 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 16:50:16,983 - INFO - ========== Method gen_api_seq() returned: seq=['API_1837', 'API_1838'], malicious_sign_seq=[0, 0] ==========
2025-03-10 16:50:16,983 - INFO - ========== Method gen_api_seq() returned: seq=['API_1837', 'API_1838'], malicious_sign_seq=[0, 0] ==========
2025-03-10 16:50:16,983 - INFO - ========== Method gen_api_seq() returned: seq=['API_1837', 'API_1838'], malicious_sign_seq=[0, 0] ==========
2025-03-10 16:50:16,983 - INFO - API sequence 2/12 generated
2025-03-10 16:50:16,983 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 16:50:16,983 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 16:50:16,983 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 16:50:19,224 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 16:50:19,224 - INFO - ========== Method gen_api_seq() returned: seq=['API_1837', 'API_1838'], malicious_sign_seq=[0, 0] ==========
2025-03-10 16:50:19,224 - INFO - ========== Method gen_api_seq() returned: seq=['API_1837', 'API_1838'], malicious_sign_seq=[0, 0] ==========
2025-03-10 16:50:19,224 - INFO - ========== Method gen_api_seq() returned: seq=['API_1837', 'API_1838'], malicious_sign_seq=[0, 0] ==========
2025-03-10 16:50:19,225 - INFO - API sequence 3/12 generated
2025-03-10 16:50:19,225 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-10 16:50:19,225 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-10 16:50:19,225 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-10 16:50:24,749 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 16:50:24,750 - INFO - ========== Method gen_api_seq() returned: seq=['API_1837', 'API_1838'], malicious_sign_seq=[0, 1] ==========
2025-03-10 16:50:24,750 - INFO - ========== Method gen_api_seq() returned: seq=['API_1837', 'API_1838'], malicious_sign_seq=[0, 1] ==========
2025-03-10 16:50:24,750 - INFO - ========== Method gen_api_seq() returned: seq=['API_1837', 'API_1838'], malicious_sign_seq=[0, 1] ==========
2025-03-10 16:50:24,751 - INFO - API sequence 4/12 generated
2025-03-10 16:50:24,751 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-10 16:50:24,751 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-10 16:50:24,751 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-10 16:50:27,529 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 16:50:27,530 - INFO - ========== Method gen_api_seq() returned: seq=['API_1837', 'API_1838'], malicious_sign_seq=[0, 1] ==========
2025-03-10 16:50:27,530 - INFO - ========== Method gen_api_seq() returned: seq=['API_1837', 'API_1838'], malicious_sign_seq=[0, 1] ==========
2025-03-10 16:50:27,530 - INFO - ========== Method gen_api_seq() returned: seq=['API_1837', 'API_1838'], malicious_sign_seq=[0, 1] ==========
2025-03-10 16:50:27,530 - INFO - API sequence 5/12 generated
2025-03-10 16:50:27,530 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-10 16:50:27,530 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-10 16:50:27,530 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-10 16:50:32,811 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 16:50:32,812 - INFO - ========== Method gen_api_seq() returned: seq=['API_1837', 'API_1838'], malicious_sign_seq=[0, 1] ==========
2025-03-10 16:50:32,812 - INFO - ========== Method gen_api_seq() returned: seq=['API_1837', 'API_1838'], malicious_sign_seq=[0, 1] ==========
2025-03-10 16:50:32,812 - INFO - ========== Method gen_api_seq() returned: seq=['API_1837', 'API_1838'], malicious_sign_seq=[0, 1] ==========
2025-03-10 16:50:32,812 - INFO - API sequence 6/12 generated
2025-03-10 16:50:32,812 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 16:50:32,812 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 16:50:32,812 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 16:50:36,910 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 16:50:36,911 - INFO - ========== Method gen_api_seq() returned: seq=['API_1837', 'API_1838'], malicious_sign_seq=[0, 0] ==========
2025-03-10 16:50:36,911 - INFO - ========== Method gen_api_seq() returned: seq=['API_1837', 'API_1838'], malicious_sign_seq=[0, 0] ==========
2025-03-10 16:50:36,911 - INFO - ========== Method gen_api_seq() returned: seq=['API_1837', 'API_1838'], malicious_sign_seq=[0, 0] ==========
2025-03-10 16:50:36,911 - INFO - API sequence 7/12 generated
2025-03-10 16:50:36,911 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 16:50:36,911 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 16:50:36,911 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 16:50:39,731 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 16:50:39,732 - INFO - ========== Method gen_api_seq() returned: seq=['API_1837', 'API_1838'], malicious_sign_seq=[0, 0] ==========
2025-03-10 16:50:39,732 - INFO - ========== Method gen_api_seq() returned: seq=['API_1837', 'API_1838'], malicious_sign_seq=[0, 0] ==========
2025-03-10 16:50:39,732 - INFO - ========== Method gen_api_seq() returned: seq=['API_1837', 'API_1838'], malicious_sign_seq=[0, 0] ==========
2025-03-10 16:50:39,732 - INFO - API sequence 8/12 generated
2025-03-10 16:50:39,732 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-10 16:50:39,732 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-10 16:50:39,732 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-10 16:50:41,738 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 16:50:41,739 - INFO - ========== Method gen_api_seq() returned: seq=['API_1837', 'API_1838'], malicious_sign_seq=[0, 1] ==========
2025-03-10 16:50:41,739 - INFO - ========== Method gen_api_seq() returned: seq=['API_1837', 'API_1838'], malicious_sign_seq=[0, 1] ==========
2025-03-10 16:50:41,739 - INFO - ========== Method gen_api_seq() returned: seq=['API_1837', 'API_1838'], malicious_sign_seq=[0, 1] ==========
2025-03-10 16:50:41,739 - INFO - API sequence 9/12 generated
2025-03-10 16:50:41,740 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 16:50:41,740 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 16:50:41,740 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 16:50:44,347 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 16:50:44,347 - INFO - ========== Method gen_api_seq() returned: seq=['API_1837', 'API_1838'], malicious_sign_seq=[0, 0] ==========
2025-03-10 16:50:44,347 - INFO - ========== Method gen_api_seq() returned: seq=['API_1837', 'API_1838'], malicious_sign_seq=[0, 0] ==========
2025-03-10 16:50:44,347 - INFO - ========== Method gen_api_seq() returned: seq=['API_1837', 'API_1838'], malicious_sign_seq=[0, 0] ==========
2025-03-10 16:50:44,348 - INFO - API sequence 10/12 generated
2025-03-10 16:50:44,348 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-10 16:50:44,348 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-10 16:50:44,348 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-10 16:50:47,963 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 16:50:47,964 - INFO - ========== Method gen_api_seq() returned: seq=['API_1837', 'API_1838'], malicious_sign_seq=[0, 0] ==========
2025-03-10 16:50:47,964 - INFO - ========== Method gen_api_seq() returned: seq=['API_1837', 'API_1838'], malicious_sign_seq=[0, 0] ==========
2025-03-10 16:50:47,964 - INFO - ========== Method gen_api_seq() returned: seq=['API_1837', 'API_1838'], malicious_sign_seq=[0, 0] ==========
2025-03-10 16:50:47,964 - INFO - API sequence 11/12 generated
2025-03-10 16:50:47,965 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-10 16:50:47,965 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-10 16:50:47,965 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-10 16:50:52,132 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 16:50:52,133 - INFO - ========== Method gen_api_seq() returned: seq=['API_1837', 'API_1838'], malicious_sign_seq=[0, 1] ==========
2025-03-10 16:50:52,133 - INFO - ========== Method gen_api_seq() returned: seq=['API_1837', 'API_1838'], malicious_sign_seq=[0, 1] ==========
2025-03-10 16:50:52,133 - INFO - ========== Method gen_api_seq() returned: seq=['API_1837', 'API_1838'], malicious_sign_seq=[0, 1] ==========
2025-03-10 16:50:52,134 - INFO - API sequence 12/12 generated
2025-03-10 16:50:52,134 - INFO - API sequences serialized to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py/serialized_llm_agents.json
2025-03-10 16:50:52,134 - INFO - Generating simulated traffic data set...
2025-03-10 16:50:52,137 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 16:50:52,137 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 16:50:52,140 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 16:50:52,140 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-10 16:50:52,140 - INFO - Simulated traffic data for 1/12 user collected：user: normaluser malicious: True
2025-03-10 16:50:52,142 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 16:50:52,142 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 16:50:52,145 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 16:50:52,145 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 16:50:52,145 - INFO - Simulated traffic data for 2/12 user collected：user: adminuser malicious: False
2025-03-10 16:50:52,147 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 16:50:52,147 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 16:50:52,150 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 16:50:52,150 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 16:50:52,150 - INFO - Simulated traffic data for 3/12 user collected：user: normaluser malicious: False
2025-03-10 16:50:52,152 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 16:50:52,152 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 16:50:52,155 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 16:50:52,155 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-10 16:50:52,155 - INFO - Simulated traffic data for 4/12 user collected：user: normaluser malicious: True
2025-03-10 16:50:52,157 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 16:50:52,157 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 16:50:52,160 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/memo/21 {}
2025-03-10 16:50:52,160 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-10 16:50:52,160 - INFO - Simulated traffic data for 5/12 user collected：user: unloggeduser malicious: True
2025-03-10 16:50:52,162 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/resource/16 {}
2025-03-10 16:50:52,162 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 16:50:52,165 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 16:50:52,165 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-10 16:50:52,165 - INFO - Simulated traffic data for 6/12 user collected：user: unloggeduser malicious: True
2025-03-10 16:50:52,167 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 16:50:52,168 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 16:50:52,170 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 16:50:52,170 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 16:50:52,170 - INFO - Simulated traffic data for 7/12 user collected：user: normaluser malicious: False
2025-03-10 16:50:52,172 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 16:50:52,173 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 16:50:52,175 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 16:50:52,175 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 16:50:52,175 - INFO - Simulated traffic data for 8/12 user collected：user: normaluser malicious: False
2025-03-10 16:50:52,177 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 16:50:52,177 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 16:50:52,180 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 16:50:52,180 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-10 16:50:52,180 - INFO - Simulated traffic data for 9/12 user collected：user: unloggeduser malicious: True
2025-03-10 16:50:52,182 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 16:50:52,182 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 16:50:52,185 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 16:50:52,185 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 16:50:52,185 - INFO - Simulated traffic data for 10/12 user collected：user: normaluser malicious: False
2025-03-10 16:50:52,187 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 16:50:52,188 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 16:50:52,190 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 16:50:52,190 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 16:50:52,190 - INFO - Simulated traffic data for 11/12 user collected：user: adminuser malicious: False
2025-03-10 16:50:52,192 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 16:50:52,193 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 16:50:52,195 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 16:50:52,195 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-10 16:50:52,195 - INFO - Simulated traffic data for 12/12 user collected：user: normaluser malicious: True
2025-03-10 16:50:52,202 - INFO - All simulated traffic data collected：/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/simulated_traffic_data.csv
2025-03-10 16:51:11,818 - INFO - Trying to construct model...
2025-03-10 16:51:11,818 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-10 16:51:11,866 - INFO - Training model... Size of feature_list: 6
2025-03-10 16:51:11,883 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 16:51:11,889 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 16:51:11,890 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 16:51:11,891 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 16:51:11,892 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 16:51:11,893 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 16:51:11,895 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 16:51:11,896 - INFO - Extracting features... Size of feature_list: 6
[16:51:11] WARNING: /workspace/src/learner.cc:740: 
Parameters: { "use_label_encoder" } are not used.

2025-03-10 16:51:12,022 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 16:51:12,023 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 16:51:12,024 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 16:51:12,025 - INFO - Extracting features... Size of feature_list: 6
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
2025-03-10 16:51:12,040 - INFO - Model constructed.
2025-03-10 16:51:43,083 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-10 16:51:43,126 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-10 16:51:43,126 - INFO - Extracting API list with API discovery algorithm...
2025-03-10 16:51:43,187 - INFO - Starting Drain3 template miner
2025-03-10 16:51:43,190 - INFO - Starting Drain3 template miner
2025-03-10 16:51:43,191 - INFO - Starting Drain3 template miner
2025-03-10 16:51:43,192 - INFO - Starting Drain3 template miner
2025-03-10 16:51:43,192 - INFO - Starting Drain3 template miner
2025-03-10 16:51:44,669 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-10 16:52:10,958 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-10 16:52:11,012 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-10 16:52:11,012 - INFO - Extracting API list with API discovery algorithm...
2025-03-10 16:52:11,075 - INFO - Starting Drain3 template miner
2025-03-10 16:52:11,078 - INFO - Starting Drain3 template miner
2025-03-10 16:52:11,079 - INFO - Starting Drain3 template miner
2025-03-10 16:52:11,080 - INFO - Starting Drain3 template miner
2025-03-10 16:52:11,080 - INFO - Starting Drain3 template miner
2025-03-10 16:52:12,528 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
[2025-03-10 16:52:12,563: ERROR/MainProcess] Received unregistered task of type 'SFWAP.views.handle_api_discovery_notification'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[["1", {"discovered_API_list": [{"function_description": "Please fill in the function description", "permission_info": "Please fill in the permission info", "sample_url": "http://47.97.114.24:5230/api/v1/memo/20", "sample_request_data": {}, "request_method": "GET", "path_segments": [{"name": "api", "is_path_variable": false}, {"name": "v1", "is_path_variable": false}, {"name": "memo", "is_path_variable": false}, {"name": "<NUM>", "is_path_variable": true}], "request_param_list": [], "request_data_fields": []}, {"function_description": "Please fill in the function description", "permission_info": "Please fill in the permission info", "sample_url": "http://47.97.114.24:5230/o/r/15?thumbnail=1", "sample_request_data": {}, "request_method": "GET", "path_segments": [{"name": "o", "is_path_variable": false}, {"name": "r", "is_path_variable": false}, {"name": "<NUM>", "is_path_variable": true}], "request_param_list": [{"name": "thumbnail", "is_necessary": true}], "request_data_fields": []},... (29391b)

The full contents of the message headers:
{'lang': 'py', 'task': 'SFWAP.views.handle_api_discovery_notification', 'id': '6d873794-f01c-4222-94e0-f1f4145a1f6c', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': '6d873794-f01c-4222-94e0-f1f4145a1f6c', 'parent_id': None, 'argsrepr': "('1', {'discovered_API_list': [{...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}]})", 'kwargsrepr': '{}', 'origin': 'gen408589@VM-16-2-ubuntu', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "/home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
KeyError: 'SFWAP.views.handle_api_discovery_notification'
2025-03-10 16:53:28,045 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-10 16:53:28,088 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-10 16:53:28,088 - INFO - Extracting API list with API discovery algorithm...
2025-03-10 16:53:28,149 - INFO - Starting Drain3 template miner
2025-03-10 16:53:28,152 - INFO - Starting Drain3 template miner
2025-03-10 16:53:28,154 - INFO - Starting Drain3 template miner
2025-03-10 16:53:28,154 - INFO - Starting Drain3 template miner
2025-03-10 16:53:28,155 - INFO - Starting Drain3 template miner
2025-03-10 16:53:29,598 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
[2025-03-10 16:53:29,638: ERROR/MainProcess] Received unregistered task of type 'SFWAP.views.handle_api_discovery_notification'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[["1", {"discovered_API_list": [{"function_description": "Please fill in the function description", "permission_info": "Please fill in the permission info", "sample_url": "http://47.97.114.24:5230/api/v1/memo/20", "sample_request_data": {}, "request_method": "GET", "path_segments": [{"name": "api", "is_path_variable": false}, {"name": "v1", "is_path_variable": false}, {"name": "memo", "is_path_variable": false}, {"name": "<NUM>", "is_path_variable": true}], "request_param_list": [], "request_data_fields": []}, {"function_description": "Please fill in the function description", "permission_info": "Please fill in the permission info", "sample_url": "http://47.97.114.24:5230/o/r/15?thumbnail=1", "sample_request_data": {}, "request_method": "GET", "path_segments": [{"name": "o", "is_path_variable": false}, {"name": "r", "is_path_variable": false}, {"name": "<NUM>", "is_path_variable": true}], "request_param_list": [{"name": "thumbnail", "is_necessary": true}], "request_data_fields": []},... (29391b)

The full contents of the message headers:
{'lang': 'py', 'task': 'SFWAP.views.handle_api_discovery_notification', 'id': 'f4100d43-66ad-4b7f-947a-9d84faa766ca', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': 'f4100d43-66ad-4b7f-947a-9d84faa766ca', 'parent_id': None, 'argsrepr': "('1', {'discovered_API_list': [{...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}]})", 'kwargsrepr': '{}', 'origin': 'gen408589@VM-16-2-ubuntu', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "/home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
KeyError: 'SFWAP.views.handle_api_discovery_notification'
2025-03-10 16:53:30,032 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-10 16:53:30,075 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-10 16:53:30,075 - INFO - Extracting API list with API discovery algorithm...
2025-03-10 16:53:30,135 - INFO - Starting Drain3 template miner
2025-03-10 16:53:30,137 - INFO - Starting Drain3 template miner
2025-03-10 16:53:30,139 - INFO - Starting Drain3 template miner
2025-03-10 16:53:30,140 - INFO - Starting Drain3 template miner
2025-03-10 16:53:30,140 - INFO - Starting Drain3 template miner
2025-03-10 16:53:31,597 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
[2025-03-10 16:53:31,631: ERROR/MainProcess] Received unregistered task of type 'SFWAP.views.handle_api_discovery_notification'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[["1", {"discovered_API_list": [{"function_description": "Please fill in the function description", "permission_info": "Please fill in the permission info", "sample_url": "http://47.97.114.24:5230/api/v1/memo/20", "sample_request_data": {}, "request_method": "GET", "path_segments": [{"name": "api", "is_path_variable": false}, {"name": "v1", "is_path_variable": false}, {"name": "memo", "is_path_variable": false}, {"name": "<NUM>", "is_path_variable": true}], "request_param_list": [], "request_data_fields": []}, {"function_description": "Please fill in the function description", "permission_info": "Please fill in the permission info", "sample_url": "http://47.97.114.24:5230/o/r/15?thumbnail=1", "sample_request_data": {}, "request_method": "GET", "path_segments": [{"name": "o", "is_path_variable": false}, {"name": "r", "is_path_variable": false}, {"name": "<NUM>", "is_path_variable": true}], "request_param_list": [{"name": "thumbnail", "is_necessary": true}], "request_data_fields": []},... (29391b)

The full contents of the message headers:
{'lang': 'py', 'task': 'SFWAP.views.handle_api_discovery_notification', 'id': '90e3a3eb-a307-4432-9d1e-f24fff477239', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': '90e3a3eb-a307-4432-9d1e-f24fff477239', 'parent_id': None, 'argsrepr': "('1', {'discovered_API_list': [{...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}]})", 'kwargsrepr': '{}', 'origin': 'gen408589@VM-16-2-ubuntu', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "/home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
KeyError: 'SFWAP.views.handle_api_discovery_notification'
2025-03-10 16:53:32,624 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-10 16:53:32,672 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-10 16:53:32,672 - INFO - Extracting API list with API discovery algorithm...
2025-03-10 16:53:32,735 - INFO - Starting Drain3 template miner
2025-03-10 16:53:32,739 - INFO - Starting Drain3 template miner
2025-03-10 16:53:32,740 - INFO - Starting Drain3 template miner
2025-03-10 16:53:32,741 - INFO - Starting Drain3 template miner
2025-03-10 16:53:32,742 - INFO - Starting Drain3 template miner
2025-03-10 16:53:34,237 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
[2025-03-10 16:53:34,273: ERROR/MainProcess] Received unregistered task of type 'SFWAP.views.handle_api_discovery_notification'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[["1", {"discovered_API_list": [{"function_description": "Please fill in the function description", "permission_info": "Please fill in the permission info", "sample_url": "http://47.97.114.24:5230/api/v1/memo/20", "sample_request_data": {}, "request_method": "GET", "path_segments": [{"name": "api", "is_path_variable": false}, {"name": "v1", "is_path_variable": false}, {"name": "memo", "is_path_variable": false}, {"name": "<NUM>", "is_path_variable": true}], "request_param_list": [], "request_data_fields": []}, {"function_description": "Please fill in the function description", "permission_info": "Please fill in the permission info", "sample_url": "http://47.97.114.24:5230/o/r/15?thumbnail=1", "sample_request_data": {}, "request_method": "GET", "path_segments": [{"name": "o", "is_path_variable": false}, {"name": "r", "is_path_variable": false}, {"name": "<NUM>", "is_path_variable": true}], "request_param_list": [{"name": "thumbnail", "is_necessary": true}], "request_data_fields": []},... (29391b)

The full contents of the message headers:
{'lang': 'py', 'task': 'SFWAP.views.handle_api_discovery_notification', 'id': '8dae7b4d-aa2c-453a-9130-6884c3c671cc', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': '8dae7b4d-aa2c-453a-9130-6884c3c671cc', 'parent_id': None, 'argsrepr': "('1', {'discovered_API_list': [{...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}]})", 'kwargsrepr': '{}', 'origin': 'gen408589@VM-16-2-ubuntu', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "/home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
KeyError: 'SFWAP.views.handle_api_discovery_notification'
2025-03-10 16:53:34,775 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-10 16:53:34,817 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-10 16:53:34,817 - INFO - Extracting API list with API discovery algorithm...
2025-03-10 16:53:34,878 - INFO - Starting Drain3 template miner
2025-03-10 16:53:34,880 - INFO - Starting Drain3 template miner
2025-03-10 16:53:34,882 - INFO - Starting Drain3 template miner
2025-03-10 16:53:34,882 - INFO - Starting Drain3 template miner
2025-03-10 16:53:34,883 - INFO - Starting Drain3 template miner
2025-03-10 16:53:36,363 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-10 16:55:52,077 - INFO - Trying to construct model...
2025-03-10 16:55:52,077 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-10 16:55:52,108 - INFO - Training model... Size of feature_list: 6
2025-03-10 16:55:52,119 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 16:55:52,120 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 16:55:52,121 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 16:55:52,122 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 16:55:52,123 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 16:55:52,124 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 16:55:52,125 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 16:55:52,127 - INFO - Extracting features... Size of feature_list: 6
[16:55:52] WARNING: /workspace/src/learner.cc:740: 
Parameters: { "use_label_encoder" } are not used.

2025-03-10 16:55:52,167 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 16:55:52,168 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 16:55:52,169 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 16:55:52,170 - INFO - Extracting features... Size of feature_list: 6
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
2025-03-10 16:55:52,181 - INFO - Model constructed.
2025-03-10 17:09:18,945 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-10 17:09:18,988 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-10 17:09:19,075 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-10 17:09:19,075 - INFO - Starting data generation...
2025-03-10 17:09:19,075 - INFO - API_KNOWLEDGE: [{'number': 'API_1953', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_1954', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}]
2025-03-10 17:09:19,075 - INFO - APP_KNOWLEDGE: {'func_description': 'This is an updated test applicationaaa', 'normal_seqs': ['Role: admin; API_1953(Call 1); API_1954(Call 2)', 'Role: oridinary_user; API_1953(); API_1954()'], 'malicious_seqs': ['Role: admin; API_1953(); API_1954()', 'Role: ordinary_user; API_1953(); API_1954()'], 'roles': ['admin', 'ordinary_user', 'unlogged_in_user']}
2025-03-10 17:09:19,125 - INFO - Generating simulated API sequences...
2025-03-10 17:09:19,125 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-10 17:09:19,125 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-10 17:09:19,125 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-10 17:09:19,125 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-10 17:09:22,088 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 17:09:22,089 - INFO - ========== Method gen_api_seq() returned: seq=['API_1953', 'API_1954'], malicious_sign_seq=[0, 1] ==========
2025-03-10 17:09:22,089 - INFO - ========== Method gen_api_seq() returned: seq=['API_1953', 'API_1954'], malicious_sign_seq=[0, 1] ==========
2025-03-10 17:09:22,089 - INFO - ========== Method gen_api_seq() returned: seq=['API_1953', 'API_1954'], malicious_sign_seq=[0, 1] ==========
2025-03-10 17:09:22,089 - INFO - ========== Method gen_api_seq() returned: seq=['API_1953', 'API_1954'], malicious_sign_seq=[0, 1] ==========
2025-03-10 17:09:22,089 - INFO - API sequence 1/12 generated
2025-03-10 17:09:22,089 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-10 17:09:22,089 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-10 17:09:22,089 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-10 17:09:22,089 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-10 17:09:25,896 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 17:09:25,897 - INFO - ========== Method gen_api_seq() returned: seq=['API_1953', 'API_1954'], malicious_sign_seq=[0, 1] ==========
2025-03-10 17:09:25,897 - INFO - ========== Method gen_api_seq() returned: seq=['API_1953', 'API_1954'], malicious_sign_seq=[0, 1] ==========
2025-03-10 17:09:25,897 - INFO - ========== Method gen_api_seq() returned: seq=['API_1953', 'API_1954'], malicious_sign_seq=[0, 1] ==========
2025-03-10 17:09:25,897 - INFO - ========== Method gen_api_seq() returned: seq=['API_1953', 'API_1954'], malicious_sign_seq=[0, 1] ==========
2025-03-10 17:09:25,897 - INFO - API sequence 2/12 generated
2025-03-10 17:09:25,897 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 17:09:25,897 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 17:09:25,897 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 17:09:25,897 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 17:09:29,113 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 17:09:29,114 - INFO - ========== Method gen_api_seq() returned: seq=['API_1953', 'API_1954'], malicious_sign_seq=[0, 0] ==========
2025-03-10 17:09:29,114 - INFO - ========== Method gen_api_seq() returned: seq=['API_1953', 'API_1954'], malicious_sign_seq=[0, 0] ==========
2025-03-10 17:09:29,114 - INFO - ========== Method gen_api_seq() returned: seq=['API_1953', 'API_1954'], malicious_sign_seq=[0, 0] ==========
2025-03-10 17:09:29,114 - INFO - ========== Method gen_api_seq() returned: seq=['API_1953', 'API_1954'], malicious_sign_seq=[0, 0] ==========
2025-03-10 17:09:29,114 - INFO - API sequence 3/12 generated
2025-03-10 17:09:29,114 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-10 17:09:29,114 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-10 17:09:29,114 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-10 17:09:29,114 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-10 17:09:32,411 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 17:09:32,411 - INFO - ========== Method gen_api_seq() returned: seq=['API_1953', 'API_1954'], malicious_sign_seq=[0, 0] ==========
2025-03-10 17:09:32,411 - INFO - ========== Method gen_api_seq() returned: seq=['API_1953', 'API_1954'], malicious_sign_seq=[0, 0] ==========
2025-03-10 17:09:32,411 - INFO - ========== Method gen_api_seq() returned: seq=['API_1953', 'API_1954'], malicious_sign_seq=[0, 0] ==========
2025-03-10 17:09:32,411 - INFO - ========== Method gen_api_seq() returned: seq=['API_1953', 'API_1954'], malicious_sign_seq=[0, 0] ==========
2025-03-10 17:09:32,412 - INFO - API sequence 4/12 generated
2025-03-10 17:09:32,412 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-10 17:09:32,412 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-10 17:09:32,412 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-10 17:09:32,412 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-10 17:09:36,177 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 17:09:36,178 - INFO - ========== Method gen_api_seq() returned: seq=['API_1953', 'API_1954'], malicious_sign_seq=[0, 0] ==========
2025-03-10 17:09:36,178 - INFO - ========== Method gen_api_seq() returned: seq=['API_1953', 'API_1954'], malicious_sign_seq=[0, 0] ==========
2025-03-10 17:09:36,178 - INFO - ========== Method gen_api_seq() returned: seq=['API_1953', 'API_1954'], malicious_sign_seq=[0, 0] ==========
2025-03-10 17:09:36,178 - INFO - ========== Method gen_api_seq() returned: seq=['API_1953', 'API_1954'], malicious_sign_seq=[0, 0] ==========
2025-03-10 17:09:36,179 - INFO - API sequence 5/12 generated
2025-03-10 17:09:36,179 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-10 17:09:36,179 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-10 17:09:36,179 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-10 17:09:36,179 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-10 17:09:39,440 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 17:09:39,441 - INFO - ========== Method gen_api_seq() returned: seq=['API_1953', 'API_1954'], malicious_sign_seq=[0, 1] ==========
2025-03-10 17:09:39,441 - INFO - ========== Method gen_api_seq() returned: seq=['API_1953', 'API_1954'], malicious_sign_seq=[0, 1] ==========
2025-03-10 17:09:39,441 - INFO - ========== Method gen_api_seq() returned: seq=['API_1953', 'API_1954'], malicious_sign_seq=[0, 1] ==========
2025-03-10 17:09:39,441 - INFO - ========== Method gen_api_seq() returned: seq=['API_1953', 'API_1954'], malicious_sign_seq=[0, 1] ==========
2025-03-10 17:09:39,441 - INFO - API sequence 6/12 generated
2025-03-10 17:09:39,441 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 17:09:39,441 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 17:09:39,441 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 17:09:39,441 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 17:09:41,191 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 17:09:41,192 - INFO - ========== Method gen_api_seq() returned: seq=['API_1953', 'API_1954'], malicious_sign_seq=[0, 0] ==========
2025-03-10 17:09:41,192 - INFO - ========== Method gen_api_seq() returned: seq=['API_1953', 'API_1954'], malicious_sign_seq=[0, 0] ==========
2025-03-10 17:09:41,192 - INFO - ========== Method gen_api_seq() returned: seq=['API_1953', 'API_1954'], malicious_sign_seq=[0, 0] ==========
2025-03-10 17:09:41,192 - INFO - ========== Method gen_api_seq() returned: seq=['API_1953', 'API_1954'], malicious_sign_seq=[0, 0] ==========
2025-03-10 17:09:41,192 - INFO - API sequence 7/12 generated
2025-03-10 17:09:41,192 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 17:09:41,192 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 17:09:41,192 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 17:09:41,192 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 17:09:43,864 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 17:09:43,865 - INFO - ========== Method gen_api_seq() returned: seq=['API_1953', 'API_1954'], malicious_sign_seq=[0, 0] ==========
2025-03-10 17:09:43,865 - INFO - ========== Method gen_api_seq() returned: seq=['API_1953', 'API_1954'], malicious_sign_seq=[0, 0] ==========
2025-03-10 17:09:43,865 - INFO - ========== Method gen_api_seq() returned: seq=['API_1953', 'API_1954'], malicious_sign_seq=[0, 0] ==========
2025-03-10 17:09:43,865 - INFO - ========== Method gen_api_seq() returned: seq=['API_1953', 'API_1954'], malicious_sign_seq=[0, 0] ==========
2025-03-10 17:09:43,865 - INFO - API sequence 8/12 generated
2025-03-10 17:09:43,865 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-10 17:09:43,865 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-10 17:09:43,865 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-10 17:09:43,865 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-10 17:09:45,749 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 17:09:45,750 - INFO - ========== Method gen_api_seq() returned: seq=['API_1953', 'API_1954'], malicious_sign_seq=[0, 1] ==========
2025-03-10 17:09:45,750 - INFO - ========== Method gen_api_seq() returned: seq=['API_1953', 'API_1954'], malicious_sign_seq=[0, 1] ==========
2025-03-10 17:09:45,750 - INFO - ========== Method gen_api_seq() returned: seq=['API_1953', 'API_1954'], malicious_sign_seq=[0, 1] ==========
2025-03-10 17:09:45,750 - INFO - ========== Method gen_api_seq() returned: seq=['API_1953', 'API_1954'], malicious_sign_seq=[0, 1] ==========
2025-03-10 17:09:45,750 - INFO - API sequence 9/12 generated
2025-03-10 17:09:45,750 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-10 17:09:45,750 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-10 17:09:45,750 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-10 17:09:45,750 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-10 17:09:49,317 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 17:09:49,317 - INFO - ========== Method gen_api_seq() returned: seq=['API_1953', 'API_1954'], malicious_sign_seq=[0, 1] ==========
2025-03-10 17:09:49,317 - INFO - ========== Method gen_api_seq() returned: seq=['API_1953', 'API_1954'], malicious_sign_seq=[0, 1] ==========
2025-03-10 17:09:49,317 - INFO - ========== Method gen_api_seq() returned: seq=['API_1953', 'API_1954'], malicious_sign_seq=[0, 1] ==========
2025-03-10 17:09:49,317 - INFO - ========== Method gen_api_seq() returned: seq=['API_1953', 'API_1954'], malicious_sign_seq=[0, 1] ==========
2025-03-10 17:09:49,318 - INFO - API sequence 10/12 generated
2025-03-10 17:09:49,318 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 17:09:49,318 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 17:09:49,318 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 17:09:49,318 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-10 17:09:51,190 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 17:09:51,191 - INFO - ========== Method gen_api_seq() returned: seq=['API_1953', 'API_1954'], malicious_sign_seq=[0, 0] ==========
2025-03-10 17:09:51,191 - INFO - ========== Method gen_api_seq() returned: seq=['API_1953', 'API_1954'], malicious_sign_seq=[0, 0] ==========
2025-03-10 17:09:51,191 - INFO - ========== Method gen_api_seq() returned: seq=['API_1953', 'API_1954'], malicious_sign_seq=[0, 0] ==========
2025-03-10 17:09:51,191 - INFO - ========== Method gen_api_seq() returned: seq=['API_1953', 'API_1954'], malicious_sign_seq=[0, 0] ==========
2025-03-10 17:09:51,191 - INFO - API sequence 11/12 generated
2025-03-10 17:09:51,191 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-10 17:09:51,191 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-10 17:09:51,191 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-10 17:09:51,191 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-10 17:09:54,040 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-10 17:09:54,041 - INFO - ========== Method gen_api_seq() returned: seq=['API_1953', 'API_1954'], malicious_sign_seq=[0, 1] ==========
2025-03-10 17:09:54,041 - INFO - ========== Method gen_api_seq() returned: seq=['API_1953', 'API_1954'], malicious_sign_seq=[0, 1] ==========
2025-03-10 17:09:54,041 - INFO - ========== Method gen_api_seq() returned: seq=['API_1953', 'API_1954'], malicious_sign_seq=[0, 1] ==========
2025-03-10 17:09:54,041 - INFO - ========== Method gen_api_seq() returned: seq=['API_1953', 'API_1954'], malicious_sign_seq=[0, 1] ==========
2025-03-10 17:09:54,041 - INFO - API sequence 12/12 generated
2025-03-10 17:09:54,042 - INFO - API sequences serialized to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py/serialized_llm_agents.json
2025-03-10 17:09:54,042 - INFO - Generating simulated traffic data set...
2025-03-10 17:09:54,049 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 17:09:54,049 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 17:09:54,055 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 17:09:54,055 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-10 17:09:54,055 - INFO - Simulated traffic data for 1/12 user collected：user: normaluser malicious: True
2025-03-10 17:09:54,061 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/resource/16 {}
2025-03-10 17:09:54,061 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 17:09:54,066 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 17:09:54,066 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-10 17:09:54,067 - INFO - Simulated traffic data for 2/12 user collected：user: unloggeduser malicious: True
2025-03-10 17:09:54,072 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 17:09:54,072 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 17:09:54,078 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 17:09:54,078 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 17:09:54,078 - INFO - Simulated traffic data for 3/12 user collected：user: normaluser malicious: False
2025-03-10 17:09:54,085 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 17:09:54,085 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 17:09:54,090 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 17:09:54,091 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 17:09:54,091 - INFO - Simulated traffic data for 4/12 user collected：user: adminuser malicious: False
2025-03-10 17:09:54,096 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 17:09:54,096 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 17:09:54,102 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 17:09:54,102 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 17:09:54,102 - INFO - Simulated traffic data for 5/12 user collected：user: adminuser malicious: False
2025-03-10 17:09:54,108 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 17:09:54,108 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 17:09:54,114 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 17:09:54,114 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-10 17:09:54,114 - INFO - Simulated traffic data for 6/12 user collected：user: normaluser malicious: True
2025-03-10 17:09:54,120 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 17:09:54,120 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 17:09:54,126 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 17:09:54,126 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 17:09:54,126 - INFO - Simulated traffic data for 7/12 user collected：user: normaluser malicious: False
2025-03-10 17:09:54,132 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 17:09:54,132 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 17:09:54,138 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 17:09:54,138 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 17:09:54,138 - INFO - Simulated traffic data for 8/12 user collected：user: normaluser malicious: False
2025-03-10 17:09:54,144 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 17:09:54,144 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 17:09:54,149 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 17:09:54,150 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-10 17:09:54,150 - INFO - Simulated traffic data for 9/12 user collected：user: normaluser malicious: True
2025-03-10 17:09:54,155 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 17:09:54,155 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 17:09:54,161 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 17:09:54,161 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-10 17:09:54,161 - INFO - Simulated traffic data for 10/12 user collected：user: unloggeduser malicious: True
2025-03-10 17:09:54,167 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 17:09:54,167 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 17:09:54,173 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 17:09:54,173 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 17:09:54,173 - INFO - Simulated traffic data for 11/12 user collected：user: normaluser malicious: False
2025-03-10 17:09:54,377 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-10 17:09:54,377 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-10 17:09:54,383 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-10 17:09:54,383 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-10 17:09:54,383 - INFO - Simulated traffic data for 12/12 user collected：user: unloggeduser malicious: True
2025-03-10 17:09:54,386 - INFO - All simulated traffic data collected：/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/simulated_traffic_data.csv
2025-03-10 23:53:42,290 - INFO - Trying to construct model...
2025-03-10 23:53:42,291 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-10 23:53:42,322 - INFO - Training model... Size of feature_list: 6
2025-03-10 23:53:42,332 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 23:53:42,333 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 23:53:42,334 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 23:53:42,335 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 23:53:42,336 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 23:53:42,337 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 23:53:42,338 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 23:53:42,339 - INFO - Extracting features... Size of feature_list: 6
[23:53:42] WARNING: /workspace/src/learner.cc:740: 
Parameters: { "use_label_encoder" } are not used.

2025-03-10 23:53:42,369 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 23:53:42,371 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 23:53:42,372 - INFO - Extracting features... Size of feature_list: 6
2025-03-10 23:53:42,373 - INFO - Extracting features... Size of feature_list: 6
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
2025-03-10 23:53:42,383 - INFO - Model constructed.
2025-03-11 00:20:35,724 - INFO - Detection started. Combined data duration: 10
2025-03-11 00:44:59,705 - INFO - Detection paused.
2025-03-11 00:57:17,554 - INFO - Detection started. Combined data duration: 10
2025-03-11 00:57:18,786 - INFO - Detection paused.
2025-03-11 00:57:19,410 - INFO - Detection started. Combined data duration: 10
2025-03-11 00:57:19,988 - INFO - Detection paused.
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-03-11 10:44:55,533 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 6
2025-03-11 10:50:23,728 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-11 10:50:23,794 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-11 10:50:23,794 - INFO - Extracting API list with API discovery algorithm...
2025-03-11 10:50:23,860 - INFO - Starting Drain3 template miner
2025-03-11 10:50:23,863 - INFO - Starting Drain3 template miner
2025-03-11 10:50:23,864 - INFO - Starting Drain3 template miner
2025-03-11 10:50:23,865 - INFO - Starting Drain3 template miner
2025-03-11 10:50:23,865 - INFO - Starting Drain3 template miner
2025-03-11 10:50:25,295 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-03-11 17:26:20,738 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 6
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-03-12 08:52:50,756 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 6
 
 -------------- celery@VM-16-2-ubuntu v5.4.0 (opalescent)
--- ***** ----- 
-- ******* ---- Linux-5.15.0-130-generic-x86_64-with-glibc2.35 2025-03-12 15:05:44
- *** --- * --- 
- ** ---------- [config]
- ** ---------- .> app:         tasks:0x7f8a5035ffa0
- ** ---------- .> transport:   redis://localhost:6379/0
- ** ---------- .> results:     disabled://
- *** --- * --- .> concurrency: 2 (prefork)
-- ******* ---- .> task events: OFF (enable -E to monitor tasks in this worker)
--- ***** ----- 
 -------------- [queues]
                .> celery           exchange=celery(direct) key=celery
                

[tasks]
  . traffic_collector.consume_traffic_periodically

[2025-03-12 15:05:44,677: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

[2025-03-12 15:05:44,682: INFO/MainProcess] Connected to redis://localhost:6379/0
[2025-03-12 15:05:44,683: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

[2025-03-12 15:05:44,684: INFO/MainProcess] mingle: searching for neighbors
[2025-03-12 15:05:45,698: INFO/MainProcess] mingle: all alone
[2025-03-12 15:05:45,709: INFO/MainProcess] celery@VM-16-2-ubuntu ready.
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-03-12 15:05:46,212 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 5
 * Serving Flask app 'app'
 * Debug mode: on
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-03-12 15:05:48,054 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 5
2025-03-12 15:07:23,533 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-12 15:07:23,613 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-12 15:07:23,613 - INFO - Extracting API list with API discovery algorithm...
2025-03-12 15:07:23,678 - INFO - Starting Drain3 template miner
2025-03-12 15:07:23,681 - INFO - Starting Drain3 template miner
2025-03-12 15:07:23,683 - INFO - Starting Drain3 template miner
2025-03-12 15:07:23,683 - INFO - Starting Drain3 template miner
2025-03-12 15:07:23,684 - INFO - Starting Drain3 template miner
2025-03-12 15:07:25,107 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-12 15:07:25,273 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-12 15:07:25,344 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-12 15:07:25,344 - INFO - Extracting API list with API discovery algorithm...
2025-03-12 15:07:25,424 - INFO - Starting Drain3 template miner
2025-03-12 15:07:25,427 - INFO - Starting Drain3 template miner
2025-03-12 15:07:25,429 - INFO - Starting Drain3 template miner
2025-03-12 15:07:25,429 - INFO - Starting Drain3 template miner
2025-03-12 15:07:25,430 - INFO - Starting Drain3 template miner
2025-03-12 15:07:26,930 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
[2025-03-12 15:07:26,961: ERROR/MainProcess] Received unregistered task of type 'SFWAP.views.handle_api_discovery_notification'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[["1", {"discovered_API_list": [{"function_description": "Please fill in the function description", "permission_info": "Please fill in the permission info", "sample_url": "http://47.97.114.24:5230/api/v1/memo/20", "sample_request_data": {}, "request_method": "GET", "path_segments": [{"name": "api", "is_path_variable": false}, {"name": "v1", "is_path_variable": false}, {"name": "memo", "is_path_variable": false}, {"name": "<NUM>", "is_path_variable": true}], "request_param_list": [], "request_data_fields": []}, {"function_description": "Please fill in the function description", "permission_info": "Please fill in the permission info", "sample_url": "http://47.97.114.24:5230/o/r/15?thumbnail=1", "sample_request_data": {}, "request_method": "GET", "path_segments": [{"name": "o", "is_path_variable": false}, {"name": "r", "is_path_variable": false}, {"name": "<NUM>", "is_path_variable": true}], "request_param_list": [{"name": "thumbnail", "is_necessary": true}], "request_data_fields": []},... (29391b)

The full contents of the message headers:
{'lang': 'py', 'task': 'SFWAP.views.handle_api_discovery_notification', 'id': '5f49c569-7e42-4234-8cc2-5caa0bf8fee3', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': '5f49c569-7e42-4234-8cc2-5caa0bf8fee3', 'parent_id': None, 'argsrepr': "('1', {'discovered_API_list': [{...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}]})", 'kwargsrepr': '{}', 'origin': 'gen7291@VM-16-2-ubuntu', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "/home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
KeyError: 'SFWAP.views.handle_api_discovery_notification'
2025-03-12 15:07:28,047 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-12 15:07:28,091 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-12 15:07:28,091 - INFO - Extracting API list with API discovery algorithm...
2025-03-12 15:07:28,150 - INFO - Starting Drain3 template miner
2025-03-12 15:07:28,153 - INFO - Starting Drain3 template miner
2025-03-12 15:07:28,155 - INFO - Starting Drain3 template miner
2025-03-12 15:07:28,155 - INFO - Starting Drain3 template miner
2025-03-12 15:07:28,156 - INFO - Starting Drain3 template miner
2025-03-12 15:07:29,585 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
[2025-03-12 15:07:29,694: ERROR/MainProcess] Received unregistered task of type 'SFWAP.views.handle_api_discovery_notification'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[["1", {"discovered_API_list": [{"function_description": "Please fill in the function description", "permission_info": "Please fill in the permission info", "sample_url": "http://47.97.114.24:5230/api/v1/memo/20", "sample_request_data": {}, "request_method": "GET", "path_segments": [{"name": "api", "is_path_variable": false}, {"name": "v1", "is_path_variable": false}, {"name": "memo", "is_path_variable": false}, {"name": "<NUM>", "is_path_variable": true}], "request_param_list": [], "request_data_fields": []}, {"function_description": "Please fill in the function description", "permission_info": "Please fill in the permission info", "sample_url": "http://47.97.114.24:5230/o/r/15?thumbnail=1", "sample_request_data": {}, "request_method": "GET", "path_segments": [{"name": "o", "is_path_variable": false}, {"name": "r", "is_path_variable": false}, {"name": "<NUM>", "is_path_variable": true}], "request_param_list": [{"name": "thumbnail", "is_necessary": true}], "request_data_fields": []},... (29391b)

The full contents of the message headers:
{'lang': 'py', 'task': 'SFWAP.views.handle_api_discovery_notification', 'id': '2d971ab8-ed55-4d99-89d7-ade3d142a17c', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': '2d971ab8-ed55-4d99-89d7-ade3d142a17c', 'parent_id': None, 'argsrepr': "('1', {'discovered_API_list': [{...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}]})", 'kwargsrepr': '{}', 'origin': 'gen7291@VM-16-2-ubuntu', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "/home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
KeyError: 'SFWAP.views.handle_api_discovery_notification'
2025-03-12 15:08:34,944 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-12 15:08:34,986 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-12 15:08:34,986 - INFO - Extracting API list with API discovery algorithm...
2025-03-12 15:08:35,045 - INFO - Starting Drain3 template miner
2025-03-12 15:08:35,047 - INFO - Starting Drain3 template miner
2025-03-12 15:08:35,049 - INFO - Starting Drain3 template miner
2025-03-12 15:08:35,050 - INFO - Starting Drain3 template miner
2025-03-12 15:08:35,050 - INFO - Starting Drain3 template miner
2025-03-12 15:08:36,493 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-12 15:09:50,550 - INFO - Detection started. Combined data duration: 10
2025-03-12 15:09:52,232 - INFO - Detection paused.
2025-03-12 17:45:25,529 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-12 17:45:25,710 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-12 17:45:25,711 - INFO - Extracting API list with API discovery algorithm...
2025-03-12 17:45:25,776 - INFO - Starting Drain3 template miner
2025-03-12 17:45:25,779 - INFO - Starting Drain3 template miner
2025-03-12 17:45:25,780 - INFO - Starting Drain3 template miner
2025-03-12 17:45:25,781 - INFO - Starting Drain3 template miner
2025-03-12 17:45:25,781 - INFO - Starting Drain3 template miner
2025-03-12 17:45:27,222 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-13 11:33:18,365 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-13 11:33:18,406 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-13 11:33:18,406 - INFO - Extracting API list with API discovery algorithm...
2025-03-13 11:33:18,465 - INFO - Starting Drain3 template miner
2025-03-13 11:33:18,467 - INFO - Starting Drain3 template miner
2025-03-13 11:33:18,469 - INFO - Starting Drain3 template miner
2025-03-13 11:33:18,469 - INFO - Starting Drain3 template miner
2025-03-13 11:33:18,470 - INFO - Starting Drain3 template miner
2025-03-13 11:33:19,911 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
[2025-03-13 11:33:20,119: ERROR/MainProcess] Received unregistered task of type 'SFWAP.views.handle_api_discovery_notification'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[["1", {"discovered_API_list": [{"function_description": "Please fill in the function description", "permission_info": "Please fill in the permission info", "sample_url": "http://47.97.114.24:5230/api/v1/memo/20", "sample_request_data": {}, "request_method": "GET", "path_segments": [{"name": "api", "is_path_variable": false}, {"name": "v1", "is_path_variable": false}, {"name": "memo", "is_path_variable": false}, {"name": "<NUM>", "is_path_variable": true}], "request_param_list": [], "request_data_fields": []}, {"function_description": "Please fill in the function description", "permission_info": "Please fill in the permission info", "sample_url": "http://47.97.114.24:5230/o/r/15?thumbnail=1", "sample_request_data": {}, "request_method": "GET", "path_segments": [{"name": "o", "is_path_variable": false}, {"name": "r", "is_path_variable": false}, {"name": "<NUM>", "is_path_variable": true}], "request_param_list": [{"name": "thumbnail", "is_necessary": true}], "request_data_fields": []},... (29391b)

The full contents of the message headers:
{'lang': 'py', 'task': 'SFWAP.views.handle_api_discovery_notification', 'id': '51f2c96e-dd00-49c5-b662-459ce996fc0b', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': '51f2c96e-dd00-49c5-b662-459ce996fc0b', 'parent_id': None, 'argsrepr': "('1', {'discovered_API_list': [{...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}]})", 'kwargsrepr': '{}', 'origin': 'gen23678@VM-16-2-ubuntu', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "/home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
KeyError: 'SFWAP.views.handle_api_discovery_notification'
2025-03-13 11:34:51,363 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-13 11:34:51,400 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-13 11:34:51,400 - INFO - Extracting API list with API discovery algorithm...
2025-03-13 11:34:51,460 - INFO - Starting Drain3 template miner
2025-03-13 11:34:51,463 - INFO - Starting Drain3 template miner
2025-03-13 11:34:51,464 - INFO - Starting Drain3 template miner
2025-03-13 11:34:51,465 - INFO - Starting Drain3 template miner
2025-03-13 11:34:51,465 - INFO - Starting Drain3 template miner
2025-03-13 11:34:52,894 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-13 11:38:58,582 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-13 11:38:58,628 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-13 11:38:58,629 - INFO - Extracting API list with API discovery algorithm...
2025-03-13 11:38:58,688 - INFO - Starting Drain3 template miner
2025-03-13 11:38:58,691 - INFO - Starting Drain3 template miner
2025-03-13 11:38:58,692 - INFO - Starting Drain3 template miner
2025-03-13 11:38:58,693 - INFO - Starting Drain3 template miner
2025-03-13 11:38:58,693 - INFO - Starting Drain3 template miner
2025-03-13 11:39:00,170 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
[2025-03-13 11:39:00,253: ERROR/MainProcess] Received unregistered task of type 'SFWAP.views.handle_api_discovery_notification'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[["1", {"discovered_API_list": [{"function_description": "Please fill in the function description", "permission_info": "Please fill in the permission info", "sample_url": "http://47.97.114.24:5230/api/v1/memo/20", "sample_request_data": {}, "request_method": "GET", "path_segments": [{"name": "api", "is_path_variable": false}, {"name": "v1", "is_path_variable": false}, {"name": "memo", "is_path_variable": false}, {"name": "<NUM>", "is_path_variable": true}], "request_param_list": [], "request_data_fields": []}, {"function_description": "Please fill in the function description", "permission_info": "Please fill in the permission info", "sample_url": "http://47.97.114.24:5230/o/r/15?thumbnail=1", "sample_request_data": {}, "request_method": "GET", "path_segments": [{"name": "o", "is_path_variable": false}, {"name": "r", "is_path_variable": false}, {"name": "<NUM>", "is_path_variable": true}], "request_param_list": [{"name": "thumbnail", "is_necessary": true}], "request_data_fields": []},... (29391b)

The full contents of the message headers:
{'lang': 'py', 'task': 'SFWAP.views.handle_api_discovery_notification', 'id': '72887247-52bc-447d-b9f4-b23f4c098275', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': '72887247-52bc-447d-b9f4-b23f4c098275', 'parent_id': None, 'argsrepr': "('1', {'discovered_API_list': [{...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}]})", 'kwargsrepr': '{}', 'origin': 'gen387381@VM-16-2-ubuntu', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "/home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
KeyError: 'SFWAP.views.handle_api_discovery_notification'
2025-03-13 11:39:35,587 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-13 11:39:35,630 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-13 11:39:35,630 - INFO - Extracting API list with API discovery algorithm...
2025-03-13 11:39:35,690 - INFO - Starting Drain3 template miner
2025-03-13 11:39:35,693 - INFO - Starting Drain3 template miner
2025-03-13 11:39:35,695 - INFO - Starting Drain3 template miner
2025-03-13 11:39:35,695 - INFO - Starting Drain3 template miner
2025-03-13 11:39:35,696 - INFO - Starting Drain3 template miner
2025-03-13 11:39:37,508 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-13 11:40:19,306 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-13 11:40:19,352 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-13 11:40:19,352 - INFO - Extracting API list with API discovery algorithm...
2025-03-13 11:40:19,416 - INFO - Starting Drain3 template miner
2025-03-13 11:40:19,418 - INFO - Starting Drain3 template miner
2025-03-13 11:40:19,420 - INFO - Starting Drain3 template miner
2025-03-13 11:40:19,420 - INFO - Starting Drain3 template miner
2025-03-13 11:40:19,421 - INFO - Starting Drain3 template miner
2025-03-13 11:40:21,061 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
[2025-03-13 11:40:21,143: ERROR/MainProcess] Received unregistered task of type 'SFWAP.views.handle_api_discovery_notification'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[["1", {"discovered_API_list": [{"function_description": "Please fill in the function description", "permission_info": "Please fill in the permission info", "sample_url": "http://47.97.114.24:5230/api/v1/memo/20", "sample_request_data": {}, "request_method": "GET", "path_segments": [{"name": "api", "is_path_variable": false}, {"name": "v1", "is_path_variable": false}, {"name": "memo", "is_path_variable": false}, {"name": "<NUM>", "is_path_variable": true}], "request_param_list": [], "request_data_fields": []}, {"function_description": "Please fill in the function description", "permission_info": "Please fill in the permission info", "sample_url": "http://47.97.114.24:5230/o/r/15?thumbnail=1", "sample_request_data": {}, "request_method": "GET", "path_segments": [{"name": "o", "is_path_variable": false}, {"name": "r", "is_path_variable": false}, {"name": "<NUM>", "is_path_variable": true}], "request_param_list": [{"name": "thumbnail", "is_necessary": true}], "request_data_fields": []},... (29391b)

The full contents of the message headers:
{'lang': 'py', 'task': 'SFWAP.views.handle_api_discovery_notification', 'id': 'b37f2275-4d80-4a91-9294-e32cd429c076', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': 'b37f2275-4d80-4a91-9294-e32cd429c076', 'parent_id': None, 'argsrepr': "('1', {'discovered_API_list': [{...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}]})", 'kwargsrepr': '{}', 'origin': 'gen387864@VM-16-2-ubuntu', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "/home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
KeyError: 'SFWAP.views.handle_api_discovery_notification'
2025-03-13 11:42:01,930 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-13 11:42:01,973 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-13 11:42:01,974 - INFO - Extracting API list with API discovery algorithm...
2025-03-13 11:42:02,034 - INFO - Starting Drain3 template miner
2025-03-13 11:42:02,037 - INFO - Starting Drain3 template miner
2025-03-13 11:42:02,038 - INFO - Starting Drain3 template miner
2025-03-13 11:42:02,039 - INFO - Starting Drain3 template miner
2025-03-13 11:42:02,039 - INFO - Starting Drain3 template miner
2025-03-13 11:42:03,681 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
[2025-03-13 11:42:03,757: ERROR/MainProcess] Received unregistered task of type 'SFWAP.views.handle_api_discovery_notification'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[["1", {"discovered_API_list": [{"function_description": "Please fill in the function description", "permission_info": "Please fill in the permission info", "sample_url": "http://47.97.114.24:5230/api/v1/memo/20", "sample_request_data": {}, "request_method": "GET", "path_segments": [{"name": "api", "is_path_variable": false}, {"name": "v1", "is_path_variable": false}, {"name": "memo", "is_path_variable": false}, {"name": "<NUM>", "is_path_variable": true}], "request_param_list": [], "request_data_fields": []}, {"function_description": "Please fill in the function description", "permission_info": "Please fill in the permission info", "sample_url": "http://47.97.114.24:5230/o/r/15?thumbnail=1", "sample_request_data": {}, "request_method": "GET", "path_segments": [{"name": "o", "is_path_variable": false}, {"name": "r", "is_path_variable": false}, {"name": "<NUM>", "is_path_variable": true}], "request_param_list": [{"name": "thumbnail", "is_necessary": true}], "request_data_fields": []},... (29391b)

The full contents of the message headers:
{'lang': 'py', 'task': 'SFWAP.views.handle_api_discovery_notification', 'id': 'a97a5bca-b91a-484a-b9c7-7cf780b36dc3', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': 'a97a5bca-b91a-484a-b9c7-7cf780b36dc3', 'parent_id': None, 'argsrepr': "('1', {'discovered_API_list': [{...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}]})", 'kwargsrepr': '{}', 'origin': 'gen388428@VM-16-2-ubuntu', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "/home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
KeyError: 'SFWAP.views.handle_api_discovery_notification'
2025-03-13 11:59:17,665 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-13 11:59:17,709 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-13 11:59:17,804 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-13 11:59:17,804 - INFO - Starting data generation...
2025-03-13 11:59:17,805 - INFO - API_KNOWLEDGE: [{'number': 'API_2069', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_2070', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}]
2025-03-13 11:59:17,805 - INFO - APP_KNOWLEDGE: {'func_description': 'This is an updated test applicationaaaaaaa', 'normal_seqs': ['Role: admin; API_2069(Call 1); API_2070(Call 2)', 'Role: oridinary_user; API_2069(); API_2070()'], 'malicious_seqs': ['Role: admin; API_2069(); API_2070()', 'Role: ordinary_user; API_2069(); API_2070()'], 'roles': ['admin', 'ordinary_user', 'unlogged_in_user']}
2025-03-13 11:59:18,044 - INFO - Generating simulated API sequences...
2025-03-13 11:59:18,044 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-13 11:59:18,044 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-13 11:59:19,538 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 11:59:19,577 - INFO - ========== Method gen_api_seq() returned: seq=['API_2069'], malicious_sign_seq=[0] ==========
2025-03-13 11:59:19,577 - INFO - ========== Method gen_api_seq() returned: seq=['API_2069'], malicious_sign_seq=[0] ==========
2025-03-13 11:59:19,577 - INFO - API sequence 1/12 generated
2025-03-13 11:59:19,577 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-13 11:59:19,577 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-13 11:59:22,430 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 11:59:22,431 - INFO - ========== Method gen_api_seq() returned: seq=['API_2069', 'API_2070'], malicious_sign_seq=[0, 1] ==========
2025-03-13 11:59:22,431 - INFO - ========== Method gen_api_seq() returned: seq=['API_2069', 'API_2070'], malicious_sign_seq=[0, 1] ==========
2025-03-13 11:59:22,432 - INFO - API sequence 2/12 generated
2025-03-13 11:59:22,432 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-13 11:59:22,432 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-13 11:59:24,077 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 11:59:24,078 - INFO - ========== Method gen_api_seq() returned: seq=['API_2069', 'API_2070'], malicious_sign_seq=[0, 1] ==========
2025-03-13 11:59:24,078 - INFO - ========== Method gen_api_seq() returned: seq=['API_2069', 'API_2070'], malicious_sign_seq=[0, 1] ==========
2025-03-13 11:59:24,078 - INFO - API sequence 3/12 generated
2025-03-13 11:59:24,078 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-13 11:59:24,078 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-13 11:59:25,404 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 11:59:25,405 - INFO - ========== Method gen_api_seq() returned: seq=['API_2069', 'API_2070'], malicious_sign_seq=[0, 1] ==========
2025-03-13 11:59:25,405 - INFO - ========== Method gen_api_seq() returned: seq=['API_2069', 'API_2070'], malicious_sign_seq=[0, 1] ==========
2025-03-13 11:59:25,415 - INFO - API sequence 4/12 generated
2025-03-13 11:59:25,415 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-13 11:59:25,415 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-13 11:59:26,913 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 11:59:26,914 - INFO - ========== Method gen_api_seq() returned: seq=['API_2069', 'API_2070'], malicious_sign_seq=[0, 1] ==========
2025-03-13 11:59:26,914 - INFO - ========== Method gen_api_seq() returned: seq=['API_2069', 'API_2070'], malicious_sign_seq=[0, 1] ==========
2025-03-13 11:59:26,914 - INFO - API sequence 5/12 generated
2025-03-13 11:59:26,914 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-13 11:59:26,914 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-13 11:59:28,475 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 11:59:28,476 - INFO - ========== Method gen_api_seq() returned: seq=['API_2069', 'API_2070'], malicious_sign_seq=[0, 0] ==========
2025-03-13 11:59:28,476 - INFO - ========== Method gen_api_seq() returned: seq=['API_2069', 'API_2070'], malicious_sign_seq=[0, 0] ==========
2025-03-13 11:59:28,476 - INFO - API sequence 6/12 generated
2025-03-13 11:59:28,476 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-13 11:59:28,476 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-13 11:59:30,212 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-13 11:59:30,254 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-13 11:59:30,254 - INFO - Extracting API list with API discovery algorithm...
2025-03-13 11:59:30,313 - INFO - Starting Drain3 template miner
2025-03-13 11:59:30,316 - INFO - Starting Drain3 template miner
2025-03-13 11:59:30,317 - INFO - Starting Drain3 template miner
2025-03-13 11:59:30,318 - INFO - Starting Drain3 template miner
2025-03-13 11:59:30,318 - INFO - Starting Drain3 template miner
2025-03-13 11:59:31,636 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 11:59:31,642 - INFO - ========== Method gen_api_seq() returned: seq=['API_2069', 'API_2070'], malicious_sign_seq=[0, 1] ==========
2025-03-13 11:59:31,642 - INFO - ========== Method gen_api_seq() returned: seq=['API_2069', 'API_2070'], malicious_sign_seq=[0, 1] ==========
2025-03-13 11:59:31,653 - INFO - API sequence 7/12 generated
2025-03-13 11:59:31,658 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-13 11:59:31,658 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-13 11:59:31,820 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-13 11:59:32,877 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 11:59:32,878 - INFO - ========== Method gen_api_seq() returned: seq=['API_2069'], malicious_sign_seq=[0] ==========
2025-03-13 11:59:32,878 - INFO - ========== Method gen_api_seq() returned: seq=['API_2069'], malicious_sign_seq=[0] ==========
2025-03-13 11:59:32,878 - INFO - API sequence 8/12 generated
2025-03-13 11:59:32,878 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-13 11:59:32,878 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-13 11:59:34,205 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 11:59:34,206 - INFO - ========== Method gen_api_seq() returned: seq=['API_2069', 'API_2070'], malicious_sign_seq=[0, 0] ==========
2025-03-13 11:59:34,206 - INFO - ========== Method gen_api_seq() returned: seq=['API_2069', 'API_2070'], malicious_sign_seq=[0, 0] ==========
2025-03-13 11:59:34,206 - INFO - API sequence 9/12 generated
2025-03-13 11:59:34,206 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-13 11:59:34,206 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-13 11:59:35,862 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 11:59:35,863 - INFO - ========== Method gen_api_seq() returned: seq=['API_2069', 'API_2070'], malicious_sign_seq=[0, 0] ==========
2025-03-13 11:59:35,863 - INFO - ========== Method gen_api_seq() returned: seq=['API_2069', 'API_2070'], malicious_sign_seq=[0, 0] ==========
2025-03-13 11:59:35,863 - INFO - API sequence 10/12 generated
2025-03-13 11:59:35,863 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-13 11:59:35,863 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-13 11:59:38,723 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 11:59:38,724 - INFO - ========== Method gen_api_seq() returned: seq=['API_2069', 'API_2070'], malicious_sign_seq=[0, 1] ==========
2025-03-13 11:59:38,724 - INFO - ========== Method gen_api_seq() returned: seq=['API_2069', 'API_2070'], malicious_sign_seq=[0, 1] ==========
2025-03-13 11:59:38,724 - INFO - API sequence 11/12 generated
2025-03-13 11:59:38,724 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-13 11:59:38,724 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-13 11:59:41,193 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 11:59:41,194 - INFO - ========== Method gen_api_seq() returned: seq=['API_2069', 'API_2070'], malicious_sign_seq=[0, 0] ==========
2025-03-13 11:59:41,194 - INFO - ========== Method gen_api_seq() returned: seq=['API_2069', 'API_2070'], malicious_sign_seq=[0, 0] ==========
2025-03-13 11:59:41,194 - INFO - API sequence 12/12 generated
2025-03-13 11:59:41,194 - INFO - API sequences serialized to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py/serialized_llm_agents.json
2025-03-13 11:59:41,194 - INFO - Generating simulated traffic data set...
2025-03-13 11:59:41,203 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-13 11:59:41,203 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 11:59:41,203 - INFO - Simulated traffic data for 1/12 user collected：user: normaluser malicious: False
2025-03-13 11:59:41,210 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-13 11:59:41,210 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 11:59:41,217 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-13 11:59:41,217 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-13 11:59:41,217 - INFO - Simulated traffic data for 2/12 user collected：user: normaluser malicious: True
2025-03-13 11:59:41,224 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-13 11:59:41,224 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 11:59:41,231 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-13 11:59:41,231 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-13 11:59:41,231 - INFO - Simulated traffic data for 3/12 user collected：user: unloggeduser malicious: True
2025-03-13 11:59:41,238 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-13 11:59:41,238 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 11:59:41,245 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-13 11:59:41,245 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-13 11:59:41,245 - INFO - Simulated traffic data for 4/12 user collected：user: normaluser malicious: True
2025-03-13 11:59:41,251 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-13 11:59:41,252 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 11:59:41,259 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-13 11:59:41,259 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-13 11:59:41,259 - INFO - Simulated traffic data for 5/12 user collected：user: normaluser malicious: True
2025-03-13 11:59:41,266 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-13 11:59:41,266 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 11:59:41,273 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-13 11:59:41,273 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 11:59:41,273 - INFO - Simulated traffic data for 6/12 user collected：user: adminuser malicious: False
2025-03-13 11:59:41,280 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-13 11:59:41,280 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 11:59:41,287 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-13 11:59:41,287 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-13 11:59:41,288 - INFO - Simulated traffic data for 7/12 user collected：user: unloggeduser malicious: True
2025-03-13 11:59:41,294 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-13 11:59:41,294 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 11:59:41,295 - INFO - Simulated traffic data for 8/12 user collected：user: adminuser malicious: False
2025-03-13 11:59:41,434 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-13 11:59:41,434 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 11:59:41,441 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-13 11:59:41,441 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 11:59:41,441 - INFO - Simulated traffic data for 9/12 user collected：user: normaluser malicious: False
2025-03-13 11:59:41,448 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-13 11:59:41,448 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 11:59:41,456 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-13 11:59:41,456 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 11:59:41,456 - INFO - Simulated traffic data for 10/12 user collected：user: normaluser malicious: False
2025-03-13 11:59:41,463 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-13 11:59:41,463 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 11:59:41,470 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-13 11:59:41,470 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-13 11:59:41,470 - INFO - Simulated traffic data for 11/12 user collected：user: unloggeduser malicious: True
2025-03-13 11:59:41,477 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-13 11:59:41,477 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 11:59:41,484 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-13 11:59:41,484 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 11:59:41,484 - INFO - Simulated traffic data for 12/12 user collected：user: normaluser malicious: False
2025-03-13 11:59:41,497 - INFO - All simulated traffic data collected：/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/simulated_traffic_data.csv
2025-03-13 15:22:28,916 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-13 15:22:28,954 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-13 15:22:28,954 - INFO - Extracting API list with API discovery algorithm...
2025-03-13 15:22:29,013 - INFO - Starting Drain3 template miner
2025-03-13 15:22:29,016 - INFO - Starting Drain3 template miner
2025-03-13 15:22:29,017 - INFO - Starting Drain3 template miner
2025-03-13 15:22:29,018 - INFO - Starting Drain3 template miner
2025-03-13 15:22:29,018 - INFO - Starting Drain3 template miner
2025-03-13 15:22:30,492 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-13 15:23:06,755 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-13 15:23:06,795 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-13 15:23:06,795 - INFO - Extracting API list with API discovery algorithm...
2025-03-13 15:23:06,856 - INFO - Starting Drain3 template miner
2025-03-13 15:23:06,858 - INFO - Starting Drain3 template miner
2025-03-13 15:23:06,860 - INFO - Starting Drain3 template miner
2025-03-13 15:23:06,860 - INFO - Starting Drain3 template miner
2025-03-13 15:23:06,861 - INFO - Starting Drain3 template miner
2025-03-13 15:23:08,366 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-13 15:24:46,302 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-13 15:24:46,340 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-13 15:24:46,340 - INFO - Extracting API list with API discovery algorithm...
2025-03-13 15:24:46,405 - INFO - Starting Drain3 template miner
2025-03-13 15:24:46,408 - INFO - Starting Drain3 template miner
2025-03-13 15:24:46,410 - INFO - Starting Drain3 template miner
2025-03-13 15:24:46,410 - INFO - Starting Drain3 template miner
2025-03-13 15:24:46,411 - INFO - Starting Drain3 template miner
2025-03-13 15:24:47,912 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
[2025-03-13 15:24:47,999: ERROR/MainProcess] Received unregistered task of type 'SFWAP.views.handle_api_discovery_notification'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[["1", {"discovered_API_list": [{"function_description": "Please fill in the function description", "permission_info": "Please fill in the permission info", "sample_url": "http://47.97.114.24:5230/api/v1/memo/20", "sample_request_data": {}, "request_method": "GET", "path_segments": [{"name": "api", "is_path_variable": false}, {"name": "v1", "is_path_variable": false}, {"name": "memo", "is_path_variable": false}, {"name": "<NUM>", "is_path_variable": true}], "request_param_list": [], "request_data_fields": []}, {"function_description": "Please fill in the function description", "permission_info": "Please fill in the permission info", "sample_url": "http://47.97.114.24:5230/o/r/15?thumbnail=1", "sample_request_data": {}, "request_method": "GET", "path_segments": [{"name": "o", "is_path_variable": false}, {"name": "r", "is_path_variable": false}, {"name": "<NUM>", "is_path_variable": true}], "request_param_list": [{"name": "thumbnail", "is_necessary": true}], "request_data_fields": []},... (29391b)

The full contents of the message headers:
{'lang': 'py', 'task': 'SFWAP.views.handle_api_discovery_notification', 'id': 'df34fee4-dbee-4017-850f-27cd44fc912e', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': 'df34fee4-dbee-4017-850f-27cd44fc912e', 'parent_id': None, 'argsrepr': "('1', {'discovered_API_list': [{...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}]})", 'kwargsrepr': '{}', 'origin': 'gen393818@VM-16-2-ubuntu', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "/home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
KeyError: 'SFWAP.views.handle_api_discovery_notification'
2025-03-13 17:29:03,638 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-13 17:29:03,676 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-13 17:29:03,780 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-13 17:29:03,780 - INFO - Starting data generation...
2025-03-13 17:29:03,780 - INFO - API_KNOWLEDGE: [{'number': 'API_2071', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_2072', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}]
2025-03-13 17:29:03,780 - INFO - APP_KNOWLEDGE: {'func_description': 'This is an updated test applicationaaaaaaa', 'normal_seqs': ['There are no example normal seqs'], 'malicious_seqs': ['There are no example malicious seqs'], 'roles': ['admin', 'ordinary_user', 'unlogged_in_user']}
2025-03-13 17:29:03,845 - INFO - Generating simulated API sequences...
2025-03-13 17:29:03,845 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-13 17:29:03,845 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-13 17:29:03,845 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-13 17:29:07,660 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 17:29:07,661 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-13 17:29:07,661 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-13 17:29:07,661 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-13 17:29:07,661 - INFO - API sequence 1/12 generated
2025-03-13 17:29:07,661 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-13 17:29:07,661 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-13 17:29:07,661 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-13 17:29:08,992 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 17:29:08,993 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-13 17:29:08,993 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-13 17:29:08,993 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-13 17:29:08,994 - INFO - API sequence 2/12 generated
2025-03-13 17:29:08,994 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-13 17:29:08,994 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-13 17:29:08,994 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-13 17:29:10,833 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 17:29:10,834 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-13 17:29:10,834 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-13 17:29:10,834 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-13 17:29:10,834 - INFO - API sequence 3/12 generated
2025-03-13 17:29:10,834 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-13 17:29:10,834 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-13 17:29:10,834 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-13 17:29:12,091 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 17:29:12,092 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-13 17:29:12,092 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-13 17:29:12,092 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-13 17:29:12,092 - INFO - API sequence 4/12 generated
2025-03-13 17:29:12,092 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-13 17:29:12,092 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-13 17:29:12,092 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-13 17:29:13,251 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 17:29:13,252 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-13 17:29:13,252 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-13 17:29:13,252 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-13 17:29:13,252 - INFO - API sequence 5/12 generated
2025-03-13 17:29:13,252 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-13 17:29:13,252 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-13 17:29:13,252 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-13 17:29:15,532 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 17:29:15,533 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-13 17:29:15,533 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-13 17:29:15,533 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-13 17:29:15,533 - INFO - API sequence 6/12 generated
2025-03-13 17:29:15,533 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-13 17:29:15,533 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-13 17:29:15,533 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-13 17:29:17,884 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 17:29:17,884 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-13 17:29:17,884 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-13 17:29:17,884 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-13 17:29:17,884 - INFO - API sequence 7/12 generated
2025-03-13 17:29:17,885 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-13 17:29:17,885 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-13 17:29:17,885 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-13 17:29:19,585 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 17:29:19,586 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-13 17:29:19,586 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-13 17:29:19,586 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-13 17:29:19,586 - INFO - API sequence 8/12 generated
2025-03-13 17:29:19,586 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-13 17:29:19,586 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-13 17:29:19,586 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-13 17:29:20,767 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 17:29:20,768 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-13 17:29:20,768 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-13 17:29:20,768 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-13 17:29:20,768 - INFO - API sequence 9/12 generated
2025-03-13 17:29:20,768 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-13 17:29:20,768 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-13 17:29:20,768 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-13 17:29:22,629 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 17:29:22,630 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-13 17:29:22,630 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-13 17:29:22,630 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-13 17:29:22,630 - INFO - API sequence 10/12 generated
2025-03-13 17:29:22,630 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-13 17:29:22,630 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-13 17:29:22,630 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-13 17:29:30,354 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 17:29:30,355 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-13 17:29:30,355 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-13 17:29:30,355 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-13 17:29:30,355 - INFO - API sequence 11/12 generated
2025-03-13 17:29:30,355 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-13 17:29:30,355 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-13 17:29:30,355 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-13 17:29:31,839 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 17:29:31,840 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-13 17:29:31,840 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-13 17:29:31,840 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-13 17:29:31,840 - INFO - API sequence 12/12 generated
2025-03-13 17:29:31,840 - INFO - API sequences serialized to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py/serialized_llm_agents.json
2025-03-13 17:29:31,840 - INFO - Generating simulated traffic data set...
2025-03-13 17:29:31,849 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-13 17:29:31,850 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 17:29:31,858 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-13 17:29:31,858 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-13 17:29:31,858 - INFO - Simulated traffic data for 1/12 user collected：user: normaluser malicious: True
2025-03-13 17:29:31,867 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/resource/16 {}
2025-03-13 17:29:31,867 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 17:29:31,867 - INFO - Simulated traffic data for 2/12 user collected：user: adminuser malicious: False
2025-03-13 17:29:31,876 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-13 17:29:31,877 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 17:29:31,877 - INFO - Simulated traffic data for 3/12 user collected：user: normaluser malicious: False
2025-03-13 17:29:31,886 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-13 17:29:31,886 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 17:29:31,886 - INFO - Simulated traffic data for 4/12 user collected：user: normaluser malicious: False
2025-03-13 17:29:31,895 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-13 17:29:31,895 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 17:29:31,895 - INFO - Simulated traffic data for 5/12 user collected：user: adminuser malicious: False
2025-03-13 17:29:31,903 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-13 17:29:31,903 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 17:29:31,912 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-13 17:29:31,912 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-13 17:29:31,912 - INFO - Simulated traffic data for 6/12 user collected：user: normaluser malicious: True
2025-03-13 17:29:31,920 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-13 17:29:31,920 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 17:29:31,929 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-13 17:29:31,929 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-13 17:29:31,937 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-13 17:29:31,937 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：False
2025-03-13 17:29:31,937 - INFO - Simulated traffic data for 7/12 user collected：user: unloggeduser malicious: True
2025-03-13 17:29:32,026 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-13 17:29:32,026 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 17:29:32,034 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/resource/16 {}
2025-03-13 17:29:32,035 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-13 17:29:32,035 - INFO - Simulated traffic data for 8/12 user collected：user: unloggeduser malicious: True
2025-03-13 17:29:32,043 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/resource/16 {}
2025-03-13 17:29:32,044 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 17:29:32,044 - INFO - Simulated traffic data for 9/12 user collected：user: normaluser malicious: False
2025-03-13 17:29:32,052 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-13 17:29:32,052 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 17:29:32,053 - INFO - Simulated traffic data for 10/12 user collected：user: normaluser malicious: False
2025-03-13 17:29:32,061 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-13 17:29:32,061 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 17:29:32,070 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-13 17:29:32,071 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-13 17:29:32,071 - INFO - Simulated traffic data for 11/12 user collected：user: normaluser malicious: True
2025-03-13 17:29:32,080 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-13 17:29:32,080 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 17:29:32,088 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-13 17:29:32,088 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-13 17:29:32,088 - INFO - Simulated traffic data for 12/12 user collected：user: unloggeduser malicious: True
2025-03-13 17:29:32,091 - INFO - All simulated traffic data collected：/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/simulated_traffic_data.csv
2025-03-13 17:31:27,675 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-13 17:31:27,713 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-13 17:31:27,816 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-13 17:31:27,816 - INFO - Starting data generation...
2025-03-13 17:31:27,816 - INFO - API_KNOWLEDGE: [{'number': 'API_2073', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_2074', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}]
2025-03-13 17:31:27,817 - INFO - APP_KNOWLEDGE: {'func_description': 'This is an updated test applicationaaaaaaa', 'normal_seqs': ['There are no example normal seqs'], 'malicious_seqs': ['There are no example malicious seqs'], 'roles': ['admin', 'ordinary_user', 'unlogged_in_user']}
2025-03-13 17:31:27,866 - INFO - Generating simulated API sequences...
2025-03-13 17:31:27,866 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-13 17:31:27,866 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-13 17:31:27,866 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-13 17:31:27,866 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-13 17:31:30,310 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 17:31:30,311 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-13 17:31:30,311 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-13 17:31:30,311 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-13 17:31:30,311 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-13 17:31:30,311 - INFO - API sequence 1/12 generated
2025-03-13 17:31:30,311 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-13 17:31:30,311 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-13 17:31:30,311 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-13 17:31:30,311 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-13 17:31:32,687 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 17:31:32,688 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-13 17:31:32,688 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-13 17:31:32,688 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-13 17:31:32,688 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-13 17:31:32,688 - INFO - API sequence 2/12 generated
2025-03-13 17:31:32,688 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-13 17:31:32,688 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-13 17:31:32,688 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-13 17:31:32,688 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-13 17:31:34,471 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 17:31:34,472 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-13 17:31:34,472 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-13 17:31:34,472 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-13 17:31:34,472 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-13 17:31:34,472 - INFO - API sequence 3/12 generated
2025-03-13 17:31:34,472 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-13 17:31:34,472 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-13 17:31:34,472 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-13 17:31:34,472 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-13 17:31:35,781 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 17:31:35,782 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-13 17:31:35,782 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-13 17:31:35,782 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-13 17:31:35,782 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-13 17:31:35,782 - INFO - API sequence 4/12 generated
2025-03-13 17:31:35,782 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-13 17:31:35,782 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-13 17:31:35,782 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-13 17:31:35,782 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-13 17:31:37,327 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 17:31:37,327 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-13 17:31:37,327 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-13 17:31:37,327 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-13 17:31:37,327 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-13 17:31:37,327 - INFO - API sequence 5/12 generated
2025-03-13 17:31:37,327 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-13 17:31:37,327 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-13 17:31:37,327 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-13 17:31:37,327 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-13 17:31:39,548 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 17:31:39,549 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-13 17:31:39,549 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-13 17:31:39,549 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-13 17:31:39,549 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-13 17:31:39,549 - INFO - API sequence 6/12 generated
2025-03-13 17:31:39,549 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-13 17:31:39,549 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-13 17:31:39,549 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-13 17:31:39,549 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-13 17:31:41,044 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 17:31:41,045 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-13 17:31:41,045 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-13 17:31:41,045 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-13 17:31:41,045 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-13 17:31:41,045 - INFO - API sequence 7/12 generated
2025-03-13 17:31:41,045 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-13 17:31:41,045 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-13 17:31:41,045 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-13 17:31:41,045 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-13 17:31:42,924 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 17:31:42,925 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-13 17:31:42,925 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-13 17:31:42,925 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-13 17:31:42,925 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-13 17:31:42,925 - INFO - API sequence 8/12 generated
2025-03-13 17:31:42,925 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-13 17:31:42,925 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-13 17:31:42,925 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-13 17:31:42,925 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-13 17:31:45,283 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 17:31:45,284 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-13 17:31:45,284 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-13 17:31:45,284 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-13 17:31:45,284 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-13 17:31:45,284 - INFO - API sequence 9/12 generated
2025-03-13 17:31:45,284 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-13 17:31:45,284 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-13 17:31:45,284 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-13 17:31:45,284 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-13 17:31:46,843 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 17:31:46,844 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-13 17:31:46,844 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-13 17:31:46,844 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-13 17:31:46,844 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-13 17:31:46,844 - INFO - API sequence 10/12 generated
2025-03-13 17:31:46,844 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-13 17:31:46,844 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-13 17:31:46,844 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-13 17:31:46,844 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-13 17:31:49,296 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 17:31:49,297 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-13 17:31:49,297 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-13 17:31:49,297 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-13 17:31:49,297 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-13 17:31:49,297 - INFO - API sequence 11/12 generated
2025-03-13 17:31:49,297 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-13 17:31:49,297 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-13 17:31:49,297 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-13 17:31:49,297 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-13 17:32:00,249 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 17:32:00,249 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-13 17:32:00,249 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-13 17:32:00,249 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-13 17:32:00,249 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-13 17:32:00,250 - INFO - API sequence 12/12 generated
2025-03-13 17:32:00,250 - INFO - API sequences serialized to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py/serialized_llm_agents.json
2025-03-13 17:32:00,250 - INFO - Generating simulated traffic data set...
2025-03-13 17:32:00,259 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-13 17:32:00,259 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
Exception in thread Thread-216 (async_data_collect):
Traceback (most recent call last):
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/./app.py", line 528, in async_data_collect
    traffic_data_generation.gen_data_set(user_api_set, api_knowledge, app_knowledge)
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py", line 315, in gen_data_set
    user_data, seq_valid = param_injection_for_api_seq(
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py", line 167, in param_injection_for_api_seq
    url, req_data = param_injection_for_api(api_seq[i])
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py", line 242, in param_injection_for_api
    val = random.choice(api_param_set['query_params'][param])
KeyError: 'abc'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/threading.py", line 1016, in _bootstrap_inner
    self.run()
  File "/usr/lib/python3.10/threading.py", line 953, in run
    self._target(*self._args, **self._kwargs)
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/./app.py", line 535, in async_data_collect
    LOGGER.error(f"Error in data collection: {e.with_traceback(10)}")
TypeError: __traceback__ must be a traceback or None
2025-03-13 19:51:35,721 - INFO - Detection started. Combined data duration: 10
2025-03-13 19:51:36,459 - INFO - Detection paused.
2025-03-13 19:56:15,865 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-13 19:56:16,016 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-13 19:56:16,016 - INFO - Extracting API list with API discovery algorithm...
2025-03-13 19:56:16,083 - INFO - Starting Drain3 template miner
2025-03-13 19:56:16,085 - INFO - Starting Drain3 template miner
2025-03-13 19:56:16,087 - INFO - Starting Drain3 template miner
2025-03-13 19:56:16,088 - INFO - Starting Drain3 template miner
2025-03-13 19:56:16,088 - INFO - Starting Drain3 template miner
2025-03-13 19:56:17,622 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
[2025-03-13 19:56:17,965: ERROR/MainProcess] Received unregistered task of type 'SFWAP.views.handle_api_discovery_notification'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[["4", {"discovered_API_list": [{"function_description": "Please fill in the function description", "permission_info": "Please fill in the permission info", "sample_url": "http://47.97.114.24:5230/api/v1/memo/20", "sample_request_data": {}, "request_method": "GET", "path_segments": [{"name": "api", "is_path_variable": false}, {"name": "v1", "is_path_variable": false}, {"name": "memo", "is_path_variable": false}, {"name": "<NUM>", "is_path_variable": true}], "request_param_list": [], "request_data_fields": []}, {"function_description": "Please fill in the function description", "permission_info": "Please fill in the permission info", "sample_url": "http://47.97.114.24:5230/o/r/15?thumbnail=1", "sample_request_data": {}, "request_method": "GET", "path_segments": [{"name": "o", "is_path_variable": false}, {"name": "r", "is_path_variable": false}, {"name": "<NUM>", "is_path_variable": true}], "request_param_list": [{"name": "thumbnail", "is_necessary": true}], "request_data_fields": []},... (29391b)

The full contents of the message headers:
{'lang': 'py', 'task': 'SFWAP.views.handle_api_discovery_notification', 'id': '4faebae9-2bb3-43a8-b9a4-76a024913c89', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': '4faebae9-2bb3-43a8-b9a4-76a024913c89', 'parent_id': None, 'argsrepr': "('4', {'discovered_API_list': [{...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}]})", 'kwargsrepr': '{}', 'origin': 'gen393818@VM-16-2-ubuntu', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "/home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
KeyError: 'SFWAP.views.handle_api_discovery_notification'
2025-03-13 19:56:22,884 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-13 19:56:22,939 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-13 19:56:22,939 - INFO - Extracting API list with API discovery algorithm...
2025-03-13 19:56:23,004 - INFO - Starting Drain3 template miner
2025-03-13 19:56:23,008 - INFO - Starting Drain3 template miner
2025-03-13 19:56:23,009 - INFO - Starting Drain3 template miner
2025-03-13 19:56:23,010 - INFO - Starting Drain3 template miner
2025-03-13 19:56:23,011 - INFO - Starting Drain3 template miner
2025-03-13 19:56:24,560 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
[2025-03-13 19:56:24,599: ERROR/MainProcess] Received unregistered task of type 'SFWAP.views.handle_api_discovery_notification'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[["4", {"discovered_API_list": [{"function_description": "Please fill in the function description", "permission_info": "Please fill in the permission info", "sample_url": "http://47.97.114.24:5230/api/v1/memo/20", "sample_request_data": {}, "request_method": "GET", "path_segments": [{"name": "api", "is_path_variable": false}, {"name": "v1", "is_path_variable": false}, {"name": "memo", "is_path_variable": false}, {"name": "<NUM>", "is_path_variable": true}], "request_param_list": [], "request_data_fields": []}, {"function_description": "Please fill in the function description", "permission_info": "Please fill in the permission info", "sample_url": "http://47.97.114.24:5230/o/r/15?thumbnail=1", "sample_request_data": {}, "request_method": "GET", "path_segments": [{"name": "o", "is_path_variable": false}, {"name": "r", "is_path_variable": false}, {"name": "<NUM>", "is_path_variable": true}], "request_param_list": [{"name": "thumbnail", "is_necessary": true}], "request_data_fields": []},... (29391b)

The full contents of the message headers:
{'lang': 'py', 'task': 'SFWAP.views.handle_api_discovery_notification', 'id': '20046175-a847-4f6b-9556-0fe57e9414c7', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': '20046175-a847-4f6b-9556-0fe57e9414c7', 'parent_id': None, 'argsrepr': "('4', {'discovered_API_list': [{...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}]})", 'kwargsrepr': '{}', 'origin': 'gen393818@VM-16-2-ubuntu', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "/home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
KeyError: 'SFWAP.views.handle_api_discovery_notification'
2025-03-13 19:57:27,846 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-13 19:57:27,891 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-13 19:57:27,892 - INFO - Extracting API list with API discovery algorithm...
2025-03-13 19:57:27,954 - INFO - Starting Drain3 template miner
2025-03-13 19:57:27,956 - INFO - Starting Drain3 template miner
2025-03-13 19:57:27,958 - INFO - Starting Drain3 template miner
2025-03-13 19:57:27,958 - INFO - Starting Drain3 template miner
2025-03-13 19:57:27,959 - INFO - Starting Drain3 template miner
2025-03-13 19:57:29,506 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
[2025-03-13 19:57:29,546: ERROR/MainProcess] Received unregistered task of type 'SFWAP.views.handle_api_discovery_notification'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[["4", {"discovered_API_list": [{"function_description": "Please fill in the function description", "permission_info": "Please fill in the permission info", "sample_url": "http://47.97.114.24:5230/api/v1/memo/20", "sample_request_data": {}, "request_method": "GET", "path_segments": [{"name": "api", "is_path_variable": false}, {"name": "v1", "is_path_variable": false}, {"name": "memo", "is_path_variable": false}, {"name": "<NUM>", "is_path_variable": true}], "request_param_list": [], "request_data_fields": []}, {"function_description": "Please fill in the function description", "permission_info": "Please fill in the permission info", "sample_url": "http://47.97.114.24:5230/o/r/15?thumbnail=1", "sample_request_data": {}, "request_method": "GET", "path_segments": [{"name": "o", "is_path_variable": false}, {"name": "r", "is_path_variable": false}, {"name": "<NUM>", "is_path_variable": true}], "request_param_list": [{"name": "thumbnail", "is_necessary": true}], "request_data_fields": []},... (29391b)

The full contents of the message headers:
{'lang': 'py', 'task': 'SFWAP.views.handle_api_discovery_notification', 'id': '57a4af61-a236-4040-86ce-38b74eab73c8', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': '57a4af61-a236-4040-86ce-38b74eab73c8', 'parent_id': None, 'argsrepr': "('4', {'discovered_API_list': [{...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}]})", 'kwargsrepr': '{}', 'origin': 'gen393818@VM-16-2-ubuntu', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "/home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
KeyError: 'SFWAP.views.handle_api_discovery_notification'
[2025-03-13 20:01:25,364: INFO/MainProcess] Task traffic_collector.consume_traffic_periodically[ba5fbecb-076d-4e90-9338-a15d315811e7] received
 
 -------------- celery@VM-16-2-ubuntu v5.4.0 (opalescent)
--- ***** ----- 
-- ******* ---- Linux-5.15.0-130-generic-x86_64-with-glibc2.35 2025-03-13 20:01:25
- *** --- * --- 
- ** ---------- [config]
- ** ---------- .> app:         tasks:0x7f59b655ffa0
- ** ---------- .> transport:   redis://localhost:6379/0
- ** ---------- .> results:     disabled://
- *** --- * --- .> concurrency: 2 (prefork)
-- ******* ---- .> task events: OFF (enable -E to monitor tasks in this worker)
--- ***** ----- 
 -------------- [queues]
                .> celery           exchange=celery(direct) key=celery
                

[tasks]
  . traffic_collector.consume_traffic_periodically

[2025-03-13 20:01:25,682: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

[2025-03-13 20:01:25,688: INFO/MainProcess] Connected to redis://localhost:6379/0
[2025-03-13 20:01:25,689: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

[2025-03-13 20:01:25,690: INFO/MainProcess] mingle: searching for neighbors
 
 -------------- celery@VM-16-2-ubuntu v5.4.0 (opalescent)
--- ***** ----- 
-- ******* ---- Linux-5.15.0-130-generic-x86_64-with-glibc2.35 2025-03-13 20:01:26
- *** --- * --- 
- ** ---------- [config]
- ** ---------- .> app:         tasks:0x7f88d785ffa0
- ** ---------- .> transport:   redis://localhost:6379/0
- ** ---------- .> results:     disabled://
- *** --- * --- .> concurrency: 2 (prefork)
-- ******* ---- .> task events: OFF (enable -E to monitor tasks in this worker)
--- ***** ----- 
 -------------- [queues]
                .> celery           exchange=celery(direct) key=celery
                

[tasks]
  . traffic_collector.consume_traffic_periodically

[2025-03-13 20:01:26,701: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/app/control.py:56: DuplicateNodenameWarning: Received multiple replies from node name: celery@VM-16-2-ubuntu.
Please make sure you give each node a unique nodename using
the celery worker `-n` option.
  warnings.warn(DuplicateNodenameWarning(

[2025-03-13 20:01:26,701: INFO/MainProcess] mingle: all alone
[2025-03-13 20:01:26,714: INFO/MainProcess] celery@VM-16-2-ubuntu ready.
[2025-03-13 20:01:26,764: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

[2025-03-13 20:01:26,769: INFO/MainProcess] Connected to redis://localhost:6379/0
[2025-03-13 20:01:26,769: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

[2025-03-13 20:01:26,772: INFO/MainProcess] mingle: searching for neighbors
[2025-03-13 20:01:27,783: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/app/control.py:56: DuplicateNodenameWarning: Received multiple replies from node name: celery@VM-16-2-ubuntu.
Please make sure you give each node a unique nodename using
the celery worker `-n` option.
  warnings.warn(DuplicateNodenameWarning(

[2025-03-13 20:01:27,783: INFO/MainProcess] mingle: all alone
[2025-03-13 20:01:27,789: INFO/MainProcess] celery@VM-16-2-ubuntu ready.
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
Traceback (most recent call last):
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/./app.py", line 645, in <module>
    load_target_app()
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/./app.py", line 627, in load_target_app
    write_detection_duration(int(combined_data_duration))
TypeError: int() argument must be a string, a bytes-like object or a real number, not 'NoneType'
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
{'id': 4, 'APP_name': 'New Test App', 'APP_url': 'http://testapp.com', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is a test application', 'created_at': '2025-03-09 14:13:22', 'updated_at': '2025-03-09 14:13:22', 'is_draft': False, 'last_API_discovery_at': None, 'last_model_construction_at': None, 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'user', 'username': 'normaluser', 'password': 'normalpass'}], 'detect_state': 'API_LIST_TO_DISCOVER', 'model_report': None, 'enhanced_detection_enabled': None, 'combined_data_duration': None}
Traceback (most recent call last):
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/./app.py", line 646, in <module>
    load_target_app()
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/./app.py", line 628, in load_target_app
    write_detection_duration(int(combined_data_duration))
TypeError: int() argument must be a string, a bytes-like object or a real number, not 'NoneType'
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-03-13 20:04:34,352 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
{'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test applicationaaaaaaa', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-12 07:10:52', 'is_draft': False, 'last_API_discovery_at': '2025-03-13 07:23:08', 'last_model_construction_at': '2025-03-10 15:53:42', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': '              precision    recall  f1-score   support\n\n           0       0.50      1.00      0.67         2\n           1       0.00      0.00      0.00         2\n\n    accuracy                           0.50         4\n   macro avg       0.25      0.50      0.33         4\nweighted avg       0.25      0.50      0.33         4\n', 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
 * Serving Flask app 'app'
 * Debug mode: on
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-03-13 20:04:36,397 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
{'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test applicationaaaaaaa', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-12 07:10:52', 'is_draft': False, 'last_API_discovery_at': '2025-03-13 07:23:08', 'last_model_construction_at': '2025-03-10 15:53:42', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': '              precision    recall  f1-score   support\n\n           0       0.50      1.00      0.67         2\n           1       0.00      0.00      0.00         2\n\n    accuracy                           0.50         4\n   macro avg       0.25      0.50      0.33         4\nweighted avg       0.25      0.50      0.33         4\n', 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-03-13 20:05:10,500 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
{'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test applicationaaaaaaa', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-12 07:10:52', 'is_draft': False, 'last_API_discovery_at': '2025-03-13 07:23:08', 'last_model_construction_at': '2025-03-10 15:53:42', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': '              precision    recall  f1-score   support\n\n           0       0.50      1.00      0.67         2\n           1       0.00      0.00      0.00         2\n\n    accuracy                           0.50         4\n   macro avg       0.25      0.50      0.33         4\nweighted avg       0.25      0.50      0.33         4\n', 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-03-13 20:05:37,483 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test applicationaaaaaaa', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-12 07:10:52', 'is_draft': False, 'last_API_discovery_at': '2025-03-13 07:23:08', 'last_model_construction_at': '2025-03-10 15:53:42', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': '              precision    recall  f1-score   support\n\n           0       0.50      1.00      0.67         2\n           1       0.00      0.00      0.00         2\n\n    accuracy                           0.50         4\n   macro avg       0.25      0.50      0.33         4\nweighted avg       0.25      0.50      0.33         4\n', 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-13 20:05:37,484 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-03-13 20:05:52,240 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test applicationaaaaaaa', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-12 07:10:52', 'is_draft': False, 'last_API_discovery_at': '2025-03-13 07:23:08', 'last_model_construction_at': '2025-03-10 15:53:42', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': '              precision    recall  f1-score   support\n\n           0       0.50      1.00      0.67         2\n           1       0.00      0.00      0.00         2\n\n    accuracy                           0.50         4\n   macro avg       0.25      0.50      0.33         4\nweighted avg       0.25      0.50      0.33         4\n', 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-13 20:05:52,240 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7

Restarting celery worker (/home/ubuntu/.local/bin/celery -A traffic_collector.celery worker --loglevel=info)

Restarting celery worker (/home/ubuntu/.local/bin/celery -A traffic_collector.celery worker --loglevel=info)
[2025-03-13 20:08:12,574: INFO/MainProcess] Task traffic_collector.consume_traffic_periodically[db6bda72-7904-4246-a20d-801ac022254f] received
 
 -------------- celery@VM-16-2-ubuntu v5.4.0 (opalescent)
--- ***** ----- 
-- ******* ---- Linux-5.15.0-130-generic-x86_64-with-glibc2.35 2025-03-13 20:08:12
- *** --- * --- 
- ** ---------- [config]
- ** ---------- .> app:         tasks:0x7f6ef5f3f1f0
- ** ---------- .> transport:   redis://localhost:6379/0
- ** ---------- .> results:     disabled://
- *** --- * --- .> concurrency: 2 (prefork)
-- ******* ---- .> task events: OFF (enable -E to monitor tasks in this worker)
--- ***** ----- 
 -------------- [queues]
                .> celery           exchange=celery(direct) key=celery
                

[tasks]
  . traffic_collector.consume_traffic_periodically

 
 -------------- celery@VM-16-2-ubuntu v5.4.0 (opalescent)
--- ***** ----- 
-- ******* ---- Linux-5.15.0-130-generic-x86_64-with-glibc2.35 2025-03-13 20:08:12
- *** --- * --- 
- ** ---------- [config]
- ** ---------- .> app:         tasks:0x7fd465e631f0
- ** ---------- .> transport:   redis://localhost:6379/0
- ** ---------- .> results:     disabled://
- *** --- * --- .> concurrency: 2 (prefork)
-- ******* ---- .> task events: OFF (enable -E to monitor tasks in this worker)
--- ***** ----- 
 -------------- [queues]
                .> celery           exchange=celery(direct) key=celery
                

[tasks]
  . traffic_collector.consume_traffic_periodically

[2025-03-13 20:08:12,926: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

[2025-03-13 20:08:12,948: INFO/MainProcess] Connected to redis://localhost:6379/0
[2025-03-13 20:08:12,949: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

[2025-03-13 20:08:12,959: INFO/MainProcess] mingle: searching for neighbors
[2025-03-13 20:08:13,134: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

[2025-03-13 20:08:13,145: INFO/MainProcess] Connected to redis://localhost:6379/0
[2025-03-13 20:08:13,146: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

[2025-03-13 20:08:13,152: INFO/MainProcess] mingle: searching for neighbors
[2025-03-13 20:08:13,971: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/app/control.py:56: DuplicateNodenameWarning: Received multiple replies from node name: celery@VM-16-2-ubuntu.
Please make sure you give each node a unique nodename using
the celery worker `-n` option.
  warnings.warn(DuplicateNodenameWarning(

[2025-03-13 20:08:13,971: INFO/MainProcess] mingle: all alone
[2025-03-13 20:08:13,978: INFO/MainProcess] celery@VM-16-2-ubuntu ready.
[2025-03-13 20:08:14,162: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/app/control.py:56: DuplicateNodenameWarning: Received multiple replies from node name: celery@VM-16-2-ubuntu.
Please make sure you give each node a unique nodename using
the celery worker `-n` option.
  warnings.warn(DuplicateNodenameWarning(

[2025-03-13 20:08:14,162: INFO/MainProcess] mingle: all alone
[2025-03-13 20:08:14,169: INFO/MainProcess] celery@VM-16-2-ubuntu ready.
 
 -------------- celery@VM-16-2-ubuntu v5.4.0 (opalescent)
--- ***** ----- 
-- ******* ---- Linux-5.15.0-130-generic-x86_64-with-glibc2.35 2025-03-13 20:19:58
- *** --- * --- 
- ** ---------- [config]
- ** ---------- .> app:         tasks:0x7f07a875bfd0
- ** ---------- .> transport:   redis://localhost:6379/0
- ** ---------- .> results:     disabled://
- *** --- * --- .> concurrency: 2 (prefork)
-- ******* ---- .> task events: OFF (enable -E to monitor tasks in this worker)
--- ***** ----- 
 -------------- [queues]
                .> celery           exchange=celery(direct) key=celery
                

[tasks]
  . traffic_collector.consume_traffic_periodically

[2025-03-13 20:19:58,352: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

[2025-03-13 20:19:58,362: INFO/MainProcess] Connected to redis://localhost:6379/0
[2025-03-13 20:19:58,363: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

[2025-03-13 20:19:58,374: INFO/MainProcess] mingle: searching for neighbors
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-03-13 20:19:58,976 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test applicationaaaaaaa', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-12 07:10:52', 'is_draft': False, 'last_API_discovery_at': '2025-03-13 07:23:08', 'last_model_construction_at': '2025-03-10 15:53:42', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': '              precision    recall  f1-score   support\n\n           0       0.50      1.00      0.67         2\n           1       0.00      0.00      0.00         2\n\n    accuracy                           0.50         4\n   macro avg       0.25      0.50      0.33         4\nweighted avg       0.25      0.50      0.33         4\n', 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-13 20:19:58,977 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
 * Serving Flask app 'app'
 * Debug mode: on
[2025-03-13 20:19:59,380: INFO/MainProcess] mingle: all alone
[2025-03-13 20:19:59,389: INFO/MainProcess] celery@VM-16-2-ubuntu ready.
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-03-13 20:20:00,876 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test applicationaaaaaaa', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-12 07:10:52', 'is_draft': False, 'last_API_discovery_at': '2025-03-13 07:23:08', 'last_model_construction_at': '2025-03-10 15:53:42', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': '              precision    recall  f1-score   support\n\n           0       0.50      1.00      0.67         2\n           1       0.00      0.00      0.00         2\n\n    accuracy                           0.50         4\n   macro avg       0.25      0.50      0.33         4\nweighted avg       0.25      0.50      0.33         4\n', 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-13 20:20:00,876 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
2025-03-13 20:34:41,681 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-13 20:34:41,874 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-13 20:34:41,874 - INFO - Extracting API list with API discovery algorithm...
2025-03-13 20:34:41,947 - INFO - Starting Drain3 template miner
2025-03-13 20:34:41,951 - INFO - Starting Drain3 template miner
2025-03-13 20:34:41,952 - INFO - Starting Drain3 template miner
2025-03-13 20:34:41,953 - INFO - Starting Drain3 template miner
2025-03-13 20:34:41,953 - INFO - Starting Drain3 template miner
2025-03-13 20:34:43,397 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
[2025-03-13 20:34:44,407: ERROR/MainProcess] Received unregistered task of type 'SFWAP.views.handle_api_discovery_notification'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[["1", {"discovered_API_list": [{"function_description": "Please fill in the function description", "permission_info": "Please fill in the permission info", "sample_url": "http://47.97.114.24:5230/api/v1/memo/20", "sample_request_data": {}, "request_method": "GET", "path_segments": [{"name": "api", "is_path_variable": false}, {"name": "v1", "is_path_variable": false}, {"name": "memo", "is_path_variable": false}, {"name": "<NUM>", "is_path_variable": true}], "request_param_list": [], "request_data_fields": []}, {"function_description": "Please fill in the function description", "permission_info": "Please fill in the permission info", "sample_url": "http://47.97.114.24:5230/o/r/15?thumbnail=1", "sample_request_data": {}, "request_method": "GET", "path_segments": [{"name": "o", "is_path_variable": false}, {"name": "r", "is_path_variable": false}, {"name": "<NUM>", "is_path_variable": true}], "request_param_list": [{"name": "thumbnail", "is_necessary": true}], "request_data_fields": []},... (29391b)

The full contents of the message headers:
{'lang': 'py', 'task': 'SFWAP.views.handle_api_discovery_notification', 'id': 'ce9d9772-afad-4baf-a800-f00eae0516b7', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': 'ce9d9772-afad-4baf-a800-f00eae0516b7', 'parent_id': None, 'argsrepr': "('1', {'discovered_API_list': [{...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}]})", 'kwargsrepr': '{}', 'origin': 'gen2766@VM-16-2-ubuntu', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "/home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
KeyError: 'SFWAP.views.handle_api_discovery_notification'
[2025-03-13 20:39:55,186: INFO/MainProcess] Task traffic_collector.consume_traffic_periodically[4bad56ec-902f-45d9-b746-9a78d76514cf] received
2025-03-13 20:40:08,319 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-13 20:40:08,372 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-13 20:40:08,372 - INFO - Extracting API list with API discovery algorithm...
2025-03-13 20:40:08,434 - INFO - Starting Drain3 template miner
2025-03-13 20:40:08,437 - INFO - Starting Drain3 template miner
2025-03-13 20:40:08,438 - INFO - Starting Drain3 template miner
2025-03-13 20:40:08,439 - INFO - Starting Drain3 template miner
2025-03-13 20:40:08,439 - INFO - Starting Drain3 template miner
2025-03-13 20:40:09,854 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
 
 -------------- celery@VM-16-2-ubuntu v5.4.0 (opalescent)
--- ***** ----- 
-- ******* ---- Linux-5.15.0-130-generic-x86_64-with-glibc2.35 2025-03-13 20:42:24
- *** --- * --- 
- ** ---------- [config]
- ** ---------- .> app:         tasks:0x7f128a74bfd0
- ** ---------- .> transport:   redis://localhost:6379/0
- ** ---------- .> results:     disabled://
- *** --- * --- .> concurrency: 2 (prefork)
-- ******* ---- .> task events: OFF (enable -E to monitor tasks in this worker)
--- ***** ----- 
 -------------- [queues]
                .> celery           exchange=celery(direct) key=celery
                

[tasks]
  . traffic_collector.consume_traffic_periodically

[2025-03-13 20:42:24,479: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

[2025-03-13 20:42:24,484: INFO/MainProcess] Connected to redis://localhost:6379/0
[2025-03-13 20:42:24,485: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

[2025-03-13 20:42:24,488: INFO/MainProcess] mingle: searching for neighbors
[2025-03-13 20:42:25,495: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/app/control.py:56: DuplicateNodenameWarning: Received multiple replies from node name: celery@VM-16-2-ubuntu.
Please make sure you give each node a unique nodename using
the celery worker `-n` option.
  warnings.warn(DuplicateNodenameWarning(

[2025-03-13 20:42:25,495: INFO/MainProcess] mingle: all alone
[2025-03-13 20:42:25,501: INFO/MainProcess] celery@VM-16-2-ubuntu ready.
2025-03-13 20:42:34,523 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-13 20:42:34,566 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-13 20:42:34,567 - INFO - Extracting API list with API discovery algorithm...
2025-03-13 20:42:34,625 - INFO - Starting Drain3 template miner
2025-03-13 20:42:34,627 - INFO - Starting Drain3 template miner
2025-03-13 20:42:34,629 - INFO - Starting Drain3 template miner
2025-03-13 20:42:34,629 - INFO - Starting Drain3 template miner
2025-03-13 20:42:34,630 - INFO - Starting Drain3 template miner
2025-03-13 20:42:36,033 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
[2025-03-13 20:42:36,138: ERROR/MainProcess] Received unregistered task of type 'SFWAP.views.handle_api_discovery_notification'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[["1", {"discovered_API_list": [{"function_description": "Please fill in the function description", "permission_info": "Please fill in the permission info", "sample_url": "http://47.97.114.24:5230/api/v1/memo/20", "sample_request_data": {}, "request_method": "GET", "path_segments": [{"name": "api", "is_path_variable": false}, {"name": "v1", "is_path_variable": false}, {"name": "memo", "is_path_variable": false}, {"name": "<NUM>", "is_path_variable": true}], "request_param_list": [], "request_data_fields": []}, {"function_description": "Please fill in the function description", "permission_info": "Please fill in the permission info", "sample_url": "http://47.97.114.24:5230/o/r/15?thumbnail=1", "sample_request_data": {}, "request_method": "GET", "path_segments": [{"name": "o", "is_path_variable": false}, {"name": "r", "is_path_variable": false}, {"name": "<NUM>", "is_path_variable": true}], "request_param_list": [{"name": "thumbnail", "is_necessary": true}], "request_data_fields": []},... (29391b)

The full contents of the message headers:
{'lang': 'py', 'task': 'SFWAP.views.handle_api_discovery_notification', 'id': 'fa46bd88-46f7-4952-8583-e90aa3ce2ae2', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': 'fa46bd88-46f7-4952-8583-e90aa3ce2ae2', 'parent_id': None, 'argsrepr': "('1', {'discovered_API_list': [{...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}]})", 'kwargsrepr': '{}', 'origin': 'gen2766@VM-16-2-ubuntu', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "/home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
KeyError: 'SFWAP.views.handle_api_discovery_notification'
2025-03-13 20:43:53,971 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-13 20:43:54,014 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-13 20:43:54,014 - INFO - Extracting API list with API discovery algorithm...
2025-03-13 20:43:54,073 - INFO - Starting Drain3 template miner
2025-03-13 20:43:54,076 - INFO - Starting Drain3 template miner
2025-03-13 20:43:54,077 - INFO - Starting Drain3 template miner
2025-03-13 20:43:54,078 - INFO - Starting Drain3 template miner
2025-03-13 20:43:54,078 - INFO - Starting Drain3 template miner
2025-03-13 20:43:55,509 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-13 20:43:58,683 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-13 20:43:58,741 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-13 20:43:58,742 - INFO - Extracting API list with API discovery algorithm...
2025-03-13 20:43:58,809 - INFO - Starting Drain3 template miner
2025-03-13 20:43:58,812 - INFO - Starting Drain3 template miner
2025-03-13 20:43:58,813 - INFO - Starting Drain3 template miner
2025-03-13 20:43:58,814 - INFO - Starting Drain3 template miner
2025-03-13 20:43:58,815 - INFO - Starting Drain3 template miner
2025-03-13 20:44:00,245 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-13 20:44:00,707 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-13 20:44:00,750 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-13 20:44:00,750 - INFO - Extracting API list with API discovery algorithm...
2025-03-13 20:44:00,809 - INFO - Starting Drain3 template miner
2025-03-13 20:44:00,812 - INFO - Starting Drain3 template miner
2025-03-13 20:44:00,813 - INFO - Starting Drain3 template miner
2025-03-13 20:44:00,814 - INFO - Starting Drain3 template miner
2025-03-13 20:44:00,815 - INFO - Starting Drain3 template miner
2025-03-13 20:44:02,269 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-13 20:44:02,705 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-13 20:44:02,746 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-13 20:44:02,746 - INFO - Extracting API list with API discovery algorithm...
2025-03-13 20:44:02,806 - INFO - Starting Drain3 template miner
2025-03-13 20:44:02,808 - INFO - Starting Drain3 template miner
2025-03-13 20:44:02,810 - INFO - Starting Drain3 template miner
2025-03-13 20:44:02,810 - INFO - Starting Drain3 template miner
2025-03-13 20:44:02,811 - INFO - Starting Drain3 template miner
2025-03-13 20:44:04,248 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json

Restarting celery worker (/home/ubuntu/.local/bin/celery -A traffic_collector.celery worker --loglevel=info)
 
 -------------- celery@VM-16-2-ubuntu v5.4.0 (opalescent)
--- ***** ----- 
-- ******* ---- Linux-5.15.0-130-generic-x86_64-with-glibc2.35 2025-03-13 20:44:41
- *** --- * --- 
- ** ---------- [config]
- ** ---------- .> app:         tasks:0x7fb7e3a62830
- ** ---------- .> transport:   redis://localhost:6379/0
- ** ---------- .> results:     disabled://
- *** --- * --- .> concurrency: 2 (prefork)
-- ******* ---- .> task events: OFF (enable -E to monitor tasks in this worker)
--- ***** ----- 
 -------------- [queues]
                .> celery           exchange=celery(direct) key=celery
                

[tasks]
  . traffic_collector.consume_traffic_periodically

[2025-03-13 20:44:41,691: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

[2025-03-13 20:44:41,696: INFO/MainProcess] Connected to redis://localhost:6379/0
[2025-03-13 20:44:41,697: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

[2025-03-13 20:44:41,698: INFO/MainProcess] mingle: searching for neighbors
[2025-03-13 20:44:42,706: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/app/control.py:56: DuplicateNodenameWarning: Received multiple replies from node name: celery@VM-16-2-ubuntu.
Please make sure you give each node a unique nodename using
the celery worker `-n` option.
  warnings.warn(DuplicateNodenameWarning(

[2025-03-13 20:44:42,706: INFO/MainProcess] mingle: all alone
[2025-03-13 20:44:42,713: INFO/MainProcess] celery@VM-16-2-ubuntu ready.
2025-03-13 22:29:04,540 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-13 22:29:04,585 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-13 22:29:04,585 - INFO - Extracting API list with API discovery algorithm...
2025-03-13 22:29:04,645 - INFO - Starting Drain3 template miner
2025-03-13 22:29:04,648 - INFO - Starting Drain3 template miner
2025-03-13 22:29:04,650 - INFO - Starting Drain3 template miner
2025-03-13 22:29:04,651 - INFO - Starting Drain3 template miner
2025-03-13 22:29:04,651 - INFO - Starting Drain3 template miner
2025-03-13 22:29:06,092 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-03-13 23:28:10,786 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test applicationaaaaaaa', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-12 07:10:52', 'is_draft': False, 'last_API_discovery_at': '2025-03-13 14:29:06', 'last_model_construction_at': '2025-03-10 15:53:42', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': '              precision    recall  f1-score   support\n\n           0       0.50      1.00      0.67         2\n           1       0.00      0.00      0.00         2\n\n    accuracy                           0.50         4\n   macro avg       0.25      0.50      0.33         4\nweighted avg       0.25      0.50      0.33         4\n', 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-13 23:28:10,787 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
 * Serving Flask app 'app'
 * Debug mode: on
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-03-13 23:28:13,902 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test applicationaaaaaaa', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-12 07:10:52', 'is_draft': False, 'last_API_discovery_at': '2025-03-13 14:29:06', 'last_model_construction_at': '2025-03-10 15:53:42', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': '              precision    recall  f1-score   support\n\n           0       0.50      1.00      0.67         2\n           1       0.00      0.00      0.00         2\n\n    accuracy                           0.50         4\n   macro avg       0.25      0.50      0.33         4\nweighted avg       0.25      0.50      0.33         4\n', 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-13 23:28:13,902 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
 
 -------------- celery@VM-16-2-ubuntu v5.4.0 (opalescent)
--- ***** ----- 
-- ******* ---- Linux-5.15.0-130-generic-x86_64-with-glibc2.35 2025-03-13 23:28:14
- *** --- * --- 
- ** ---------- [config]
- ** ---------- .> app:         tasks:0x7fab39f5ffa0
- ** ---------- .> transport:   redis://localhost:6379/0
- ** ---------- .> results:     disabled://
- *** --- * --- .> concurrency: 2 (prefork)
-- ******* ---- .> task events: OFF (enable -E to monitor tasks in this worker)
--- ***** ----- 
 -------------- [queues]
                .> celery           exchange=celery(direct) key=celery
                

[tasks]
  . traffic_collector.consume_traffic_periodically

[2025-03-13 23:28:14,537: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

[2025-03-13 23:28:14,543: INFO/MainProcess] Connected to redis://localhost:6379/0
[2025-03-13 23:28:14,544: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

[2025-03-13 23:28:14,545: INFO/MainProcess] mingle: searching for neighbors
[2025-03-13 23:28:15,556: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/app/control.py:56: DuplicateNodenameWarning: Received multiple replies from node name: celery@VM-16-2-ubuntu.
Please make sure you give each node a unique nodename using
the celery worker `-n` option.
  warnings.warn(DuplicateNodenameWarning(

[2025-03-13 23:28:15,557: INFO/MainProcess] mingle: all alone
[2025-03-13 23:28:15,563: INFO/MainProcess] celery@VM-16-2-ubuntu ready.
2025-03-13 23:44:33,167 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-13 23:44:33,341 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-13 23:44:33,373 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-13 23:44:33,374 - INFO - Starting data generation...
2025-03-13 23:44:33,375 - INFO - API_KNOWLEDGE: [{'number': 'API_2417', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_2418', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}]
2025-03-13 23:44:33,375 - INFO - APP_KNOWLEDGE: {'func_description': 'This is an updated test applicationaaaaaaa', 'normal_seqs': ['Role: admin; API_2417(Call 1); API_2418(Call 2)', 'Role: oridinary_user; API_2417(); API_2418()'], 'malicious_seqs': ['Role: admin; API_2417(); API_2418()', 'Role: ordinary_user; API_2417(); API_2418()'], 'roles': ['admin', 'ordinary_user', 'unlogged_in_user']}
2025-03-13 23:44:33,751 - INFO - Generating simulated API sequences...
2025-03-13 23:44:33,751 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-13 23:44:33,751 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-13 23:44:35,286 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 23:44:35,324 - INFO - ========== Method gen_api_seq() returned: seq=['API_2417', 'API_2418'], malicious_sign_seq=[0, 0] ==========
2025-03-13 23:44:35,324 - INFO - ========== Method gen_api_seq() returned: seq=['API_2417', 'API_2418'], malicious_sign_seq=[0, 0] ==========
2025-03-13 23:44:35,324 - INFO - API sequence 1/12 generated
2025-03-13 23:44:35,324 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-13 23:44:35,324 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-13 23:44:38,656 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 23:44:38,657 - INFO - ========== Method gen_api_seq() returned: seq=['API_2417', 'API_2418'], malicious_sign_seq=[0, 0] ==========
2025-03-13 23:44:38,657 - INFO - ========== Method gen_api_seq() returned: seq=['API_2417', 'API_2418'], malicious_sign_seq=[0, 0] ==========
2025-03-13 23:44:38,657 - INFO - API sequence 2/12 generated
2025-03-13 23:44:38,657 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-13 23:44:38,657 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-13 23:44:40,021 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 23:44:40,022 - INFO - ========== Method gen_api_seq() returned: seq=['API_2417', 'API_2418'], malicious_sign_seq=[0, 0] ==========
2025-03-13 23:44:40,022 - INFO - ========== Method gen_api_seq() returned: seq=['API_2417', 'API_2418'], malicious_sign_seq=[0, 0] ==========
2025-03-13 23:44:40,022 - INFO - API sequence 3/12 generated
2025-03-13 23:44:40,022 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-13 23:44:40,022 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-13 23:44:42,676 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 23:44:42,677 - INFO - ========== Method gen_api_seq() returned: seq=['API_2417', 'API_2418'], malicious_sign_seq=[0, 1] ==========
2025-03-13 23:44:42,677 - INFO - ========== Method gen_api_seq() returned: seq=['API_2417', 'API_2418'], malicious_sign_seq=[0, 1] ==========
2025-03-13 23:44:42,677 - INFO - API sequence 4/12 generated
2025-03-13 23:44:42,677 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-13 23:44:42,677 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-13 23:44:43,936 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 23:44:43,937 - INFO - ========== Method gen_api_seq() returned: seq=['API_2417', 'API_2418'], malicious_sign_seq=[0, 1] ==========
2025-03-13 23:44:43,937 - INFO - ========== Method gen_api_seq() returned: seq=['API_2417', 'API_2418'], malicious_sign_seq=[0, 1] ==========
2025-03-13 23:44:43,937 - INFO - API sequence 5/12 generated
2025-03-13 23:44:43,938 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-13 23:44:43,938 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-13 23:44:45,100 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 23:44:45,101 - INFO - ========== Method gen_api_seq() returned: seq=['API_2417', 'API_2418'], malicious_sign_seq=[0, 1] ==========
2025-03-13 23:44:45,101 - INFO - ========== Method gen_api_seq() returned: seq=['API_2417', 'API_2418'], malicious_sign_seq=[0, 1] ==========
2025-03-13 23:44:45,101 - INFO - API sequence 6/12 generated
2025-03-13 23:44:45,101 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-13 23:44:45,101 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-13 23:44:46,911 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 23:44:46,912 - INFO - ========== Method gen_api_seq() returned: seq=['API_2417', 'API_2418'], malicious_sign_seq=[0, 1] ==========
2025-03-13 23:44:46,912 - INFO - ========== Method gen_api_seq() returned: seq=['API_2417', 'API_2418'], malicious_sign_seq=[0, 1] ==========
2025-03-13 23:44:46,912 - INFO - API sequence 7/12 generated
2025-03-13 23:44:46,912 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-13 23:44:46,912 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-13 23:44:48,224 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 23:44:48,225 - INFO - ========== Method gen_api_seq() returned: seq=['API_2417', 'API_2418'], malicious_sign_seq=[0, 0] ==========
2025-03-13 23:44:48,225 - INFO - ========== Method gen_api_seq() returned: seq=['API_2417', 'API_2418'], malicious_sign_seq=[0, 0] ==========
2025-03-13 23:44:48,225 - INFO - API sequence 8/12 generated
2025-03-13 23:44:48,225 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-13 23:44:48,225 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-13 23:44:49,878 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 23:44:49,879 - INFO - ========== Method gen_api_seq() returned: seq=['API_2417', 'API_2418'], malicious_sign_seq=[0, 0] ==========
2025-03-13 23:44:49,879 - INFO - ========== Method gen_api_seq() returned: seq=['API_2417', 'API_2418'], malicious_sign_seq=[0, 0] ==========
2025-03-13 23:44:49,879 - INFO - API sequence 9/12 generated
2025-03-13 23:44:49,879 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-13 23:44:49,879 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-13 23:44:52,293 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 23:44:52,294 - INFO - ========== Method gen_api_seq() returned: seq=['API_2417', 'API_2418'], malicious_sign_seq=[0, 1] ==========
2025-03-13 23:44:52,294 - INFO - ========== Method gen_api_seq() returned: seq=['API_2417', 'API_2418'], malicious_sign_seq=[0, 1] ==========
2025-03-13 23:44:52,294 - INFO - API sequence 10/12 generated
2025-03-13 23:44:52,294 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-13 23:44:52,294 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-13 23:44:54,825 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 23:44:54,826 - INFO - ========== Method gen_api_seq() returned: seq=['API_2417', 'API_2418'], malicious_sign_seq=[0, 1] ==========
2025-03-13 23:44:54,826 - INFO - ========== Method gen_api_seq() returned: seq=['API_2417', 'API_2418'], malicious_sign_seq=[0, 1] ==========
2025-03-13 23:44:54,826 - INFO - API sequence 11/12 generated
2025-03-13 23:44:54,827 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-13 23:44:54,827 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-13 23:44:57,265 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-13 23:44:57,266 - INFO - ========== Method gen_api_seq() returned: seq=['API_2417', 'API_2418'], malicious_sign_seq=[0, 0] ==========
2025-03-13 23:44:57,266 - INFO - ========== Method gen_api_seq() returned: seq=['API_2417', 'API_2418'], malicious_sign_seq=[0, 0] ==========
2025-03-13 23:44:57,266 - INFO - API sequence 12/12 generated
2025-03-13 23:44:57,266 - INFO - API sequences serialized to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py/serialized_llm_agents.json
2025-03-13 23:44:57,266 - INFO - Generating simulated traffic data set...
2025-03-13 23:44:57,267 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-13 23:44:57,267 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 23:44:57,267 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/memo/21 {}
2025-03-13 23:44:57,267 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 23:44:57,267 - INFO - Simulated traffic data for 1/12 user collected：user: normaluser malicious: False
2025-03-13 23:44:57,267 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-13 23:44:57,267 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 23:44:57,267 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-13 23:44:57,267 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 23:44:57,268 - INFO - Simulated traffic data for 2/12 user collected：user: normaluser malicious: False
2025-03-13 23:44:57,268 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-13 23:44:57,268 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 23:44:57,268 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-13 23:44:57,268 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 23:44:57,268 - INFO - Simulated traffic data for 3/12 user collected：user: adminuser malicious: False
2025-03-13 23:44:57,268 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-13 23:44:57,268 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 23:44:57,268 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-13 23:44:57,268 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-13 23:44:57,268 - INFO - Simulated traffic data for 4/12 user collected：user: unloggeduser malicious: True
2025-03-13 23:44:57,269 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-13 23:44:57,269 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 23:44:57,269 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-13 23:44:57,269 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-13 23:44:57,269 - INFO - Simulated traffic data for 5/12 user collected：user: unloggeduser malicious: True
2025-03-13 23:44:57,269 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/resource/16 {}
2025-03-13 23:44:57,269 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 23:44:57,269 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-13 23:44:57,269 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-13 23:44:57,269 - INFO - Simulated traffic data for 6/12 user collected：user: normaluser malicious: True
2025-03-13 23:44:57,269 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-13 23:44:57,269 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 23:44:57,270 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-13 23:44:57,270 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-13 23:44:57,270 - INFO - Simulated traffic data for 7/12 user collected：user: normaluser malicious: True
2025-03-13 23:44:57,270 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-13 23:44:57,270 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 23:44:57,270 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-13 23:44:57,270 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 23:44:57,270 - INFO - Simulated traffic data for 8/12 user collected：user: normaluser malicious: False
2025-03-13 23:44:57,270 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-13 23:44:57,270 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 23:44:57,270 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-13 23:44:57,271 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 23:44:57,271 - INFO - Simulated traffic data for 9/12 user collected：user: adminuser malicious: False
2025-03-13 23:44:57,271 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-13 23:44:57,271 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 23:44:57,271 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-13 23:44:57,271 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-13 23:44:57,271 - INFO - Simulated traffic data for 10/12 user collected：user: unloggeduser malicious: True
2025-03-13 23:44:57,271 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-13 23:44:57,271 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 23:44:57,271 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/memo/21 {}
2025-03-13 23:44:57,271 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-13 23:44:57,271 - INFO - Simulated traffic data for 11/12 user collected：user: normaluser malicious: True
2025-03-13 23:44:57,272 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-13 23:44:57,272 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 23:44:57,272 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-13 23:44:57,272 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-13 23:44:57,272 - INFO - Simulated traffic data for 12/12 user collected：user: normaluser malicious: False
2025-03-13 23:44:57,283 - INFO - All simulated traffic data collected：/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/simulated_traffic_data.csv
2025-03-13 23:57:22,240 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-13 23:57:22,284 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-13 23:57:22,284 - INFO - Extracting API list with API discovery algorithm...
2025-03-13 23:57:22,353 - INFO - Starting Drain3 template miner
2025-03-13 23:57:22,356 - INFO - Starting Drain3 template miner
2025-03-13 23:57:22,358 - INFO - Starting Drain3 template miner
2025-03-13 23:57:22,359 - INFO - Starting Drain3 template miner
2025-03-13 23:57:22,359 - INFO - Starting Drain3 template miner
2025-03-13 23:57:23,752 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json

Restarting celery worker (/home/ubuntu/.local/bin/celery -A traffic_collector.celery worker --loglevel=info)
 
 -------------- celery@VM-16-2-ubuntu v5.4.0 (opalescent)
--- ***** ----- 
-- ******* ---- Linux-5.15.0-130-generic-x86_64-with-glibc2.35 2025-03-14 02:58:17
- *** --- * --- 
- ** ---------- [config]
- ** ---------- .> app:         tasks:0x7f7fd815b1f0
- ** ---------- .> transport:   redis://localhost:6379/0
- ** ---------- .> results:     disabled://
- *** --- * --- .> concurrency: 2 (prefork)
-- ******* ---- .> task events: OFF (enable -E to monitor tasks in this worker)
--- ***** ----- 
 -------------- [queues]
                .> celery           exchange=celery(direct) key=celery
                

[tasks]
  . traffic_collector.consume_traffic_periodically

[2025-03-14 02:58:17,351: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

[2025-03-14 02:58:17,356: INFO/MainProcess] Connected to redis://localhost:6379/0
[2025-03-14 02:58:17,356: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

[2025-03-14 02:58:17,360: INFO/MainProcess] mingle: searching for neighbors
[2025-03-14 02:58:18,369: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/app/control.py:56: DuplicateNodenameWarning: Received multiple replies from node name: celery@VM-16-2-ubuntu.
Please make sure you give each node a unique nodename using
the celery worker `-n` option.
  warnings.warn(DuplicateNodenameWarning(

[2025-03-14 02:58:18,370: INFO/MainProcess] mingle: all alone
[2025-03-14 02:58:18,376: INFO/MainProcess] celery@VM-16-2-ubuntu ready.
2025-03-14 09:02:07,686 - INFO - Trying to construct model...
2025-03-14 09:02:07,687 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-14 09:02:07,740 - INFO - Training model... Size of feature_list: 8
2025-03-14 09:02:07,755 - INFO - Extracting features... Size of feature_list: 8
2025-03-14 09:02:07,762 - INFO - Extracting features... Size of feature_list: 8
2025-03-14 09:02:07,764 - INFO - Extracting features... Size of feature_list: 8
2025-03-14 09:02:07,766 - INFO - Extracting features... Size of feature_list: 8
2025-03-14 09:02:07,767 - INFO - Extracting features... Size of feature_list: 8
2025-03-14 09:02:07,769 - INFO - Extracting features... Size of feature_list: 8
2025-03-14 09:02:07,771 - INFO - Extracting features... Size of feature_list: 8
2025-03-14 09:02:07,772 - INFO - Extracting features... Size of feature_list: 8
[09:02:07] WARNING: /workspace/src/learner.cc:740: 
Parameters: { "use_label_encoder" } are not used.

2025-03-14 09:02:07,901 - INFO - Extracting features... Size of feature_list: 8
2025-03-14 09:02:07,903 - INFO - Extracting features... Size of feature_list: 8
2025-03-14 09:02:07,906 - INFO - Extracting features... Size of feature_list: 8
2025-03-14 09:02:07,908 - INFO - Extracting features... Size of feature_list: 8
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
2025-03-14 09:02:07,950 - INFO - Model constructed.
2025-03-14 09:06:29,022 - INFO - Trying to construct model...
2025-03-14 09:06:29,024 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-14 09:06:29,058 - INFO - Training model... Size of feature_list: 8
2025-03-14 09:06:29,069 - INFO - Extracting features... Size of feature_list: 8
2025-03-14 09:06:29,071 - INFO - Extracting features... Size of feature_list: 8
2025-03-14 09:06:29,073 - INFO - Extracting features... Size of feature_list: 8
2025-03-14 09:06:29,074 - INFO - Extracting features... Size of feature_list: 8
2025-03-14 09:06:29,076 - INFO - Extracting features... Size of feature_list: 8
2025-03-14 09:06:29,078 - INFO - Extracting features... Size of feature_list: 8
2025-03-14 09:06:29,079 - INFO - Extracting features... Size of feature_list: 8
2025-03-14 09:06:29,081 - INFO - Extracting features... Size of feature_list: 8
[09:06:29] WARNING: /workspace/src/learner.cc:740: 
Parameters: { "use_label_encoder" } are not used.

2025-03-14 09:06:29,112 - INFO - Extracting features... Size of feature_list: 8
2025-03-14 09:06:29,115 - INFO - Extracting features... Size of feature_list: 8
2025-03-14 09:06:29,116 - INFO - Extracting features... Size of feature_list: 8
2025-03-14 09:06:29,118 - INFO - Extracting features... Size of feature_list: 8
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
2025-03-14 09:06:29,131 - INFO - Model constructed.
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-03-14 10:07:02,030 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-13 15:57:24', 'last_model_construction_at': '2025-03-14 01:06:29', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.5, 1.0, 0.67, 2.0, 0.0, 0.0, 0.0, 2.0, 0.5, 4.0, 0.25, 0.5, 0.33, 4.0, 0.25, 0.5, 0.33, 4.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-14 10:07:02,031 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 6
 * Serving Flask app 'app'
 * Debug mode: on
 
 -------------- celery@VM-16-2-ubuntu v5.4.0 (opalescent)
--- ***** ----- 
-- ******* ---- Linux-5.15.0-130-generic-x86_64-with-glibc2.35 2025-03-14 10:07:04
- *** --- * --- 
- ** ---------- [config]
- ** ---------- .> app:         tasks:0x7f2b68c77fa0
- ** ---------- .> transport:   redis://localhost:6379/0
- ** ---------- .> results:     disabled://
- *** --- * --- .> concurrency: 2 (prefork)
-- ******* ---- .> task events: OFF (enable -E to monitor tasks in this worker)
--- ***** ----- 
 -------------- [queues]
                .> celery           exchange=celery(direct) key=celery
                

[tasks]
  . traffic_collector.consume_traffic_periodically

None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-03-14 10:07:04,785 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-13 15:57:24', 'last_model_construction_at': '2025-03-14 01:06:29', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.5, 1.0, 0.67, 2.0, 0.0, 0.0, 0.0, 2.0, 0.5, 4.0, 0.25, 0.5, 0.33, 4.0, 0.25, 0.5, 0.33, 4.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-14 10:07:04,785 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 6
[2025-03-14 10:07:04,827: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

[2025-03-14 10:07:04,833: INFO/MainProcess] Connected to redis://localhost:6379/0
[2025-03-14 10:07:04,835: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

[2025-03-14 10:07:04,846: INFO/MainProcess] mingle: searching for neighbors
[2025-03-14 10:07:05,855: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/app/control.py:56: DuplicateNodenameWarning: Received multiple replies from node name: celery@VM-16-2-ubuntu.
Please make sure you give each node a unique nodename using
the celery worker `-n` option.
  warnings.warn(DuplicateNodenameWarning(

[2025-03-14 10:07:05,856: INFO/MainProcess] mingle: all alone
[2025-03-14 10:07:05,862: INFO/MainProcess] celery@VM-16-2-ubuntu ready.
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-03-14 10:08:30,127 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-13 15:57:24', 'last_model_construction_at': '2025-03-14 01:06:29', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.5, 1.0, 0.67, 2.0, 0.0, 0.0, 0.0, 2.0, 0.5, 4.0, 0.25, 0.5, 0.33, 4.0, 0.25, 0.5, 0.33, 4.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-14 10:08:30,127 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 6
 * Serving Flask app 'app'
 * Debug mode: on
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-03-14 10:08:32,337 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-13 15:57:24', 'last_model_construction_at': '2025-03-14 01:06:29', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.5, 1.0, 0.67, 2.0, 0.0, 0.0, 0.0, 2.0, 0.5, 4.0, 0.25, 0.5, 0.33, 4.0, 0.25, 0.5, 0.33, 4.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-14 10:08:32,337 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 6
 
 -------------- celery@VM-16-2-ubuntu v5.4.0 (opalescent)
--- ***** ----- 
-- ******* ---- Linux-5.15.0-130-generic-x86_64-with-glibc2.35 2025-03-14 10:08:33
- *** --- * --- 
- ** ---------- [config]
- ** ---------- .> app:         tasks:0x7f51d603ffa0
- ** ---------- .> transport:   redis://localhost:6379/0
- ** ---------- .> results:     disabled://
- *** --- * --- .> concurrency: 2 (prefork)
-- ******* ---- .> task events: OFF (enable -E to monitor tasks in this worker)
--- ***** ----- 
 -------------- [queues]
                .> celery           exchange=celery(direct) key=celery
                

[tasks]
  . traffic_collector.consume_traffic_periodically

[2025-03-14 10:08:33,675: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

[2025-03-14 10:08:33,686: INFO/MainProcess] Connected to redis://localhost:6379/0
[2025-03-14 10:08:33,687: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

[2025-03-14 10:08:33,695: INFO/MainProcess] mingle: searching for neighbors
[2025-03-14 10:08:34,707: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/app/control.py:56: DuplicateNodenameWarning: Received multiple replies from node name: celery@VM-16-2-ubuntu.
Please make sure you give each node a unique nodename using
the celery worker `-n` option.
  warnings.warn(DuplicateNodenameWarning(

[2025-03-14 10:08:34,707: INFO/MainProcess] mingle: all alone
[2025-03-14 10:08:34,716: INFO/MainProcess] celery@VM-16-2-ubuntu ready.
2025-03-14 10:11:30,319 - INFO - Trying to construct model...
2025-03-14 10:11:30,320 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-14 10:11:30,394 - INFO - Training model... Size of feature_list: 6
2025-03-14 10:11:30,415 - INFO - Extracting features... Size of feature_list: 6
2025-03-14 10:11:30,421 - INFO - Extracting features... Size of feature_list: 6
2025-03-14 10:11:30,422 - INFO - Extracting features... Size of feature_list: 6
2025-03-14 10:11:30,423 - INFO - Extracting features... Size of feature_list: 6
2025-03-14 10:11:30,424 - INFO - Extracting features... Size of feature_list: 6
2025-03-14 10:11:30,425 - INFO - Extracting features... Size of feature_list: 6
2025-03-14 10:11:30,427 - INFO - Extracting features... Size of feature_list: 6
2025-03-14 10:11:30,428 - INFO - Extracting features... Size of feature_list: 6
[10:11:30] WARNING: /workspace/src/learner.cc:740: 
Parameters: { "use_label_encoder" } are not used.

2025-03-14 10:11:30,564 - INFO - Extracting features... Size of feature_list: 6
2025-03-14 10:11:30,566 - INFO - Extracting features... Size of feature_list: 6
2025-03-14 10:11:30,567 - INFO - Extracting features... Size of feature_list: 6
2025-03-14 10:11:30,568 - INFO - Extracting features... Size of feature_list: 6
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
2025-03-14 10:11:30,584 - INFO - Model constructed.
2025-03-14 11:38:09,104 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-14 11:38:09,197 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-14 11:38:09,227 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-14 11:38:09,227 - INFO - Starting data generation...
2025-03-14 11:38:09,227 - INFO - API_KNOWLEDGE: [{'number': 'API_2476', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_2477', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}]
2025-03-14 11:38:09,227 - INFO - APP_KNOWLEDGE: {'func_description': 'This is an updated test application', 'normal_seqs': ['Role: admin; API_2476(Call 1); API_2477(Call 2)', 'Role: oridinary_user; API_2476(); API_2477()'], 'malicious_seqs': ['Role: admin; API_2476(); API_2477()', 'Role: ordinary_user; API_2476(); API_2477()'], 'roles': ['admin', 'ordinary_user', 'unlogged_in_user']}
2025-03-14 11:38:09,543 - INFO - Generating simulated API sequences...
2025-03-14 11:38:09,543 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 11:38:09,543 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 11:38:14,657 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 11:38:14,661 - INFO - ========== Method gen_api_seq() returned: seq=['API_2476', 'API_2477'], malicious_sign_seq=[0, 0] ==========
2025-03-14 11:38:14,661 - INFO - ========== Method gen_api_seq() returned: seq=['API_2476', 'API_2477'], malicious_sign_seq=[0, 0] ==========
2025-03-14 11:38:14,661 - INFO - API sequence 1/12 generated
2025-03-14 11:38:14,662 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 11:38:14,662 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 11:38:16,488 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 11:38:16,489 - INFO - ========== Method gen_api_seq() returned: seq=['API_2476', 'API_2477'], malicious_sign_seq=[0, 0] ==========
2025-03-14 11:38:16,489 - INFO - ========== Method gen_api_seq() returned: seq=['API_2476', 'API_2477'], malicious_sign_seq=[0, 0] ==========
2025-03-14 11:38:16,489 - INFO - API sequence 2/12 generated
2025-03-14 11:38:16,489 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 11:38:16,489 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 11:38:17,860 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 11:38:17,861 - INFO - ========== Method gen_api_seq() returned: seq=['API_2476', 'API_2477'], malicious_sign_seq=[0, 1] ==========
2025-03-14 11:38:17,861 - INFO - ========== Method gen_api_seq() returned: seq=['API_2476', 'API_2477'], malicious_sign_seq=[0, 1] ==========
2025-03-14 11:38:17,861 - INFO - API sequence 3/12 generated
2025-03-14 11:38:17,861 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 11:38:17,861 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 11:38:19,927 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 11:38:19,930 - INFO - ========== Method gen_api_seq() returned: seq=['API_2476', 'API_2477'], malicious_sign_seq=[0, 0] ==========
2025-03-14 11:38:19,930 - INFO - ========== Method gen_api_seq() returned: seq=['API_2476', 'API_2477'], malicious_sign_seq=[0, 0] ==========
2025-03-14 11:38:19,932 - INFO - API sequence 4/12 generated
2025-03-14 11:38:19,932 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 11:38:19,932 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 11:38:22,950 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 11:38:22,951 - INFO - ========== Method gen_api_seq() returned: seq=['API_2476', 'API_2477'], malicious_sign_seq=[0, 1] ==========
2025-03-14 11:38:22,951 - INFO - ========== Method gen_api_seq() returned: seq=['API_2476', 'API_2477'], malicious_sign_seq=[0, 1] ==========
2025-03-14 11:38:22,951 - INFO - API sequence 5/12 generated
2025-03-14 11:38:22,951 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 11:38:22,951 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 11:38:25,665 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 11:38:25,666 - INFO - ========== Method gen_api_seq() returned: seq=['API_2476', 'API_2477'], malicious_sign_seq=[0, 1] ==========
2025-03-14 11:38:25,666 - INFO - ========== Method gen_api_seq() returned: seq=['API_2476', 'API_2477'], malicious_sign_seq=[0, 1] ==========
2025-03-14 11:38:25,666 - INFO - API sequence 6/12 generated
2025-03-14 11:38:25,666 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 11:38:25,666 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 11:38:26,663 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 11:38:26,664 - INFO - ========== Method gen_api_seq() returned: seq=['API_2476'], malicious_sign_seq=[0] ==========
2025-03-14 11:38:26,664 - INFO - ========== Method gen_api_seq() returned: seq=['API_2476'], malicious_sign_seq=[0] ==========
2025-03-14 11:38:26,664 - INFO - API sequence 7/12 generated
2025-03-14 11:38:26,664 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 11:38:26,664 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 11:38:28,992 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 11:38:28,993 - INFO - ========== Method gen_api_seq() returned: seq=['API_2476', 'API_2477'], malicious_sign_seq=[0, 0] ==========
2025-03-14 11:38:28,993 - INFO - ========== Method gen_api_seq() returned: seq=['API_2476', 'API_2477'], malicious_sign_seq=[0, 0] ==========
2025-03-14 11:38:28,993 - INFO - API sequence 8/12 generated
2025-03-14 11:38:28,993 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 11:38:28,993 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 11:38:30,794 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 11:38:30,794 - INFO - ========== Method gen_api_seq() returned: seq=['API_2476', 'API_2477'], malicious_sign_seq=[0, 1] ==========
2025-03-14 11:38:30,794 - INFO - ========== Method gen_api_seq() returned: seq=['API_2476', 'API_2477'], malicious_sign_seq=[0, 1] ==========
2025-03-14 11:38:30,795 - INFO - API sequence 9/12 generated
2025-03-14 11:38:30,795 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 11:38:30,795 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 11:38:33,403 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 11:38:33,404 - INFO - ========== Method gen_api_seq() returned: seq=['API_2476'], malicious_sign_seq=[0] ==========
2025-03-14 11:38:33,404 - INFO - ========== Method gen_api_seq() returned: seq=['API_2476'], malicious_sign_seq=[0] ==========
2025-03-14 11:38:33,404 - INFO - API sequence 10/12 generated
2025-03-14 11:38:33,404 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 11:38:33,404 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 11:38:36,134 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 11:38:36,135 - INFO - ========== Method gen_api_seq() returned: seq=['API_2476', 'API_2477'], malicious_sign_seq=[0, 1] ==========
2025-03-14 11:38:36,135 - INFO - ========== Method gen_api_seq() returned: seq=['API_2476', 'API_2477'], malicious_sign_seq=[0, 1] ==========
2025-03-14 11:38:36,135 - INFO - API sequence 11/12 generated
2025-03-14 11:38:36,135 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 11:38:36,135 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 11:38:37,726 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 11:38:37,727 - INFO - ========== Method gen_api_seq() returned: seq=['API_2476', 'API_2477'], malicious_sign_seq=[0, 1] ==========
2025-03-14 11:38:37,727 - INFO - ========== Method gen_api_seq() returned: seq=['API_2476', 'API_2477'], malicious_sign_seq=[0, 1] ==========
2025-03-14 11:38:37,728 - INFO - API sequence 12/12 generated
2025-03-14 11:38:37,728 - INFO - API sequences serialized to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py/serialized_llm_agents.json
2025-03-14 11:38:37,728 - INFO - Generating simulated traffic data set...
Exception in thread Thread-35 (async_data_collect):
Traceback (most recent call last):
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/./app.py", line 528, in async_data_collect
    traffic_data_generation.gen_data_set(user_api_set, api_knowledge, app_knowledge)
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py", line 315, in gen_data_set
    user_data, seq_valid = param_injection_for_api_seq(
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py", line 167, in param_injection_for_api_seq
    url, req_data = param_injection_for_api(api_seq[i])
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py", line 242, in param_injection_for_api
    val = random.choice(api_param_set['query_params'][param])
KeyError: 'a'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/threading.py", line 1016, in _bootstrap_inner
    self.run()
  File "/usr/lib/python3.10/threading.py", line 953, in run
    self._target(*self._args, **self._kwargs)
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/./app.py", line 535, in async_data_collect
    LOGGER.error(f"Error in data collection: {e.with_traceback(10)}")
TypeError: __traceback__ must be a traceback or None
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-03-14 11:43:03,387 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-13 15:57:24', 'last_model_construction_at': '2025-03-14 02:11:30', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.5, 1.0, 0.67, 2.0, 0.0, 0.0, 0.0, 2.0, 0.5, 4.0, 0.25, 0.5, 0.33, 4.0, 0.25, 0.5, 0.33, 4.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-14 11:43:03,388 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-03-14 11:50:14,366 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-13 15:57:24', 'last_model_construction_at': '2025-03-14 02:11:30', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.5, 1.0, 0.67, 2.0, 0.0, 0.0, 0.0, 2.0, 0.5, 4.0, 0.25, 0.5, 0.33, 4.0, 0.25, 0.5, 0.33, 4.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-14 11:50:14,368 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-03-14 11:51:04,061 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-13 15:57:24', 'last_model_construction_at': '2025-03-14 02:11:30', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.5, 1.0, 0.67, 2.0, 0.0, 0.0, 0.0, 2.0, 0.5, 4.0, 0.25, 0.5, 0.33, 4.0, 0.25, 0.5, 0.33, 4.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-14 11:51:04,061 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-03-14 11:52:21,878 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-13 15:57:24', 'last_model_construction_at': '2025-03-14 02:11:30', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.5, 1.0, 0.67, 2.0, 0.0, 0.0, 0.0, 2.0, 0.5, 4.0, 0.25, 0.5, 0.33, 4.0, 0.25, 0.5, 0.33, 4.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-14 11:52:21,879 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-03-14 11:53:48,783 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-13 15:57:24', 'last_model_construction_at': '2025-03-14 02:11:30', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.5, 1.0, 0.67, 2.0, 0.0, 0.0, 0.0, 2.0, 0.5, 4.0, 0.25, 0.5, 0.33, 4.0, 0.25, 0.5, 0.33, 4.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-14 11:53:48,784 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-03-14 11:54:56,773 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-13 15:57:24', 'last_model_construction_at': '2025-03-14 02:11:30', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.5, 1.0, 0.67, 2.0, 0.0, 0.0, 0.0, 2.0, 0.5, 4.0, 0.25, 0.5, 0.33, 4.0, 0.25, 0.5, 0.33, 4.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-14 11:54:56,773 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-03-14 11:55:06,729 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-13 15:57:24', 'last_model_construction_at': '2025-03-14 02:11:30', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.5, 1.0, 0.67, 2.0, 0.0, 0.0, 0.0, 2.0, 0.5, 4.0, 0.25, 0.5, 0.33, 4.0, 0.25, 0.5, 0.33, 4.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-14 11:55:06,729 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-03-14 11:55:20,803 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-13 15:57:24', 'last_model_construction_at': '2025-03-14 02:11:30', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.5, 1.0, 0.67, 2.0, 0.0, 0.0, 0.0, 2.0, 0.5, 4.0, 0.25, 0.5, 0.33, 4.0, 0.25, 0.5, 0.33, 4.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-14 11:55:20,803 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-03-14 11:55:52,210 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-13 15:57:24', 'last_model_construction_at': '2025-03-14 02:11:30', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.5, 1.0, 0.67, 2.0, 0.0, 0.0, 0.0, 2.0, 0.5, 4.0, 0.25, 0.5, 0.33, 4.0, 0.25, 0.5, 0.33, 4.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-14 11:55:52,210 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
2025-03-14 11:55:52,391 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-14 11:55:52,480 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-14 11:55:52,512 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-14 11:55:52,512 - INFO - Starting data generation...
2025-03-14 11:55:52,512 - INFO - API_KNOWLEDGE: [{'number': 'API_2478', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_2479', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}]
2025-03-14 11:55:52,512 - INFO - APP_KNOWLEDGE: {'func_description': 'This is an updated test application', 'normal_seqs': ['Role: admin; API_2478(Call 1); API_2479(Call 2)', 'Role: oridinary_user; API_2478(); API_2479()'], 'malicious_seqs': ['Role: admin; API_2478(); API_2479()', 'Role: ordinary_user; API_2478(); API_2479()'], 'roles': ['admin', 'ordinary_user', 'unlogged_in_user']}
2025-03-14 11:55:52,820 - INFO - Generating simulated API sequences...
2025-03-14 11:55:52,820 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 11:55:52,820 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 11:55:55,372 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 11:55:55,376 - INFO - ========== Method gen_api_seq() returned: seq=['API_2478', 'API_2479'], malicious_sign_seq=[0, 1] ==========
2025-03-14 11:55:55,376 - INFO - ========== Method gen_api_seq() returned: seq=['API_2478', 'API_2479'], malicious_sign_seq=[0, 1] ==========
2025-03-14 11:55:55,376 - INFO - API sequence 1/12 generated
2025-03-14 11:55:55,376 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 11:55:55,376 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 11:55:58,931 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 11:55:58,932 - INFO - ========== Method gen_api_seq() returned: seq=['API_2478', 'API_2479'], malicious_sign_seq=[0, 1] ==========
2025-03-14 11:55:58,932 - INFO - ========== Method gen_api_seq() returned: seq=['API_2478', 'API_2479'], malicious_sign_seq=[0, 1] ==========
2025-03-14 11:55:58,932 - INFO - API sequence 2/12 generated
2025-03-14 11:55:58,932 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 11:55:58,932 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 11:56:00,334 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 11:56:00,334 - INFO - ========== Method gen_api_seq() returned: seq=['API_2478', 'API_2479'], malicious_sign_seq=[0, 0] ==========
2025-03-14 11:56:00,334 - INFO - ========== Method gen_api_seq() returned: seq=['API_2478', 'API_2479'], malicious_sign_seq=[0, 0] ==========
2025-03-14 11:56:00,335 - INFO - API sequence 3/12 generated
2025-03-14 11:56:00,335 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 11:56:00,335 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 11:56:02,722 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 11:56:02,723 - INFO - ========== Method gen_api_seq() returned: seq=['API_2478', 'API_2479'], malicious_sign_seq=[0, 1] ==========
2025-03-14 11:56:02,723 - INFO - ========== Method gen_api_seq() returned: seq=['API_2478', 'API_2479'], malicious_sign_seq=[0, 1] ==========
2025-03-14 11:56:02,723 - INFO - API sequence 4/12 generated
2025-03-14 11:56:02,723 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 11:56:02,723 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 11:56:04,643 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 11:56:04,644 - INFO - ========== Method gen_api_seq() returned: seq=['API_2478', 'API_2479'], malicious_sign_seq=[0, 1] ==========
2025-03-14 11:56:04,644 - INFO - ========== Method gen_api_seq() returned: seq=['API_2478', 'API_2479'], malicious_sign_seq=[0, 1] ==========
2025-03-14 11:56:04,644 - INFO - API sequence 5/12 generated
2025-03-14 11:56:04,645 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 11:56:04,645 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 11:56:07,165 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 11:56:07,166 - INFO - ========== Method gen_api_seq() returned: seq=['API_2478', 'API_2479'], malicious_sign_seq=[0, 0] ==========
2025-03-14 11:56:07,166 - INFO - ========== Method gen_api_seq() returned: seq=['API_2478', 'API_2479'], malicious_sign_seq=[0, 0] ==========
2025-03-14 11:56:07,166 - INFO - API sequence 6/12 generated
2025-03-14 11:56:07,166 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 11:56:07,166 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 11:56:08,662 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 11:56:08,663 - INFO - ========== Method gen_api_seq() returned: seq=['API_2478', 'API_2479'], malicious_sign_seq=[0, 1] ==========
2025-03-14 11:56:08,663 - INFO - ========== Method gen_api_seq() returned: seq=['API_2478', 'API_2479'], malicious_sign_seq=[0, 1] ==========
2025-03-14 11:56:08,663 - INFO - API sequence 7/12 generated
2025-03-14 11:56:08,663 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 11:56:08,663 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 11:56:10,302 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 11:56:10,303 - INFO - ========== Method gen_api_seq() returned: seq=['API_2478', 'API_2479'], malicious_sign_seq=[0, 1] ==========
2025-03-14 11:56:10,303 - INFO - ========== Method gen_api_seq() returned: seq=['API_2478', 'API_2479'], malicious_sign_seq=[0, 1] ==========
2025-03-14 11:56:10,303 - INFO - API sequence 8/12 generated
2025-03-14 11:56:10,304 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 11:56:10,304 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 11:56:12,187 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 11:56:12,188 - INFO - ========== Method gen_api_seq() returned: seq=['API_2478'], malicious_sign_seq=[0] ==========
2025-03-14 11:56:12,188 - INFO - ========== Method gen_api_seq() returned: seq=['API_2478'], malicious_sign_seq=[0] ==========
2025-03-14 11:56:12,188 - INFO - API sequence 9/12 generated
2025-03-14 11:56:12,188 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 11:56:12,188 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 11:56:14,747 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 11:56:14,748 - INFO - ========== Method gen_api_seq() returned: seq=['API_2478', 'API_2479'], malicious_sign_seq=[0, 0] ==========
2025-03-14 11:56:14,748 - INFO - ========== Method gen_api_seq() returned: seq=['API_2478', 'API_2479'], malicious_sign_seq=[0, 0] ==========
2025-03-14 11:56:14,749 - INFO - API sequence 10/12 generated
2025-03-14 11:56:14,749 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 11:56:14,749 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 11:56:17,078 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 11:56:17,079 - INFO - ========== Method gen_api_seq() returned: seq=['API_2478', 'API_2479'], malicious_sign_seq=[0, 0] ==========
2025-03-14 11:56:17,079 - INFO - ========== Method gen_api_seq() returned: seq=['API_2478', 'API_2479'], malicious_sign_seq=[0, 0] ==========
2025-03-14 11:56:17,079 - INFO - API sequence 11/12 generated
2025-03-14 11:56:17,080 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 11:56:17,080 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 11:56:18,761 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 11:56:18,762 - INFO - ========== Method gen_api_seq() returned: seq=['API_2478', 'API_2479'], malicious_sign_seq=[0, 0] ==========
2025-03-14 11:56:18,762 - INFO - ========== Method gen_api_seq() returned: seq=['API_2478', 'API_2479'], malicious_sign_seq=[0, 0] ==========
2025-03-14 11:56:18,762 - INFO - API sequence 12/12 generated
2025-03-14 11:56:18,762 - INFO - API sequences serialized to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py/serialized_llm_agents.json
2025-03-14 11:56:18,762 - INFO - Generating simulated traffic data set...
2025-03-14 11:56:18,762 - INFO - Error when injecting params for API_2478
2025-03-14 11:56:18,763 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 11:56:18,763 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 11:56:18,763 - INFO - Simulated traffic data for 1/12 user collected：user: normaluser malicious: True
2025-03-14 11:56:18,763 - INFO - Error when injecting params for API_2478
2025-03-14 11:56:18,763 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/memo/21 {}
2025-03-14 11:56:18,763 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 11:56:18,763 - INFO - Simulated traffic data for 2/12 user collected：user: unloggeduser malicious: True
2025-03-14 11:56:18,763 - INFO - Error when injecting params for API_2478
2025-03-14 11:56:18,763 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 11:56:18,764 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 11:56:18,764 - INFO - Simulated traffic data for 3/12 user collected：user: normaluser malicious: False
2025-03-14 11:56:18,764 - INFO - Error when injecting params for API_2478
2025-03-14 11:56:18,764 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 11:56:18,764 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 11:56:18,764 - INFO - Simulated traffic data for 4/12 user collected：user: normaluser malicious: True
2025-03-14 11:56:18,764 - INFO - Error when injecting params for API_2478
2025-03-14 11:56:18,764 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/memo/21 {}
2025-03-14 11:56:18,764 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 11:56:18,764 - INFO - Simulated traffic data for 5/12 user collected：user: unloggeduser malicious: True
2025-03-14 11:56:18,765 - INFO - Error when injecting params for API_2478
2025-03-14 11:56:18,765 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 11:56:18,765 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 11:56:18,765 - INFO - Simulated traffic data for 6/12 user collected：user: normaluser malicious: False
2025-03-14 11:56:18,765 - INFO - Error when injecting params for API_2478
2025-03-14 11:56:18,765 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 11:56:18,765 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 11:56:18,765 - INFO - Simulated traffic data for 7/12 user collected：user: normaluser malicious: True
2025-03-14 11:56:18,765 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/resource/16 {}
2025-03-14 11:56:18,765 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 11:56:18,765 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 11:56:18,765 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 11:56:18,766 - INFO - Simulated traffic data for 8/12 user collected：user: unloggeduser malicious: True
2025-03-14 11:56:18,766 - INFO - Error when injecting params for API_2478
2025-03-14 11:56:18,766 - INFO - Simulated traffic data for 9/12 user collected：user: adminuser malicious: False
2025-03-14 11:56:18,766 - INFO - Error when injecting params for API_2478
2025-03-14 11:56:18,766 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 11:56:18,766 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 11:56:18,766 - INFO - Simulated traffic data for 10/12 user collected：user: normaluser malicious: False
2025-03-14 11:56:18,766 - INFO - Error when injecting params for API_2478
2025-03-14 11:56:18,766 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 11:56:18,766 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 11:56:18,766 - INFO - Simulated traffic data for 11/12 user collected：user: normaluser malicious: False
2025-03-14 11:56:18,767 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/resource/16 {}
2025-03-14 11:56:18,767 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 11:56:18,767 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 11:56:18,767 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 11:56:18,767 - INFO - Simulated traffic data for 12/12 user collected：user: adminuser malicious: False
2025-03-14 11:56:18,771 - INFO - All simulated traffic data collected：/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/simulated_traffic_data.csv
2025-03-14 11:56:42,431 - INFO - Trying to construct model...
2025-03-14 11:56:42,432 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-14 11:56:42,476 - INFO - Training model... Size of feature_list: 7
2025-03-14 11:56:42,492 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 11:56:42,497 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 11:56:42,498 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 11:56:42,499 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 11:56:42,500 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 11:56:42,502 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 11:56:42,503 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 11:56:42,504 - INFO - Extracting features... Size of feature_list: 7
[11:56:42] WARNING: /workspace/src/learner.cc:740: 
Parameters: { "use_label_encoder" } are not used.

2025-03-14 11:56:42,671 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 11:56:42,673 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 11:56:42,674 - INFO - Extracting features... Size of feature_list: 7
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
2025-03-14 11:56:42,690 - INFO - Model constructed.
2025-03-14 11:57:04,141 - INFO - Trying to construct model...
2025-03-14 11:57:04,142 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-14 11:57:04,169 - INFO - Training model... Size of feature_list: 7
2025-03-14 11:57:04,179 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 11:57:04,180 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 11:57:04,181 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 11:57:04,183 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 11:57:04,184 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 11:57:04,185 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 11:57:04,187 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 11:57:04,188 - INFO - Extracting features... Size of feature_list: 7
[11:57:04] WARNING: /workspace/src/learner.cc:740: 
Parameters: { "use_label_encoder" } are not used.

2025-03-14 11:57:04,216 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 11:57:04,218 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 11:57:04,220 - INFO - Extracting features... Size of feature_list: 7
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
2025-03-14 11:57:04,231 - INFO - Model constructed.
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/./app.py", line 444
    global ERROR_APIS
    ^^^^^^^^^^^^^^^^^
SyntaxError: name 'ERROR_APIS' is used prior to global declaration
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-03-14 12:01:25,840 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-13 15:57:24', 'last_model_construction_at': '2025-03-14 03:57:04', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.33, 1.0, 0.5, 1.0, 0.0, 0.0, 0.0, 2.0, 0.33, 3.0, 0.17, 0.5, 0.25, 3.0, 0.11, 0.33, 0.17, 3.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-14 12:01:25,840 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
 * Serving Flask app 'app'
 * Debug mode: on
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-03-14 12:01:27,596 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-13 15:57:24', 'last_model_construction_at': '2025-03-14 03:57:04', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.33, 1.0, 0.5, 1.0, 0.0, 0.0, 0.0, 2.0, 0.33, 3.0, 0.17, 0.5, 0.25, 3.0, 0.11, 0.33, 0.17, 3.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-14 12:01:27,596 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
2025-03-14 12:01:27,741 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-14 12:01:27,795 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-14 12:01:27,827 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-14 12:01:27,827 - INFO - Starting data generation...
2025-03-14 12:01:27,827 - INFO - API_KNOWLEDGE: [{'number': 'API_2484', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_2485', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}]
2025-03-14 12:01:27,828 - INFO - APP_KNOWLEDGE: {'func_description': 'This is an updated test application', 'normal_seqs': ['Role: admin; API_2484(Call 1); API_2485(Call 2)', 'Role: oridinary_user; API_2484(); API_2485()'], 'malicious_seqs': ['Role: admin; API_2484(); API_2485()', 'Role: ordinary_user; API_2484(); API_2485()'], 'roles': ['admin', 'ordinary_user', 'unlogged_in_user']}
2025-03-14 12:01:28,025 - INFO - Generating simulated API sequences...
2025-03-14 12:01:28,025 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:01:28,025 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:01:30,863 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:01:30,867 - INFO - ========== Method gen_api_seq() returned: seq=['API_2484', 'API_2485'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:01:30,867 - INFO - ========== Method gen_api_seq() returned: seq=['API_2484', 'API_2485'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:01:30,867 - INFO - API sequence 1/12 generated
2025-03-14 12:01:30,867 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:01:30,867 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:01:32,404 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:01:32,405 - INFO - ========== Method gen_api_seq() returned: seq=['API_2484', 'API_2485'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:01:32,405 - INFO - ========== Method gen_api_seq() returned: seq=['API_2484', 'API_2485'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:01:32,405 - INFO - API sequence 2/12 generated
2025-03-14 12:01:32,405 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 12:01:32,405 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 12:01:34,424 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:01:34,424 - INFO - ========== Method gen_api_seq() returned: seq=['API_2484'], malicious_sign_seq=[0] ==========
2025-03-14 12:01:34,424 - INFO - ========== Method gen_api_seq() returned: seq=['API_2484'], malicious_sign_seq=[0] ==========
2025-03-14 12:01:34,425 - INFO - API sequence 3/12 generated
2025-03-14 12:01:34,425 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:01:34,425 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:01:35,854 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:01:35,855 - INFO - ========== Method gen_api_seq() returned: seq=['API_2484', 'API_2485'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:01:35,855 - INFO - ========== Method gen_api_seq() returned: seq=['API_2484', 'API_2485'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:01:35,855 - INFO - API sequence 4/12 generated
2025-03-14 12:01:35,855 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:01:35,855 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:01:37,173 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:01:37,173 - INFO - ========== Method gen_api_seq() returned: seq=['API_2484', 'API_2485'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:01:37,173 - INFO - ========== Method gen_api_seq() returned: seq=['API_2484', 'API_2485'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:01:37,174 - INFO - API sequence 5/12 generated
2025-03-14 12:01:37,174 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:01:37,174 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:01:38,507 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:01:38,508 - INFO - ========== Method gen_api_seq() returned: seq=['API_2484', 'API_2485'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:01:38,508 - INFO - ========== Method gen_api_seq() returned: seq=['API_2484', 'API_2485'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:01:38,508 - INFO - API sequence 6/12 generated
2025-03-14 12:01:38,508 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:01:38,508 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:01:39,874 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:01:39,874 - INFO - ========== Method gen_api_seq() returned: seq=['API_2484', 'API_2485'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:01:39,874 - INFO - ========== Method gen_api_seq() returned: seq=['API_2484', 'API_2485'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:01:39,875 - INFO - API sequence 7/12 generated
2025-03-14 12:01:39,875 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:01:39,875 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:01:41,003 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:01:41,004 - INFO - ========== Method gen_api_seq() returned: seq=['API_2484'], malicious_sign_seq=[0] ==========
2025-03-14 12:01:41,004 - INFO - ========== Method gen_api_seq() returned: seq=['API_2484'], malicious_sign_seq=[0] ==========
2025-03-14 12:01:41,004 - INFO - API sequence 8/12 generated
2025-03-14 12:01:41,004 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 12:01:41,004 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 12:01:43,703 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:01:43,704 - INFO - ========== Method gen_api_seq() returned: seq=['API_2484', 'API_2485'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:01:43,704 - INFO - ========== Method gen_api_seq() returned: seq=['API_2484', 'API_2485'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:01:43,704 - INFO - API sequence 9/12 generated
2025-03-14 12:01:43,704 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:01:43,704 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:01:44,900 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:01:44,902 - INFO - ========== Method gen_api_seq() returned: seq=['API_2484', 'API_2485'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:01:44,902 - INFO - ========== Method gen_api_seq() returned: seq=['API_2484', 'API_2485'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:01:44,902 - INFO - API sequence 10/12 generated
2025-03-14 12:01:44,902 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:01:44,902 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:01:46,135 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:01:46,136 - INFO - ========== Method gen_api_seq() returned: seq=['API_2484', 'API_2485'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:01:46,136 - INFO - ========== Method gen_api_seq() returned: seq=['API_2484', 'API_2485'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:01:46,136 - INFO - API sequence 11/12 generated
2025-03-14 12:01:46,136 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:01:46,136 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:01:47,565 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:01:47,566 - INFO - ========== Method gen_api_seq() returned: seq=['API_2484', 'API_2485'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:01:47,566 - INFO - ========== Method gen_api_seq() returned: seq=['API_2484', 'API_2485'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:01:47,566 - INFO - API sequence 12/12 generated
2025-03-14 12:01:47,567 - INFO - API sequences serialized to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py/serialized_llm_agents.json
2025-03-14 12:01:47,567 - INFO - Generating simulated traffic data set...
2025-03-14 12:01:47,568 - INFO - Error when injecting params for API_2484
2025-03-14 12:01:47,568 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:01:47,569 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:01:47,569 - INFO - Simulated traffic data for 1/12 user collected：user: normaluser malicious: False
2025-03-14 12:01:47,569 - INFO - Error when injecting params for API_2484
2025-03-14 12:01:47,569 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:01:47,570 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:01:47,570 - INFO - Simulated traffic data for 2/12 user collected：user: normaluser malicious: True
2025-03-14 12:01:47,570 - INFO - Error when injecting params for API_2484
2025-03-14 12:01:47,570 - INFO - Simulated traffic data for 3/12 user collected：user: adminuser malicious: False
2025-03-14 12:01:47,571 - INFO - Error when injecting params for API_2484
2025-03-14 12:01:47,571 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:01:47,571 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:01:47,571 - INFO - Simulated traffic data for 4/12 user collected：user: normaluser malicious: False
2025-03-14 12:01:47,572 - INFO - Error when injecting params for API_2484
2025-03-14 12:01:47,572 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:01:47,572 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:01:47,572 - INFO - Simulated traffic data for 5/12 user collected：user: unloggeduser malicious: True
2025-03-14 12:01:47,573 - INFO - Error when injecting params for API_2484
2025-03-14 12:01:47,573 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:01:47,573 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:01:47,573 - INFO - Simulated traffic data for 6/12 user collected：user: normaluser malicious: False
2025-03-14 12:01:47,574 - INFO - Error when injecting params for API_2484
2025-03-14 12:01:47,574 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/memo/21 {}
2025-03-14 12:01:47,574 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:01:47,574 - INFO - Simulated traffic data for 7/12 user collected：user: unloggeduser malicious: True
2025-03-14 12:01:47,575 - INFO - Error when injecting params for API_2484
2025-03-14 12:01:47,575 - INFO - Simulated traffic data for 8/12 user collected：user: normaluser malicious: False
2025-03-14 12:01:47,575 - INFO - Error when injecting params for API_2484
2025-03-14 12:01:47,576 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:01:47,576 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:01:47,576 - INFO - Simulated traffic data for 9/12 user collected：user: adminuser malicious: False
2025-03-14 12:01:47,576 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/resource/16 {}
2025-03-14 12:01:47,577 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:01:47,577 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:01:47,577 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:01:47,577 - INFO - Simulated traffic data for 10/12 user collected：user: normaluser malicious: True
2025-03-14 12:01:47,578 - INFO - Error when injecting params for API_2484
2025-03-14 12:01:47,578 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:01:47,578 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:01:47,578 - INFO - Simulated traffic data for 11/12 user collected：user: unloggeduser malicious: True
2025-03-14 12:01:47,579 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/resource/16 {}
2025-03-14 12:01:47,579 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:01:47,579 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:01:47,579 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:01:47,579 - INFO - Simulated traffic data for 12/12 user collected：user: normaluser malicious: True
2025-03-14 12:01:47,582 - INFO - All simulated traffic data collected：/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/simulated_traffic_data.csv
2025-03-14 12:01:47,582 - INFO - error_apis: []
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-03-14 12:03:28,492 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-13 15:57:24', 'last_model_construction_at': '2025-03-14 03:57:04', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.33, 1.0, 0.5, 1.0, 0.0, 0.0, 0.0, 2.0, 0.33, 3.0, 0.17, 0.5, 0.25, 3.0, 0.11, 0.33, 0.17, 3.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-14 12:03:28,492 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
2025-03-14 12:03:31,543 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-14 12:03:31,593 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-14 12:03:31,624 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-14 12:03:31,625 - INFO - Starting data generation...
2025-03-14 12:03:31,625 - INFO - API_KNOWLEDGE: [{'number': 'API_2486', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_2487', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}]
2025-03-14 12:03:31,625 - INFO - APP_KNOWLEDGE: {'func_description': 'This is an updated test application', 'normal_seqs': ['Role: admin; API_2486(Call 1); API_2487(Call 2)', 'Role: oridinary_user; API_2486(); API_2487()'], 'malicious_seqs': ['Role: admin; API_2486(); API_2487()', 'Role: ordinary_user; API_2486(); API_2487()'], 'roles': ['admin', 'ordinary_user', 'unlogged_in_user']}
2025-03-14 12:03:31,840 - INFO - Generating simulated API sequences...
2025-03-14 12:03:31,840 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:03:31,840 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:03:33,239 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:03:33,243 - INFO - ========== Method gen_api_seq() returned: seq=['API_2486', 'API_2487'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:03:33,243 - INFO - ========== Method gen_api_seq() returned: seq=['API_2486', 'API_2487'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:03:33,243 - INFO - API sequence 1/12 generated
2025-03-14 12:03:33,243 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:03:33,243 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:03:35,815 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:03:35,816 - INFO - ========== Method gen_api_seq() returned: seq=['API_2486', 'API_2487'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:03:35,816 - INFO - ========== Method gen_api_seq() returned: seq=['API_2486', 'API_2487'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:03:35,816 - INFO - API sequence 2/12 generated
2025-03-14 12:03:35,816 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:03:35,816 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:03:38,062 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:03:38,063 - INFO - ========== Method gen_api_seq() returned: seq=['API_2486', 'API_2487'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:03:38,063 - INFO - ========== Method gen_api_seq() returned: seq=['API_2486', 'API_2487'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:03:38,063 - INFO - API sequence 3/12 generated
2025-03-14 12:03:38,064 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 12:03:38,064 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 12:03:40,597 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:03:40,598 - INFO - ========== Method gen_api_seq() returned: seq=['API_2486', 'API_2487'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:03:40,598 - INFO - ========== Method gen_api_seq() returned: seq=['API_2486', 'API_2487'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:03:40,598 - INFO - API sequence 4/12 generated
2025-03-14 12:03:40,598 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:03:40,598 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:03:43,614 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:03:43,614 - INFO - ========== Method gen_api_seq() returned: seq=['API_2486', 'API_2487'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:03:43,614 - INFO - ========== Method gen_api_seq() returned: seq=['API_2486', 'API_2487'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:03:43,615 - INFO - API sequence 5/12 generated
2025-03-14 12:03:43,615 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:03:43,615 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:03:44,957 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:03:44,958 - INFO - ========== Method gen_api_seq() returned: seq=['API_2486', 'API_2487'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:03:44,958 - INFO - ========== Method gen_api_seq() returned: seq=['API_2486', 'API_2487'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:03:44,958 - INFO - API sequence 6/12 generated
2025-03-14 12:03:44,958 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:03:44,958 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:03:47,372 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:03:47,373 - INFO - ========== Method gen_api_seq() returned: seq=['API_2486', 'API_2487'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:03:47,373 - INFO - ========== Method gen_api_seq() returned: seq=['API_2486', 'API_2487'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:03:47,373 - INFO - API sequence 7/12 generated
2025-03-14 12:03:47,373 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:03:47,373 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:03:48,698 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:03:48,699 - INFO - ========== Method gen_api_seq() returned: seq=['API_2486', 'API_2487'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:03:48,699 - INFO - ========== Method gen_api_seq() returned: seq=['API_2486', 'API_2487'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:03:48,699 - INFO - API sequence 8/12 generated
2025-03-14 12:03:48,699 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 12:03:48,699 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 12:03:50,643 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:03:50,644 - INFO - ========== Method gen_api_seq() returned: seq=['API_2486'], malicious_sign_seq=[0] ==========
2025-03-14 12:03:50,644 - INFO - ========== Method gen_api_seq() returned: seq=['API_2486'], malicious_sign_seq=[0] ==========
2025-03-14 12:03:50,644 - INFO - API sequence 9/12 generated
2025-03-14 12:03:50,644 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:03:50,644 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:03:51,910 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:03:51,911 - INFO - ========== Method gen_api_seq() returned: seq=['API_2486', 'API_2487'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:03:51,911 - INFO - ========== Method gen_api_seq() returned: seq=['API_2486', 'API_2487'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:03:51,911 - INFO - API sequence 10/12 generated
2025-03-14 12:03:51,911 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:03:51,911 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:03:54,297 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:03:54,298 - INFO - ========== Method gen_api_seq() returned: seq=['API_2486', 'API_2487'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:03:54,298 - INFO - ========== Method gen_api_seq() returned: seq=['API_2486', 'API_2487'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:03:54,298 - INFO - API sequence 11/12 generated
2025-03-14 12:03:54,298 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:03:54,298 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:03:55,569 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:03:55,570 - INFO - ========== Method gen_api_seq() returned: seq=['API_2486', 'API_2487'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:03:55,570 - INFO - ========== Method gen_api_seq() returned: seq=['API_2486', 'API_2487'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:03:55,570 - INFO - API sequence 12/12 generated
2025-03-14 12:03:55,571 - INFO - API sequences serialized to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py/serialized_llm_agents.json
2025-03-14 12:03:55,571 - INFO - Generating simulated traffic data set...
2025-03-14 12:03:55,571 - INFO - Error when injecting params for API_2486
2025-03-14 12:03:55,572 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:03:55,572 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:03:55,572 - INFO - error_apis: [<algorithm.entity.api.API object at 0x7f1b3714ef20>]
2025-03-14 12:03:55,572 - INFO - Simulated traffic data for 1/12 user collected：user: normaluser malicious: True
2025-03-14 12:03:55,572 - INFO - Error when injecting params for API_2486
2025-03-14 12:03:55,572 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:03:55,572 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:03:55,572 - INFO - error_apis: [<algorithm.entity.api.API object at 0x7f1b3714ef20>]
2025-03-14 12:03:55,572 - INFO - Simulated traffic data for 2/12 user collected：user: normaluser malicious: True
2025-03-14 12:03:55,572 - INFO - Error when injecting params for API_2486
2025-03-14 12:03:55,573 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:03:55,573 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:03:55,573 - INFO - error_apis: [<algorithm.entity.api.API object at 0x7f1b3714ef20>]
2025-03-14 12:03:55,573 - INFO - Simulated traffic data for 3/12 user collected：user: unloggeduser malicious: True
2025-03-14 12:03:55,573 - INFO - Error when injecting params for API_2486
2025-03-14 12:03:55,573 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:03:55,573 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:03:55,573 - INFO - error_apis: [<algorithm.entity.api.API object at 0x7f1b3714ef20>]
2025-03-14 12:03:55,573 - INFO - Simulated traffic data for 4/12 user collected：user: adminuser malicious: False
2025-03-14 12:03:55,573 - INFO - Error when injecting params for API_2486
2025-03-14 12:03:55,573 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:03:55,573 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:03:55,573 - INFO - error_apis: [<algorithm.entity.api.API object at 0x7f1b3714ef20>]
2025-03-14 12:03:55,573 - INFO - Simulated traffic data for 5/12 user collected：user: normaluser malicious: False
2025-03-14 12:03:55,574 - INFO - Error when injecting params for API_2486
2025-03-14 12:03:55,574 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:03:55,574 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:03:55,574 - INFO - error_apis: [<algorithm.entity.api.API object at 0x7f1b3714ef20>]
2025-03-14 12:03:55,574 - INFO - Simulated traffic data for 6/12 user collected：user: unloggeduser malicious: True
2025-03-14 12:03:55,574 - INFO - Error when injecting params for API_2486
2025-03-14 12:03:55,574 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:03:55,574 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:03:55,574 - INFO - error_apis: [<algorithm.entity.api.API object at 0x7f1b3714ef20>]
2025-03-14 12:03:55,574 - INFO - Simulated traffic data for 7/12 user collected：user: normaluser malicious: False
2025-03-14 12:03:55,574 - INFO - Error when injecting params for API_2486
2025-03-14 12:03:55,574 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:03:55,575 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:03:55,575 - INFO - error_apis: [<algorithm.entity.api.API object at 0x7f1b3714ef20>]
2025-03-14 12:03:55,575 - INFO - Simulated traffic data for 8/12 user collected：user: unloggeduser malicious: True
2025-03-14 12:03:55,575 - INFO - Error when injecting params for API_2486
2025-03-14 12:03:55,575 - INFO - error_apis: [<algorithm.entity.api.API object at 0x7f1b3714ef20>]
2025-03-14 12:03:55,575 - INFO - Simulated traffic data for 9/12 user collected：user: adminuser malicious: False
2025-03-14 12:03:55,575 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/resource/16 {}
2025-03-14 12:03:55,575 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:03:55,575 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:03:55,575 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:03:55,575 - INFO - error_apis: []
2025-03-14 12:03:55,576 - INFO - Simulated traffic data for 10/12 user collected：user: normaluser malicious: False
2025-03-14 12:03:55,576 - INFO - Error when injecting params for API_2486
2025-03-14 12:03:55,576 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:03:55,576 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:03:55,576 - INFO - error_apis: [<algorithm.entity.api.API object at 0x7f1b3714ef20>]
2025-03-14 12:03:55,576 - INFO - Simulated traffic data for 11/12 user collected：user: normaluser malicious: True
2025-03-14 12:03:55,576 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/resource/16 {}
2025-03-14 12:03:55,576 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:03:55,576 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:03:55,576 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:03:55,576 - INFO - error_apis: []
2025-03-14 12:03:55,576 - INFO - Simulated traffic data for 12/12 user collected：user: normaluser malicious: False
2025-03-14 12:03:55,579 - INFO - All simulated traffic data collected：/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/simulated_traffic_data.csv
2025-03-14 12:03:55,579 - INFO - error_apis: []
2025-03-14 12:12:27,925 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-14 12:12:28,636 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-14 12:12:28,981 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-14 12:12:28,984 - INFO - Starting data generation...
2025-03-14 12:12:28,985 - INFO - API_KNOWLEDGE: [{'number': 'API_2488', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_2489', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}]
2025-03-14 12:12:28,985 - INFO - APP_KNOWLEDGE: {'func_description': 'This is an updated test application', 'normal_seqs': ['Role: admin; API_2488(Call 1); API_2489(Call 2)', 'Role: oridinary_user; API_2488(); API_2489()'], 'malicious_seqs': ['Role: admin; API_2488(); API_2489()', 'Role: ordinary_user; API_2488(); API_2489()'], 'roles': ['admin', 'ordinary_user', 'unlogged_in_user']}
2025-03-14 12:12:29,116 - INFO - Generating simulated API sequences...
2025-03-14 12:12:29,141 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:12:29,141 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:12:29,141 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:12:30,790 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:12:30,812 - INFO - ========== Method gen_api_seq() returned: seq=['API_2488', 'API_2489'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:12:30,812 - INFO - ========== Method gen_api_seq() returned: seq=['API_2488', 'API_2489'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:12:30,812 - INFO - ========== Method gen_api_seq() returned: seq=['API_2488', 'API_2489'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:12:30,813 - INFO - API sequence 1/12 generated
2025-03-14 12:12:30,813 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:12:30,813 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:12:30,813 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:12:32,613 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:12:34,772 - INFO - ========== Method gen_api_seq() returned: seq=['API_2488', 'API_2489'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:12:34,772 - INFO - ========== Method gen_api_seq() returned: seq=['API_2488', 'API_2489'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:12:34,772 - INFO - ========== Method gen_api_seq() returned: seq=['API_2488', 'API_2489'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:12:35,271 - INFO - API sequence 2/12 generated
2025-03-14 12:12:35,281 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:12:35,281 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:12:35,281 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:12:39,334 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:12:40,846 - INFO - ========== Method gen_api_seq() returned: seq=['API_2488', 'API_2489'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:12:40,846 - INFO - ========== Method gen_api_seq() returned: seq=['API_2488', 'API_2489'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:12:40,846 - INFO - ========== Method gen_api_seq() returned: seq=['API_2488', 'API_2489'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:12:40,933 - INFO - API sequence 3/12 generated
2025-03-14 12:12:40,934 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 12:12:40,934 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 12:12:40,934 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 12:12:44,315 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:12:44,871 - INFO - ========== Method gen_api_seq() returned: seq=['API_2488'], malicious_sign_seq=[0] ==========
2025-03-14 12:12:44,871 - INFO - ========== Method gen_api_seq() returned: seq=['API_2488'], malicious_sign_seq=[0] ==========
2025-03-14 12:12:44,871 - INFO - ========== Method gen_api_seq() returned: seq=['API_2488'], malicious_sign_seq=[0] ==========
2025-03-14 12:12:44,968 - INFO - API sequence 4/12 generated
2025-03-14 12:12:44,990 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:12:44,990 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:12:44,990 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:12:46,908 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:12:47,604 - INFO - ========== Method gen_api_seq() returned: seq=['API_2488', 'API_2489'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:12:47,604 - INFO - ========== Method gen_api_seq() returned: seq=['API_2488', 'API_2489'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:12:47,604 - INFO - ========== Method gen_api_seq() returned: seq=['API_2488', 'API_2489'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:12:51,470 - INFO - API sequence 5/12 generated
2025-03-14 12:12:52,615 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 12:12:52,615 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 12:12:52,615 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-03-14 12:16:25,097 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-13 15:57:24', 'last_model_construction_at': '2025-03-14 03:57:04', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.33, 1.0, 0.5, 1.0, 0.0, 0.0, 0.0, 2.0, 0.33, 3.0, 0.17, 0.5, 0.25, 3.0, 0.11, 0.33, 0.17, 3.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-14 12:16:25,099 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
 * Serving Flask app 'app'
 * Debug mode: on
 
 -------------- celery@VM-16-2-ubuntu v5.4.0 (opalescent)
--- ***** ----- 
-- ******* ---- Linux-5.15.0-130-generic-x86_64-with-glibc2.35 2025-03-14 12:16:26
- *** --- * --- 
- ** ---------- [config]
- ** ---------- .> app:         tasks:0x7f4265477fa0
- ** ---------- .> transport:   redis://localhost:6379/0
- ** ---------- .> results:     disabled://
- *** --- * --- .> concurrency: 2 (prefork)
-- ******* ---- .> task events: OFF (enable -E to monitor tasks in this worker)
--- ***** ----- 
 -------------- [queues]
                .> celery           exchange=celery(direct) key=celery
                

[tasks]
  . traffic_collector.consume_traffic_periodically

[2025-03-14 12:16:27,069: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

[2025-03-14 12:16:27,081: INFO/MainProcess] Connected to redis://localhost:6379/0
[2025-03-14 12:16:27,082: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

[2025-03-14 12:16:27,083: INFO/MainProcess] mingle: searching for neighbors
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-03-14 12:16:27,621 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-13 15:57:24', 'last_model_construction_at': '2025-03-14 03:57:04', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.33, 1.0, 0.5, 1.0, 0.0, 0.0, 0.0, 2.0, 0.33, 3.0, 0.17, 0.5, 0.25, 3.0, 0.11, 0.33, 0.17, 3.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-14 12:16:27,621 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
[2025-03-14 12:16:28,090: INFO/MainProcess] mingle: all alone
[2025-03-14 12:16:28,099: INFO/MainProcess] celery@VM-16-2-ubuntu ready.
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-03-14 12:19:42,152 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-13 15:57:24', 'last_model_construction_at': '2025-03-14 03:57:04', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.33, 1.0, 0.5, 1.0, 0.0, 0.0, 0.0, 2.0, 0.33, 3.0, 0.17, 0.5, 0.25, 3.0, 0.11, 0.33, 0.17, 3.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-14 12:19:42,152 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-03-14 12:19:52,818 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-13 15:57:24', 'last_model_construction_at': '2025-03-14 03:57:04', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.33, 1.0, 0.5, 1.0, 0.0, 0.0, 0.0, 2.0, 0.33, 3.0, 0.17, 0.5, 0.25, 3.0, 0.11, 0.33, 0.17, 3.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-14 12:19:52,819 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-03-14 12:20:49,962 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-13 15:57:24', 'last_model_construction_at': '2025-03-14 03:57:04', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.33, 1.0, 0.5, 1.0, 0.0, 0.0, 0.0, 2.0, 0.33, 3.0, 0.17, 0.5, 0.25, 3.0, 0.11, 0.33, 0.17, 3.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-14 12:20:49,962 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-03-14 12:21:22,617 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-13 15:57:24', 'last_model_construction_at': '2025-03-14 03:57:04', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.33, 1.0, 0.5, 1.0, 0.0, 0.0, 0.0, 2.0, 0.33, 3.0, 0.17, 0.5, 0.25, 3.0, 0.11, 0.33, 0.17, 3.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-14 12:21:22,618 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
2025-03-14 12:22:22,701 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-14 12:22:22,780 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-14 12:22:22,811 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-14 12:22:22,811 - INFO - Starting data generation...
2025-03-14 12:22:22,811 - INFO - API_KNOWLEDGE: [{'number': 'API_2490', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_2491', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}]
2025-03-14 12:22:22,811 - INFO - APP_KNOWLEDGE: {'func_description': 'This is an updated test application', 'normal_seqs': ['Role: admin; API_2490(Call 1); API_2491(Call 2)', 'Role: oridinary_user; API_2490(); API_2491()'], 'malicious_seqs': ['Role: admin; API_2490(); API_2491()', 'Role: ordinary_user; API_2490(); API_2491()'], 'roles': ['admin', 'ordinary_user', 'unlogged_in_user']}
2025-03-14 12:22:23,118 - INFO - Generating simulated API sequences...
2025-03-14 12:22:23,118 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:22:23,118 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:22:24,869 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:22:24,873 - INFO - ========== Method gen_api_seq() returned: seq=['API_2490', 'API_2491'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:22:24,873 - INFO - ========== Method gen_api_seq() returned: seq=['API_2490', 'API_2491'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:22:24,873 - INFO - API sequence 1/12 generated
2025-03-14 12:22:24,873 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 12:22:24,873 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 12:22:27,745 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:22:27,746 - INFO - ========== Method gen_api_seq() returned: seq=['API_2490'], malicious_sign_seq=[0] ==========
2025-03-14 12:22:27,746 - INFO - ========== Method gen_api_seq() returned: seq=['API_2490'], malicious_sign_seq=[0] ==========
2025-03-14 12:22:27,747 - INFO - API sequence 2/12 generated
2025-03-14 12:22:27,747 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:22:27,747 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:22:30,019 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:22:30,020 - INFO - ========== Method gen_api_seq() returned: seq=['API_2490', 'API_2491'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:22:30,020 - INFO - ========== Method gen_api_seq() returned: seq=['API_2490', 'API_2491'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:22:30,020 - INFO - API sequence 3/12 generated
2025-03-14 12:22:30,020 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:22:30,020 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:22:32,538 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:22:32,539 - INFO - ========== Method gen_api_seq() returned: seq=['API_2490', 'API_2491'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:22:32,539 - INFO - ========== Method gen_api_seq() returned: seq=['API_2490', 'API_2491'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:22:32,540 - INFO - API sequence 4/12 generated
2025-03-14 12:22:32,540 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 12:22:32,540 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 12:22:33,644 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:22:33,646 - INFO - ========== Method gen_api_seq() returned: seq=['API_2490'], malicious_sign_seq=[0] ==========
2025-03-14 12:22:33,646 - INFO - ========== Method gen_api_seq() returned: seq=['API_2490'], malicious_sign_seq=[0] ==========
2025-03-14 12:22:33,646 - INFO - API sequence 5/12 generated
2025-03-14 12:22:33,646 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:22:33,646 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:22:34,910 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:22:34,912 - INFO - ========== Method gen_api_seq() returned: seq=['API_2490', 'API_2491'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:22:34,912 - INFO - ========== Method gen_api_seq() returned: seq=['API_2490', 'API_2491'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:22:34,912 - INFO - API sequence 6/12 generated
2025-03-14 12:22:34,912 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:22:34,912 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:22:37,919 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:22:37,920 - INFO - ========== Method gen_api_seq() returned: seq=['API_2490', 'API_2491'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:22:37,920 - INFO - ========== Method gen_api_seq() returned: seq=['API_2490', 'API_2491'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:22:37,920 - INFO - API sequence 7/12 generated
2025-03-14 12:22:37,920 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:22:37,920 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:22:40,236 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:22:40,237 - INFO - ========== Method gen_api_seq() returned: seq=['API_2490', 'API_2491'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:22:40,237 - INFO - ========== Method gen_api_seq() returned: seq=['API_2490', 'API_2491'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:22:40,237 - INFO - API sequence 8/12 generated
2025-03-14 12:22:40,237 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:22:40,237 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:22:42,499 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:22:42,500 - INFO - ========== Method gen_api_seq() returned: seq=['API_2490', 'API_2491'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:22:42,500 - INFO - ========== Method gen_api_seq() returned: seq=['API_2490', 'API_2491'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:22:42,500 - INFO - API sequence 9/12 generated
2025-03-14 12:22:42,500 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:22:42,500 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:22:43,771 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:22:43,772 - INFO - ========== Method gen_api_seq() returned: seq=['API_2490', 'API_2491'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:22:43,772 - INFO - ========== Method gen_api_seq() returned: seq=['API_2490', 'API_2491'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:22:43,772 - INFO - API sequence 10/12 generated
2025-03-14 12:22:43,772 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:22:43,772 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:22:46,778 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:22:46,779 - INFO - ========== Method gen_api_seq() returned: seq=['API_2490', 'API_2491'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:22:46,779 - INFO - ========== Method gen_api_seq() returned: seq=['API_2490', 'API_2491'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:22:46,779 - INFO - API sequence 11/12 generated
2025-03-14 12:22:46,779 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:22:46,779 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:22:48,347 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:22:48,348 - INFO - ========== Method gen_api_seq() returned: seq=['API_2490', 'API_2491'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:22:48,348 - INFO - ========== Method gen_api_seq() returned: seq=['API_2490', 'API_2491'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:22:48,348 - INFO - API sequence 12/12 generated
2025-03-14 12:22:48,349 - INFO - API sequences serialized to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py/serialized_llm_agents.json
2025-03-14 12:22:48,349 - INFO - Generating simulated traffic data set...
2025-03-14 12:22:48,349 - INFO - Error when injecting params for API_2490
Exception in thread Thread-3 (async_data_collect):
Traceback (most recent call last):
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py", line 169, in param_injection_for_api_seq
    url, req_data = param_injection_for_api(api_seq[i])
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py", line 230, in param_injection_for_api
    val = random.choice(api_param_set['query_params'][param])
KeyError: 'a'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/./app.py", line 529, in async_data_collect
    error_apis = traffic_data_generation.gen_data_set(user_api_set, api_knowledge, app_knowledge)
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py", line 304, in gen_data_set
    user_data, seq_valid, error_apis = param_injection_for_api_seq(
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py", line 194, in param_injection_for_api_seq
    error_apis.append(str(api_seq[i].id))
AttributeError: 'API' object has no attribute 'id'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/threading.py", line 1016, in _bootstrap_inner
    self.run()
  File "/usr/lib/python3.10/threading.py", line 953, in run
    self._target(*self._args, **self._kwargs)
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/./app.py", line 538, in async_data_collect
    LOGGER.error(f"Error in data collection: {e.with_traceback(10)}")
TypeError: __traceback__ must be a traceback or None
2025-03-14 12:24:15,735 - INFO - Trying to construct model...
2025-03-14 12:24:15,735 - INFO - DATA_COLLECTION_STATUS: IN_PROGRESS
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-03-14 12:24:55,316 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-13 15:57:24', 'last_model_construction_at': '2025-03-14 03:57:04', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.33, 1.0, 0.5, 1.0, 0.0, 0.0, 0.0, 2.0, 0.33, 3.0, 0.17, 0.5, 0.25, 3.0, 0.11, 0.33, 0.17, 3.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-14 12:24:55,316 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-03-14 12:25:04,789 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-13 15:57:24', 'last_model_construction_at': '2025-03-14 03:57:04', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.33, 1.0, 0.5, 1.0, 0.0, 0.0, 0.0, 2.0, 0.33, 3.0, 0.17, 0.5, 0.25, 3.0, 0.11, 0.33, 0.17, 3.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-14 12:25:04,789 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
2025-03-14 12:25:44,330 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-14 12:25:44,378 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-14 12:25:44,408 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-14 12:25:44,409 - INFO - Starting data generation...
2025-03-14 12:25:44,409 - INFO - API_KNOWLEDGE: [{'number': 'API_2492', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_2493', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}]
2025-03-14 12:25:44,409 - INFO - APP_KNOWLEDGE: {'func_description': 'This is an updated test application', 'normal_seqs': ['Role: admin; API_2492(Call 1); API_2493(Call 2)', 'Role: oridinary_user; API_2492(); API_2493()'], 'malicious_seqs': ['Role: admin; API_2492(); API_2493()', 'Role: ordinary_user; API_2492(); API_2493()'], 'roles': ['admin', 'ordinary_user', 'unlogged_in_user']}
2025-03-14 12:25:44,609 - INFO - Generating simulated API sequences...
2025-03-14 12:25:44,609 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 12:25:44,609 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 12:25:47,355 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:25:47,360 - INFO - ========== Method gen_api_seq() returned: seq=['API_2492', 'API_2493'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:25:47,360 - INFO - ========== Method gen_api_seq() returned: seq=['API_2492', 'API_2493'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:25:47,360 - INFO - API sequence 1/12 generated
2025-03-14 12:25:47,360 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:25:47,360 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:25:51,077 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:25:51,078 - INFO - ========== Method gen_api_seq() returned: seq=['API_2492', 'API_2493'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:25:51,078 - INFO - ========== Method gen_api_seq() returned: seq=['API_2492', 'API_2493'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:25:51,078 - INFO - API sequence 2/12 generated
2025-03-14 12:25:51,078 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 12:25:51,078 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 12:25:52,382 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:25:52,383 - INFO - ========== Method gen_api_seq() returned: seq=['API_2492'], malicious_sign_seq=[0] ==========
2025-03-14 12:25:52,383 - INFO - ========== Method gen_api_seq() returned: seq=['API_2492'], malicious_sign_seq=[0] ==========
2025-03-14 12:25:52,383 - INFO - API sequence 3/12 generated
2025-03-14 12:25:52,383 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:25:52,383 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:25:53,815 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:25:53,816 - INFO - ========== Method gen_api_seq() returned: seq=['API_2492'], malicious_sign_seq=[0] ==========
2025-03-14 12:25:53,816 - INFO - ========== Method gen_api_seq() returned: seq=['API_2492'], malicious_sign_seq=[0] ==========
2025-03-14 12:25:53,816 - INFO - API sequence 4/12 generated
2025-03-14 12:25:53,816 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:25:53,816 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:25:55,288 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:25:55,289 - INFO - ========== Method gen_api_seq() returned: seq=['API_2492'], malicious_sign_seq=[0] ==========
2025-03-14 12:25:55,289 - INFO - ========== Method gen_api_seq() returned: seq=['API_2492'], malicious_sign_seq=[0] ==========
2025-03-14 12:25:55,289 - INFO - API sequence 5/12 generated
2025-03-14 12:25:55,289 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:25:55,289 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:25:57,644 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:25:57,645 - INFO - ========== Method gen_api_seq() returned: seq=['API_2492', 'API_2493'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:25:57,645 - INFO - ========== Method gen_api_seq() returned: seq=['API_2492', 'API_2493'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:25:57,645 - INFO - API sequence 6/12 generated
2025-03-14 12:25:57,645 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:25:57,645 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:26:00,178 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:26:00,179 - INFO - ========== Method gen_api_seq() returned: seq=['API_2492', 'API_2493'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:26:00,179 - INFO - ========== Method gen_api_seq() returned: seq=['API_2492', 'API_2493'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:26:00,179 - INFO - API sequence 7/12 generated
2025-03-14 12:26:00,179 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:26:00,179 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:26:02,882 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:26:02,883 - INFO - ========== Method gen_api_seq() returned: seq=['API_2492', 'API_2493'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:26:02,883 - INFO - ========== Method gen_api_seq() returned: seq=['API_2492', 'API_2493'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:26:02,883 - INFO - API sequence 8/12 generated
2025-03-14 12:26:02,883 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:26:02,883 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:26:04,459 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:26:04,460 - INFO - ========== Method gen_api_seq() returned: seq=['API_2492', 'API_2493'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:26:04,460 - INFO - ========== Method gen_api_seq() returned: seq=['API_2492', 'API_2493'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:26:04,460 - INFO - API sequence 9/12 generated
2025-03-14 12:26:04,460 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:26:04,460 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:26:06,593 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:26:06,595 - INFO - ========== Method gen_api_seq() returned: seq=['API_2492', 'API_2493'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:26:06,595 - INFO - ========== Method gen_api_seq() returned: seq=['API_2492', 'API_2493'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:26:06,595 - INFO - API sequence 10/12 generated
2025-03-14 12:26:06,595 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:26:06,595 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:26:07,850 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:26:07,851 - INFO - ========== Method gen_api_seq() returned: seq=['API_2492', 'API_2493'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:26:07,851 - INFO - ========== Method gen_api_seq() returned: seq=['API_2492', 'API_2493'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:26:07,851 - INFO - API sequence 11/12 generated
2025-03-14 12:26:07,851 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:26:07,851 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:26:09,086 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:26:09,087 - INFO - ========== Method gen_api_seq() returned: seq=['API_2492', 'API_2493'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:26:09,087 - INFO - ========== Method gen_api_seq() returned: seq=['API_2492', 'API_2493'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:26:09,087 - INFO - API sequence 12/12 generated
2025-03-14 12:26:09,087 - INFO - API sequences serialized to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py/serialized_llm_agents.json
2025-03-14 12:26:09,087 - INFO - Generating simulated traffic data set...
2025-03-14 12:26:09,088 - INFO - Error when injecting params for API_2492
2025-03-14 12:26:09,088 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/memo/21 {}
2025-03-14 12:26:09,088 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:26:09,088 - INFO - error_apis: ['2492']
2025-03-14 12:26:09,088 - INFO - Simulated traffic data for 1/12 user collected：user: adminuser malicious: False
2025-03-14 12:26:09,088 - INFO - Error when injecting params for API_2492
2025-03-14 12:26:09,088 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:26:09,088 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:26:09,088 - INFO - error_apis: ['2492']
2025-03-14 12:26:09,088 - INFO - Simulated traffic data for 2/12 user collected：user: normaluser malicious: True
2025-03-14 12:26:09,088 - INFO - Error when injecting params for API_2492
2025-03-14 12:26:09,089 - INFO - error_apis: ['2492']
2025-03-14 12:26:09,089 - INFO - Simulated traffic data for 3/12 user collected：user: adminuser malicious: False
2025-03-14 12:26:09,089 - INFO - Error when injecting params for API_2492
2025-03-14 12:26:09,089 - INFO - error_apis: ['2492']
2025-03-14 12:26:09,089 - INFO - Simulated traffic data for 4/12 user collected：user: normaluser malicious: False
2025-03-14 12:26:09,089 - INFO - Error when injecting params for API_2492
2025-03-14 12:26:09,089 - INFO - error_apis: ['2492']
2025-03-14 12:26:09,089 - INFO - Simulated traffic data for 5/12 user collected：user: normaluser malicious: False
2025-03-14 12:26:09,089 - INFO - Error when injecting params for API_2492
2025-03-14 12:26:09,089 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:26:09,089 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:26:09,089 - INFO - error_apis: ['2492']
2025-03-14 12:26:09,089 - INFO - Simulated traffic data for 6/12 user collected：user: normaluser malicious: False
2025-03-14 12:26:09,090 - INFO - Error when injecting params for API_2492
2025-03-14 12:26:09,090 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:26:09,090 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:26:09,090 - INFO - error_apis: ['2492']
2025-03-14 12:26:09,090 - INFO - Simulated traffic data for 7/12 user collected：user: unloggeduser malicious: True
2025-03-14 12:26:09,090 - INFO - Error when injecting params for API_2492
2025-03-14 12:26:09,090 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:26:09,090 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:26:09,090 - INFO - error_apis: ['2492']
2025-03-14 12:26:09,090 - INFO - Simulated traffic data for 8/12 user collected：user: normaluser malicious: False
2025-03-14 12:26:09,090 - INFO - Error when injecting params for API_2492
2025-03-14 12:26:09,091 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:26:09,091 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:26:09,091 - INFO - error_apis: ['2492']
2025-03-14 12:26:09,091 - INFO - Simulated traffic data for 9/12 user collected：user: normaluser malicious: True
2025-03-14 12:26:09,091 - INFO - Error when injecting params for API_2492
2025-03-14 12:26:09,091 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:26:09,091 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:26:09,091 - INFO - error_apis: ['2492']
2025-03-14 12:26:09,091 - INFO - Simulated traffic data for 10/12 user collected：user: normaluser malicious: True
2025-03-14 12:26:09,091 - INFO - Error when injecting params for API_2492
2025-03-14 12:26:09,091 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:26:09,091 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:26:09,091 - INFO - error_apis: ['2492']
2025-03-14 12:26:09,092 - INFO - Simulated traffic data for 11/12 user collected：user: unloggeduser malicious: True
2025-03-14 12:26:09,092 - INFO - Error when injecting params for API_2492
2025-03-14 12:26:09,092 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:26:09,092 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:26:09,092 - INFO - error_apis: ['2492']
2025-03-14 12:26:09,092 - INFO - Simulated traffic data for 12/12 user collected：user: unloggeduser malicious: True
2025-03-14 12:26:09,097 - INFO - All simulated traffic data collected：/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/simulated_traffic_data.csv
2025-03-14 12:26:09,097 - INFO - error_apis: ['2492']
2025-03-14 12:26:20,321 - INFO - Trying to construct model...
2025-03-14 12:26:20,321 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-14 12:26:20,363 - INFO - Training model... Size of feature_list: 7
2025-03-14 12:26:20,376 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 12:26:20,380 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 12:26:20,381 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 12:26:20,382 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 12:26:20,383 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 12:26:20,385 - INFO - Extracting features... Size of feature_list: 7
[12:26:20] WARNING: /workspace/src/learner.cc:740: 
Parameters: { "use_label_encoder" } are not used.

2025-03-14 12:26:20,487 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 12:26:20,489 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 12:26:20,490 - INFO - Extracting features... Size of feature_list: 7
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
2025-03-14 12:26:20,511 - INFO - Model constructed.
2025-03-14 12:28:01,690 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-14 12:28:01,735 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-14 12:28:01,765 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-14 12:28:01,765 - INFO - Starting data generation...
2025-03-14 12:28:01,766 - INFO - API_KNOWLEDGE: [{'number': 'API_2494', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_2495', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}]
2025-03-14 12:28:01,766 - INFO - APP_KNOWLEDGE: {'func_description': 'This is an updated test application', 'normal_seqs': ['Role: admin; API_2494(Call 1); API_2495(Call 2)', 'Role: oridinary_user; API_2494(); API_2495()'], 'malicious_seqs': ['Role: admin; API_2494(); API_2495()', 'Role: ordinary_user; API_2494(); API_2495()'], 'roles': ['admin', 'ordinary_user', 'unlogged_in_user']}
2025-03-14 12:28:01,816 - INFO - Generating simulated API sequences...
2025-03-14 12:28:01,816 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:28:01,816 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:28:01,816 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:28:03,999 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:28:03,999 - INFO - ========== Method gen_api_seq() returned: seq=['API_2494', 'API_2495'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:28:03,999 - INFO - ========== Method gen_api_seq() returned: seq=['API_2494', 'API_2495'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:28:03,999 - INFO - ========== Method gen_api_seq() returned: seq=['API_2494', 'API_2495'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:28:04,000 - INFO - API sequence 1/12 generated
2025-03-14 12:28:04,000 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 12:28:04,000 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 12:28:04,000 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 12:28:06,422 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:28:06,423 - INFO - ========== Method gen_api_seq() returned: seq=['API_2494', 'API_2495'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:28:06,423 - INFO - ========== Method gen_api_seq() returned: seq=['API_2494', 'API_2495'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:28:06,423 - INFO - ========== Method gen_api_seq() returned: seq=['API_2494', 'API_2495'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:28:06,423 - INFO - API sequence 2/12 generated
2025-03-14 12:28:06,423 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:28:06,423 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:28:06,423 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:28:07,699 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:28:07,700 - INFO - ========== Method gen_api_seq() returned: seq=['API_2494', 'API_2495'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:28:07,700 - INFO - ========== Method gen_api_seq() returned: seq=['API_2494', 'API_2495'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:28:07,700 - INFO - ========== Method gen_api_seq() returned: seq=['API_2494', 'API_2495'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:28:07,700 - INFO - API sequence 3/12 generated
2025-03-14 12:28:07,700 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:28:07,700 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:28:07,700 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:28:10,042 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:28:10,043 - INFO - ========== Method gen_api_seq() returned: seq=['API_2494', 'API_2495'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:28:10,043 - INFO - ========== Method gen_api_seq() returned: seq=['API_2494', 'API_2495'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:28:10,043 - INFO - ========== Method gen_api_seq() returned: seq=['API_2494', 'API_2495'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:28:10,043 - INFO - API sequence 4/12 generated
2025-03-14 12:28:10,043 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:28:10,043 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:28:10,043 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:28:12,190 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:28:12,191 - INFO - ========== Method gen_api_seq() returned: seq=['API_2494', 'API_2495'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:28:12,191 - INFO - ========== Method gen_api_seq() returned: seq=['API_2494', 'API_2495'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:28:12,191 - INFO - ========== Method gen_api_seq() returned: seq=['API_2494', 'API_2495'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:28:12,191 - INFO - API sequence 5/12 generated
2025-03-14 12:28:12,191 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:28:12,191 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:28:12,191 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:28:14,406 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:28:14,407 - INFO - ========== Method gen_api_seq() returned: seq=['API_2494', 'API_2495'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:28:14,407 - INFO - ========== Method gen_api_seq() returned: seq=['API_2494', 'API_2495'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:28:14,407 - INFO - ========== Method gen_api_seq() returned: seq=['API_2494', 'API_2495'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:28:14,407 - INFO - API sequence 6/12 generated
2025-03-14 12:28:14,407 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:28:14,407 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:28:14,407 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:28:16,982 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:28:16,983 - INFO - ========== Method gen_api_seq() returned: seq=['API_2494', 'API_2495'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:28:16,983 - INFO - ========== Method gen_api_seq() returned: seq=['API_2494', 'API_2495'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:28:16,983 - INFO - ========== Method gen_api_seq() returned: seq=['API_2494', 'API_2495'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:28:16,983 - INFO - API sequence 7/12 generated
2025-03-14 12:28:16,983 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:28:16,983 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:28:16,983 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:28:19,271 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:28:19,272 - INFO - ========== Method gen_api_seq() returned: seq=['API_2494', 'API_2495'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:28:19,272 - INFO - ========== Method gen_api_seq() returned: seq=['API_2494', 'API_2495'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:28:19,272 - INFO - ========== Method gen_api_seq() returned: seq=['API_2494', 'API_2495'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:28:19,272 - INFO - API sequence 8/12 generated
2025-03-14 12:28:19,272 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:28:19,272 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:28:19,272 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:28:21,422 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:28:21,423 - INFO - ========== Method gen_api_seq() returned: seq=['API_2494', 'API_2495'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:28:21,423 - INFO - ========== Method gen_api_seq() returned: seq=['API_2494', 'API_2495'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:28:21,423 - INFO - ========== Method gen_api_seq() returned: seq=['API_2494', 'API_2495'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:28:21,423 - INFO - API sequence 9/12 generated
2025-03-14 12:28:21,423 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 12:28:21,423 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 12:28:21,423 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 12:28:22,638 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:28:22,639 - INFO - ========== Method gen_api_seq() returned: seq=['API_2494'], malicious_sign_seq=[0] ==========
2025-03-14 12:28:22,639 - INFO - ========== Method gen_api_seq() returned: seq=['API_2494'], malicious_sign_seq=[0] ==========
2025-03-14 12:28:22,639 - INFO - ========== Method gen_api_seq() returned: seq=['API_2494'], malicious_sign_seq=[0] ==========
2025-03-14 12:28:22,640 - INFO - API sequence 10/12 generated
2025-03-14 12:28:22,640 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:28:22,640 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:28:22,640 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:28:24,930 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:28:24,931 - INFO - ========== Method gen_api_seq() returned: seq=['API_2494', 'API_2495'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:28:24,931 - INFO - ========== Method gen_api_seq() returned: seq=['API_2494', 'API_2495'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:28:24,931 - INFO - ========== Method gen_api_seq() returned: seq=['API_2494', 'API_2495'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:28:24,931 - INFO - API sequence 11/12 generated
2025-03-14 12:28:24,931 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:28:24,931 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:28:24,931 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:28:27,769 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:28:27,770 - INFO - ========== Method gen_api_seq() returned: seq=['API_2494', 'API_2495'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:28:27,770 - INFO - ========== Method gen_api_seq() returned: seq=['API_2494', 'API_2495'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:28:27,770 - INFO - ========== Method gen_api_seq() returned: seq=['API_2494', 'API_2495'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:28:27,770 - INFO - API sequence 12/12 generated
2025-03-14 12:28:27,771 - INFO - API sequences serialized to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py/serialized_llm_agents.json
2025-03-14 12:28:27,771 - INFO - Generating simulated traffic data set...
2025-03-14 12:28:27,771 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-14 12:28:27,771 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:28:27,772 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:28:27,772 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:28:27,772 - INFO - error_apis: []
2025-03-14 12:28:27,772 - INFO - Simulated traffic data for 1/12 user collected：user: normaluser malicious: False
2025-03-14 12:28:27,772 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-14 12:28:27,772 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:28:27,772 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:28:27,772 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:28:27,772 - INFO - error_apis: []
2025-03-14 12:28:27,772 - INFO - Simulated traffic data for 2/12 user collected：user: adminuser malicious: False
2025-03-14 12:28:27,772 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/resource/16 {}
2025-03-14 12:28:27,772 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:28:27,773 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:28:27,773 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:28:27,773 - INFO - error_apis: []
2025-03-14 12:28:27,773 - INFO - Simulated traffic data for 3/12 user collected：user: normaluser malicious: False
2025-03-14 12:28:27,773 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-14 12:28:27,773 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:28:27,773 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:28:27,773 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:28:27,773 - INFO - error_apis: []
2025-03-14 12:28:27,773 - INFO - Simulated traffic data for 4/12 user collected：user: normaluser malicious: True
2025-03-14 12:28:27,773 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-14 12:28:27,773 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:28:27,774 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:28:27,774 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:28:27,774 - INFO - error_apis: []
2025-03-14 12:28:27,774 - INFO - Simulated traffic data for 5/12 user collected：user: unloggeduser malicious: True
2025-03-14 12:28:27,774 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-14 12:28:27,774 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:28:27,774 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:28:27,774 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:28:27,774 - INFO - error_apis: []
2025-03-14 12:28:27,774 - INFO - Simulated traffic data for 6/12 user collected：user: normaluser malicious: True
2025-03-14 12:28:27,774 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-14 12:28:27,774 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:28:27,775 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:28:27,775 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:28:27,775 - INFO - error_apis: []
2025-03-14 12:28:27,775 - INFO - Simulated traffic data for 7/12 user collected：user: normaluser malicious: True
2025-03-14 12:28:27,775 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-14 12:28:27,775 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:28:27,775 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:28:27,775 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:28:27,775 - INFO - error_apis: []
2025-03-14 12:28:27,775 - INFO - Simulated traffic data for 8/12 user collected：user: normaluser malicious: False
2025-03-14 12:28:27,775 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-14 12:28:27,775 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:28:27,776 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:28:27,776 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:28:27,776 - INFO - error_apis: []
2025-03-14 12:28:27,776 - INFO - Simulated traffic data for 9/12 user collected：user: unloggeduser malicious: True
2025-03-14 12:28:27,776 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-14 12:28:27,776 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:28:27,776 - INFO - error_apis: []
2025-03-14 12:28:27,776 - INFO - Simulated traffic data for 10/12 user collected：user: adminuser malicious: False
2025-03-14 12:28:27,776 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-14 12:28:27,776 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:28:27,776 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:28:27,777 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:28:27,777 - INFO - error_apis: []
2025-03-14 12:28:27,777 - INFO - Simulated traffic data for 11/12 user collected：user: unloggeduser malicious: True
2025-03-14 12:28:27,777 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-14 12:28:27,777 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:28:27,777 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/memo/21 {}
2025-03-14 12:28:27,777 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:28:27,777 - INFO - error_apis: []
2025-03-14 12:28:27,777 - INFO - Simulated traffic data for 12/12 user collected：user: normaluser malicious: False
2025-03-14 12:28:27,780 - INFO - All simulated traffic data collected：/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/simulated_traffic_data.csv
2025-03-14 12:28:27,780 - INFO - error_apis: []
2025-03-14 12:28:37,515 - INFO - Trying to construct model...
2025-03-14 12:28:37,516 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-14 12:28:37,547 - INFO - Training model... Size of feature_list: 7
2025-03-14 12:28:37,557 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 12:28:37,559 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 12:28:37,560 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 12:28:37,562 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 12:28:37,563 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 12:28:37,565 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 12:28:37,566 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 12:28:37,568 - INFO - Extracting features... Size of feature_list: 7
[12:28:37] WARNING: /workspace/src/learner.cc:740: 
Parameters: { "use_label_encoder" } are not used.

2025-03-14 12:28:37,597 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 12:28:37,599 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 12:28:37,601 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 12:28:37,602 - INFO - Extracting features... Size of feature_list: 7
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
2025-03-14 12:28:37,614 - INFO - Model constructed.
2025-03-14 12:55:10,022 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-14 12:55:10,065 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-14 12:55:10,137 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-14 12:55:10,138 - INFO - Starting data generation...
2025-03-14 12:55:10,138 - INFO - API_KNOWLEDGE: [{'number': 'API_2496', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_2497', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_2498', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}]
2025-03-14 12:55:10,138 - INFO - APP_KNOWLEDGE: {'func_description': 'This is an updated test application', 'normal_seqs': ['Role: admin; API_2496(Call 1); API_2498(Call 2)', 'Role: oridinary_user; API_2496(); API_2498()'], 'malicious_seqs': ['Role: admin; API_2496(); API_2498()', 'Role: ordinary_user; API_2496(); API_2498()'], 'roles': ['admin', 'ordinary_user', 'unlogged_in_user']}
2025-03-14 12:55:10,187 - INFO - Generating simulated API sequences...
2025-03-14 12:55:10,188 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:55:10,188 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:55:10,188 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:55:10,188 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:55:13,074 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:55:13,075 - INFO - ========== Method gen_api_seq() returned: seq=['API_2496', 'API_2498'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:55:13,075 - INFO - ========== Method gen_api_seq() returned: seq=['API_2496', 'API_2498'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:55:13,075 - INFO - ========== Method gen_api_seq() returned: seq=['API_2496', 'API_2498'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:55:13,075 - INFO - ========== Method gen_api_seq() returned: seq=['API_2496', 'API_2498'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:55:13,075 - INFO - API sequence 1/12 generated
2025-03-14 12:55:13,076 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 12:55:13,076 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 12:55:13,076 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 12:55:13,076 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 12:55:15,566 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:55:15,567 - INFO - ========== Method gen_api_seq() returned: seq=['API_2496'], malicious_sign_seq=[0] ==========
2025-03-14 12:55:15,567 - INFO - ========== Method gen_api_seq() returned: seq=['API_2496'], malicious_sign_seq=[0] ==========
2025-03-14 12:55:15,567 - INFO - ========== Method gen_api_seq() returned: seq=['API_2496'], malicious_sign_seq=[0] ==========
2025-03-14 12:55:15,567 - INFO - ========== Method gen_api_seq() returned: seq=['API_2496'], malicious_sign_seq=[0] ==========
2025-03-14 12:55:15,567 - INFO - API sequence 2/12 generated
2025-03-14 12:55:15,567 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:55:15,567 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:55:15,567 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:55:15,567 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:55:17,259 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:55:17,260 - INFO - ========== Method gen_api_seq() returned: seq=['API_2496', 'API_2498'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:55:17,260 - INFO - ========== Method gen_api_seq() returned: seq=['API_2496', 'API_2498'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:55:17,260 - INFO - ========== Method gen_api_seq() returned: seq=['API_2496', 'API_2498'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:55:17,260 - INFO - ========== Method gen_api_seq() returned: seq=['API_2496', 'API_2498'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:55:17,260 - INFO - API sequence 3/12 generated
2025-03-14 12:55:17,260 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:55:17,260 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:55:17,260 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:55:17,260 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:55:18,370 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:55:18,371 - INFO - ========== Method gen_api_seq() returned: seq=['API_2496'], malicious_sign_seq=[0] ==========
2025-03-14 12:55:18,371 - INFO - ========== Method gen_api_seq() returned: seq=['API_2496'], malicious_sign_seq=[0] ==========
2025-03-14 12:55:18,371 - INFO - ========== Method gen_api_seq() returned: seq=['API_2496'], malicious_sign_seq=[0] ==========
2025-03-14 12:55:18,371 - INFO - ========== Method gen_api_seq() returned: seq=['API_2496'], malicious_sign_seq=[0] ==========
2025-03-14 12:55:18,371 - INFO - API sequence 4/12 generated
2025-03-14 12:55:18,371 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:55:18,371 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:55:18,371 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:55:18,371 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:55:20,669 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:55:20,671 - INFO - ========== Method gen_api_seq() returned: seq=['API_2496', 'API_2498'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:55:20,671 - INFO - ========== Method gen_api_seq() returned: seq=['API_2496', 'API_2498'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:55:20,671 - INFO - ========== Method gen_api_seq() returned: seq=['API_2496', 'API_2498'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:55:20,671 - INFO - ========== Method gen_api_seq() returned: seq=['API_2496', 'API_2498'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:55:20,671 - INFO - API sequence 5/12 generated
2025-03-14 12:55:20,671 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 12:55:20,671 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 12:55:20,671 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 12:55:20,671 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 12:55:23,285 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:55:23,286 - INFO - ========== Method gen_api_seq() returned: seq=['API_2496', 'API_2498'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:55:23,286 - INFO - ========== Method gen_api_seq() returned: seq=['API_2496', 'API_2498'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:55:23,286 - INFO - ========== Method gen_api_seq() returned: seq=['API_2496', 'API_2498'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:55:23,286 - INFO - ========== Method gen_api_seq() returned: seq=['API_2496', 'API_2498'], malicious_sign_seq=[0, 0] ==========
2025-03-14 12:55:23,286 - INFO - API sequence 6/12 generated
2025-03-14 12:55:23,286 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:55:23,286 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:55:23,286 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:55:23,286 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:55:24,509 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:55:24,510 - INFO - ========== Method gen_api_seq() returned: seq=['API_2496', 'API_2498'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:55:24,510 - INFO - ========== Method gen_api_seq() returned: seq=['API_2496', 'API_2498'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:55:24,510 - INFO - ========== Method gen_api_seq() returned: seq=['API_2496', 'API_2498'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:55:24,510 - INFO - ========== Method gen_api_seq() returned: seq=['API_2496', 'API_2498'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:55:24,510 - INFO - API sequence 7/12 generated
2025-03-14 12:55:24,510 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:55:24,510 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:55:24,510 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:55:24,510 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:55:26,788 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:55:26,789 - INFO - ========== Method gen_api_seq() returned: seq=['API_2496', 'API_2498'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:55:26,789 - INFO - ========== Method gen_api_seq() returned: seq=['API_2496', 'API_2498'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:55:26,789 - INFO - ========== Method gen_api_seq() returned: seq=['API_2496', 'API_2498'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:55:26,789 - INFO - ========== Method gen_api_seq() returned: seq=['API_2496', 'API_2498'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:55:26,789 - INFO - API sequence 8/12 generated
2025-03-14 12:55:26,789 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:55:26,789 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:55:26,789 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:55:26,789 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:55:29,080 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:55:29,081 - INFO - ========== Method gen_api_seq() returned: seq=['API_2496', 'API_2498'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:55:29,081 - INFO - ========== Method gen_api_seq() returned: seq=['API_2496', 'API_2498'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:55:29,081 - INFO - ========== Method gen_api_seq() returned: seq=['API_2496', 'API_2498'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:55:29,081 - INFO - ========== Method gen_api_seq() returned: seq=['API_2496', 'API_2498'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:55:29,081 - INFO - API sequence 9/12 generated
2025-03-14 12:55:29,081 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:55:29,081 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:55:29,081 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:55:29,081 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:55:30,190 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:55:30,191 - INFO - ========== Method gen_api_seq() returned: seq=['API_2496'], malicious_sign_seq=[0] ==========
2025-03-14 12:55:30,191 - INFO - ========== Method gen_api_seq() returned: seq=['API_2496'], malicious_sign_seq=[0] ==========
2025-03-14 12:55:30,191 - INFO - ========== Method gen_api_seq() returned: seq=['API_2496'], malicious_sign_seq=[0] ==========
2025-03-14 12:55:30,191 - INFO - ========== Method gen_api_seq() returned: seq=['API_2496'], malicious_sign_seq=[0] ==========
2025-03-14 12:55:30,192 - INFO - API sequence 10/12 generated
2025-03-14 12:55:30,192 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:55:30,192 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:55:30,192 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:55:30,192 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:55:31,476 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:55:31,477 - INFO - ========== Method gen_api_seq() returned: seq=['API_2496', 'API_2498'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:55:31,477 - INFO - ========== Method gen_api_seq() returned: seq=['API_2496', 'API_2498'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:55:31,477 - INFO - ========== Method gen_api_seq() returned: seq=['API_2496', 'API_2498'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:55:31,477 - INFO - ========== Method gen_api_seq() returned: seq=['API_2496', 'API_2498'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:55:31,477 - INFO - API sequence 11/12 generated
2025-03-14 12:55:31,477 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:55:31,477 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:55:31,477 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:55:31,477 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:55:32,759 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:55:32,760 - INFO - ========== Method gen_api_seq() returned: seq=['API_2496', 'API_2498'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:55:32,760 - INFO - ========== Method gen_api_seq() returned: seq=['API_2496', 'API_2498'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:55:32,760 - INFO - ========== Method gen_api_seq() returned: seq=['API_2496', 'API_2498'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:55:32,760 - INFO - ========== Method gen_api_seq() returned: seq=['API_2496', 'API_2498'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:55:32,760 - INFO - API sequence 12/12 generated
2025-03-14 12:55:32,761 - INFO - API sequences serialized to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py/serialized_llm_agents.json
2025-03-14 12:55:32,761 - INFO - Generating simulated traffic data set...
2025-03-14 12:55:32,761 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-14 12:55:32,761 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:55:32,762 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:55:32,762 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:55:32,762 - INFO - error_apis: []
2025-03-14 12:55:32,762 - INFO - Simulated traffic data for 1/12 user collected：user: normaluser malicious: False
2025-03-14 12:55:32,762 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-14 12:55:32,762 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:55:32,762 - INFO - error_apis: []
2025-03-14 12:55:32,762 - INFO - Simulated traffic data for 2/12 user collected：user: adminuser malicious: False
2025-03-14 12:55:32,762 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/resource/16 {}
2025-03-14 12:55:32,762 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:55:32,762 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/memo/21 {}
2025-03-14 12:55:32,762 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:55:32,762 - INFO - error_apis: []
2025-03-14 12:55:32,763 - INFO - Simulated traffic data for 3/12 user collected：user: normaluser malicious: True
2025-03-14 12:55:32,763 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-14 12:55:32,763 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:55:32,763 - INFO - error_apis: []
2025-03-14 12:55:32,763 - INFO - Simulated traffic data for 4/12 user collected：user: normaluser malicious: False
2025-03-14 12:55:32,763 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-14 12:55:32,763 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:55:32,763 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:55:32,763 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:55:32,763 - INFO - error_apis: []
2025-03-14 12:55:32,763 - INFO - Simulated traffic data for 5/12 user collected：user: normaluser malicious: False
2025-03-14 12:55:32,764 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-14 12:55:32,764 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:55:32,764 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:55:32,764 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:55:32,764 - INFO - error_apis: []
2025-03-14 12:55:32,764 - INFO - Simulated traffic data for 6/12 user collected：user: adminuser malicious: False
2025-03-14 12:55:32,764 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/resource/16 {}
2025-03-14 12:55:32,764 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:55:32,764 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:55:32,764 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:55:32,764 - INFO - error_apis: []
2025-03-14 12:55:32,764 - INFO - Simulated traffic data for 7/12 user collected：user: unloggeduser malicious: True
2025-03-14 12:55:32,765 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-14 12:55:32,765 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:55:32,765 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:55:32,765 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:55:32,765 - INFO - error_apis: []
2025-03-14 12:55:32,765 - INFO - Simulated traffic data for 8/12 user collected：user: normaluser malicious: True
2025-03-14 12:55:32,765 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-14 12:55:32,765 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:55:32,765 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:55:32,765 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:55:32,765 - INFO - error_apis: []
2025-03-14 12:55:32,765 - INFO - Simulated traffic data for 9/12 user collected：user: unloggeduser malicious: True
2025-03-14 12:55:32,766 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-14 12:55:32,766 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:55:32,766 - INFO - error_apis: []
2025-03-14 12:55:32,766 - INFO - Simulated traffic data for 10/12 user collected：user: normaluser malicious: False
2025-03-14 12:55:32,766 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-14 12:55:32,766 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:55:32,766 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:55:32,766 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:55:32,766 - INFO - error_apis: []
2025-03-14 12:55:32,766 - INFO - Simulated traffic data for 11/12 user collected：user: unloggeduser malicious: True
2025-03-14 12:55:32,766 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-14 12:55:32,766 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:55:32,767 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:55:32,767 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:55:32,767 - INFO - error_apis: []
2025-03-14 12:55:32,767 - INFO - Simulated traffic data for 12/12 user collected：user: normaluser malicious: True
2025-03-14 12:55:32,769 - INFO - All simulated traffic data collected：/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/simulated_traffic_data.csv
2025-03-14 12:55:32,769 - INFO - error_apis: []
2025-03-14 12:58:04,081 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-14 12:58:04,123 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-14 12:58:04,194 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-14 12:58:04,194 - INFO - Starting data generation...
2025-03-14 12:58:04,194 - INFO - API_KNOWLEDGE: [{'number': 'API_2499', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_2500', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_2501', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}]
2025-03-14 12:58:04,194 - INFO - APP_KNOWLEDGE: {'func_description': 'This is an updated test application', 'normal_seqs': ['Role: admin; API_2499(Call 1); API_2501(Call 2)', 'Role: oridinary_user; API_2501(); API_2500()'], 'malicious_seqs': ['Role: admin; API_2499(); API_2500()', 'Role: ordinary_user; API_2500(); API_2501()'], 'roles': ['admin', 'ordinary_user', 'unlogged_in_user']}
2025-03-14 12:58:04,247 - INFO - Generating simulated API sequences...
2025-03-14 12:58:04,248 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:58:04,248 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:58:04,248 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:58:04,248 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:58:04,248 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:58:06,111 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:58:06,112 - INFO - ========== Method gen_api_seq() returned: seq=['API_2501'], malicious_sign_seq=[0] ==========
2025-03-14 12:58:06,112 - INFO - ========== Method gen_api_seq() returned: seq=['API_2501'], malicious_sign_seq=[0] ==========
2025-03-14 12:58:06,112 - INFO - ========== Method gen_api_seq() returned: seq=['API_2501'], malicious_sign_seq=[0] ==========
2025-03-14 12:58:06,112 - INFO - ========== Method gen_api_seq() returned: seq=['API_2501'], malicious_sign_seq=[0] ==========
2025-03-14 12:58:06,112 - INFO - ========== Method gen_api_seq() returned: seq=['API_2501'], malicious_sign_seq=[0] ==========
2025-03-14 12:58:06,112 - INFO - API sequence 1/12 generated
2025-03-14 12:58:06,112 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:58:06,112 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:58:06,112 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:58:06,112 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:58:06,112 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:58:08,007 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:58:08,008 - INFO - ========== Method gen_api_seq() returned: seq=['API_2501'], malicious_sign_seq=[0] ==========
2025-03-14 12:58:08,008 - INFO - ========== Method gen_api_seq() returned: seq=['API_2501'], malicious_sign_seq=[0] ==========
2025-03-14 12:58:08,008 - INFO - ========== Method gen_api_seq() returned: seq=['API_2501'], malicious_sign_seq=[0] ==========
2025-03-14 12:58:08,008 - INFO - ========== Method gen_api_seq() returned: seq=['API_2501'], malicious_sign_seq=[0] ==========
2025-03-14 12:58:08,008 - INFO - ========== Method gen_api_seq() returned: seq=['API_2501'], malicious_sign_seq=[0] ==========
2025-03-14 12:58:08,008 - INFO - API sequence 2/12 generated
2025-03-14 12:58:08,008 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:58:08,008 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:58:08,008 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:58:08,008 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:58:08,008 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:58:10,173 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:58:10,173 - INFO - ========== Method gen_api_seq() returned: seq=['API_2501'], malicious_sign_seq=[0] ==========
2025-03-14 12:58:10,173 - INFO - ========== Method gen_api_seq() returned: seq=['API_2501'], malicious_sign_seq=[0] ==========
2025-03-14 12:58:10,173 - INFO - ========== Method gen_api_seq() returned: seq=['API_2501'], malicious_sign_seq=[0] ==========
2025-03-14 12:58:10,173 - INFO - ========== Method gen_api_seq() returned: seq=['API_2501'], malicious_sign_seq=[0] ==========
2025-03-14 12:58:10,173 - INFO - ========== Method gen_api_seq() returned: seq=['API_2501'], malicious_sign_seq=[0] ==========
2025-03-14 12:58:10,174 - INFO - API sequence 3/12 generated
2025-03-14 12:58:10,174 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:58:10,174 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:58:10,174 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:58:10,174 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:58:10,174 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:58:12,669 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:58:12,670 - INFO - ========== Method gen_api_seq() returned: seq=['API_2501', 'API_2500'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:58:12,670 - INFO - ========== Method gen_api_seq() returned: seq=['API_2501', 'API_2500'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:58:12,670 - INFO - ========== Method gen_api_seq() returned: seq=['API_2501', 'API_2500'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:58:12,670 - INFO - ========== Method gen_api_seq() returned: seq=['API_2501', 'API_2500'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:58:12,670 - INFO - ========== Method gen_api_seq() returned: seq=['API_2501', 'API_2500'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:58:12,670 - INFO - API sequence 4/12 generated
2025-03-14 12:58:12,670 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:58:12,670 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:58:12,670 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:58:12,670 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:58:12,670 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:58:14,945 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:58:14,946 - INFO - ========== Method gen_api_seq() returned: seq=['API_2501', 'API_2500'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:58:14,946 - INFO - ========== Method gen_api_seq() returned: seq=['API_2501', 'API_2500'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:58:14,946 - INFO - ========== Method gen_api_seq() returned: seq=['API_2501', 'API_2500'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:58:14,946 - INFO - ========== Method gen_api_seq() returned: seq=['API_2501', 'API_2500'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:58:14,946 - INFO - ========== Method gen_api_seq() returned: seq=['API_2501', 'API_2500'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:58:14,946 - INFO - API sequence 5/12 generated
2025-03-14 12:58:14,947 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:58:14,947 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:58:14,947 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:58:14,947 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:58:14,947 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:58:17,242 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:58:17,243 - INFO - ========== Method gen_api_seq() returned: seq=['API_2501', 'API_2500'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:58:17,243 - INFO - ========== Method gen_api_seq() returned: seq=['API_2501', 'API_2500'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:58:17,243 - INFO - ========== Method gen_api_seq() returned: seq=['API_2501', 'API_2500'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:58:17,243 - INFO - ========== Method gen_api_seq() returned: seq=['API_2501', 'API_2500'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:58:17,243 - INFO - ========== Method gen_api_seq() returned: seq=['API_2501', 'API_2500'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:58:17,243 - INFO - API sequence 6/12 generated
2025-03-14 12:58:17,243 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 12:58:17,243 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 12:58:17,243 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 12:58:17,243 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 12:58:17,243 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 12:58:19,055 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:58:19,056 - INFO - ========== Method gen_api_seq() returned: seq=['API_2499'], malicious_sign_seq=[0] ==========
2025-03-14 12:58:19,056 - INFO - ========== Method gen_api_seq() returned: seq=['API_2499'], malicious_sign_seq=[0] ==========
2025-03-14 12:58:19,056 - INFO - ========== Method gen_api_seq() returned: seq=['API_2499'], malicious_sign_seq=[0] ==========
2025-03-14 12:58:19,056 - INFO - ========== Method gen_api_seq() returned: seq=['API_2499'], malicious_sign_seq=[0] ==========
2025-03-14 12:58:19,056 - INFO - ========== Method gen_api_seq() returned: seq=['API_2499'], malicious_sign_seq=[0] ==========
2025-03-14 12:58:19,056 - INFO - API sequence 7/12 generated
2025-03-14 12:58:19,056 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:58:19,056 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:58:19,056 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:58:19,056 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:58:19,056 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-14 12:58:20,165 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:58:20,166 - INFO - ========== Method gen_api_seq() returned: seq=['API_2501'], malicious_sign_seq=[0] ==========
2025-03-14 12:58:20,166 - INFO - ========== Method gen_api_seq() returned: seq=['API_2501'], malicious_sign_seq=[0] ==========
2025-03-14 12:58:20,166 - INFO - ========== Method gen_api_seq() returned: seq=['API_2501'], malicious_sign_seq=[0] ==========
2025-03-14 12:58:20,166 - INFO - ========== Method gen_api_seq() returned: seq=['API_2501'], malicious_sign_seq=[0] ==========
2025-03-14 12:58:20,166 - INFO - ========== Method gen_api_seq() returned: seq=['API_2501'], malicious_sign_seq=[0] ==========
2025-03-14 12:58:20,166 - INFO - API sequence 8/12 generated
2025-03-14 12:58:20,166 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:58:20,166 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:58:20,166 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:58:20,166 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:58:20,166 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:58:21,636 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:58:21,637 - INFO - ========== Method gen_api_seq() returned: seq=['API_2501', 'API_2500'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:58:21,637 - INFO - ========== Method gen_api_seq() returned: seq=['API_2501', 'API_2500'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:58:21,637 - INFO - ========== Method gen_api_seq() returned: seq=['API_2501', 'API_2500'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:58:21,637 - INFO - ========== Method gen_api_seq() returned: seq=['API_2501', 'API_2500'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:58:21,637 - INFO - ========== Method gen_api_seq() returned: seq=['API_2501', 'API_2500'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:58:21,638 - INFO - API sequence 9/12 generated
2025-03-14 12:58:21,638 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:58:21,638 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:58:21,638 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:58:21,638 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:58:21,638 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-14 12:58:22,779 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:58:22,780 - INFO - ========== Method gen_api_seq() returned: seq=['API_2501', 'API_2500'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:58:22,780 - INFO - ========== Method gen_api_seq() returned: seq=['API_2501', 'API_2500'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:58:22,780 - INFO - ========== Method gen_api_seq() returned: seq=['API_2501', 'API_2500'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:58:22,780 - INFO - ========== Method gen_api_seq() returned: seq=['API_2501', 'API_2500'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:58:22,780 - INFO - ========== Method gen_api_seq() returned: seq=['API_2501', 'API_2500'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:58:22,780 - INFO - API sequence 10/12 generated
2025-03-14 12:58:22,780 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 12:58:22,780 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 12:58:22,780 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 12:58:22,780 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 12:58:22,780 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-14 12:58:24,655 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:58:24,656 - INFO - ========== Method gen_api_seq() returned: seq=['API_2499'], malicious_sign_seq=[0] ==========
2025-03-14 12:58:24,656 - INFO - ========== Method gen_api_seq() returned: seq=['API_2499'], malicious_sign_seq=[0] ==========
2025-03-14 12:58:24,656 - INFO - ========== Method gen_api_seq() returned: seq=['API_2499'], malicious_sign_seq=[0] ==========
2025-03-14 12:58:24,656 - INFO - ========== Method gen_api_seq() returned: seq=['API_2499'], malicious_sign_seq=[0] ==========
2025-03-14 12:58:24,656 - INFO - ========== Method gen_api_seq() returned: seq=['API_2499'], malicious_sign_seq=[0] ==========
2025-03-14 12:58:24,656 - INFO - API sequence 11/12 generated
2025-03-14 12:58:24,656 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:58:24,656 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:58:24,656 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:58:24,656 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:58:24,656 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-14 12:58:26,081 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-14 12:58:26,082 - INFO - ========== Method gen_api_seq() returned: seq=['API_2501', 'API_2500'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:58:26,082 - INFO - ========== Method gen_api_seq() returned: seq=['API_2501', 'API_2500'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:58:26,082 - INFO - ========== Method gen_api_seq() returned: seq=['API_2501', 'API_2500'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:58:26,082 - INFO - ========== Method gen_api_seq() returned: seq=['API_2501', 'API_2500'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:58:26,082 - INFO - ========== Method gen_api_seq() returned: seq=['API_2501', 'API_2500'], malicious_sign_seq=[0, 1] ==========
2025-03-14 12:58:26,083 - INFO - API sequence 12/12 generated
2025-03-14 12:58:26,084 - INFO - API sequences serialized to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py/serialized_llm_agents.json
2025-03-14 12:58:26,084 - INFO - Generating simulated traffic data set...
2025-03-14 12:58:26,084 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/memo/21 {}
2025-03-14 12:58:26,084 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:58:26,084 - INFO - error_apis: []
2025-03-14 12:58:26,085 - INFO - Simulated traffic data for 1/12 user collected：user: normaluser malicious: False
2025-03-14 12:58:26,085 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:58:26,085 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:58:26,085 - INFO - error_apis: []
2025-03-14 12:58:26,085 - INFO - Simulated traffic data for 2/12 user collected：user: normaluser malicious: False
2025-03-14 12:58:26,085 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/memo/21 {}
2025-03-14 12:58:26,085 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:58:26,085 - INFO - error_apis: []
2025-03-14 12:58:26,085 - INFO - Simulated traffic data for 3/12 user collected：user: normaluser malicious: False
2025-03-14 12:58:26,085 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:58:26,085 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:58:26,086 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/user/9 {}
2025-03-14 12:58:26,086 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:58:26,086 - INFO - error_apis: []
2025-03-14 12:58:26,086 - INFO - Simulated traffic data for 4/12 user collected：user: normaluser malicious: True
2025-03-14 12:58:26,086 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:58:26,086 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:58:26,086 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/user/9 {}
2025-03-14 12:58:26,086 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:58:26,086 - INFO - error_apis: []
2025-03-14 12:58:26,086 - INFO - Simulated traffic data for 5/12 user collected：user: unloggeduser malicious: True
2025-03-14 12:58:26,086 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:58:26,086 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:58:26,087 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/user/9 {}
2025-03-14 12:58:26,087 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:58:26,087 - INFO - error_apis: []
2025-03-14 12:58:26,087 - INFO - Simulated traffic data for 6/12 user collected：user: normaluser malicious: True
2025-03-14 12:58:26,087 - INFO - Status:  Calling API: DELETE http://47.97.114.24:5230/api/v1/resource/16 {}
2025-03-14 12:58:26,087 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:58:26,087 - INFO - error_apis: []
2025-03-14 12:58:26,087 - INFO - Simulated traffic data for 7/12 user collected：user: adminuser malicious: False
2025-03-14 12:58:26,087 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:58:26,087 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:58:26,087 - INFO - error_apis: []
2025-03-14 12:58:26,087 - INFO - Simulated traffic data for 8/12 user collected：user: normaluser malicious: False
2025-03-14 12:58:26,087 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:58:26,088 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:58:26,088 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/user/9 {}
2025-03-14 12:58:26,088 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:58:26,088 - INFO - error_apis: []
2025-03-14 12:58:26,088 - INFO - Simulated traffic data for 9/12 user collected：user: unloggeduser malicious: True
2025-03-14 12:58:26,088 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:58:26,088 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:58:26,088 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/user/9 {}
2025-03-14 12:58:26,088 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:58:26,088 - INFO - error_apis: []
2025-03-14 12:58:26,088 - INFO - Simulated traffic data for 10/12 user collected：user: unloggeduser malicious: True
2025-03-14 12:58:26,088 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/resource/16 {}
2025-03-14 12:58:26,089 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:58:26,089 - INFO - error_apis: []
2025-03-14 12:58:26,089 - INFO - Simulated traffic data for 11/12 user collected：user: adminuser malicious: False
2025-03-14 12:58:26,089 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/memo/21 {}
2025-03-14 12:58:26,089 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-14 12:58:26,089 - INFO - Status:  Calling API: DELETE http://49.234.6.241:5230/api/v1/user/9 {}
2025-03-14 12:58:26,089 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-14 12:58:26,089 - INFO - error_apis: []
2025-03-14 12:58:26,089 - INFO - Simulated traffic data for 12/12 user collected：user: normaluser malicious: True
2025-03-14 12:58:26,091 - INFO - All simulated traffic data collected：/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/simulated_traffic_data.csv
2025-03-14 12:58:26,091 - INFO - error_apis: []
2025-03-14 12:58:47,350 - INFO - Trying to construct model...
2025-03-14 12:58:47,350 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-14 12:58:47,380 - INFO - Training model... Size of feature_list: 7
2025-03-14 12:58:47,390 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 12:58:47,391 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 12:58:47,393 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 12:58:47,394 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 12:58:47,395 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 12:58:47,397 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 12:58:47,398 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 12:58:47,400 - INFO - Extracting features... Size of feature_list: 7
[12:58:47] WARNING: /workspace/src/learner.cc:740: 
Parameters: { "use_label_encoder" } are not used.

2025-03-14 12:58:47,431 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 12:58:47,433 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 12:58:47,434 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 12:58:47,436 - INFO - Extracting features... Size of feature_list: 7
2025-03-14 12:58:47,447 - INFO - Model constructed.
2025-03-14 17:54:15,661 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-14 17:54:15,714 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-14 17:54:15,714 - INFO - Extracting API list with API discovery algorithm...
2025-03-14 17:54:15,778 - INFO - Starting Drain3 template miner
2025-03-14 17:54:15,781 - INFO - Starting Drain3 template miner
2025-03-14 17:54:15,782 - INFO - Starting Drain3 template miner
2025-03-14 17:54:15,783 - INFO - Starting Drain3 template miner
2025-03-14 17:54:15,783 - INFO - Starting Drain3 template miner
2025-03-14 17:54:17,377 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
 
 -------------- celery@VM-16-2-ubuntu v5.4.0 (opalescent)
--- ***** ----- 
-- ******* ---- Linux-5.15.0-130-generic-x86_64-with-glibc2.35 2025-03-14 18:42:53
- *** --- * --- 
- ** ---------- [config]
- ** ---------- .> app:         tasks:0x7f16e7873fd0
- ** ---------- .> transport:   redis://localhost:6379/0
- ** ---------- .> results:     disabled://
- *** --- * --- .> concurrency: 2 (prefork)
-- ******* ---- .> task events: OFF (enable -E to monitor tasks in this worker)
--- ***** ----- 
 -------------- [queues]
                .> celery           exchange=celery(direct) key=celery
                

[tasks]
  . traffic_collector.consume_traffic_periodically

[2025-03-14 18:42:53,605: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

[2025-03-14 18:42:53,620: INFO/MainProcess] Connected to redis://localhost:6379/0
[2025-03-14 18:42:53,620: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

[2025-03-14 18:42:53,622: INFO/MainProcess] mingle: searching for neighbors
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-03-14 18:42:54,174 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-14 09:54:17', 'last_model_construction_at': '2025-03-14 04:58:47', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [1.0, 1.0, 1.0, 2.0, 1.0, 1.0, 1.0, 2.0, 1.0, 4.0, 1.0, 1.0, 1.0, 4.0, 1.0, 1.0, 1.0, 4.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-14 18:42:54,175 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
 * Serving Flask app 'app'
 * Debug mode: on
[2025-03-14 18:42:54,629: INFO/MainProcess] mingle: all alone
[2025-03-14 18:42:54,640: INFO/MainProcess] celery@VM-16-2-ubuntu ready.
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-03-14 18:42:56,123 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-14 09:54:17', 'last_model_construction_at': '2025-03-14 04:58:47', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [1.0, 1.0, 1.0, 2.0, 1.0, 1.0, 1.0, 2.0, 1.0, 4.0, 1.0, 1.0, 1.0, 4.0, 1.0, 1.0, 1.0, 4.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-14 18:42:56,123 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7

Restarting celery worker (/home/ubuntu/.local/bin/celery -A traffic_collector.celery worker --loglevel=info)
 
 -------------- celery@VM-16-2-ubuntu v5.4.0 (opalescent)
--- ***** ----- 
-- ******* ---- Linux-5.15.0-130-generic-x86_64-with-glibc2.35 2025-03-14 22:32:23
- *** --- * --- 
- ** ---------- [config]
- ** ---------- .> app:         tasks:0x7f1cca35e830
- ** ---------- .> transport:   redis://localhost:6379/0
- ** ---------- .> results:     disabled://
- *** --- * --- .> concurrency: 2 (prefork)
-- ******* ---- .> task events: OFF (enable -E to monitor tasks in this worker)
--- ***** ----- 
 -------------- [queues]
                .> celery           exchange=celery(direct) key=celery
                

[tasks]
  . traffic_collector.consume_traffic_periodically

[2025-03-14 22:32:23,989: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

[2025-03-14 22:32:24,001: INFO/MainProcess] Connected to redis://localhost:6379/0
[2025-03-14 22:32:24,001: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

[2025-03-14 22:32:24,003: INFO/MainProcess] mingle: searching for neighbors
[2025-03-14 22:32:25,016: INFO/MainProcess] mingle: all alone
[2025-03-14 22:32:25,025: INFO/MainProcess] celery@VM-16-2-ubuntu ready.
 
 -------------- celery@VM-16-2-ubuntu v5.4.0 (opalescent)
--- ***** ----- 
-- ******* ---- Linux-5.15.0-130-generic-x86_64-with-glibc2.35 2025-03-15 09:10:43
- *** --- * --- 
- ** ---------- [config]
- ** ---------- .> app:         tasks:0x7f6e2474bfa0
- ** ---------- .> transport:   redis://localhost:6379/0
- ** ---------- .> results:     disabled://
- *** --- * --- .> concurrency: 2 (prefork)
-- ******* ---- .> task events: OFF (enable -E to monitor tasks in this worker)
--- ***** ----- 
 -------------- [queues]
                .> celery           exchange=celery(direct) key=celery
                

[tasks]
  . traffic_collector.consume_traffic_periodically

[2025-03-15 09:10:43,493: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

[2025-03-15 09:10:43,498: INFO/MainProcess] Connected to redis://localhost:6379/0
[2025-03-15 09:10:43,499: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

[2025-03-15 09:10:43,500: INFO/MainProcess] mingle: searching for neighbors
[2025-03-15 09:10:44,510: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/app/control.py:56: DuplicateNodenameWarning: Received multiple replies from node name: celery@VM-16-2-ubuntu.
Please make sure you give each node a unique nodename using
the celery worker `-n` option.
  warnings.warn(DuplicateNodenameWarning(

[2025-03-15 09:10:44,511: INFO/MainProcess] mingle: all alone
[2025-03-15 09:10:44,518: INFO/MainProcess] celery@VM-16-2-ubuntu ready.
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-03-15 09:12:54,610 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-14 09:54:17', 'last_model_construction_at': '2025-03-14 04:58:47', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [1.0, 1.0, 1.0, 2.0, 1.0, 1.0, 1.0, 2.0, 1.0, 4.0, 1.0, 1.0, 1.0, 4.0, 1.0, 1.0, 1.0, 4.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-15 09:12:54,612 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
 
 -------------- celery@VM-16-2-ubuntu v5.4.0 (opalescent)
--- ***** ----- 
-- ******* ---- Linux-5.15.0-130-generic-x86_64-with-glibc2.35 2025-03-15 09:13:35
- *** --- * --- 
- ** ---------- [config]
- ** ---------- .> app:         tasks:0x7fbfba347fa0
- ** ---------- .> transport:   redis://localhost:6379/0
- ** ---------- .> results:     disabled://
- *** --- * --- .> concurrency: 2 (prefork)
-- ******* ---- .> task events: OFF (enable -E to monitor tasks in this worker)
--- ***** ----- 
 -------------- [queues]
                .> celery           exchange=celery(direct) key=celery
                

[tasks]
  . traffic_collector.consume_traffic_periodically

[2025-03-15 09:13:35,831: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

[2025-03-15 09:13:35,836: INFO/MainProcess] Connected to redis://localhost:6379/0
[2025-03-15 09:13:35,837: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

[2025-03-15 09:13:35,841: INFO/MainProcess] mingle: searching for neighbors
[2025-03-15 09:13:36,854: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/app/control.py:56: DuplicateNodenameWarning: Received multiple replies from node name: celery@VM-16-2-ubuntu.
Please make sure you give each node a unique nodename using
the celery worker `-n` option.
  warnings.warn(DuplicateNodenameWarning(

[2025-03-15 09:13:36,854: INFO/MainProcess] mingle: all alone
[2025-03-15 09:13:36,861: INFO/MainProcess] celery@VM-16-2-ubuntu ready.
 
 -------------- celery@VM-16-2-ubuntu v5.4.0 (opalescent)
--- ***** ----- 
-- ******* ---- Linux-5.15.0-130-generic-x86_64-with-glibc2.35 2025-03-15 09:39:40
- *** --- * --- 
- ** ---------- [config]
- ** ---------- .> app:         tasks:0x7f4e3166abf0
- ** ---------- .> transport:   redis://localhost:6379/0
- ** ---------- .> results:     disabled://
- *** --- * --- .> concurrency: 2 (prefork)
-- ******* ---- .> task events: OFF (enable -E to monitor tasks in this worker)
--- ***** ----- 
 -------------- [queues]
                .> celery           exchange=celery(direct) key=celery
                

[tasks]
  . traffic_collector.consume_traffic_periodically

[2025-03-15 09:39:41,108: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

[2025-03-15 09:39:41,113: INFO/MainProcess] Connected to redis://localhost:6379/0
[2025-03-15 09:39:41,114: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

[2025-03-15 09:39:41,115: INFO/MainProcess] mingle: searching for neighbors
[2025-03-15 09:39:42,121: INFO/MainProcess] mingle: all alone
[2025-03-15 09:39:42,128: INFO/MainProcess] celery@VM-16-2-ubuntu ready.
[2025-03-15 09:40:03,564: INFO/MainProcess] Task traffic_collector.consume_traffic_periodically[63d6f24b-63c6-4c8f-9d07-d24918c32df0] received
 
 -------------- celery@VM-16-2-ubuntu v5.4.0 (opalescent)
--- ***** ----- 
-- ******* ---- Linux-5.15.0-130-generic-x86_64-with-glibc2.35 2025-03-15 09:40:03
- *** --- * --- 
- ** ---------- [config]
- ** ---------- .> app:         tasks:0x7fd0fe63ebf0
- ** ---------- .> transport:   redis://localhost:6379/0
- ** ---------- .> results:     disabled://
- *** --- * --- .> concurrency: 2 (prefork)
-- ******* ---- .> task events: OFF (enable -E to monitor tasks in this worker)
--- ***** ----- 
 -------------- [queues]
                .> celery           exchange=celery(direct) key=celery
                

[tasks]
  . traffic_collector.consume_traffic_periodically

[2025-03-15 09:40:03,763: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

[2025-03-15 09:40:03,770: INFO/MainProcess] Connected to redis://localhost:6379/0
[2025-03-15 09:40:03,771: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

[2025-03-15 09:40:03,779: INFO/MainProcess] mingle: searching for neighbors
[2025-03-15 09:40:04,788: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/app/control.py:56: DuplicateNodenameWarning: Received multiple replies from node name: celery@VM-16-2-ubuntu.
Please make sure you give each node a unique nodename using
the celery worker `-n` option.
  warnings.warn(DuplicateNodenameWarning(

[2025-03-15 09:40:04,788: INFO/MainProcess] mingle: all alone
[2025-03-15 09:40:04,795: INFO/MainProcess] celery@VM-16-2-ubuntu ready.
[2025-03-15 09:40:12,713: ERROR/MainProcess] Received unregistered task of type '__mitmproxy_script__.traffic_collector.consume_traffic_periodically'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[[], {}, {"callbacks": null, "errbacks": null, "chain": null, "chord": null}]' (77b)

The full contents of the message headers:
{'lang': 'py', 'task': '__mitmproxy_script__.traffic_collector.consume_traffic_periodically', 'id': '09536bfa-57ea-4ad8-9115-f16286fe8590', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': '09536bfa-57ea-4ad8-9115-f16286fe8590', 'parent_id': None, 'argsrepr': '()', 'kwargsrepr': '{}', 'origin': 'gen3791@VM-16-2-ubuntu', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "/home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
KeyError: '__mitmproxy_script__.traffic_collector.consume_traffic_periodically'
[2025-03-15 09:51:59,378: ERROR/MainProcess] Received unregistered task of type 'SFWAP.views.handle_api_discovery_notification'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[["1", {"discovered_API_list": [{"function_description": "Please fill in the function description", "permission_info": "Please fill in the permission info", "sample_url": "http://47.97.114.24:5230/api/v1/memo/20", "sample_request_data": {}, "request_method": "GET", "path_segments": [{"name": "api", "is_path_variable": false}, {"name": "v1", "is_path_variable": false}, {"name": "memo", "is_path_variable": false}, {"name": "<NUM>", "is_path_variable": true}], "request_param_list": [], "request_data_fields": []}, {"function_description": "Please fill in the function description", "permission_info": "Please fill in the permission info", "sample_url": "http://47.97.114.24:5230/o/r/15?thumbnail=1", "sample_request_data": {}, "request_method": "GET", "path_segments": [{"name": "o", "is_path_variable": false}, {"name": "r", "is_path_variable": false}, {"name": "<NUM>", "is_path_variable": true}], "request_param_list": [{"name": "thumbnail", "is_necessary": true}], "request_data_fields": []},... (34427b)

The full contents of the message headers:
{'lang': 'py', 'task': 'SFWAP.views.handle_api_discovery_notification', 'id': '27053759-d4f0-4f5f-a947-cd43dd9c714a', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': '27053759-d4f0-4f5f-a947-cd43dd9c714a', 'parent_id': None, 'argsrepr': "('1', {'discovered_API_list': [{...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}]})", 'kwargsrepr': '{}', 'origin': 'gen8342@VM-16-2-ubuntu', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "/home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
KeyError: 'SFWAP.views.handle_api_discovery_notification'
[2025-03-15 09:57:41,569: ERROR/MainProcess] Received unregistered task of type 'SFWAP.views.handle_api_discovery_notification'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[["1", {"discovered_API_list": [{"function_description": "Please fill in the function description", "permission_info": "Please fill in the permission info", "sample_url": "http://47.97.114.24:5230/api/v1/memo/20", "sample_request_data": {}, "request_method": "GET", "path_segments": [{"name": "api", "is_path_variable": false}, {"name": "v1", "is_path_variable": false}, {"name": "memo", "is_path_variable": false}, {"name": "<NUM>", "is_path_variable": true}], "request_param_list": [], "request_data_fields": []}, {"function_description": "Please fill in the function description", "permission_info": "Please fill in the permission info", "sample_url": "http://47.97.114.24:5230/o/r/15?thumbnail=1", "sample_request_data": {}, "request_method": "GET", "path_segments": [{"name": "o", "is_path_variable": false}, {"name": "r", "is_path_variable": false}, {"name": "<NUM>", "is_path_variable": true}], "request_param_list": [{"name": "thumbnail", "is_necessary": true}], "request_data_fields": []},... (34427b)

The full contents of the message headers:
{'lang': 'py', 'task': 'SFWAP.views.handle_api_discovery_notification', 'id': 'fc24fefc-3689-4ce5-9c92-116998686fe5', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': 'fc24fefc-3689-4ce5-9c92-116998686fe5', 'parent_id': None, 'argsrepr': "('1', {'discovered_API_list': [{...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}]})", 'kwargsrepr': '{}', 'origin': 'gen10565@VM-16-2-ubuntu', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "/home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
KeyError: 'SFWAP.views.handle_api_discovery_notification'
[2025-03-15 10:01:12,247: ERROR/MainProcess] Received unregistered task of type 'SFWAP.views.handle_api_discovery_notification'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[["1", {"discovered_API_list": [{"function_description": "Please fill in the function description", "permission_info": "Please fill in the permission info", "sample_url": "http://47.97.114.24:5230/api/v1/memo/20", "sample_request_data": {}, "request_method": "GET", "path_segments": [{"name": "api", "is_path_variable": false}, {"name": "v1", "is_path_variable": false}, {"name": "memo", "is_path_variable": false}, {"name": "<NUM>", "is_path_variable": true}], "request_param_list": [], "request_data_fields": []}, {"function_description": "Please fill in the function description", "permission_info": "Please fill in the permission info", "sample_url": "http://47.97.114.24:5230/o/r/15?thumbnail=1", "sample_request_data": {}, "request_method": "GET", "path_segments": [{"name": "o", "is_path_variable": false}, {"name": "r", "is_path_variable": false}, {"name": "<NUM>", "is_path_variable": true}], "request_param_list": [{"name": "thumbnail", "is_necessary": true}], "request_data_fields": []},... (24958b)

The full contents of the message headers:
{'lang': 'py', 'task': 'SFWAP.views.handle_api_discovery_notification', 'id': '06ef08c0-ec12-4bc2-9e3f-a904550a9450', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': '06ef08c0-ec12-4bc2-9e3f-a904550a9450', 'parent_id': None, 'argsrepr': "('1', {'discovered_API_list': [{...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}]})", 'kwargsrepr': '{}', 'origin': 'gen11542@VM-16-2-ubuntu', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "/home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
KeyError: 'SFWAP.views.handle_api_discovery_notification'
[2025-03-15 10:01:43,640: ERROR/MainProcess] Received unregistered task of type 'SFWAP.views.handle_api_discovery_notification'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[["1", {"discovered_API_list": [{"function_description": "Please fill in the function description", "permission_info": "Please fill in the permission info", "sample_url": "http://47.97.114.24:5230/api/v1/memo/20", "sample_request_data": {}, "request_method": "GET", "path_segments": [{"name": "api", "is_path_variable": false}, {"name": "v1", "is_path_variable": false}, {"name": "memo", "is_path_variable": false}, {"name": "<NUM>", "is_path_variable": true}], "request_param_list": [], "request_data_fields": []}, {"function_description": "Please fill in the function description", "permission_info": "Please fill in the permission info", "sample_url": "http://47.97.114.24:5230/o/r/15?thumbnail=1", "sample_request_data": {}, "request_method": "GET", "path_segments": [{"name": "o", "is_path_variable": false}, {"name": "r", "is_path_variable": false}, {"name": "<NUM>", "is_path_variable": true}], "request_param_list": [{"name": "thumbnail", "is_necessary": true}], "request_data_fields": []},... (24958b)

The full contents of the message headers:
{'lang': 'py', 'task': 'SFWAP.views.handle_api_discovery_notification', 'id': 'bf32f7f1-d9c6-4dbe-bd92-2cca33694bde', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': 'bf32f7f1-d9c6-4dbe-bd92-2cca33694bde', 'parent_id': None, 'argsrepr': "('1', {'discovered_API_list': [{...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}, {...}]})", 'kwargsrepr': '{}', 'origin': 'gen11542@VM-16-2-ubuntu', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "/home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
KeyError: 'SFWAP.views.handle_api_discovery_notification'
[2025-03-15 10:32:09,564: INFO/MainProcess] Task traffic_collector.consume_traffic_periodically[5821bf12-adbe-4e10-9cac-954ce7fc6722] received
 
 -------------- celery@VM-16-2-ubuntu v5.4.0 (opalescent)
--- ***** ----- 
-- ******* ---- Linux-5.15.0-130-generic-x86_64-with-glibc2.35 2025-03-15 10:32:09
- *** --- * --- 
- ** ---------- [config]
- ** ---------- .> app:         tasks:0x7f5f4155bfd0
- ** ---------- .> transport:   redis://localhost:6379/0
- ** ---------- .> results:     disabled://
- *** --- * --- .> concurrency: 2 (prefork)
-- ******* ---- .> task events: OFF (enable -E to monitor tasks in this worker)
--- ***** ----- 
 -------------- [queues]
                .> celery           exchange=celery(direct) key=celery
                

[tasks]
  . traffic_collector.consume_traffic_periodically

[2025-03-15 10:32:09,848: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

[2025-03-15 10:32:09,858: INFO/MainProcess] Connected to redis://localhost:6379/0
[2025-03-15 10:32:09,858: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

[2025-03-15 10:32:09,860: INFO/MainProcess] mingle: searching for neighbors
[2025-03-15 10:32:10,876: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/app/control.py:56: DuplicateNodenameWarning: Received multiple replies from node name: celery@VM-16-2-ubuntu.
Please make sure you give each node a unique nodename using
the celery worker `-n` option.
  warnings.warn(DuplicateNodenameWarning(

[2025-03-15 10:32:10,877: INFO/MainProcess] mingle: all alone
[2025-03-15 10:32:10,886: INFO/MainProcess] celery@VM-16-2-ubuntu ready.
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-03-15 10:32:11,269 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-15 02:16:38', 'last_model_construction_at': '2025-03-15 02:22:00', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.5, 1.0, 0.67, 2.0, 0.0, 0.0, 0.0, 2.0, 0.5, 4.0, 0.25, 0.5, 0.33, 4.0, 0.25, 0.5, 0.33, 4.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-15 10:32:11,269 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
 * Serving Flask app 'app'
 * Debug mode: on
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-03-15 10:32:13,964 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-15 02:16:38', 'last_model_construction_at': '2025-03-15 02:22:00', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.5, 1.0, 0.67, 2.0, 0.0, 0.0, 0.0, 2.0, 0.5, 4.0, 0.25, 0.5, 0.33, 4.0, 0.25, 0.5, 0.33, 4.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-15 10:32:13,966 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
2025-03-15 10:33:12,654 - INFO - Detection started. Combined data duration: 10
2025-03-15 10:33:16,215 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 7
2025-03-15 10:33:16,264 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 10:33:16,291 - INFO - [{'MeanUrlParamsCount': 0.0, 'RepeatUrlVisitCount': 0.0, 'DeepPageVisitRate': 0.0, 'MeanUrlPathDepth': 1.0, 'MeanUrlLength': 70.0, 'UniquePageVisitCount': 1, 'SeqOccurTime_559aead08264d5795d3909718cdd05abd49572e84fe55590eef31a88a08fdffd': 1}]
2025-03-15 10:33:16,291 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 10:33:16,318 - INFO - A new detect record generated; Traffic data size: 1
2025-03-15 10:33:19,623 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 7
2025-03-15 10:33:19,624 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 10:33:19,628 - INFO - [{'MeanUrlParamsCount': 0.0, 'RepeatUrlVisitCount': 1.0, 'DeepPageVisitRate': 0.0, 'MeanUrlPathDepth': 1.0, 'MeanUrlLength': 72.6, 'UniquePageVisitCount': 4, 'SeqOccurTime_559aead08264d5795d3909718cdd05abd49572e84fe55590eef31a88a08fdffd': 1}]
2025-03-15 10:33:19,628 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 10:33:19,647 - INFO - A new detect record generated; Traffic data size: 5
2025-03-15 10:33:26,338 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 7
2025-03-15 10:33:26,340 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 10:33:26,348 - INFO - [{'MeanUrlParamsCount': 0.0, 'RepeatUrlVisitCount': 6.0, 'DeepPageVisitRate': 0.0, 'MeanUrlPathDepth': 1.0, 'MeanUrlLength': 70.77777777777777, 'UniquePageVisitCount': 8, 'SeqOccurTime_559aead08264d5795d3909718cdd05abd49572e84fe55590eef31a88a08fdffd': 9}]
2025-03-15 10:33:26,348 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 10:33:26,392 - INFO - A new detect record generated; Traffic data size: 18
2025-03-15 10:33:29,661 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 7
2025-03-15 10:33:29,663 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 10:33:29,666 - INFO - [{'MeanUrlParamsCount': 0.0, 'RepeatUrlVisitCount': 2.0, 'DeepPageVisitRate': 0.0, 'MeanUrlPathDepth': 1.0, 'MeanUrlLength': 61.625, 'UniquePageVisitCount': 5, 'SeqOccurTime_559aead08264d5795d3909718cdd05abd49572e84fe55590eef31a88a08fdffd': 0}]
2025-03-15 10:33:29,666 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 10:33:29,686 - INFO - A new detect record generated; Traffic data size: 8
2025-03-15 10:33:36,411 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 7
2025-03-15 10:33:36,412 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 10:33:36,419 - INFO - [{'MeanUrlParamsCount': 0.0, 'RepeatUrlVisitCount': 2.0, 'DeepPageVisitRate': 0.0, 'MeanUrlPathDepth': 1.0, 'MeanUrlLength': 60.38095238095238, 'UniquePageVisitCount': 2, 'SeqOccurTime_559aead08264d5795d3909718cdd05abd49572e84fe55590eef31a88a08fdffd': 0}]
2025-03-15 10:33:36,419 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 10:33:36,444 - INFO - A new detect record generated; Traffic data size: 21
2025-03-15 10:33:39,700 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 7
2025-03-15 10:33:39,702 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 10:33:39,704 - INFO - [{'MeanUrlParamsCount': 0.0, 'RepeatUrlVisitCount': 0.0, 'DeepPageVisitRate': 0.0, 'MeanUrlPathDepth': 1.0, 'MeanUrlLength': 62.8, 'UniquePageVisitCount': 5, 'SeqOccurTime_559aead08264d5795d3909718cdd05abd49572e84fe55590eef31a88a08fdffd': 1}]
2025-03-15 10:33:39,704 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 10:33:39,724 - INFO - A new detect record generated; Traffic data size: 5
2025-03-15 10:33:46,459 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 7
2025-03-15 10:33:46,461 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 10:33:46,467 - INFO - [{'MeanUrlParamsCount': 0.0, 'RepeatUrlVisitCount': 6.0, 'DeepPageVisitRate': 0.0, 'MeanUrlPathDepth': 1.0, 'MeanUrlLength': 70.125, 'UniquePageVisitCount': 8, 'SeqOccurTime_559aead08264d5795d3909718cdd05abd49572e84fe55590eef31a88a08fdffd': 5}]
2025-03-15 10:33:46,467 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 10:33:46,496 - INFO - A new detect record generated; Traffic data size: 16
2025-03-15 10:33:49,737 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 7
2025-03-15 10:33:49,739 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 10:33:49,743 - INFO - [{'MeanUrlParamsCount': 0.0, 'RepeatUrlVisitCount': 4.0, 'DeepPageVisitRate': 0.0, 'MeanUrlPathDepth': 1.0, 'MeanUrlLength': 72.25, 'UniquePageVisitCount': 6, 'SeqOccurTime_559aead08264d5795d3909718cdd05abd49572e84fe55590eef31a88a08fdffd': 4}]
2025-03-15 10:33:49,743 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 10:33:49,767 - INFO - A new detect record generated; Traffic data size: 12
2025-03-15 10:33:56,510 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 7
2025-03-15 10:33:56,511 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 10:33:56,513 - INFO - [{'MeanUrlParamsCount': 0.0, 'RepeatUrlVisitCount': 0.0, 'DeepPageVisitRate': 0.0, 'MeanUrlPathDepth': 1.0, 'MeanUrlLength': 70.5, 'UniquePageVisitCount': 2, 'SeqOccurTime_559aead08264d5795d3909718cdd05abd49572e84fe55590eef31a88a08fdffd': 2}]
2025-03-15 10:33:56,513 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 10:33:56,532 - INFO - A new detect record generated; Traffic data size: 2
2025-03-15 10:33:58,749 - INFO - Detection paused.
 
 -------------- celery@VM-16-2-ubuntu v5.4.0 (opalescent)
--- ***** ----- 
-- ******* ---- Linux-5.15.0-130-generic-x86_64-with-glibc2.35 2025-03-15 11:03:18
- *** --- * --- 
- ** ---------- [config]
- ** ---------- .> app:         tasks:0x7f1f3ba77fd0
- ** ---------- .> transport:   redis://localhost:6379/0
- ** ---------- .> results:     disabled://
- *** --- * --- .> concurrency: 2 (prefork)
-- ******* ---- .> task events: OFF (enable -E to monitor tasks in this worker)
--- ***** ----- 
 -------------- [queues]
                .> celery           exchange=celery(direct) key=celery
                

[tasks]
  . traffic_collector.consume_traffic_periodically

[2025-03-15 11:03:18,677: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

[2025-03-15 11:03:18,761: INFO/MainProcess] Connected to redis://localhost:6379/0
[2025-03-15 11:03:18,761: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

[2025-03-15 11:03:18,763: INFO/MainProcess] mingle: searching for neighbors
[2025-03-15 11:03:19,768: INFO/MainProcess] mingle: all alone
[2025-03-15 11:03:19,779: INFO/MainProcess] celery@VM-16-2-ubuntu ready.
[2025-03-15 11:03:19,781: INFO/MainProcess] Task traffic_collector.consume_traffic_periodically[776337e4-2c21-410b-97fb-cdc0359f75d9] received
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-03-15 11:03:19,846 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-15 02:16:38', 'last_model_construction_at': '2025-03-15 02:22:00', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.5, 1.0, 0.67, 2.0, 0.0, 0.0, 0.0, 2.0, 0.5, 4.0, 0.25, 0.5, 0.33, 4.0, 0.25, 0.5, 0.33, 4.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-15 11:03:19,848 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
 * Serving Flask app 'app'
 * Debug mode: on
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-03-15 11:03:22,625 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-15 02:16:38', 'last_model_construction_at': '2025-03-15 02:22:00', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.5, 1.0, 0.67, 2.0, 0.0, 0.0, 0.0, 2.0, 0.5, 4.0, 0.25, 0.5, 0.33, 4.0, 0.25, 0.5, 0.33, 4.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-15 11:03:22,626 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
[2025-03-15 11:03:23,603: ERROR/MainProcess] Received unregistered task of type '__mitmproxy_script__.traffic_collector.consume_traffic_periodically'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[[], {}, {"callbacks": null, "errbacks": null, "chain": null, "chord": null}]' (77b)

The full contents of the message headers:
{'lang': 'py', 'task': '__mitmproxy_script__.traffic_collector.consume_traffic_periodically', 'id': '961e6730-c706-4069-a134-a69a95af0518', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': '961e6730-c706-4069-a134-a69a95af0518', 'parent_id': None, 'argsrepr': '()', 'kwargsrepr': '{}', 'origin': 'gen5027@VM-16-2-ubuntu', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "/home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
KeyError: '__mitmproxy_script__.traffic_collector.consume_traffic_periodically'

Restarting celery worker (/home/ubuntu/.local/bin/celery -A traffic_collector.celery worker --loglevel=info)
[2025-03-15 16:14:17,910: ERROR/MainProcess] Process 'ForkPoolWorker-2' pid:4999 exited with 'exitcode 70'
[2025-03-15 16:14:17,920: ERROR/MainProcess] Process 'ForkPoolWorker-1' pid:4992 exited with 'exitcode 70'
[2025-03-15 16:14:17,958: ERROR/MainProcess] Task handler raised error: WorkerLostError('Worker exited prematurely: exitcode 70 Job: 0.')
Traceback (most recent call last):
  File "/home/ubuntu/.local/lib/python3.10/site-packages/billiard/pool.py", line 1265, in mark_as_worker_lost
    raise WorkerLostError(
billiard.einfo.ExceptionWithTraceback: 
"""
Traceback (most recent call last):
  File "/home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/worker.py", line 202, in start
    self.blueprint.start(self)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/celery/bootsteps.py", line 365, in start
    return self.obj.start()
  File "/home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py", line 340, in start
    blueprint.start(self)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py", line 746, in start
    c.loop(*c.loop_args())
  File "/home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/loops.py", line 86, in asynloop
    state.maybe_shutdown()
  File "/home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/state.py", line 93, in maybe_shutdown
    raise WorkerShutdown(should_stop)
celery.exceptions.WorkerShutdown: 0

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ubuntu/.local/lib/python3.10/site-packages/billiard/pool.py", line 1265, in mark_as_worker_lost
    raise WorkerLostError(
billiard.exceptions.WorkerLostError: Worker exited prematurely: exitcode 70 Job: 0.
"""
 
 -------------- celery@VM-16-2-ubuntu v5.4.0 (opalescent)
--- ***** ----- 
-- ******* ---- Linux-5.15.0-130-generic-x86_64-with-glibc2.35 2025-03-15 16:14:21
- *** --- * --- 
- ** ---------- [config]
- ** ---------- .> app:         tasks:0x7fe83ef5a830
- ** ---------- .> transport:   redis://localhost:6379/0
- ** ---------- .> results:     disabled://
- *** --- * --- .> concurrency: 2 (prefork)
-- ******* ---- .> task events: OFF (enable -E to monitor tasks in this worker)
--- ***** ----- 
 -------------- [queues]
                .> celery           exchange=celery(direct) key=celery
                

[tasks]
  . traffic_collector.consume_traffic_periodically

[2025-03-15 16:14:21,436: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

[2025-03-15 16:14:21,441: INFO/MainProcess] Connected to redis://localhost:6379/0
[2025-03-15 16:14:21,441: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

[2025-03-15 16:14:21,444: INFO/MainProcess] mingle: searching for neighbors
[2025-03-15 16:14:22,449: INFO/MainProcess] mingle: all alone
[2025-03-15 16:14:22,456: INFO/MainProcess] celery@VM-16-2-ubuntu ready.
[2025-03-15 16:14:22,458: INFO/MainProcess] Task traffic_collector.consume_traffic_periodically[4ee83658-daf9-468b-9885-18fcd2ee7e10] received
 
 -------------- celery@VM-16-2-ubuntu v5.4.0 (opalescent)
--- ***** ----- 
-- ******* ---- Linux-5.15.0-130-generic-x86_64-with-glibc2.35 2025-03-15 21:00:53
- *** --- * --- 
- ** ---------- [config]
- ** ---------- .> app:         tasks:0x7fcb9e15ffd0
- ** ---------- .> transport:   redis://localhost:6379/0
- ** ---------- .> results:     disabled://
- *** --- * --- .> concurrency: 2 (prefork)
-- ******* ---- .> task events: OFF (enable -E to monitor tasks in this worker)
--- ***** ----- 
 -------------- [queues]
                .> celery           exchange=celery(direct) key=celery
                

[tasks]
  . traffic_collector.consume_traffic_periodically

[2025-03-15 21:00:53,203: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

[2025-03-15 21:00:53,285: INFO/MainProcess] Connected to redis://localhost:6379/0
[2025-03-15 21:00:53,286: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

[2025-03-15 21:00:53,288: INFO/MainProcess] mingle: searching for neighbors
[2025-03-15 21:00:54,297: INFO/MainProcess] mingle: all alone
[2025-03-15 21:00:54,308: INFO/MainProcess] celery@VM-16-2-ubuntu ready.
[2025-03-15 21:00:54,311: INFO/MainProcess] Task traffic_collector.consume_traffic_periodically[8b45640c-d99d-4742-a970-8df089ad736e] received
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-03-15 21:00:55,238 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-15 02:16:38', 'last_model_construction_at': '2025-03-15 02:22:00', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.5, 1.0, 0.67, 2.0, 0.0, 0.0, 0.0, 2.0, 0.5, 4.0, 0.25, 0.5, 0.33, 4.0, 0.25, 0.5, 0.33, 4.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-15 21:00:55,240 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
 * Serving Flask app 'app'
 * Debug mode: on
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-03-15 21:00:57,865 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-15 02:16:38', 'last_model_construction_at': '2025-03-15 02:22:00', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.5, 1.0, 0.67, 2.0, 0.0, 0.0, 0.0, 2.0, 0.5, 4.0, 0.25, 0.5, 0.33, 4.0, 0.25, 0.5, 0.33, 4.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-15 21:00:57,866 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
[2025-03-15 21:00:58,778: ERROR/MainProcess] Received unregistered task of type '__mitmproxy_script__.traffic_collector.consume_traffic_periodically'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[[], {}, {"callbacks": null, "errbacks": null, "chain": null, "chord": null}]' (77b)

The full contents of the message headers:
{'lang': 'py', 'task': '__mitmproxy_script__.traffic_collector.consume_traffic_periodically', 'id': '4ca80018-c224-44a2-bd43-a168c9dc2962', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': '4ca80018-c224-44a2-bd43-a168c9dc2962', 'parent_id': None, 'argsrepr': '()', 'kwargsrepr': '{}', 'origin': 'gen3792@VM-16-2-ubuntu', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "/home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
KeyError: '__mitmproxy_script__.traffic_collector.consume_traffic_periodically'
2025-03-15 21:06:02,145 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-15 21:06:02,242 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-15 21:06:02,352 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-15 21:06:02,352 - INFO - Starting data generation...
2025-03-15 21:06:02,352 - INFO - API_KNOWLEDGE: [{'number': 'API_2939', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_2940', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}]
2025-03-15 21:06:02,352 - INFO - APP_KNOWLEDGE: {'func_description': 'This is an updated test application', 'normal_seqs': ['Role: admin; API_2939(Call 1); API_2940(Call 2)', 'Role: oridinary_user; API_2940(); API_2939()'], 'malicious_seqs': ['Role: admin; API_2939(); API_2940()', 'Role: ordinary_user; API_2940(); API_2939()'], 'roles': ['admin', 'ordinary_user', 'unlogged_in_user']}
2025-03-15 21:06:02,645 - INFO - Generating simulated API sequences...
2025-03-15 21:06:02,646 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-15 21:06:02,646 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-15 21:06:04,141 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:06:04,145 - INFO - ========== Method gen_api_seq() returned: seq=['API_2940', 'API_2939'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:06:04,145 - INFO - ========== Method gen_api_seq() returned: seq=['API_2940', 'API_2939'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:06:04,145 - INFO - User configured API_ROLE:{'admin': ['API_2', 'API_5', 'API_6', 'API_8', 'API_10', 'API_13', 'API_14', 'API_15', 'API_18', 'API_19', 'API_23', 'API_28', 'API_34', 'API_35', 'API_36', 'API_37', 'API_39', 'API_40', 'API_41', 'API_42', 'API_43', 'API_47', 'API_50', 'API_55', 'API_56', 'API_63', 'API_64', 'API_65', 'API_84', 'API_100', 'API_107', 'API_117', 'API_120', 'API_121', 'API_122', 'API_123', 'API_126', 'API_129', 'API_131', 'API_134', 'API_155'], 'ordinary_user': ['API_2', 'API_5', 'API_6', 'API_8', 'API_10', 'API_13', 'API_14', 'API_15', 'API_28', 'API_34', 'API_35', 'API_36', 'API_37', 'API_39', 'API_43', 'API_47', 'API_63', 'API_64', 'API_65', 'API_84', 'API_100', 'API_107', 'API_117', 'API_120', 'API_121', 'API_122', 'API_123', 'API_126', 'API_129', 'API_131', 'API_134', 'API_155'], 'unlogged_in_user': []}
2025-03-15 21:06:04,146 - INFO - API sequence 1/12 generated
2025-03-15 21:06:04,146 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-15 21:06:04,146 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-15 21:06:05,421 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:06:05,422 - INFO - ========== Method gen_api_seq() returned: seq=['API_2940', 'API_2939'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:06:05,422 - INFO - ========== Method gen_api_seq() returned: seq=['API_2940', 'API_2939'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:06:05,422 - INFO - User configured API_ROLE:{'admin': ['API_2', 'API_5', 'API_6', 'API_8', 'API_10', 'API_13', 'API_14', 'API_15', 'API_18', 'API_19', 'API_23', 'API_28', 'API_34', 'API_35', 'API_36', 'API_37', 'API_39', 'API_40', 'API_41', 'API_42', 'API_43', 'API_47', 'API_50', 'API_55', 'API_56', 'API_63', 'API_64', 'API_65', 'API_84', 'API_100', 'API_107', 'API_117', 'API_120', 'API_121', 'API_122', 'API_123', 'API_126', 'API_129', 'API_131', 'API_134', 'API_155'], 'ordinary_user': ['API_2', 'API_5', 'API_6', 'API_8', 'API_10', 'API_13', 'API_14', 'API_15', 'API_28', 'API_34', 'API_35', 'API_36', 'API_37', 'API_39', 'API_43', 'API_47', 'API_63', 'API_64', 'API_65', 'API_84', 'API_100', 'API_107', 'API_117', 'API_120', 'API_121', 'API_122', 'API_123', 'API_126', 'API_129', 'API_131', 'API_134', 'API_155'], 'unlogged_in_user': []}
2025-03-15 21:06:05,422 - INFO - API sequence 2/12 generated
2025-03-15 21:06:05,422 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-15 21:06:05,422 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-15 21:06:06,394 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:06:06,395 - INFO - ========== Method gen_api_seq() returned: seq=['API_2940'], malicious_sign_seq=[0] ==========
2025-03-15 21:06:06,395 - INFO - ========== Method gen_api_seq() returned: seq=['API_2940'], malicious_sign_seq=[0] ==========
2025-03-15 21:06:06,395 - INFO - User configured API_ROLE:{'admin': ['API_2', 'API_5', 'API_6', 'API_8', 'API_10', 'API_13', 'API_14', 'API_15', 'API_18', 'API_19', 'API_23', 'API_28', 'API_34', 'API_35', 'API_36', 'API_37', 'API_39', 'API_40', 'API_41', 'API_42', 'API_43', 'API_47', 'API_50', 'API_55', 'API_56', 'API_63', 'API_64', 'API_65', 'API_84', 'API_100', 'API_107', 'API_117', 'API_120', 'API_121', 'API_122', 'API_123', 'API_126', 'API_129', 'API_131', 'API_134', 'API_155'], 'ordinary_user': ['API_2', 'API_5', 'API_6', 'API_8', 'API_10', 'API_13', 'API_14', 'API_15', 'API_28', 'API_34', 'API_35', 'API_36', 'API_37', 'API_39', 'API_43', 'API_47', 'API_63', 'API_64', 'API_65', 'API_84', 'API_100', 'API_107', 'API_117', 'API_120', 'API_121', 'API_122', 'API_123', 'API_126', 'API_129', 'API_131', 'API_134', 'API_155'], 'unlogged_in_user': []}
2025-03-15 21:06:06,396 - INFO - API sequence 3/12 generated
2025-03-15 21:06:06,396 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-15 21:06:06,396 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-15 21:06:07,544 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:06:07,545 - INFO - ========== Method gen_api_seq() returned: seq=['API_2939'], malicious_sign_seq=[0] ==========
2025-03-15 21:06:07,545 - INFO - ========== Method gen_api_seq() returned: seq=['API_2939'], malicious_sign_seq=[0] ==========
2025-03-15 21:06:07,545 - INFO - User configured API_ROLE:{'admin': ['API_2', 'API_5', 'API_6', 'API_8', 'API_10', 'API_13', 'API_14', 'API_15', 'API_18', 'API_19', 'API_23', 'API_28', 'API_34', 'API_35', 'API_36', 'API_37', 'API_39', 'API_40', 'API_41', 'API_42', 'API_43', 'API_47', 'API_50', 'API_55', 'API_56', 'API_63', 'API_64', 'API_65', 'API_84', 'API_100', 'API_107', 'API_117', 'API_120', 'API_121', 'API_122', 'API_123', 'API_126', 'API_129', 'API_131', 'API_134', 'API_155'], 'ordinary_user': ['API_2', 'API_5', 'API_6', 'API_8', 'API_10', 'API_13', 'API_14', 'API_15', 'API_28', 'API_34', 'API_35', 'API_36', 'API_37', 'API_39', 'API_43', 'API_47', 'API_63', 'API_64', 'API_65', 'API_84', 'API_100', 'API_107', 'API_117', 'API_120', 'API_121', 'API_122', 'API_123', 'API_126', 'API_129', 'API_131', 'API_134', 'API_155'], 'unlogged_in_user': []}
2025-03-15 21:06:07,545 - INFO - API sequence 4/12 generated
2025-03-15 21:06:07,545 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-15 21:06:07,545 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-15 21:06:09,209 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:06:09,210 - INFO - ========== Method gen_api_seq() returned: seq=['API_2940'], malicious_sign_seq=[0] ==========
2025-03-15 21:06:09,210 - INFO - ========== Method gen_api_seq() returned: seq=['API_2940'], malicious_sign_seq=[0] ==========
2025-03-15 21:06:09,211 - INFO - User configured API_ROLE:{'admin': ['API_2', 'API_5', 'API_6', 'API_8', 'API_10', 'API_13', 'API_14', 'API_15', 'API_18', 'API_19', 'API_23', 'API_28', 'API_34', 'API_35', 'API_36', 'API_37', 'API_39', 'API_40', 'API_41', 'API_42', 'API_43', 'API_47', 'API_50', 'API_55', 'API_56', 'API_63', 'API_64', 'API_65', 'API_84', 'API_100', 'API_107', 'API_117', 'API_120', 'API_121', 'API_122', 'API_123', 'API_126', 'API_129', 'API_131', 'API_134', 'API_155'], 'ordinary_user': ['API_2', 'API_5', 'API_6', 'API_8', 'API_10', 'API_13', 'API_14', 'API_15', 'API_28', 'API_34', 'API_35', 'API_36', 'API_37', 'API_39', 'API_43', 'API_47', 'API_63', 'API_64', 'API_65', 'API_84', 'API_100', 'API_107', 'API_117', 'API_120', 'API_121', 'API_122', 'API_123', 'API_126', 'API_129', 'API_131', 'API_134', 'API_155'], 'unlogged_in_user': []}
2025-03-15 21:06:09,211 - INFO - API sequence 5/12 generated
2025-03-15 21:06:09,211 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-15 21:06:09,211 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-15 21:06:10,509 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:06:10,510 - INFO - ========== Method gen_api_seq() returned: seq=['API_2940', 'API_2939'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:06:10,510 - INFO - ========== Method gen_api_seq() returned: seq=['API_2940', 'API_2939'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:06:10,511 - INFO - User configured API_ROLE:{'admin': ['API_2', 'API_5', 'API_6', 'API_8', 'API_10', 'API_13', 'API_14', 'API_15', 'API_18', 'API_19', 'API_23', 'API_28', 'API_34', 'API_35', 'API_36', 'API_37', 'API_39', 'API_40', 'API_41', 'API_42', 'API_43', 'API_47', 'API_50', 'API_55', 'API_56', 'API_63', 'API_64', 'API_65', 'API_84', 'API_100', 'API_107', 'API_117', 'API_120', 'API_121', 'API_122', 'API_123', 'API_126', 'API_129', 'API_131', 'API_134', 'API_155'], 'ordinary_user': ['API_2', 'API_5', 'API_6', 'API_8', 'API_10', 'API_13', 'API_14', 'API_15', 'API_28', 'API_34', 'API_35', 'API_36', 'API_37', 'API_39', 'API_43', 'API_47', 'API_63', 'API_64', 'API_65', 'API_84', 'API_100', 'API_107', 'API_117', 'API_120', 'API_121', 'API_122', 'API_123', 'API_126', 'API_129', 'API_131', 'API_134', 'API_155'], 'unlogged_in_user': []}
2025-03-15 21:06:10,511 - INFO - API sequence 6/12 generated
2025-03-15 21:06:10,511 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-15 21:06:10,511 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-15 21:06:12,273 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:06:12,274 - INFO - ========== Method gen_api_seq() returned: seq=['API_2940'], malicious_sign_seq=[0] ==========
2025-03-15 21:06:12,274 - INFO - ========== Method gen_api_seq() returned: seq=['API_2940'], malicious_sign_seq=[0] ==========
2025-03-15 21:06:12,274 - INFO - User configured API_ROLE:{'admin': ['API_2', 'API_5', 'API_6', 'API_8', 'API_10', 'API_13', 'API_14', 'API_15', 'API_18', 'API_19', 'API_23', 'API_28', 'API_34', 'API_35', 'API_36', 'API_37', 'API_39', 'API_40', 'API_41', 'API_42', 'API_43', 'API_47', 'API_50', 'API_55', 'API_56', 'API_63', 'API_64', 'API_65', 'API_84', 'API_100', 'API_107', 'API_117', 'API_120', 'API_121', 'API_122', 'API_123', 'API_126', 'API_129', 'API_131', 'API_134', 'API_155'], 'ordinary_user': ['API_2', 'API_5', 'API_6', 'API_8', 'API_10', 'API_13', 'API_14', 'API_15', 'API_28', 'API_34', 'API_35', 'API_36', 'API_37', 'API_39', 'API_43', 'API_47', 'API_63', 'API_64', 'API_65', 'API_84', 'API_100', 'API_107', 'API_117', 'API_120', 'API_121', 'API_122', 'API_123', 'API_126', 'API_129', 'API_131', 'API_134', 'API_155'], 'unlogged_in_user': []}
2025-03-15 21:06:12,274 - INFO - API sequence 7/12 generated
2025-03-15 21:06:12,274 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-15 21:06:12,274 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-15 21:06:13,605 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:06:13,606 - INFO - ========== Method gen_api_seq() returned: seq=['API_2940', 'API_2939'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:06:13,606 - INFO - ========== Method gen_api_seq() returned: seq=['API_2940', 'API_2939'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:06:13,606 - INFO - User configured API_ROLE:{'admin': ['API_2', 'API_5', 'API_6', 'API_8', 'API_10', 'API_13', 'API_14', 'API_15', 'API_18', 'API_19', 'API_23', 'API_28', 'API_34', 'API_35', 'API_36', 'API_37', 'API_39', 'API_40', 'API_41', 'API_42', 'API_43', 'API_47', 'API_50', 'API_55', 'API_56', 'API_63', 'API_64', 'API_65', 'API_84', 'API_100', 'API_107', 'API_117', 'API_120', 'API_121', 'API_122', 'API_123', 'API_126', 'API_129', 'API_131', 'API_134', 'API_155'], 'ordinary_user': ['API_2', 'API_5', 'API_6', 'API_8', 'API_10', 'API_13', 'API_14', 'API_15', 'API_28', 'API_34', 'API_35', 'API_36', 'API_37', 'API_39', 'API_43', 'API_47', 'API_63', 'API_64', 'API_65', 'API_84', 'API_100', 'API_107', 'API_117', 'API_120', 'API_121', 'API_122', 'API_123', 'API_126', 'API_129', 'API_131', 'API_134', 'API_155'], 'unlogged_in_user': []}
2025-03-15 21:06:13,606 - INFO - API sequence 8/12 generated
2025-03-15 21:06:13,606 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-15 21:06:13,606 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-15 21:06:15,860 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:06:15,861 - INFO - ========== Method gen_api_seq() returned: seq=['API_2940', 'API_2939'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:06:15,861 - INFO - ========== Method gen_api_seq() returned: seq=['API_2940', 'API_2939'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:06:15,861 - INFO - User configured API_ROLE:{'admin': ['API_2', 'API_5', 'API_6', 'API_8', 'API_10', 'API_13', 'API_14', 'API_15', 'API_18', 'API_19', 'API_23', 'API_28', 'API_34', 'API_35', 'API_36', 'API_37', 'API_39', 'API_40', 'API_41', 'API_42', 'API_43', 'API_47', 'API_50', 'API_55', 'API_56', 'API_63', 'API_64', 'API_65', 'API_84', 'API_100', 'API_107', 'API_117', 'API_120', 'API_121', 'API_122', 'API_123', 'API_126', 'API_129', 'API_131', 'API_134', 'API_155'], 'ordinary_user': ['API_2', 'API_5', 'API_6', 'API_8', 'API_10', 'API_13', 'API_14', 'API_15', 'API_28', 'API_34', 'API_35', 'API_36', 'API_37', 'API_39', 'API_43', 'API_47', 'API_63', 'API_64', 'API_65', 'API_84', 'API_100', 'API_107', 'API_117', 'API_120', 'API_121', 'API_122', 'API_123', 'API_126', 'API_129', 'API_131', 'API_134', 'API_155'], 'unlogged_in_user': []}
2025-03-15 21:06:15,861 - INFO - API sequence 9/12 generated
2025-03-15 21:06:15,861 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-15 21:06:15,861 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-15 21:06:17,386 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:06:17,387 - INFO - ========== Method gen_api_seq() returned: seq=['API_2940'], malicious_sign_seq=[0] ==========
2025-03-15 21:06:17,387 - INFO - ========== Method gen_api_seq() returned: seq=['API_2940'], malicious_sign_seq=[0] ==========
2025-03-15 21:06:17,387 - INFO - User configured API_ROLE:{'admin': ['API_2', 'API_5', 'API_6', 'API_8', 'API_10', 'API_13', 'API_14', 'API_15', 'API_18', 'API_19', 'API_23', 'API_28', 'API_34', 'API_35', 'API_36', 'API_37', 'API_39', 'API_40', 'API_41', 'API_42', 'API_43', 'API_47', 'API_50', 'API_55', 'API_56', 'API_63', 'API_64', 'API_65', 'API_84', 'API_100', 'API_107', 'API_117', 'API_120', 'API_121', 'API_122', 'API_123', 'API_126', 'API_129', 'API_131', 'API_134', 'API_155'], 'ordinary_user': ['API_2', 'API_5', 'API_6', 'API_8', 'API_10', 'API_13', 'API_14', 'API_15', 'API_28', 'API_34', 'API_35', 'API_36', 'API_37', 'API_39', 'API_43', 'API_47', 'API_63', 'API_64', 'API_65', 'API_84', 'API_100', 'API_107', 'API_117', 'API_120', 'API_121', 'API_122', 'API_123', 'API_126', 'API_129', 'API_131', 'API_134', 'API_155'], 'unlogged_in_user': []}
2025-03-15 21:06:17,388 - INFO - API sequence 10/12 generated
2025-03-15 21:06:17,388 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-15 21:06:17,388 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-15 21:06:19,069 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:06:19,070 - INFO - ========== Method gen_api_seq() returned: seq=['API_2939'], malicious_sign_seq=[0] ==========
2025-03-15 21:06:19,070 - INFO - ========== Method gen_api_seq() returned: seq=['API_2939'], malicious_sign_seq=[0] ==========
2025-03-15 21:06:19,071 - INFO - User configured API_ROLE:{'admin': ['API_2', 'API_5', 'API_6', 'API_8', 'API_10', 'API_13', 'API_14', 'API_15', 'API_18', 'API_19', 'API_23', 'API_28', 'API_34', 'API_35', 'API_36', 'API_37', 'API_39', 'API_40', 'API_41', 'API_42', 'API_43', 'API_47', 'API_50', 'API_55', 'API_56', 'API_63', 'API_64', 'API_65', 'API_84', 'API_100', 'API_107', 'API_117', 'API_120', 'API_121', 'API_122', 'API_123', 'API_126', 'API_129', 'API_131', 'API_134', 'API_155'], 'ordinary_user': ['API_2', 'API_5', 'API_6', 'API_8', 'API_10', 'API_13', 'API_14', 'API_15', 'API_28', 'API_34', 'API_35', 'API_36', 'API_37', 'API_39', 'API_43', 'API_47', 'API_63', 'API_64', 'API_65', 'API_84', 'API_100', 'API_107', 'API_117', 'API_120', 'API_121', 'API_122', 'API_123', 'API_126', 'API_129', 'API_131', 'API_134', 'API_155'], 'unlogged_in_user': []}
2025-03-15 21:06:19,071 - INFO - API sequence 11/12 generated
2025-03-15 21:06:19,071 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-15 21:06:19,071 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-15 21:06:21,336 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:06:21,337 - INFO - ========== Method gen_api_seq() returned: seq=['API_2940', 'API_2939'], malicious_sign_seq=[1, 0] ==========
2025-03-15 21:06:21,337 - INFO - ========== Method gen_api_seq() returned: seq=['API_2940', 'API_2939'], malicious_sign_seq=[1, 0] ==========
2025-03-15 21:06:21,337 - INFO - User configured API_ROLE:{'admin': ['API_2', 'API_5', 'API_6', 'API_8', 'API_10', 'API_13', 'API_14', 'API_15', 'API_18', 'API_19', 'API_23', 'API_28', 'API_34', 'API_35', 'API_36', 'API_37', 'API_39', 'API_40', 'API_41', 'API_42', 'API_43', 'API_47', 'API_50', 'API_55', 'API_56', 'API_63', 'API_64', 'API_65', 'API_84', 'API_100', 'API_107', 'API_117', 'API_120', 'API_121', 'API_122', 'API_123', 'API_126', 'API_129', 'API_131', 'API_134', 'API_155'], 'ordinary_user': ['API_2', 'API_5', 'API_6', 'API_8', 'API_10', 'API_13', 'API_14', 'API_15', 'API_28', 'API_34', 'API_35', 'API_36', 'API_37', 'API_39', 'API_43', 'API_47', 'API_63', 'API_64', 'API_65', 'API_84', 'API_100', 'API_107', 'API_117', 'API_120', 'API_121', 'API_122', 'API_123', 'API_126', 'API_129', 'API_131', 'API_134', 'API_155'], 'unlogged_in_user': []}
2025-03-15 21:06:21,337 - INFO - API sequence 12/12 generated
2025-03-15 21:06:21,338 - INFO - API sequences serialized to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py/serialized_llm_agents.json
2025-03-15 21:06:21,338 - INFO - Generating simulated traffic data set...
2025-03-15 21:06:21,338 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:06:21,338 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:06:21,338 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:06:21,338 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-15 21:06:21,339 - INFO - error_apis: []
2025-03-15 21:06:21,339 - INFO - Simulated traffic data for 1/12 user collected：user: normaluser malicious: True
2025-03-15 21:06:21,339 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:06:21,339 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:06:21,339 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:06:21,339 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-15 21:06:21,339 - INFO - error_apis: []
2025-03-15 21:06:21,339 - INFO - Simulated traffic data for 2/12 user collected：user: normaluser malicious: True
2025-03-15 21:06:21,339 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:06:21,339 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:06:21,339 - INFO - error_apis: []
2025-03-15 21:06:21,339 - INFO - Simulated traffic data for 3/12 user collected：user: normaluser malicious: False
2025-03-15 21:06:21,340 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:06:21,340 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:06:21,340 - INFO - error_apis: []
2025-03-15 21:06:21,340 - INFO - Simulated traffic data for 4/12 user collected：user: adminuser malicious: False
2025-03-15 21:06:21,340 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:06:21,340 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:06:21,340 - INFO - error_apis: []
2025-03-15 21:06:21,340 - INFO - Simulated traffic data for 5/12 user collected：user: normaluser malicious: False
2025-03-15 21:06:21,340 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:06:21,340 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:06:21,340 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:06:21,340 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-15 21:06:21,340 - INFO - error_apis: []
2025-03-15 21:06:21,341 - INFO - Simulated traffic data for 6/12 user collected：user: unloggeduser malicious: True
2025-03-15 21:06:21,341 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:06:21,341 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:06:21,341 - INFO - error_apis: []
2025-03-15 21:06:21,341 - INFO - Simulated traffic data for 7/12 user collected：user: normaluser malicious: False
2025-03-15 21:06:21,341 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:06:21,341 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:06:21,341 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:06:21,341 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-15 21:06:21,341 - INFO - error_apis: []
2025-03-15 21:06:21,341 - INFO - Simulated traffic data for 8/12 user collected：user: unloggeduser malicious: True
2025-03-15 21:06:21,342 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:06:21,342 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:06:21,342 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:06:21,342 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-15 21:06:21,342 - INFO - error_apis: []
2025-03-15 21:06:21,342 - INFO - Simulated traffic data for 9/12 user collected：user: normaluser malicious: True
2025-03-15 21:06:21,342 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:06:21,342 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:06:21,342 - INFO - error_apis: []
2025-03-15 21:06:21,343 - INFO - Simulated traffic data for 10/12 user collected：user: normaluser malicious: False
2025-03-15 21:06:21,343 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:06:21,343 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:06:21,343 - INFO - error_apis: []
2025-03-15 21:06:21,343 - INFO - Simulated traffic data for 11/12 user collected：user: adminuser malicious: False
2025-03-15 21:06:21,343 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:06:21,343 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-15 21:06:21,343 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:06:21,343 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：False
2025-03-15 21:06:21,343 - INFO - error_apis: []
2025-03-15 21:06:21,343 - INFO - Simulated traffic data for 12/12 user collected：user: unloggeduser malicious: True
2025-03-15 21:06:21,349 - INFO - All simulated traffic data collected：/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/simulated_traffic_data.csv
2025-03-15 21:06:21,349 - INFO - error_apis: []
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-03-15 21:07:20,807 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-15 02:16:38', 'last_model_construction_at': '2025-03-15 02:22:00', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.5, 1.0, 0.67, 2.0, 0.0, 0.0, 0.0, 2.0, 0.5, 4.0, 0.25, 0.5, 0.33, 4.0, 0.25, 0.5, 0.33, 4.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-15 21:07:20,807 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-03-15 21:07:50,731 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-15 02:16:38', 'last_model_construction_at': '2025-03-15 02:22:00', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.5, 1.0, 0.67, 2.0, 0.0, 0.0, 0.0, 2.0, 0.5, 4.0, 0.25, 0.5, 0.33, 4.0, 0.25, 0.5, 0.33, 4.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-15 21:07:50,731 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-03-15 21:09:07,498 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-15 02:16:38', 'last_model_construction_at': '2025-03-15 02:22:00', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.5, 1.0, 0.67, 2.0, 0.0, 0.0, 0.0, 2.0, 0.5, 4.0, 0.25, 0.5, 0.33, 4.0, 0.25, 0.5, 0.33, 4.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-15 21:09:07,499 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
2025-03-15 21:09:16,381 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-15 21:09:16,433 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-15 21:09:16,542 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-15 21:09:16,543 - INFO - Starting data generation...
2025-03-15 21:09:16,543 - INFO - API_KNOWLEDGE: [{'number': 'API_2941', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_2942', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}]
2025-03-15 21:09:16,543 - INFO - APP_KNOWLEDGE: {'func_description': 'This is an updated test application', 'normal_seqs': ['Role: admin; API_2941(Call 1); API_2942(Call 2)', 'Role: oridinary_user; API_2942(); API_2941()'], 'malicious_seqs': ['Role: admin; API_2941(); API_2942()', 'Role: ordinary_user; API_2942(); API_2941()'], 'roles': ['admin', 'ordinary_user', 'unlogged_in_user']}
2025-03-15 21:09:16,739 - INFO - Generating simulated API sequences...
2025-03-15 21:09:16,739 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-15 21:09:16,739 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-15 21:09:18,530 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:09:18,535 - INFO - ========== Method gen_api_seq() returned: seq=['API_2941'], malicious_sign_seq=[0] ==========
2025-03-15 21:09:18,535 - INFO - ========== Method gen_api_seq() returned: seq=['API_2941'], malicious_sign_seq=[0] ==========
2025-03-15 21:09:18,535 - INFO - User configured API_ROLE:{}
2025-03-15 21:09:18,535 - INFO - API sequence 1/12 generated
2025-03-15 21:09:18,535 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-15 21:09:18,535 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-15 21:09:20,178 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:09:20,179 - INFO - ========== Method gen_api_seq() returned: seq=['API_2942'], malicious_sign_seq=[0] ==========
2025-03-15 21:09:20,179 - INFO - ========== Method gen_api_seq() returned: seq=['API_2942'], malicious_sign_seq=[0] ==========
2025-03-15 21:09:20,180 - INFO - User configured API_ROLE:{}
2025-03-15 21:09:20,180 - INFO - API sequence 2/12 generated
2025-03-15 21:09:20,180 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-15 21:09:20,180 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-15 21:09:22,422 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:09:22,423 - INFO - ========== Method gen_api_seq() returned: seq=['API_2942', 'API_2941'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:09:22,423 - INFO - ========== Method gen_api_seq() returned: seq=['API_2942', 'API_2941'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:09:22,423 - INFO - User configured API_ROLE:{}
Exception in thread Thread-4 (async_data_collect):
Traceback (most recent call last):
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/./app.py", line 543, in async_data_collect
    error_apis = traffic_data_generation.gen_data_set(user_api_set, api_knowledge, app_knowledge)
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py", line 292, in gen_data_set
    user.exec()
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/agent.py", line 51, in exec
    if self.api_sequence[index] in config.role.APIS_OF_USER_ROLES[self.role]:
KeyError: 'unlogged_in_user'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/threading.py", line 1016, in _bootstrap_inner
    self.run()
  File "/usr/lib/python3.10/threading.py", line 953, in run
    self._target(*self._args, **self._kwargs)
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/./app.py", line 552, in async_data_collect
    LOGGER.error(f"Error in data collection: {e.with_traceback(10)}")
TypeError: __traceback__ must be a traceback or None
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-03-15 21:10:40,030 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-15 02:16:38', 'last_model_construction_at': '2025-03-15 02:22:00', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.5, 1.0, 0.67, 2.0, 0.0, 0.0, 0.0, 2.0, 0.5, 4.0, 0.25, 0.5, 0.33, 4.0, 0.25, 0.5, 0.33, 4.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-15 21:10:40,031 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
2025-03-15 21:10:40,149 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-15 21:10:40,271 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-15 21:10:40,451 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-15 21:10:40,451 - INFO - Starting data generation...
2025-03-15 21:10:40,452 - INFO - API_KNOWLEDGE: [{'number': 'API_2943', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_2944', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}]
2025-03-15 21:10:40,452 - INFO - APP_KNOWLEDGE: {'func_description': 'This is an updated test application', 'normal_seqs': ['Role: admin; API_2943(Call 1); API_2944(Call 2)', 'Role: oridinary_user; API_2944(); API_2943()'], 'malicious_seqs': ['Role: admin; API_2943(); API_2944()', 'Role: ordinary_user; API_2944(); API_2943()'], 'roles': ['admin', 'ordinary_user', 'unlogged_in_user']}
2025-03-15 21:10:40,706 - INFO - Generating simulated API sequences...
2025-03-15 21:10:40,706 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-15 21:10:40,706 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-15 21:10:42,016 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:10:42,022 - INFO - ========== Method gen_api_seq() returned: seq=['API_2944', 'API_2943'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:10:42,022 - INFO - ========== Method gen_api_seq() returned: seq=['API_2944', 'API_2943'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:10:42,023 - INFO - User configured API_ROLE:{'unlogged_in_user': []}
Exception in thread Thread-4 (async_data_collect):
Traceback (most recent call last):
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/./app.py", line 545, in async_data_collect
    error_apis = traffic_data_generation.gen_data_set(user_api_set, api_knowledge, app_knowledge)
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py", line 292, in gen_data_set
    user.exec()
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/agent.py", line 51, in exec
    if self.api_sequence[index] in config.role.APIS_OF_USER_ROLES[self.role]:
KeyError: 'ordinary_user'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/threading.py", line 1016, in _bootstrap_inner
    self.run()
  File "/usr/lib/python3.10/threading.py", line 953, in run
    self._target(*self._args, **self._kwargs)
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/./app.py", line 554, in async_data_collect
    LOGGER.error(f"Error in data collection: {e.with_traceback(10)}")
TypeError: __traceback__ must be a traceback or None
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-03-15 21:12:24,541 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-15 02:16:38', 'last_model_construction_at': '2025-03-15 02:22:00', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.5, 1.0, 0.67, 2.0, 0.0, 0.0, 0.0, 2.0, 0.5, 4.0, 0.25, 0.5, 0.33, 4.0, 0.25, 0.5, 0.33, 4.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-15 21:12:24,542 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
2025-03-15 21:12:24,654 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-15 21:12:24,776 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-15 21:12:24,953 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-15 21:12:24,954 - INFO - Starting data generation...
2025-03-15 21:12:24,954 - INFO - API_KNOWLEDGE: [{'number': 'API_2945', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_2946', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}]
2025-03-15 21:12:24,954 - INFO - APP_KNOWLEDGE: {'func_description': 'This is an updated test application', 'normal_seqs': ['Role: admin; API_2945(Call 1); API_2946(Call 2)', 'Role: oridinary_user; API_2946(); API_2945()'], 'malicious_seqs': ['Role: admin; API_2945(); API_2946()', 'Role: ordinary_user; API_2946(); API_2945()'], 'roles': ['admin', 'ordinary_user', 'unlogged_in_user']}
2025-03-15 21:12:25,229 - INFO - Generating simulated API sequences...
2025-03-15 21:12:25,229 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-15 21:12:25,229 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-15 21:12:26,395 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:12:26,400 - INFO - ========== Method gen_api_seq() returned: seq=['API_2946', 'API_2945'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:12:26,400 - INFO - ========== Method gen_api_seq() returned: seq=['API_2946', 'API_2945'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:12:26,400 - INFO - User configured API_ROLE:{'unlogged_in_user': [], 'ordinary_user': [], 'admin': []}
2025-03-15 21:12:26,400 - INFO - API sequence 1/12 generated
2025-03-15 21:12:26,400 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-15 21:12:26,400 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-15 21:12:27,538 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:12:27,539 - INFO - ========== Method gen_api_seq() returned: seq=['API_2946'], malicious_sign_seq=[0] ==========
2025-03-15 21:12:27,539 - INFO - ========== Method gen_api_seq() returned: seq=['API_2946'], malicious_sign_seq=[0] ==========
2025-03-15 21:12:27,539 - INFO - User configured API_ROLE:{'unlogged_in_user': [], 'ordinary_user': [], 'admin': []}
2025-03-15 21:12:27,539 - INFO - API sequence 2/12 generated
2025-03-15 21:12:27,539 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-15 21:12:27,539 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-15 21:12:29,740 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:12:29,741 - INFO - ========== Method gen_api_seq() returned: seq=['API_2946', 'API_2945'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:12:29,741 - INFO - ========== Method gen_api_seq() returned: seq=['API_2946', 'API_2945'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:12:29,741 - INFO - User configured API_ROLE:{'unlogged_in_user': [], 'ordinary_user': [], 'admin': []}
2025-03-15 21:12:29,741 - INFO - API sequence 3/12 generated
2025-03-15 21:12:29,741 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-15 21:12:29,741 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-15 21:12:30,645 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:12:30,646 - INFO - ========== Method gen_api_seq() returned: seq=['API_2945'], malicious_sign_seq=[0] ==========
2025-03-15 21:12:30,646 - INFO - ========== Method gen_api_seq() returned: seq=['API_2945'], malicious_sign_seq=[0] ==========
2025-03-15 21:12:30,646 - INFO - User configured API_ROLE:{'unlogged_in_user': [], 'ordinary_user': [], 'admin': []}
2025-03-15 21:12:30,646 - INFO - API sequence 4/12 generated
2025-03-15 21:12:30,646 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-15 21:12:30,646 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-15 21:12:31,792 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:12:31,793 - INFO - ========== Method gen_api_seq() returned: seq=['API_2946', 'API_2945'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:12:31,793 - INFO - ========== Method gen_api_seq() returned: seq=['API_2946', 'API_2945'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:12:31,793 - INFO - User configured API_ROLE:{'unlogged_in_user': [], 'ordinary_user': [], 'admin': []}
2025-03-15 21:12:31,793 - INFO - API sequence 5/12 generated
2025-03-15 21:12:31,793 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-15 21:12:31,793 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-15 21:12:33,512 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:12:33,513 - INFO - ========== Method gen_api_seq() returned: seq=['API_2946'], malicious_sign_seq=[0] ==========
2025-03-15 21:12:33,513 - INFO - ========== Method gen_api_seq() returned: seq=['API_2946'], malicious_sign_seq=[0] ==========
2025-03-15 21:12:33,513 - INFO - User configured API_ROLE:{'unlogged_in_user': [], 'ordinary_user': [], 'admin': []}
2025-03-15 21:12:33,513 - INFO - API sequence 6/12 generated
2025-03-15 21:12:33,513 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-15 21:12:33,513 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-15 21:12:34,372 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:12:34,373 - INFO - ========== Method gen_api_seq() returned: seq=['API_2946'], malicious_sign_seq=[0] ==========
2025-03-15 21:12:34,373 - INFO - ========== Method gen_api_seq() returned: seq=['API_2946'], malicious_sign_seq=[0] ==========
2025-03-15 21:12:34,373 - INFO - User configured API_ROLE:{'unlogged_in_user': [], 'ordinary_user': [], 'admin': []}
2025-03-15 21:12:34,373 - INFO - API sequence 7/12 generated
2025-03-15 21:12:34,373 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-15 21:12:34,373 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-15 21:12:36,450 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:12:36,451 - INFO - ========== Method gen_api_seq() returned: seq=['API_2946', 'API_2945'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:12:36,451 - INFO - ========== Method gen_api_seq() returned: seq=['API_2946', 'API_2945'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:12:36,451 - INFO - User configured API_ROLE:{'unlogged_in_user': [], 'ordinary_user': [], 'admin': []}
2025-03-15 21:12:36,451 - INFO - API sequence 8/12 generated
2025-03-15 21:12:36,451 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-15 21:12:36,451 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-15 21:12:37,689 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:12:37,690 - INFO - ========== Method gen_api_seq() returned: seq=['API_2946', 'API_2945'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:12:37,690 - INFO - ========== Method gen_api_seq() returned: seq=['API_2946', 'API_2945'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:12:37,690 - INFO - User configured API_ROLE:{'unlogged_in_user': [], 'ordinary_user': [], 'admin': []}
2025-03-15 21:12:37,690 - INFO - API sequence 9/12 generated
2025-03-15 21:12:37,690 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-15 21:12:37,690 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-15 21:12:39,852 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:12:39,853 - INFO - ========== Method gen_api_seq() returned: seq=['API_2946', 'API_2945'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:12:39,853 - INFO - ========== Method gen_api_seq() returned: seq=['API_2946', 'API_2945'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:12:39,853 - INFO - User configured API_ROLE:{'unlogged_in_user': [], 'ordinary_user': [], 'admin': []}
2025-03-15 21:12:39,853 - INFO - API sequence 10/12 generated
2025-03-15 21:12:39,853 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-15 21:12:39,853 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-15 21:12:41,504 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:12:41,505 - INFO - ========== Method gen_api_seq() returned: seq=['API_2946'], malicious_sign_seq=[0] ==========
2025-03-15 21:12:41,505 - INFO - ========== Method gen_api_seq() returned: seq=['API_2946'], malicious_sign_seq=[0] ==========
2025-03-15 21:12:41,505 - INFO - User configured API_ROLE:{'unlogged_in_user': [], 'ordinary_user': [], 'admin': []}
2025-03-15 21:12:41,506 - INFO - API sequence 11/12 generated
2025-03-15 21:12:41,506 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-15 21:12:41,506 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-15 21:12:43,231 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:12:43,232 - INFO - ========== Method gen_api_seq() returned: seq=['API_2945'], malicious_sign_seq=[0] ==========
2025-03-15 21:12:43,232 - INFO - ========== Method gen_api_seq() returned: seq=['API_2945'], malicious_sign_seq=[0] ==========
2025-03-15 21:12:43,232 - INFO - User configured API_ROLE:{'unlogged_in_user': [], 'ordinary_user': [], 'admin': []}
2025-03-15 21:12:43,232 - INFO - API sequence 12/12 generated
2025-03-15 21:12:43,233 - INFO - API sequences serialized to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py/serialized_llm_agents.json
2025-03-15 21:12:43,233 - INFO - Generating simulated traffic data set...
2025-03-15 21:12:43,233 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:12:43,233 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:12:43,233 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:12:43,233 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-15 21:12:43,234 - INFO - error_apis: []
2025-03-15 21:12:43,234 - INFO - Simulated traffic data for 1/12 user collected：user: unloggeduser malicious: True
2025-03-15 21:12:43,234 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:12:43,234 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:12:43,234 - INFO - error_apis: []
2025-03-15 21:12:43,234 - INFO - Simulated traffic data for 2/12 user collected：user: normaluser malicious: False
2025-03-15 21:12:43,234 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:12:43,234 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:12:43,234 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:12:43,234 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-15 21:12:43,234 - INFO - error_apis: []
2025-03-15 21:12:43,234 - INFO - Simulated traffic data for 3/12 user collected：user: unloggeduser malicious: True
2025-03-15 21:12:43,235 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:12:43,235 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:12:43,235 - INFO - error_apis: []
2025-03-15 21:12:43,235 - INFO - Simulated traffic data for 4/12 user collected：user: adminuser malicious: False
2025-03-15 21:12:43,235 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:12:43,235 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:12:43,235 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:12:43,235 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-15 21:12:43,235 - INFO - error_apis: []
2025-03-15 21:12:43,235 - INFO - Simulated traffic data for 5/12 user collected：user: normaluser malicious: True
2025-03-15 21:12:43,235 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:12:43,236 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:12:43,236 - INFO - error_apis: []
2025-03-15 21:12:43,236 - INFO - Simulated traffic data for 6/12 user collected：user: normaluser malicious: False
2025-03-15 21:12:43,236 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:12:43,236 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:12:43,236 - INFO - error_apis: []
2025-03-15 21:12:43,236 - INFO - Simulated traffic data for 7/12 user collected：user: normaluser malicious: False
2025-03-15 21:12:43,236 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:12:43,236 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:12:43,236 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:12:43,236 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-15 21:12:43,236 - INFO - error_apis: []
2025-03-15 21:12:43,236 - INFO - Simulated traffic data for 8/12 user collected：user: unloggeduser malicious: True
2025-03-15 21:12:43,237 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:12:43,237 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:12:43,237 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:12:43,237 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-15 21:12:43,237 - INFO - error_apis: []
2025-03-15 21:12:43,237 - INFO - Simulated traffic data for 9/12 user collected：user: normaluser malicious: True
2025-03-15 21:12:43,237 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:12:43,237 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:12:43,237 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:12:43,237 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-15 21:12:43,237 - INFO - error_apis: []
2025-03-15 21:12:43,237 - INFO - Simulated traffic data for 10/12 user collected：user: normaluser malicious: True
2025-03-15 21:12:43,238 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:12:43,238 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:12:43,238 - INFO - error_apis: []
2025-03-15 21:12:43,238 - INFO - Simulated traffic data for 11/12 user collected：user: normaluser malicious: False
2025-03-15 21:12:43,238 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:12:43,238 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:12:43,238 - INFO - error_apis: []
2025-03-15 21:12:43,238 - INFO - Simulated traffic data for 12/12 user collected：user: adminuser malicious: False
2025-03-15 21:12:43,241 - INFO - All simulated traffic data collected：/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/simulated_traffic_data.csv
2025-03-15 21:12:43,241 - INFO - error_apis: []
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-03-15 21:16:31,958 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-15 02:16:38', 'last_model_construction_at': '2025-03-15 02:22:00', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.5, 1.0, 0.67, 2.0, 0.0, 0.0, 0.0, 2.0, 0.5, 4.0, 0.25, 0.5, 0.33, 4.0, 0.25, 0.5, 0.33, 4.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-15 21:16:31,958 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
2025-03-15 21:16:33,006 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-15 21:16:33,085 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-15 21:16:33,303 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-15 21:16:33,303 - INFO - Starting data generation...
2025-03-15 21:16:33,303 - INFO - API_KNOWLEDGE: [{'number': 'API_2947', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_2948', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}]
2025-03-15 21:16:33,304 - INFO - APP_KNOWLEDGE: {'func_description': 'This is an updated test application', 'normal_seqs': ['Role: admin; API_2947(Call 1); API_2948(Call 2)', 'Role: oridinary_user; API_2948(); API_2947()'], 'malicious_seqs': ['Role: admin; API_2947(); API_2948()', 'Role: ordinary_user; API_2948(); API_2947()'], 'roles': ['admin', 'ordinary_user', 'unlogged_in_user']}
2025-03-15 21:16:33,625 - INFO - Generating simulated API sequences...
2025-03-15 21:16:33,625 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-15 21:16:33,625 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-15 21:16:35,265 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:16:35,270 - INFO - ========== Method gen_api_seq() returned: seq=['API_2948'], malicious_sign_seq=[0] ==========
2025-03-15 21:16:35,270 - INFO - ========== Method gen_api_seq() returned: seq=['API_2948'], malicious_sign_seq=[0] ==========
2025-03-15 21:16:35,270 - INFO - User configured API_ROLE:{'unlogged_in_user': [], 'ordinary_user': [], 'admin': []}
2025-03-15 21:16:35,270 - INFO - API sequence 1/12 generated
2025-03-15 21:16:35,270 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-15 21:16:35,270 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-15 21:16:36,337 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:16:36,340 - INFO - ========== Method gen_api_seq() returned: seq=['API_2948', 'API_2947'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:16:36,340 - INFO - ========== Method gen_api_seq() returned: seq=['API_2948', 'API_2947'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:16:36,340 - INFO - User configured API_ROLE:{'unlogged_in_user': [], 'ordinary_user': [], 'admin': []}
2025-03-15 21:16:36,340 - INFO - API sequence 2/12 generated
2025-03-15 21:16:36,340 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-15 21:16:36,340 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-15 21:16:38,559 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:16:38,560 - INFO - ========== Method gen_api_seq() returned: seq=['API_2948', 'API_2947'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:16:38,560 - INFO - ========== Method gen_api_seq() returned: seq=['API_2948', 'API_2947'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:16:38,560 - INFO - User configured API_ROLE:{'unlogged_in_user': [], 'ordinary_user': [], 'admin': []}
2025-03-15 21:16:38,560 - INFO - API sequence 3/12 generated
2025-03-15 21:16:38,560 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-15 21:16:38,560 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-15 21:16:39,597 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:16:39,598 - INFO - ========== Method gen_api_seq() returned: seq=['API_2948', 'API_2947'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:16:39,598 - INFO - ========== Method gen_api_seq() returned: seq=['API_2948', 'API_2947'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:16:39,598 - INFO - User configured API_ROLE:{'unlogged_in_user': [], 'ordinary_user': [], 'admin': []}
2025-03-15 21:16:39,598 - INFO - API sequence 4/12 generated
2025-03-15 21:16:39,598 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-15 21:16:39,598 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-15 21:16:40,681 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:16:40,682 - INFO - ========== Method gen_api_seq() returned: seq=['API_2948'], malicious_sign_seq=[0] ==========
2025-03-15 21:16:40,682 - INFO - ========== Method gen_api_seq() returned: seq=['API_2948'], malicious_sign_seq=[0] ==========
2025-03-15 21:16:40,682 - INFO - User configured API_ROLE:{'unlogged_in_user': [], 'ordinary_user': [], 'admin': []}
2025-03-15 21:16:40,682 - INFO - API sequence 5/12 generated
2025-03-15 21:16:40,682 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-15 21:16:40,682 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-15 21:16:42,307 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:16:42,308 - INFO - ========== Method gen_api_seq() returned: seq=['API_2948'], malicious_sign_seq=[0] ==========
2025-03-15 21:16:42,308 - INFO - ========== Method gen_api_seq() returned: seq=['API_2948'], malicious_sign_seq=[0] ==========
2025-03-15 21:16:42,308 - INFO - User configured API_ROLE:{'unlogged_in_user': [], 'ordinary_user': [], 'admin': []}
2025-03-15 21:16:42,308 - INFO - API sequence 6/12 generated
2025-03-15 21:16:42,308 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-15 21:16:42,308 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-15 21:16:43,365 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:16:43,366 - INFO - ========== Method gen_api_seq() returned: seq=['API_2947'], malicious_sign_seq=[0] ==========
2025-03-15 21:16:43,366 - INFO - ========== Method gen_api_seq() returned: seq=['API_2947'], malicious_sign_seq=[0] ==========
2025-03-15 21:16:43,366 - INFO - User configured API_ROLE:{'unlogged_in_user': [], 'ordinary_user': [], 'admin': []}
2025-03-15 21:16:43,366 - INFO - API sequence 7/12 generated
2025-03-15 21:16:43,367 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-15 21:16:43,367 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-15 21:16:44,861 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:16:44,862 - INFO - ========== Method gen_api_seq() returned: seq=['API_2948', 'API_2947'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:16:44,862 - INFO - ========== Method gen_api_seq() returned: seq=['API_2948', 'API_2947'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:16:44,862 - INFO - User configured API_ROLE:{'unlogged_in_user': [], 'ordinary_user': [], 'admin': []}
2025-03-15 21:16:44,862 - INFO - API sequence 8/12 generated
2025-03-15 21:16:44,862 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-15 21:16:44,862 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-15 21:16:47,253 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:16:47,254 - INFO - ========== Method gen_api_seq() returned: seq=['API_2948', 'API_2947'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:16:47,254 - INFO - ========== Method gen_api_seq() returned: seq=['API_2948', 'API_2947'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:16:47,254 - INFO - User configured API_ROLE:{'unlogged_in_user': [], 'ordinary_user': [], 'admin': []}
2025-03-15 21:16:47,254 - INFO - API sequence 9/12 generated
2025-03-15 21:16:47,254 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-15 21:16:47,254 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-15 21:16:48,485 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:16:48,486 - INFO - ========== Method gen_api_seq() returned: seq=['API_2948', 'API_2947'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:16:48,486 - INFO - ========== Method gen_api_seq() returned: seq=['API_2948', 'API_2947'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:16:48,486 - INFO - User configured API_ROLE:{'unlogged_in_user': [], 'ordinary_user': [], 'admin': []}
2025-03-15 21:16:48,486 - INFO - API sequence 10/12 generated
2025-03-15 21:16:48,486 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-15 21:16:48,486 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-15 21:16:50,137 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:16:50,139 - INFO - ========== Method gen_api_seq() returned: seq=['API_2947'], malicious_sign_seq=[0] ==========
2025-03-15 21:16:50,139 - INFO - ========== Method gen_api_seq() returned: seq=['API_2947'], malicious_sign_seq=[0] ==========
2025-03-15 21:16:50,139 - INFO - User configured API_ROLE:{'unlogged_in_user': [], 'ordinary_user': [], 'admin': []}
2025-03-15 21:16:50,139 - INFO - API sequence 11/12 generated
2025-03-15 21:16:50,139 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-15 21:16:50,139 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-15 21:16:51,285 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:16:51,286 - INFO - ========== Method gen_api_seq() returned: seq=['API_2948'], malicious_sign_seq=[0] ==========
2025-03-15 21:16:51,286 - INFO - ========== Method gen_api_seq() returned: seq=['API_2948'], malicious_sign_seq=[0] ==========
2025-03-15 21:16:51,286 - INFO - User configured API_ROLE:{'unlogged_in_user': [], 'ordinary_user': [], 'admin': []}
2025-03-15 21:16:51,286 - INFO - API sequence 12/12 generated
2025-03-15 21:16:51,286 - INFO - API sequences serialized to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py/serialized_llm_agents.json
2025-03-15 21:16:51,287 - INFO - Generating simulated traffic data set...
2025-03-15 21:16:51,287 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:16:51,287 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:16:51,287 - INFO - error_apis: []
2025-03-15 21:16:51,287 - INFO - Simulated traffic data for 1/12 user collected：user: normaluser malicious: False
2025-03-15 21:16:51,287 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:16:51,287 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:16:51,288 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:16:51,288 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-15 21:16:51,288 - INFO - error_apis: []
2025-03-15 21:16:51,288 - INFO - Simulated traffic data for 2/12 user collected：user: normaluser malicious: True
2025-03-15 21:16:51,288 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:16:51,288 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:16:51,288 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:16:51,288 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-15 21:16:51,288 - INFO - error_apis: []
2025-03-15 21:16:51,288 - INFO - Simulated traffic data for 3/12 user collected：user: normaluser malicious: True
2025-03-15 21:16:51,288 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:16:51,288 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:16:51,289 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:16:51,289 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-15 21:16:51,289 - INFO - error_apis: []
2025-03-15 21:16:51,289 - INFO - Simulated traffic data for 4/12 user collected：user: normaluser malicious: True
2025-03-15 21:16:51,289 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:16:51,289 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:16:51,289 - INFO - error_apis: []
2025-03-15 21:16:51,289 - INFO - Simulated traffic data for 5/12 user collected：user: normaluser malicious: False
2025-03-15 21:16:51,289 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:16:51,289 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:16:51,289 - INFO - error_apis: []
2025-03-15 21:16:51,289 - INFO - Simulated traffic data for 6/12 user collected：user: normaluser malicious: False
2025-03-15 21:16:51,289 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:16:51,289 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:16:51,290 - INFO - error_apis: []
2025-03-15 21:16:51,290 - INFO - Simulated traffic data for 7/12 user collected：user: adminuser malicious: False
2025-03-15 21:16:51,290 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:16:51,290 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:16:51,290 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:16:51,290 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-15 21:16:51,290 - INFO - error_apis: []
2025-03-15 21:16:51,290 - INFO - Simulated traffic data for 8/12 user collected：user: unloggeduser malicious: True
2025-03-15 21:16:51,290 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:16:51,290 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:16:51,291 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:16:51,291 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-15 21:16:51,291 - INFO - error_apis: []
2025-03-15 21:16:51,291 - INFO - Simulated traffic data for 9/12 user collected：user: unloggeduser malicious: True
2025-03-15 21:16:51,291 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:16:51,291 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:16:51,291 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:16:51,291 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-15 21:16:51,291 - INFO - error_apis: []
2025-03-15 21:16:51,291 - INFO - Simulated traffic data for 10/12 user collected：user: unloggeduser malicious: True
2025-03-15 21:16:51,291 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:16:51,291 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:16:51,291 - INFO - error_apis: []
2025-03-15 21:16:51,291 - INFO - Simulated traffic data for 11/12 user collected：user: adminuser malicious: False
2025-03-15 21:16:51,292 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:16:51,292 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:16:51,292 - INFO - error_apis: []
2025-03-15 21:16:51,292 - INFO - Simulated traffic data for 12/12 user collected：user: normaluser malicious: False
2025-03-15 21:16:51,294 - INFO - All simulated traffic data collected：/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/simulated_traffic_data.csv
2025-03-15 21:16:51,295 - INFO - error_apis: []
2025-03-15 21:19:00,276 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-15 21:19:00,323 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-15 21:19:00,437 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-15 21:19:00,437 - INFO - Starting data generation...
2025-03-15 21:19:00,437 - INFO - API_KNOWLEDGE: [{'number': 'API_2949', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_2950', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}]
2025-03-15 21:19:00,437 - INFO - APP_KNOWLEDGE: {'func_description': 'This is an updated test application', 'normal_seqs': ['Role: admin; API_2949(Call 1); API_2950(Call 2)', 'Role: oridinary_user; API_2949(); API_2950()'], 'malicious_seqs': ['Role: admin; API_2949(); API_2950()', 'Role: ordinary_user; API_2949(); API_2950()'], 'roles': ['admin', 'ordinary_user', 'unlogged_in_user']}
2025-03-15 21:19:00,489 - INFO - Generating simulated API sequences...
2025-03-15 21:19:00,489 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-15 21:19:00,489 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-15 21:19:00,489 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-15 21:19:02,633 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:19:02,634 - INFO - ========== Method gen_api_seq() returned: seq=['API_2949', 'API_2950'], malicious_sign_seq=[0, 0] ==========
2025-03-15 21:19:02,634 - INFO - ========== Method gen_api_seq() returned: seq=['API_2949', 'API_2950'], malicious_sign_seq=[0, 0] ==========
2025-03-15 21:19:02,634 - INFO - ========== Method gen_api_seq() returned: seq=['API_2949', 'API_2950'], malicious_sign_seq=[0, 0] ==========
2025-03-15 21:19:02,634 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2949', 'API_2950'], 'ordinary_user': [], 'admin': ['API_2949', 'API_2950'], 'oridinary_user': ['API_2949', 'API_2950']}
2025-03-15 21:19:02,634 - INFO - API sequence 1/12 generated
2025-03-15 21:19:02,635 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-15 21:19:02,635 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-15 21:19:02,635 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-15 21:19:03,818 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:19:03,819 - INFO - ========== Method gen_api_seq() returned: seq=['API_2949', 'API_2950'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:19:03,819 - INFO - ========== Method gen_api_seq() returned: seq=['API_2949', 'API_2950'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:19:03,819 - INFO - ========== Method gen_api_seq() returned: seq=['API_2949', 'API_2950'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:19:03,819 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2949', 'API_2950'], 'ordinary_user': [], 'admin': ['API_2949', 'API_2950'], 'oridinary_user': ['API_2949', 'API_2950']}
2025-03-15 21:19:03,819 - INFO - API sequence 2/12 generated
2025-03-15 21:19:03,819 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-15 21:19:03,819 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-15 21:19:03,819 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-15 21:19:05,843 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:19:05,844 - INFO - ========== Method gen_api_seq() returned: seq=['API_2949', 'API_2950'], malicious_sign_seq=[0, 0] ==========
2025-03-15 21:19:05,844 - INFO - ========== Method gen_api_seq() returned: seq=['API_2949', 'API_2950'], malicious_sign_seq=[0, 0] ==========
2025-03-15 21:19:05,844 - INFO - ========== Method gen_api_seq() returned: seq=['API_2949', 'API_2950'], malicious_sign_seq=[0, 0] ==========
2025-03-15 21:19:05,844 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2949', 'API_2950'], 'ordinary_user': [], 'admin': ['API_2949', 'API_2950'], 'oridinary_user': ['API_2949', 'API_2950']}
2025-03-15 21:19:05,845 - INFO - API sequence 3/12 generated
2025-03-15 21:19:05,845 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-15 21:19:05,845 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-15 21:19:05,845 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-15 21:19:07,961 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:19:07,962 - INFO - ========== Method gen_api_seq() returned: seq=['API_2949', 'API_2950'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:19:07,962 - INFO - ========== Method gen_api_seq() returned: seq=['API_2949', 'API_2950'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:19:07,962 - INFO - ========== Method gen_api_seq() returned: seq=['API_2949', 'API_2950'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:19:07,962 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2949', 'API_2950'], 'ordinary_user': [], 'admin': ['API_2949', 'API_2950'], 'oridinary_user': ['API_2949', 'API_2950']}
2025-03-15 21:19:07,962 - INFO - API sequence 4/12 generated
2025-03-15 21:19:07,962 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-15 21:19:07,962 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-15 21:19:07,962 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-15 21:19:10,074 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:19:10,075 - INFO - ========== Method gen_api_seq() returned: seq=['API_2949', 'API_2950'], malicious_sign_seq=[0, 0] ==========
2025-03-15 21:19:10,075 - INFO - ========== Method gen_api_seq() returned: seq=['API_2949', 'API_2950'], malicious_sign_seq=[0, 0] ==========
2025-03-15 21:19:10,075 - INFO - ========== Method gen_api_seq() returned: seq=['API_2949', 'API_2950'], malicious_sign_seq=[0, 0] ==========
2025-03-15 21:19:10,076 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2949', 'API_2950'], 'ordinary_user': [], 'admin': ['API_2949', 'API_2950'], 'oridinary_user': ['API_2949', 'API_2950']}
2025-03-15 21:19:10,076 - INFO - API sequence 5/12 generated
2025-03-15 21:19:10,076 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-15 21:19:10,076 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-15 21:19:10,076 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-15 21:19:12,239 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:19:12,240 - INFO - ========== Method gen_api_seq() returned: seq=['API_2949', 'API_2950'], malicious_sign_seq=[0, 0] ==========
2025-03-15 21:19:12,240 - INFO - ========== Method gen_api_seq() returned: seq=['API_2949', 'API_2950'], malicious_sign_seq=[0, 0] ==========
2025-03-15 21:19:12,240 - INFO - ========== Method gen_api_seq() returned: seq=['API_2949', 'API_2950'], malicious_sign_seq=[0, 0] ==========
2025-03-15 21:19:12,240 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2949', 'API_2950'], 'ordinary_user': [], 'admin': ['API_2949', 'API_2950'], 'oridinary_user': ['API_2949', 'API_2950']}
2025-03-15 21:19:12,240 - INFO - API sequence 6/12 generated
2025-03-15 21:19:12,240 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-15 21:19:12,240 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-15 21:19:12,240 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-15 21:19:13,535 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:19:13,537 - INFO - ========== Method gen_api_seq() returned: seq=['API_2949', 'API_2950'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:19:13,537 - INFO - ========== Method gen_api_seq() returned: seq=['API_2949', 'API_2950'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:19:13,537 - INFO - ========== Method gen_api_seq() returned: seq=['API_2949', 'API_2950'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:19:13,537 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2949', 'API_2950'], 'ordinary_user': [], 'admin': ['API_2949', 'API_2950'], 'oridinary_user': ['API_2949', 'API_2950']}
2025-03-15 21:19:13,537 - INFO - API sequence 7/12 generated
2025-03-15 21:19:13,537 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-15 21:19:13,537 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-15 21:19:13,537 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-15 21:19:15,799 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:19:15,800 - INFO - ========== Method gen_api_seq() returned: seq=['API_2949', 'API_2950'], malicious_sign_seq=[0, 0] ==========
2025-03-15 21:19:15,800 - INFO - ========== Method gen_api_seq() returned: seq=['API_2949', 'API_2950'], malicious_sign_seq=[0, 0] ==========
2025-03-15 21:19:15,800 - INFO - ========== Method gen_api_seq() returned: seq=['API_2949', 'API_2950'], malicious_sign_seq=[0, 0] ==========
2025-03-15 21:19:15,800 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2949', 'API_2950'], 'ordinary_user': [], 'admin': ['API_2949', 'API_2950'], 'oridinary_user': ['API_2949', 'API_2950']}
2025-03-15 21:19:15,800 - INFO - API sequence 8/12 generated
2025-03-15 21:19:15,800 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-15 21:19:15,800 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-15 21:19:15,800 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-15 21:19:17,164 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:19:17,165 - INFO - ========== Method gen_api_seq() returned: seq=['API_2949', 'API_2950'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:19:17,165 - INFO - ========== Method gen_api_seq() returned: seq=['API_2949', 'API_2950'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:19:17,165 - INFO - ========== Method gen_api_seq() returned: seq=['API_2949', 'API_2950'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:19:17,165 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2949', 'API_2950'], 'ordinary_user': [], 'admin': ['API_2949', 'API_2950'], 'oridinary_user': ['API_2949', 'API_2950']}
2025-03-15 21:19:17,165 - INFO - API sequence 9/12 generated
2025-03-15 21:19:17,165 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-15 21:19:17,165 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-15 21:19:17,165 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-15 21:19:18,265 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:19:18,266 - INFO - ========== Method gen_api_seq() returned: seq=['API_2949', 'API_2950'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:19:18,266 - INFO - ========== Method gen_api_seq() returned: seq=['API_2949', 'API_2950'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:19:18,266 - INFO - ========== Method gen_api_seq() returned: seq=['API_2949', 'API_2950'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:19:18,266 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2949', 'API_2950'], 'ordinary_user': [], 'admin': ['API_2949', 'API_2950'], 'oridinary_user': ['API_2949', 'API_2950']}
2025-03-15 21:19:18,266 - INFO - API sequence 10/12 generated
2025-03-15 21:19:18,266 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-15 21:19:18,266 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-15 21:19:18,266 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-15 21:19:20,456 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:19:20,457 - INFO - ========== Method gen_api_seq() returned: seq=['API_2949', 'API_2950'], malicious_sign_seq=[0, 0] ==========
2025-03-15 21:19:20,457 - INFO - ========== Method gen_api_seq() returned: seq=['API_2949', 'API_2950'], malicious_sign_seq=[0, 0] ==========
2025-03-15 21:19:20,457 - INFO - ========== Method gen_api_seq() returned: seq=['API_2949', 'API_2950'], malicious_sign_seq=[0, 0] ==========
2025-03-15 21:19:20,457 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2949', 'API_2950'], 'ordinary_user': [], 'admin': ['API_2949', 'API_2950'], 'oridinary_user': ['API_2949', 'API_2950']}
2025-03-15 21:19:20,457 - INFO - API sequence 11/12 generated
2025-03-15 21:19:20,457 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-15 21:19:20,457 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-15 21:19:20,457 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-15 21:19:21,803 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-15 21:19:21,804 - INFO - ========== Method gen_api_seq() returned: seq=['API_2949', 'API_2950'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:19:21,804 - INFO - ========== Method gen_api_seq() returned: seq=['API_2949', 'API_2950'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:19:21,804 - INFO - ========== Method gen_api_seq() returned: seq=['API_2949', 'API_2950'], malicious_sign_seq=[0, 1] ==========
2025-03-15 21:19:21,804 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2949', 'API_2950'], 'ordinary_user': [], 'admin': ['API_2949', 'API_2950'], 'oridinary_user': ['API_2949', 'API_2950']}
2025-03-15 21:19:21,804 - INFO - API sequence 12/12 generated
2025-03-15 21:19:21,804 - INFO - API sequences serialized to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py/serialized_llm_agents.json
2025-03-15 21:19:21,804 - INFO - Generating simulated traffic data set...
2025-03-15 21:19:21,805 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:19:21,805 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:19:21,805 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:19:21,805 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:19:21,805 - INFO - error_apis: []
2025-03-15 21:19:21,805 - INFO - Simulated traffic data for 1/12 user collected：user: normaluser malicious: False
2025-03-15 21:19:21,805 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:19:21,805 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:19:21,805 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:19:21,806 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-15 21:19:21,806 - INFO - error_apis: []
2025-03-15 21:19:21,806 - INFO - Simulated traffic data for 2/12 user collected：user: unloggeduser malicious: True
2025-03-15 21:19:21,806 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:19:21,806 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:19:21,806 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:19:21,806 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:19:21,806 - INFO - error_apis: []
2025-03-15 21:19:21,806 - INFO - Simulated traffic data for 3/12 user collected：user: normaluser malicious: False
2025-03-15 21:19:21,806 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:19:21,806 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:19:21,806 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:19:21,807 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-15 21:19:21,807 - INFO - error_apis: []
2025-03-15 21:19:21,807 - INFO - Simulated traffic data for 4/12 user collected：user: unloggeduser malicious: True
2025-03-15 21:19:21,807 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:19:21,807 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:19:21,807 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:19:21,807 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:19:21,807 - INFO - error_apis: []
2025-03-15 21:19:21,807 - INFO - Simulated traffic data for 5/12 user collected：user: normaluser malicious: False
2025-03-15 21:19:21,807 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:19:21,807 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:19:21,807 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:19:21,807 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:19:21,808 - INFO - error_apis: []
2025-03-15 21:19:21,808 - INFO - Simulated traffic data for 6/12 user collected：user: adminuser malicious: False
2025-03-15 21:19:21,808 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:19:21,808 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:19:21,808 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:19:21,808 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-15 21:19:21,808 - INFO - error_apis: []
2025-03-15 21:19:21,808 - INFO - Simulated traffic data for 7/12 user collected：user: unloggeduser malicious: True
2025-03-15 21:19:21,808 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:19:21,808 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:19:21,808 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:19:21,808 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:19:21,808 - INFO - error_apis: []
2025-03-15 21:19:21,809 - INFO - Simulated traffic data for 8/12 user collected：user: normaluser malicious: False
2025-03-15 21:19:21,809 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:19:21,809 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:19:21,809 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:19:21,809 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-15 21:19:21,809 - INFO - error_apis: []
2025-03-15 21:19:21,809 - INFO - Simulated traffic data for 9/12 user collected：user: normaluser malicious: True
2025-03-15 21:19:21,809 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:19:21,809 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:19:21,809 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:19:21,809 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-15 21:19:21,809 - INFO - error_apis: []
2025-03-15 21:19:21,810 - INFO - Simulated traffic data for 10/12 user collected：user: normaluser malicious: True
2025-03-15 21:19:21,810 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:19:21,810 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:19:21,810 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:19:21,810 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:19:21,810 - INFO - error_apis: []
2025-03-15 21:19:21,810 - INFO - Simulated traffic data for 11/12 user collected：user: adminuser malicious: False
2025-03-15 21:19:21,810 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-15 21:19:21,810 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-15 21:19:21,810 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-15 21:19:21,810 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-15 21:19:21,810 - INFO - error_apis: []
2025-03-15 21:19:21,811 - INFO - Simulated traffic data for 12/12 user collected：user: normaluser malicious: True
2025-03-15 21:19:21,813 - INFO - All simulated traffic data collected：/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/simulated_traffic_data.csv
2025-03-15 21:19:21,813 - INFO - error_apis: []
2025-03-15 21:20:46,012 - INFO - Trying to construct model...
2025-03-15 21:20:46,013 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-15 21:20:46,070 - INFO - Training model... Size of feature_list: 7
2025-03-15 21:20:46,086 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 21:20:46,092 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 21:20:46,094 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 21:20:46,095 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 21:20:46,097 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 21:20:46,098 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 21:20:46,100 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 21:20:46,101 - INFO - Extracting features... Size of feature_list: 7
[21:20:46] WARNING: /workspace/src/learner.cc:740: 
Parameters: { "use_label_encoder" } are not used.

2025-03-15 21:20:46,195 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 21:20:46,196 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 21:20:46,198 - INFO - Extracting features... Size of feature_list: 7
2025-03-15 21:20:46,199 - INFO - Extracting features... Size of feature_list: 7
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
2025-03-15 21:20:46,216 - INFO - Model constructed.

Restarting celery worker (/home/ubuntu/.local/bin/celery -A traffic_collector.celery worker --loglevel=info)
[2025-03-15 21:41:09,819: ERROR/MainProcess] Process 'ForkPoolWorker-1' pid:3760 exited with 'exitcode 70'
[2025-03-15 21:41:09,839: ERROR/MainProcess] Task handler raised error: WorkerLostError('Worker exited prematurely: exitcode 70 Job: 0.')
Traceback (most recent call last):
  File "/home/ubuntu/.local/lib/python3.10/site-packages/billiard/pool.py", line 1265, in mark_as_worker_lost
    raise WorkerLostError(
billiard.einfo.ExceptionWithTraceback: 
"""
Traceback (most recent call last):
  File "/home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/worker.py", line 202, in start
    self.blueprint.start(self)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/celery/bootsteps.py", line 365, in start
    return self.obj.start()
  File "/home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py", line 340, in start
    blueprint.start(self)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py", line 746, in start
    c.loop(*c.loop_args())
  File "/home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/loops.py", line 86, in asynloop
    state.maybe_shutdown()
  File "/home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/state.py", line 93, in maybe_shutdown
    raise WorkerShutdown(should_stop)
celery.exceptions.WorkerShutdown: 0

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ubuntu/.local/lib/python3.10/site-packages/billiard/pool.py", line 1265, in mark_as_worker_lost
    raise WorkerLostError(
billiard.exceptions.WorkerLostError: Worker exited prematurely: exitcode 70 Job: 0.
"""
[2025-03-15 21:41:09,839: ERROR/MainProcess] Process 'ForkPoolWorker-2' pid:3761 exited with 'exitcode 70'
 
 -------------- celery@VM-16-2-ubuntu v5.4.0 (opalescent)
--- ***** ----- 
-- ******* ---- Linux-5.15.0-130-generic-x86_64-with-glibc2.35 2025-03-15 21:41:17
- *** --- * --- 
- ** ---------- [config]
- ** ---------- .> app:         tasks:0x7f2e26076830
- ** ---------- .> transport:   redis://localhost:6379/0
- ** ---------- .> results:     disabled://
- *** --- * --- .> concurrency: 2 (prefork)
-- ******* ---- .> task events: OFF (enable -E to monitor tasks in this worker)
--- ***** ----- 
 -------------- [queues]
                .> celery           exchange=celery(direct) key=celery
                

[tasks]
  . traffic_collector.consume_traffic_periodically

[2025-03-15 21:41:17,756: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

[2025-03-15 21:41:17,762: INFO/MainProcess] Connected to redis://localhost:6379/0
[2025-03-15 21:41:17,763: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

[2025-03-15 21:41:17,765: INFO/MainProcess] mingle: searching for neighbors
[2025-03-15 21:41:18,770: INFO/MainProcess] mingle: all alone
[2025-03-15 21:41:18,777: INFO/MainProcess] celery@VM-16-2-ubuntu ready.
[2025-03-15 21:41:18,779: INFO/MainProcess] Task traffic_collector.consume_traffic_periodically[978825c2-13c6-4888-9b3b-8b1dc193ca50] received
2025-03-16 17:20:42,756 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-16 17:20:42,850 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-16 17:20:42,952 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-16 17:20:42,953 - INFO - Starting data generation...
2025-03-16 17:20:42,953 - INFO - API_KNOWLEDGE: [{'number': 'API_2951', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_2952', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}]
2025-03-16 17:20:42,953 - INFO - APP_KNOWLEDGE: {'func_description': 'This is an updated test application', 'normal_seqs': ['There are no example normal seqs'], 'malicious_seqs': ['There are no example malicious seqs'], 'roles': ['admin', 'ordinary_user', 'unlogged_in_user']}
2025-03-16 17:20:43,003 - INFO - Generating simulated API sequences...
2025-03-16 17:20:43,003 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-16 17:20:43,003 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-16 17:20:43,003 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-16 17:20:43,003 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-16 17:20:44,702 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-16 17:20:44,703 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-16 17:20:44,703 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-16 17:20:44,703 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-16 17:20:44,703 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-16 17:20:44,703 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2951', 'API_2952'], 'ordinary_user': [], 'admin': ['API_2951', 'API_2952'], 'oridinary_user': ['API_2951', 'API_2952']}
2025-03-16 17:20:44,703 - INFO - API sequence 1/12 generated
2025-03-16 17:20:44,703 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-16 17:20:44,703 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-16 17:20:44,703 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-16 17:20:44,703 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-16 17:20:45,626 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-16 17:20:45,628 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-16 17:20:45,628 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-16 17:20:45,628 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-16 17:20:45,628 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-16 17:20:45,629 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2951', 'API_2952'], 'ordinary_user': [], 'admin': ['API_2951', 'API_2952'], 'oridinary_user': ['API_2951', 'API_2952']}
2025-03-16 17:20:45,629 - INFO - API sequence 2/12 generated
2025-03-16 17:20:45,629 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-16 17:20:45,629 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-16 17:20:45,629 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-16 17:20:45,629 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-16 17:20:47,034 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-16 17:20:47,035 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-16 17:20:47,035 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-16 17:20:47,035 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-16 17:20:47,035 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-16 17:20:47,035 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2951', 'API_2952'], 'ordinary_user': [], 'admin': ['API_2951', 'API_2952'], 'oridinary_user': ['API_2951', 'API_2952']}
2025-03-16 17:20:47,035 - INFO - API sequence 3/12 generated
2025-03-16 17:20:47,035 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-16 17:20:47,035 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-16 17:20:47,035 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-16 17:20:47,035 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-16 17:20:47,983 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-16 17:20:47,984 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-16 17:20:47,984 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-16 17:20:47,984 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-16 17:20:47,984 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-16 17:20:47,984 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2951', 'API_2952'], 'ordinary_user': [], 'admin': ['API_2951', 'API_2952'], 'oridinary_user': ['API_2951', 'API_2952']}
2025-03-16 17:20:47,985 - INFO - API sequence 4/12 generated
2025-03-16 17:20:47,985 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-16 17:20:47,985 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-16 17:20:47,985 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-16 17:20:47,985 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-16 17:20:48,920 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-16 17:20:48,921 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-16 17:20:48,921 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-16 17:20:48,921 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-16 17:20:48,921 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-16 17:20:48,921 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2951', 'API_2952'], 'ordinary_user': [], 'admin': ['API_2951', 'API_2952'], 'oridinary_user': ['API_2951', 'API_2952']}
2025-03-16 17:20:48,921 - INFO - API sequence 5/12 generated
2025-03-16 17:20:48,921 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-16 17:20:48,921 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-16 17:20:48,921 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-16 17:20:48,921 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-16 17:20:49,796 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-16 17:20:49,797 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-16 17:20:49,797 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-16 17:20:49,797 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-16 17:20:49,797 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-16 17:20:49,797 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2951', 'API_2952'], 'ordinary_user': [], 'admin': ['API_2951', 'API_2952'], 'oridinary_user': ['API_2951', 'API_2952']}
2025-03-16 17:20:49,797 - INFO - API sequence 6/12 generated
2025-03-16 17:20:49,797 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-16 17:20:49,797 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-16 17:20:49,797 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-16 17:20:49,797 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-16 17:20:50,750 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-16 17:20:50,751 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-16 17:20:50,751 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-16 17:20:50,751 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-16 17:20:50,751 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-16 17:20:50,751 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2951', 'API_2952'], 'ordinary_user': [], 'admin': ['API_2951', 'API_2952'], 'oridinary_user': ['API_2951', 'API_2952']}
2025-03-16 17:20:50,751 - INFO - API sequence 7/12 generated
2025-03-16 17:20:50,751 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-16 17:20:50,751 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-16 17:20:50,751 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-16 17:20:50,751 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-16 17:20:51,814 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-16 17:20:51,815 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-16 17:20:51,815 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-16 17:20:51,815 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-16 17:20:51,815 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-16 17:20:51,815 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2951', 'API_2952'], 'ordinary_user': [], 'admin': ['API_2951', 'API_2952'], 'oridinary_user': ['API_2951', 'API_2952']}
2025-03-16 17:20:51,815 - INFO - API sequence 8/12 generated
2025-03-16 17:20:51,815 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-16 17:20:51,815 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-16 17:20:51,815 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-16 17:20:51,815 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-16 17:20:52,894 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-16 17:20:52,896 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-16 17:20:52,896 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-16 17:20:52,896 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-16 17:20:52,896 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-16 17:20:52,896 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2951', 'API_2952'], 'ordinary_user': [], 'admin': ['API_2951', 'API_2952'], 'oridinary_user': ['API_2951', 'API_2952']}
2025-03-16 17:20:52,897 - INFO - API sequence 9/12 generated
2025-03-16 17:20:52,897 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-16 17:20:52,897 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-16 17:20:52,897 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-16 17:20:52,897 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-16 17:20:53,899 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-16 17:20:53,902 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-16 17:20:53,902 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-16 17:20:53,902 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-16 17:20:53,902 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-16 17:20:53,902 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2951', 'API_2952'], 'ordinary_user': [], 'admin': ['API_2951', 'API_2952'], 'oridinary_user': ['API_2951', 'API_2952']}
2025-03-16 17:20:53,902 - INFO - API sequence 10/12 generated
2025-03-16 17:20:53,902 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-16 17:20:53,902 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-16 17:20:53,902 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-16 17:20:53,902 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-16 17:20:54,991 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-16 17:20:54,992 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-16 17:20:54,992 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-16 17:20:54,992 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-16 17:20:54,992 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-16 17:20:54,992 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2951', 'API_2952'], 'ordinary_user': [], 'admin': ['API_2951', 'API_2952'], 'oridinary_user': ['API_2951', 'API_2952']}
2025-03-16 17:20:54,992 - INFO - API sequence 11/12 generated
2025-03-16 17:20:54,992 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-16 17:20:54,992 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-16 17:20:54,992 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-16 17:20:54,992 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-16 17:20:57,021 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-16 17:20:57,022 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-16 17:20:57,022 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-16 17:20:57,022 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-16 17:20:57,022 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-16 17:20:57,022 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2951', 'API_2952'], 'ordinary_user': [], 'admin': ['API_2951', 'API_2952'], 'oridinary_user': ['API_2951', 'API_2952']}
2025-03-16 17:20:57,022 - INFO - API sequence 12/12 generated
2025-03-16 17:20:57,023 - INFO - API sequences serialized to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py/serialized_llm_agents.json
2025-03-16 17:20:57,023 - INFO - Generating simulated traffic data set...
2025-03-16 17:20:57,023 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-16 17:20:57,023 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-16 17:20:57,023 - INFO - error_apis: []
2025-03-16 17:20:57,023 - INFO - Simulated traffic data for 1/12 user collected：user: normaluser malicious: False
2025-03-16 17:20:57,023 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-16 17:20:57,023 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-16 17:20:57,023 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-16 17:20:57,023 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-16 17:20:57,023 - INFO - error_apis: []
2025-03-16 17:20:57,023 - INFO - Simulated traffic data for 2/12 user collected：user: normaluser malicious: True
2025-03-16 17:20:57,023 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-16 17:20:57,024 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-16 17:20:57,024 - INFO - error_apis: []
2025-03-16 17:20:57,024 - INFO - Simulated traffic data for 3/12 user collected：user: normaluser malicious: False
2025-03-16 17:20:57,024 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-16 17:20:57,024 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-16 17:20:57,024 - INFO - error_apis: []
2025-03-16 17:20:57,024 - INFO - Simulated traffic data for 4/12 user collected：user: normaluser malicious: False
2025-03-16 17:20:57,024 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-16 17:20:57,024 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-16 17:20:57,024 - INFO - error_apis: []
2025-03-16 17:20:57,024 - INFO - Simulated traffic data for 5/12 user collected：user: adminuser malicious: False
2025-03-16 17:20:57,024 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-16 17:20:57,024 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-16 17:20:57,024 - INFO - error_apis: []
2025-03-16 17:20:57,024 - INFO - Simulated traffic data for 6/12 user collected：user: normaluser malicious: False
2025-03-16 17:20:57,024 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-16 17:20:57,024 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-16 17:20:57,025 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-16 17:20:57,025 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-16 17:20:57,025 - INFO - error_apis: []
2025-03-16 17:20:57,025 - INFO - Simulated traffic data for 7/12 user collected：user: unloggeduser malicious: True
2025-03-16 17:20:57,025 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-16 17:20:57,025 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-16 17:20:57,025 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-16 17:20:57,025 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-16 17:20:57,025 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-16 17:20:57,025 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：False
2025-03-16 17:20:57,025 - INFO - error_apis: []
2025-03-16 17:20:57,025 - INFO - Simulated traffic data for 8/12 user collected：user: normaluser malicious: True
2025-03-16 17:20:57,025 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-16 17:20:57,025 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-16 17:20:57,025 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-16 17:20:57,025 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-16 17:20:57,025 - INFO - error_apis: []
2025-03-16 17:20:57,026 - INFO - Simulated traffic data for 9/12 user collected：user: unloggeduser malicious: True
2025-03-16 17:20:57,026 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-16 17:20:57,026 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-16 17:20:57,026 - INFO - error_apis: []
2025-03-16 17:20:57,026 - INFO - Simulated traffic data for 10/12 user collected：user: adminuser malicious: False
2025-03-16 17:20:57,026 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-16 17:20:57,026 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-16 17:20:57,026 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-16 17:20:57,026 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-16 17:20:57,026 - INFO - error_apis: []
2025-03-16 17:20:57,026 - INFO - Simulated traffic data for 11/12 user collected：user: normaluser malicious: True
2025-03-16 17:20:57,026 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-16 17:20:57,026 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-16 17:20:57,026 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-16 17:20:57,026 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-16 17:20:57,026 - INFO - error_apis: []
2025-03-16 17:20:57,026 - INFO - Simulated traffic data for 12/12 user collected：user: unloggeduser malicious: True
2025-03-16 17:20:57,028 - INFO - All simulated traffic data collected：/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/simulated_traffic_data.csv
2025-03-16 17:20:57,028 - INFO - error_apis: []
2025-03-16 17:49:21,807 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-16 17:49:21,847 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-16 17:49:21,955 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-16 17:49:21,955 - INFO - Starting data generation...
2025-03-16 17:49:21,955 - INFO - API_KNOWLEDGE: [{'number': 'API_2953', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_2954', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}]
2025-03-16 17:49:21,955 - INFO - APP_KNOWLEDGE: {'func_description': 'This is an updated test application', 'normal_seqs': ['Role: role1; API_2953(); API_2954()'], 'malicious_seqs': ['Role: xxx; API_2953()', 'Role: 22; API_2953(); API_2954()'], 'roles': ['admin', 'ordinary_user', 'unlogged_in_user']}
2025-03-16 17:49:22,005 - INFO - Generating simulated API sequences...
2025-03-16 17:49:22,005 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-16 17:49:22,005 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-16 17:49:22,005 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-16 17:49:22,005 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-16 17:49:22,005 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-16 17:49:24,203 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-16 17:49:24,203 - INFO - ========== Method gen_api_seq() returned: seq=['API_2953', 'API_2954'], malicious_sign_seq=[0, 1] ==========
2025-03-16 17:49:24,203 - INFO - ========== Method gen_api_seq() returned: seq=['API_2953', 'API_2954'], malicious_sign_seq=[0, 1] ==========
2025-03-16 17:49:24,203 - INFO - ========== Method gen_api_seq() returned: seq=['API_2953', 'API_2954'], malicious_sign_seq=[0, 1] ==========
2025-03-16 17:49:24,203 - INFO - ========== Method gen_api_seq() returned: seq=['API_2953', 'API_2954'], malicious_sign_seq=[0, 1] ==========
2025-03-16 17:49:24,203 - INFO - ========== Method gen_api_seq() returned: seq=['API_2953', 'API_2954'], malicious_sign_seq=[0, 1] ==========
2025-03-16 17:49:24,203 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2953', 'API_2954'], 'ordinary_user': [], 'admin': ['API_2953', 'API_2954'], 'oridinary_user': ['API_2953', 'API_2954']}
2025-03-16 17:49:24,204 - INFO - API sequence 1/12 generated
2025-03-16 17:49:24,204 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-16 17:49:24,204 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-16 17:49:24,204 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-16 17:49:24,204 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-16 17:49:24,204 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-16 17:49:25,860 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-16 17:49:25,860 - INFO - ========== Method gen_api_seq() returned: seq=['API_2953'], malicious_sign_seq=[0] ==========
2025-03-16 17:49:25,860 - INFO - ========== Method gen_api_seq() returned: seq=['API_2953'], malicious_sign_seq=[0] ==========
2025-03-16 17:49:25,860 - INFO - ========== Method gen_api_seq() returned: seq=['API_2953'], malicious_sign_seq=[0] ==========
2025-03-16 17:49:25,860 - INFO - ========== Method gen_api_seq() returned: seq=['API_2953'], malicious_sign_seq=[0] ==========
2025-03-16 17:49:25,860 - INFO - ========== Method gen_api_seq() returned: seq=['API_2953'], malicious_sign_seq=[0] ==========
2025-03-16 17:49:25,861 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2953', 'API_2954'], 'ordinary_user': [], 'admin': ['API_2953', 'API_2954'], 'oridinary_user': ['API_2953', 'API_2954']}
2025-03-16 17:49:25,861 - INFO - API sequence 2/12 generated
2025-03-16 17:49:25,861 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-16 17:49:25,861 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-16 17:49:25,861 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-16 17:49:25,861 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-16 17:49:25,861 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-16 17:49:26,760 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-16 17:49:26,761 - INFO - ========== Method gen_api_seq() returned: seq=['API_2953'], malicious_sign_seq=[0] ==========
2025-03-16 17:49:26,761 - INFO - ========== Method gen_api_seq() returned: seq=['API_2953'], malicious_sign_seq=[0] ==========
2025-03-16 17:49:26,761 - INFO - ========== Method gen_api_seq() returned: seq=['API_2953'], malicious_sign_seq=[0] ==========
2025-03-16 17:49:26,761 - INFO - ========== Method gen_api_seq() returned: seq=['API_2953'], malicious_sign_seq=[0] ==========
2025-03-16 17:49:26,761 - INFO - ========== Method gen_api_seq() returned: seq=['API_2953'], malicious_sign_seq=[0] ==========
2025-03-16 17:49:26,761 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2953', 'API_2954'], 'ordinary_user': [], 'admin': ['API_2953', 'API_2954'], 'oridinary_user': ['API_2953', 'API_2954']}
2025-03-16 17:49:26,761 - INFO - API sequence 3/12 generated
2025-03-16 17:49:26,761 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-16 17:49:26,761 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-16 17:49:26,761 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-16 17:49:26,761 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-16 17:49:26,761 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-16 17:49:29,033 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-16 17:49:29,034 - INFO - ========== Method gen_api_seq() returned: seq=['API_2953', 'API_2954'], malicious_sign_seq=[0, 1] ==========
2025-03-16 17:49:29,034 - INFO - ========== Method gen_api_seq() returned: seq=['API_2953', 'API_2954'], malicious_sign_seq=[0, 1] ==========
2025-03-16 17:49:29,034 - INFO - ========== Method gen_api_seq() returned: seq=['API_2953', 'API_2954'], malicious_sign_seq=[0, 1] ==========
2025-03-16 17:49:29,034 - INFO - ========== Method gen_api_seq() returned: seq=['API_2953', 'API_2954'], malicious_sign_seq=[0, 1] ==========
2025-03-16 17:49:29,034 - INFO - ========== Method gen_api_seq() returned: seq=['API_2953', 'API_2954'], malicious_sign_seq=[0, 1] ==========
2025-03-16 17:49:29,034 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2953', 'API_2954'], 'ordinary_user': [], 'admin': ['API_2953', 'API_2954'], 'oridinary_user': ['API_2953', 'API_2954']}
2025-03-16 17:49:29,034 - INFO - API sequence 4/12 generated
2025-03-16 17:49:29,034 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-16 17:49:29,034 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-16 17:49:29,034 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-16 17:49:29,034 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-16 17:49:29,034 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-16 17:49:31,229 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-16 17:49:31,230 - INFO - ========== Method gen_api_seq() returned: seq=['API_2953', 'API_2954'], malicious_sign_seq=[0, 1] ==========
2025-03-16 17:49:31,230 - INFO - ========== Method gen_api_seq() returned: seq=['API_2953', 'API_2954'], malicious_sign_seq=[0, 1] ==========
2025-03-16 17:49:31,230 - INFO - ========== Method gen_api_seq() returned: seq=['API_2953', 'API_2954'], malicious_sign_seq=[0, 1] ==========
2025-03-16 17:49:31,230 - INFO - ========== Method gen_api_seq() returned: seq=['API_2953', 'API_2954'], malicious_sign_seq=[0, 1] ==========
2025-03-16 17:49:31,230 - INFO - ========== Method gen_api_seq() returned: seq=['API_2953', 'API_2954'], malicious_sign_seq=[0, 1] ==========
2025-03-16 17:49:31,230 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2953', 'API_2954'], 'ordinary_user': [], 'admin': ['API_2953', 'API_2954'], 'oridinary_user': ['API_2953', 'API_2954']}
2025-03-16 17:49:31,230 - INFO - API sequence 5/12 generated
2025-03-16 17:49:31,230 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-16 17:49:31,230 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-16 17:49:31,230 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-16 17:49:31,230 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-16 17:49:31,230 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-16 17:49:32,214 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-16 17:49:32,215 - INFO - ========== Method gen_api_seq() returned: seq=['API_2953'], malicious_sign_seq=[0] ==========
2025-03-16 17:49:32,215 - INFO - ========== Method gen_api_seq() returned: seq=['API_2953'], malicious_sign_seq=[0] ==========
2025-03-16 17:49:32,215 - INFO - ========== Method gen_api_seq() returned: seq=['API_2953'], malicious_sign_seq=[0] ==========
2025-03-16 17:49:32,215 - INFO - ========== Method gen_api_seq() returned: seq=['API_2953'], malicious_sign_seq=[0] ==========
2025-03-16 17:49:32,215 - INFO - ========== Method gen_api_seq() returned: seq=['API_2953'], malicious_sign_seq=[0] ==========
2025-03-16 17:49:32,215 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2953', 'API_2954'], 'ordinary_user': [], 'admin': ['API_2953', 'API_2954'], 'oridinary_user': ['API_2953', 'API_2954']}
2025-03-16 17:49:32,215 - INFO - API sequence 6/12 generated
2025-03-16 17:49:32,215 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-16 17:49:32,215 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-16 17:49:32,215 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-16 17:49:32,215 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-16 17:49:32,215 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-16 17:49:33,579 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-16 17:49:33,580 - INFO - ========== Method gen_api_seq() returned: seq=['API_2953', 'API_2954', 'API_2955'], malicious_sign_seq=[0, 0, 1] ==========
2025-03-16 17:49:33,580 - INFO - ========== Method gen_api_seq() returned: seq=['API_2953', 'API_2954', 'API_2955'], malicious_sign_seq=[0, 0, 1] ==========
2025-03-16 17:49:33,580 - INFO - ========== Method gen_api_seq() returned: seq=['API_2953', 'API_2954', 'API_2955'], malicious_sign_seq=[0, 0, 1] ==========
2025-03-16 17:49:33,580 - INFO - ========== Method gen_api_seq() returned: seq=['API_2953', 'API_2954', 'API_2955'], malicious_sign_seq=[0, 0, 1] ==========
2025-03-16 17:49:33,580 - INFO - ========== Method gen_api_seq() returned: seq=['API_2953', 'API_2954', 'API_2955'], malicious_sign_seq=[0, 0, 1] ==========
2025-03-16 17:49:33,580 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2953', 'API_2954'], 'ordinary_user': [], 'admin': ['API_2953', 'API_2954'], 'oridinary_user': ['API_2953', 'API_2954']}
2025-03-16 17:49:33,580 - INFO - API sequence 7/12 generated
2025-03-16 17:49:33,580 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-16 17:49:33,580 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-16 17:49:33,580 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-16 17:49:33,580 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-16 17:49:33,580 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-16 17:49:34,997 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-16 17:49:34,997 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-16 17:49:34,997 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-16 17:49:34,997 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-16 17:49:34,997 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-16 17:49:34,997 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-16 17:49:34,998 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2953', 'API_2954'], 'ordinary_user': [], 'admin': ['API_2953', 'API_2954'], 'oridinary_user': ['API_2953', 'API_2954']}
2025-03-16 17:49:34,998 - INFO - API sequence 8/12 generated
2025-03-16 17:49:34,998 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-16 17:49:34,998 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-16 17:49:34,998 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-16 17:49:34,998 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-16 17:49:34,998 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-16 17:49:36,041 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-16 17:49:36,042 - INFO - ========== Method gen_api_seq() returned: seq=['API_2953', 'API_2954'], malicious_sign_seq=[0, 1] ==========
2025-03-16 17:49:36,042 - INFO - ========== Method gen_api_seq() returned: seq=['API_2953', 'API_2954'], malicious_sign_seq=[0, 1] ==========
2025-03-16 17:49:36,042 - INFO - ========== Method gen_api_seq() returned: seq=['API_2953', 'API_2954'], malicious_sign_seq=[0, 1] ==========
2025-03-16 17:49:36,042 - INFO - ========== Method gen_api_seq() returned: seq=['API_2953', 'API_2954'], malicious_sign_seq=[0, 1] ==========
2025-03-16 17:49:36,042 - INFO - ========== Method gen_api_seq() returned: seq=['API_2953', 'API_2954'], malicious_sign_seq=[0, 1] ==========
2025-03-16 17:49:36,042 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2953', 'API_2954'], 'ordinary_user': [], 'admin': ['API_2953', 'API_2954'], 'oridinary_user': ['API_2953', 'API_2954']}
2025-03-16 17:49:36,042 - INFO - API sequence 9/12 generated
2025-03-16 17:49:36,042 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-16 17:49:36,042 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-16 17:49:36,042 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-16 17:49:36,042 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-16 17:49:36,042 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-16 17:49:37,930 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-16 17:49:37,930 - INFO - ========== Method gen_api_seq() returned: seq=['API_2953'], malicious_sign_seq=[0] ==========
2025-03-16 17:49:37,930 - INFO - ========== Method gen_api_seq() returned: seq=['API_2953'], malicious_sign_seq=[0] ==========
2025-03-16 17:49:37,930 - INFO - ========== Method gen_api_seq() returned: seq=['API_2953'], malicious_sign_seq=[0] ==========
2025-03-16 17:49:37,930 - INFO - ========== Method gen_api_seq() returned: seq=['API_2953'], malicious_sign_seq=[0] ==========
2025-03-16 17:49:37,930 - INFO - ========== Method gen_api_seq() returned: seq=['API_2953'], malicious_sign_seq=[0] ==========
2025-03-16 17:49:37,931 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2953', 'API_2954'], 'ordinary_user': [], 'admin': ['API_2953', 'API_2954'], 'oridinary_user': ['API_2953', 'API_2954']}
2025-03-16 17:49:37,931 - INFO - API sequence 10/12 generated
2025-03-16 17:49:37,931 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-16 17:49:37,931 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-16 17:49:37,931 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-16 17:49:37,931 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-16 17:49:37,931 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-16 17:49:39,220 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-16 17:49:39,221 - INFO - ========== Method gen_api_seq() returned: seq=['API_2953', 'API_2954'], malicious_sign_seq=[0, 1] ==========
2025-03-16 17:49:39,221 - INFO - ========== Method gen_api_seq() returned: seq=['API_2953', 'API_2954'], malicious_sign_seq=[0, 1] ==========
2025-03-16 17:49:39,221 - INFO - ========== Method gen_api_seq() returned: seq=['API_2953', 'API_2954'], malicious_sign_seq=[0, 1] ==========
2025-03-16 17:49:39,221 - INFO - ========== Method gen_api_seq() returned: seq=['API_2953', 'API_2954'], malicious_sign_seq=[0, 1] ==========
2025-03-16 17:49:39,221 - INFO - ========== Method gen_api_seq() returned: seq=['API_2953', 'API_2954'], malicious_sign_seq=[0, 1] ==========
2025-03-16 17:49:39,221 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2953', 'API_2954'], 'ordinary_user': [], 'admin': ['API_2953', 'API_2954'], 'oridinary_user': ['API_2953', 'API_2954']}
2025-03-16 17:49:39,221 - INFO - API sequence 11/12 generated
2025-03-16 17:49:39,221 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-16 17:49:39,221 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-16 17:49:39,221 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-16 17:49:39,221 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-16 17:49:39,221 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-16 17:49:40,279 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-16 17:49:40,280 - INFO - ========== Method gen_api_seq() returned: seq=['API_2953'], malicious_sign_seq=[0] ==========
2025-03-16 17:49:40,280 - INFO - ========== Method gen_api_seq() returned: seq=['API_2953'], malicious_sign_seq=[0] ==========
2025-03-16 17:49:40,280 - INFO - ========== Method gen_api_seq() returned: seq=['API_2953'], malicious_sign_seq=[0] ==========
2025-03-16 17:49:40,280 - INFO - ========== Method gen_api_seq() returned: seq=['API_2953'], malicious_sign_seq=[0] ==========
2025-03-16 17:49:40,280 - INFO - ========== Method gen_api_seq() returned: seq=['API_2953'], malicious_sign_seq=[0] ==========
2025-03-16 17:49:40,280 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2953', 'API_2954'], 'ordinary_user': [], 'admin': ['API_2953', 'API_2954'], 'oridinary_user': ['API_2953', 'API_2954']}
2025-03-16 17:49:40,280 - INFO - API sequence 12/12 generated
2025-03-16 17:49:40,281 - INFO - API sequences serialized to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py/serialized_llm_agents.json
2025-03-16 17:49:40,281 - INFO - Generating simulated traffic data set...
2025-03-16 17:49:40,281 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-16 17:49:40,281 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-16 17:49:40,282 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-16 17:49:40,282 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-16 17:49:40,282 - INFO - error_apis: []
2025-03-16 17:49:40,282 - INFO - Simulated traffic data for 1/12 user collected：user: unloggeduser malicious: True
2025-03-16 17:49:40,282 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-16 17:49:40,282 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-16 17:49:40,282 - INFO - error_apis: []
2025-03-16 17:49:40,282 - INFO - Simulated traffic data for 2/12 user collected：user: normaluser malicious: False
2025-03-16 17:49:40,282 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-16 17:49:40,282 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-16 17:49:40,282 - INFO - error_apis: []
2025-03-16 17:49:40,282 - INFO - Simulated traffic data for 3/12 user collected：user: normaluser malicious: False
2025-03-16 17:49:40,282 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-16 17:49:40,282 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-16 17:49:40,282 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-16 17:49:40,282 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-16 17:49:40,282 - INFO - error_apis: []
2025-03-16 17:49:40,282 - INFO - Simulated traffic data for 4/12 user collected：user: normaluser malicious: True
2025-03-16 17:49:40,283 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-16 17:49:40,283 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-16 17:49:40,283 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-16 17:49:40,283 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-16 17:49:40,283 - INFO - error_apis: []
2025-03-16 17:49:40,283 - INFO - Simulated traffic data for 5/12 user collected：user: unloggeduser malicious: True
2025-03-16 17:49:40,283 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-16 17:49:40,283 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-16 17:49:40,283 - INFO - error_apis: []
2025-03-16 17:49:40,283 - INFO - Simulated traffic data for 6/12 user collected：user: adminuser malicious: False
2025-03-16 17:49:40,283 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-16 17:49:40,283 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-16 17:49:40,283 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-16 17:49:40,283 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-16 17:49:40,283 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-16 17:49:40,284 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-16 17:49:40,284 - INFO - error_apis: []
2025-03-16 17:49:40,284 - INFO - Simulated traffic data for 7/12 user collected：user: normaluser malicious: True
2025-03-16 17:49:40,284 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-16 17:49:40,284 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-16 17:49:40,284 - INFO - error_apis: []
2025-03-16 17:49:40,284 - INFO - Simulated traffic data for 8/12 user collected：user: adminuser malicious: False
2025-03-16 17:49:40,284 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-16 17:49:40,284 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-16 17:49:40,284 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-16 17:49:40,284 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-16 17:49:40,284 - INFO - error_apis: []
2025-03-16 17:49:40,284 - INFO - Simulated traffic data for 9/12 user collected：user: unloggeduser malicious: True
2025-03-16 17:49:40,284 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-16 17:49:40,284 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-16 17:49:40,284 - INFO - error_apis: []
2025-03-16 17:49:40,284 - INFO - Simulated traffic data for 10/12 user collected：user: normaluser malicious: False
2025-03-16 17:49:40,284 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-16 17:49:40,285 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-16 17:49:40,285 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-16 17:49:40,285 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-16 17:49:40,285 - INFO - error_apis: []
2025-03-16 17:49:40,285 - INFO - Simulated traffic data for 11/12 user collected：user: normaluser malicious: True
2025-03-16 17:49:40,285 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-16 17:49:40,285 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-16 17:49:40,285 - INFO - error_apis: []
2025-03-16 17:49:40,285 - INFO - Simulated traffic data for 12/12 user collected：user: normaluser malicious: False
2025-03-16 17:49:40,287 - INFO - All simulated traffic data collected：/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/simulated_traffic_data.csv
2025-03-16 17:49:40,287 - INFO - error_apis: []
2025-03-17 08:42:06,808 - INFO - Detection started. Combined data duration: 10
2025-03-17 08:42:08,759 - INFO - Detection paused.
2025-03-17 08:42:55,775 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-17 08:42:55,874 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-17 08:42:55,983 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-17 08:42:55,983 - INFO - Starting data generation...
2025-03-17 08:42:55,983 - INFO - API_KNOWLEDGE: [{'number': 'API_2955', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_2956', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}]
2025-03-17 08:42:55,983 - INFO - APP_KNOWLEDGE: {'func_description': 'This is an updated test application', 'normal_seqs': ['There are no example normal seqs'], 'malicious_seqs': ['There are no example malicious seqs'], 'roles': ['admin', 'ordinary_user', 'unlogged_in_user']}
2025-03-17 08:42:56,051 - INFO - Generating simulated API sequences...
2025-03-17 08:42:56,051 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 08:42:56,051 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 08:42:56,051 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 08:42:56,051 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 08:42:56,051 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 08:42:56,051 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 08:42:57,141 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 08:42:57,142 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 08:42:57,142 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 08:42:57,142 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 08:42:57,142 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 08:42:57,142 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 08:42:57,142 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 08:42:57,142 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2955', 'API_2956'], 'ordinary_user': [], 'admin': ['API_2955', 'API_2956'], 'oridinary_user': ['API_2955', 'API_2956']}
2025-03-17 08:42:57,142 - INFO - API sequence 1/12 generated
2025-03-17 08:42:57,142 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 08:42:57,142 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 08:42:57,142 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 08:42:57,142 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 08:42:57,142 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 08:42:57,142 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 08:42:58,119 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 08:42:58,120 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 08:42:58,120 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 08:42:58,120 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 08:42:58,120 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 08:42:58,120 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 08:42:58,120 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 08:42:58,121 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2955', 'API_2956'], 'ordinary_user': [], 'admin': ['API_2955', 'API_2956'], 'oridinary_user': ['API_2955', 'API_2956']}
2025-03-17 08:42:58,121 - INFO - API sequence 2/12 generated
2025-03-17 08:42:58,121 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 08:42:58,121 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 08:42:58,121 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 08:42:58,121 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 08:42:58,121 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 08:42:58,121 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 08:42:59,973 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 08:42:59,974 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 08:42:59,974 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 08:42:59,974 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 08:42:59,974 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 08:42:59,974 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 08:42:59,974 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 08:42:59,974 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2955', 'API_2956'], 'ordinary_user': [], 'admin': ['API_2955', 'API_2956'], 'oridinary_user': ['API_2955', 'API_2956']}
2025-03-17 08:42:59,974 - INFO - API sequence 3/12 generated
2025-03-17 08:42:59,974 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 08:42:59,974 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 08:42:59,974 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 08:42:59,974 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 08:42:59,974 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 08:42:59,974 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 08:43:01,437 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 08:43:01,438 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 08:43:01,438 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 08:43:01,438 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 08:43:01,438 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 08:43:01,438 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 08:43:01,438 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 08:43:01,438 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2955', 'API_2956'], 'ordinary_user': [], 'admin': ['API_2955', 'API_2956'], 'oridinary_user': ['API_2955', 'API_2956']}
2025-03-17 08:43:01,438 - INFO - API sequence 4/12 generated
2025-03-17 08:43:01,438 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 08:43:01,438 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 08:43:01,438 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 08:43:01,438 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 08:43:01,438 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 08:43:01,438 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 08:43:02,403 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 08:43:02,403 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 08:43:02,403 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 08:43:02,403 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 08:43:02,403 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 08:43:02,403 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 08:43:02,403 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 08:43:02,404 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2955', 'API_2956'], 'ordinary_user': [], 'admin': ['API_2955', 'API_2956'], 'oridinary_user': ['API_2955', 'API_2956']}
2025-03-17 08:43:02,404 - INFO - API sequence 5/12 generated
2025-03-17 08:43:02,404 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 08:43:02,404 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 08:43:02,404 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 08:43:02,404 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 08:43:02,404 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 08:43:02,404 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 08:43:03,946 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 08:43:03,947 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 08:43:03,947 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 08:43:03,947 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 08:43:03,947 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 08:43:03,947 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 08:43:03,947 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 08:43:03,947 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2955', 'API_2956'], 'ordinary_user': [], 'admin': ['API_2955', 'API_2956'], 'oridinary_user': ['API_2955', 'API_2956']}
2025-03-17 08:43:03,947 - INFO - API sequence 6/12 generated
2025-03-17 08:43:03,947 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 08:43:03,947 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 08:43:03,947 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 08:43:03,947 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 08:43:03,947 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 08:43:03,947 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 08:43:05,779 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 08:43:05,782 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 08:43:05,782 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 08:43:05,782 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 08:43:05,782 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 08:43:05,782 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 08:43:05,782 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 08:43:05,782 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2955', 'API_2956'], 'ordinary_user': [], 'admin': ['API_2955', 'API_2956'], 'oridinary_user': ['API_2955', 'API_2956']}
2025-03-17 08:43:05,782 - INFO - API sequence 7/12 generated
2025-03-17 08:43:05,782 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 08:43:05,782 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 08:43:05,782 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 08:43:05,782 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 08:43:05,782 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 08:43:05,782 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 08:43:06,586 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 08:43:06,587 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 08:43:06,587 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 08:43:06,587 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 08:43:06,587 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 08:43:06,587 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 08:43:06,587 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 08:43:06,587 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2955', 'API_2956'], 'ordinary_user': [], 'admin': ['API_2955', 'API_2956'], 'oridinary_user': ['API_2955', 'API_2956']}
2025-03-17 08:43:06,587 - INFO - API sequence 8/12 generated
2025-03-17 08:43:06,587 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 08:43:06,587 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 08:43:06,587 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 08:43:06,587 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 08:43:06,587 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 08:43:06,587 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 08:43:08,112 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 08:43:08,113 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 08:43:08,113 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 08:43:08,113 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 08:43:08,113 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 08:43:08,113 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 08:43:08,113 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 08:43:08,113 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2955', 'API_2956'], 'ordinary_user': [], 'admin': ['API_2955', 'API_2956'], 'oridinary_user': ['API_2955', 'API_2956']}
2025-03-17 08:43:08,114 - INFO - API sequence 9/12 generated
2025-03-17 08:43:08,114 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 08:43:08,114 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 08:43:08,114 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 08:43:08,114 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 08:43:08,114 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 08:43:08,114 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 08:43:08,905 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 08:43:08,906 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 08:43:08,906 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 08:43:08,906 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 08:43:08,906 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 08:43:08,906 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 08:43:08,906 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 08:43:08,906 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2955', 'API_2956'], 'ordinary_user': [], 'admin': ['API_2955', 'API_2956'], 'oridinary_user': ['API_2955', 'API_2956']}
2025-03-17 08:43:08,906 - INFO - API sequence 10/12 generated
2025-03-17 08:43:08,906 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 08:43:08,906 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 08:43:08,906 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 08:43:08,906 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 08:43:08,906 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 08:43:08,906 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 08:43:11,124 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 08:43:11,125 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-17 08:43:11,125 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-17 08:43:11,125 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-17 08:43:11,125 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-17 08:43:11,125 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-17 08:43:11,125 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-17 08:43:11,125 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2955', 'API_2956'], 'ordinary_user': [], 'admin': ['API_2955', 'API_2956'], 'oridinary_user': ['API_2955', 'API_2956']}
2025-03-17 08:43:11,125 - INFO - API sequence 11/12 generated
2025-03-17 08:43:11,125 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 08:43:11,125 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 08:43:11,125 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 08:43:11,125 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 08:43:11,125 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 08:43:11,125 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 08:43:12,121 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 08:43:12,122 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 08:43:12,122 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 08:43:12,122 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 08:43:12,122 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 08:43:12,122 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 08:43:12,122 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 08:43:12,123 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2955', 'API_2956'], 'ordinary_user': [], 'admin': ['API_2955', 'API_2956'], 'oridinary_user': ['API_2955', 'API_2956']}
2025-03-17 08:43:12,123 - INFO - API sequence 12/12 generated
2025-03-17 08:43:12,123 - INFO - API sequences serialized to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py/serialized_llm_agents.json
2025-03-17 08:43:12,123 - INFO - Generating simulated traffic data set...
2025-03-17 08:43:12,124 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-17 08:43:12,124 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 08:43:12,124 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-17 08:43:12,124 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-17 08:43:12,124 - INFO - error_apis: []
2025-03-17 08:43:12,124 - INFO - Simulated traffic data for 1/12 user collected：user: normaluser malicious: True
2025-03-17 08:43:12,124 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-17 08:43:12,124 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 08:43:12,124 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-17 08:43:12,124 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-17 08:43:12,124 - INFO - error_apis: []
2025-03-17 08:43:12,124 - INFO - Simulated traffic data for 2/12 user collected：user: unloggeduser malicious: True
2025-03-17 08:43:12,125 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-17 08:43:12,125 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 08:43:12,125 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-17 08:43:12,125 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-17 08:43:12,125 - INFO - error_apis: []
2025-03-17 08:43:12,125 - INFO - Simulated traffic data for 3/12 user collected：user: unloggeduser malicious: True
2025-03-17 08:43:12,125 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-17 08:43:12,125 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 08:43:12,125 - INFO - error_apis: []
2025-03-17 08:43:12,125 - INFO - Simulated traffic data for 4/12 user collected：user: normaluser malicious: False
2025-03-17 08:43:12,126 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-17 08:43:12,126 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 08:43:12,126 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-17 08:43:12,126 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-17 08:43:12,126 - INFO - error_apis: []
2025-03-17 08:43:12,126 - INFO - Simulated traffic data for 5/12 user collected：user: normaluser malicious: True
2025-03-17 08:43:12,126 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-17 08:43:12,126 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 08:43:12,126 - INFO - error_apis: []
2025-03-17 08:43:12,126 - INFO - Simulated traffic data for 6/12 user collected：user: adminuser malicious: False
2025-03-17 08:43:12,126 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-17 08:43:12,126 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 08:43:12,127 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-17 08:43:12,127 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-17 08:43:12,127 - INFO - error_apis: []
2025-03-17 08:43:12,127 - INFO - Simulated traffic data for 7/12 user collected：user: normaluser malicious: True
2025-03-17 08:43:12,127 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-17 08:43:12,127 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 08:43:12,127 - INFO - error_apis: []
2025-03-17 08:43:12,127 - INFO - Simulated traffic data for 8/12 user collected：user: normaluser malicious: False
2025-03-17 08:43:12,127 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-17 08:43:12,127 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 08:43:12,127 - INFO - error_apis: []
2025-03-17 08:43:12,127 - INFO - Simulated traffic data for 9/12 user collected：user: normaluser malicious: False
2025-03-17 08:43:12,127 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-17 08:43:12,127 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 08:43:12,128 - INFO - error_apis: []
2025-03-17 08:43:12,128 - INFO - Simulated traffic data for 10/12 user collected：user: adminuser malicious: False
2025-03-17 08:43:12,128 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-17 08:43:12,128 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 08:43:12,128 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-17 08:43:12,128 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-17 08:43:12,128 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-17 08:43:12,128 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：False
2025-03-17 08:43:12,128 - INFO - error_apis: []
2025-03-17 08:43:12,128 - INFO - Simulated traffic data for 11/12 user collected：user: unloggeduser malicious: True
2025-03-17 08:43:12,128 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-17 08:43:12,129 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 08:43:12,129 - INFO - error_apis: []
2025-03-17 08:43:12,129 - INFO - Simulated traffic data for 12/12 user collected：user: normaluser malicious: False
2025-03-17 08:43:12,132 - INFO - All simulated traffic data collected：/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/simulated_traffic_data.csv
2025-03-17 08:43:12,132 - INFO - error_apis: []
2025-03-17 08:44:14,379 - INFO - Trying to construct model...
2025-03-17 08:44:14,379 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-17 08:44:14,446 - INFO - Training model... Size of feature_list: 7
2025-03-17 08:44:14,461 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 08:44:14,471 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 08:44:14,473 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 08:44:14,475 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 08:44:14,476 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 08:44:14,478 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 08:44:14,479 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 08:44:14,481 - INFO - Extracting features... Size of feature_list: 7
[08:44:14] WARNING: /workspace/src/learner.cc:740: 
Parameters: { "use_label_encoder" } are not used.

2025-03-17 08:44:14,626 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 08:44:14,628 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 08:44:14,629 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 08:44:14,630 - INFO - Extracting features... Size of feature_list: 7
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
2025-03-17 08:44:14,642 - INFO - Model constructed.
2025-03-17 08:46:57,894 - INFO - Detection started. Combined data duration: 10
2025-03-17 08:46:59,074 - INFO - Detection paused.
2025-03-17 09:01:09,771 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-17 09:01:09,815 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-17 09:01:09,925 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-17 09:01:09,925 - INFO - Starting data generation...
2025-03-17 09:01:09,925 - INFO - API_KNOWLEDGE: [{'number': 'API_2957', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_2958', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}]
2025-03-17 09:01:09,925 - INFO - APP_KNOWLEDGE: {'func_description': 'This is an updated test application', 'normal_seqs': ['There are no example normal seqs'], 'malicious_seqs': ['There are no example malicious seqs'], 'roles': ['admin', 'ordinary_user', 'unlogged_in_user']}
2025-03-17 09:01:09,975 - INFO - Generating simulated API sequences...
2025-03-17 09:01:09,975 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 09:01:09,975 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 09:01:09,975 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 09:01:09,975 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 09:01:09,975 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 09:01:09,975 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 09:01:09,975 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 09:01:10,984 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 09:01:10,985 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:01:10,985 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:01:10,985 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:01:10,985 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:01:10,985 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:01:10,985 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:01:10,985 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:01:10,985 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2957', 'API_2958'], 'ordinary_user': [], 'admin': ['API_2957', 'API_2958'], 'oridinary_user': ['API_2957', 'API_2958']}
2025-03-17 09:01:10,985 - INFO - API sequence 1/12 generated
2025-03-17 09:01:10,985 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 09:01:10,985 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 09:01:10,985 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 09:01:10,985 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 09:01:10,985 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 09:01:10,985 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 09:01:10,985 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 09:01:12,579 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 09:01:12,580 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:01:12,580 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:01:12,580 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:01:12,580 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:01:12,580 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:01:12,580 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:01:12,580 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:01:12,580 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2957', 'API_2958'], 'ordinary_user': [], 'admin': ['API_2957', 'API_2958'], 'oridinary_user': ['API_2957', 'API_2958']}
2025-03-17 09:01:12,580 - INFO - API sequence 2/12 generated
2025-03-17 09:01:12,581 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 09:01:12,581 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 09:01:12,581 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 09:01:12,581 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 09:01:12,581 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 09:01:12,581 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 09:01:12,581 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 09:01:13,461 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 09:01:13,462 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 09:01:13,462 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 09:01:13,462 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 09:01:13,462 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 09:01:13,462 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 09:01:13,462 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 09:01:13,462 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 09:01:13,462 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2957', 'API_2958'], 'ordinary_user': [], 'admin': ['API_2957', 'API_2958'], 'oridinary_user': ['API_2957', 'API_2958']}
2025-03-17 09:01:13,462 - INFO - API sequence 3/12 generated
2025-03-17 09:01:13,462 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 09:01:13,462 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 09:01:13,462 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 09:01:13,462 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 09:01:13,462 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 09:01:13,462 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 09:01:13,462 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 09:01:15,582 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 09:01:15,586 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 09:01:15,586 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 09:01:15,586 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 09:01:15,586 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 09:01:15,586 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 09:01:15,586 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 09:01:15,586 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 09:01:15,586 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2957', 'API_2958'], 'ordinary_user': [], 'admin': ['API_2957', 'API_2958'], 'oridinary_user': ['API_2957', 'API_2958']}
2025-03-17 09:01:15,586 - INFO - API sequence 4/12 generated
2025-03-17 09:01:15,586 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 09:01:15,586 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 09:01:15,586 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 09:01:15,586 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 09:01:15,586 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 09:01:15,586 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 09:01:15,586 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 09:01:18,073 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 09:01:18,074 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-17 09:01:18,074 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-17 09:01:18,074 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-17 09:01:18,074 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-17 09:01:18,074 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-17 09:01:18,074 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-17 09:01:18,074 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-17 09:01:18,074 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2957', 'API_2958'], 'ordinary_user': [], 'admin': ['API_2957', 'API_2958'], 'oridinary_user': ['API_2957', 'API_2958']}
2025-03-17 09:01:18,074 - INFO - API sequence 5/12 generated
2025-03-17 09:01:18,074 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 09:01:18,074 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 09:01:18,074 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 09:01:18,074 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 09:01:18,074 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 09:01:18,074 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 09:01:18,074 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 09:01:18,934 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 09:01:18,935 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:01:18,935 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:01:18,935 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:01:18,935 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:01:18,935 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:01:18,935 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:01:18,935 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:01:18,936 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2957', 'API_2958'], 'ordinary_user': [], 'admin': ['API_2957', 'API_2958'], 'oridinary_user': ['API_2957', 'API_2958']}
2025-03-17 09:01:18,936 - INFO - API sequence 6/12 generated
2025-03-17 09:01:18,936 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 09:01:18,936 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 09:01:18,936 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 09:01:18,936 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 09:01:18,936 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 09:01:18,936 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 09:01:18,936 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 09:01:20,439 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 09:01:20,440 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:01:20,440 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:01:20,440 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:01:20,440 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:01:20,440 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:01:20,440 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:01:20,440 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:01:20,441 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2957', 'API_2958'], 'ordinary_user': [], 'admin': ['API_2957', 'API_2958'], 'oridinary_user': ['API_2957', 'API_2958']}
2025-03-17 09:01:20,441 - INFO - API sequence 7/12 generated
2025-03-17 09:01:20,441 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 09:01:20,441 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 09:01:20,441 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 09:01:20,441 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 09:01:20,441 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 09:01:20,441 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 09:01:20,441 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 09:01:21,656 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 09:01:21,657 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-17 09:01:21,657 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-17 09:01:21,657 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-17 09:01:21,657 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-17 09:01:21,657 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-17 09:01:21,657 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-17 09:01:21,657 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-17 09:01:21,658 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2957', 'API_2958'], 'ordinary_user': [], 'admin': ['API_2957', 'API_2958'], 'oridinary_user': ['API_2957', 'API_2958']}
2025-03-17 09:01:21,658 - INFO - API sequence 8/12 generated
2025-03-17 09:01:21,658 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 09:01:21,658 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 09:01:21,658 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 09:01:21,658 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 09:01:21,658 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 09:01:21,658 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 09:01:21,658 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 09:01:22,580 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 09:01:22,581 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:01:22,581 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:01:22,581 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:01:22,581 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:01:22,581 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:01:22,581 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:01:22,581 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:01:22,581 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2957', 'API_2958'], 'ordinary_user': [], 'admin': ['API_2957', 'API_2958'], 'oridinary_user': ['API_2957', 'API_2958']}
2025-03-17 09:01:22,581 - INFO - API sequence 9/12 generated
2025-03-17 09:01:22,581 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 09:01:22,581 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 09:01:22,581 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 09:01:22,581 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 09:01:22,581 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 09:01:22,581 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 09:01:22,581 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 09:01:23,581 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 09:01:23,583 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 09:01:23,583 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 09:01:23,583 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 09:01:23,583 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 09:01:23,583 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 09:01:23,583 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 09:01:23,583 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 09:01:23,583 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2957', 'API_2958'], 'ordinary_user': [], 'admin': ['API_2957', 'API_2958'], 'oridinary_user': ['API_2957', 'API_2958']}
2025-03-17 09:01:23,583 - INFO - API sequence 10/12 generated
2025-03-17 09:01:23,583 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 09:01:23,583 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 09:01:23,583 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 09:01:23,583 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 09:01:23,583 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 09:01:23,583 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 09:01:23,583 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 09:01:25,467 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 09:01:25,470 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 09:01:25,470 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 09:01:25,470 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 09:01:25,470 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 09:01:25,470 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 09:01:25,470 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 09:01:25,470 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 09:01:25,470 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2957', 'API_2958'], 'ordinary_user': [], 'admin': ['API_2957', 'API_2958'], 'oridinary_user': ['API_2957', 'API_2958']}
2025-03-17 09:01:25,470 - INFO - API sequence 11/12 generated
2025-03-17 09:01:25,470 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 09:01:25,470 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 09:01:25,470 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 09:01:25,470 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 09:01:25,470 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 09:01:25,470 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 09:01:25,470 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 09:01:26,294 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 09:01:26,295 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:01:26,295 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:01:26,295 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:01:26,295 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:01:26,295 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:01:26,295 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:01:26,295 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:01:26,295 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2957', 'API_2958'], 'ordinary_user': [], 'admin': ['API_2957', 'API_2958'], 'oridinary_user': ['API_2957', 'API_2958']}
2025-03-17 09:01:26,295 - INFO - API sequence 12/12 generated
2025-03-17 09:01:26,295 - INFO - API sequences serialized to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py/serialized_llm_agents.json
2025-03-17 09:01:26,295 - INFO - Generating simulated traffic data set...
2025-03-17 09:01:26,296 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-17 09:01:26,296 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 09:01:26,296 - INFO - error_apis: []
2025-03-17 09:01:26,296 - INFO - Simulated traffic data for 1/12 user collected：user: normaluser malicious: False
2025-03-17 09:01:26,296 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-17 09:01:26,296 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 09:01:26,296 - INFO - error_apis: []
2025-03-17 09:01:26,296 - INFO - Simulated traffic data for 2/12 user collected：user: normaluser malicious: False
2025-03-17 09:01:26,296 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-17 09:01:26,296 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 09:01:26,297 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-17 09:01:26,297 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-17 09:01:26,297 - INFO - error_apis: []
2025-03-17 09:01:26,297 - INFO - Simulated traffic data for 3/12 user collected：user: normaluser malicious: True
2025-03-17 09:01:26,297 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-17 09:01:26,297 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 09:01:26,297 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-17 09:01:26,297 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-17 09:01:26,297 - INFO - error_apis: []
2025-03-17 09:01:26,297 - INFO - Simulated traffic data for 4/12 user collected：user: unloggeduser malicious: True
2025-03-17 09:01:26,298 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-17 09:01:26,298 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 09:01:26,298 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-17 09:01:26,298 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-17 09:01:26,298 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-17 09:01:26,298 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：False
2025-03-17 09:01:26,298 - INFO - error_apis: []
2025-03-17 09:01:26,298 - INFO - Simulated traffic data for 5/12 user collected：user: normaluser malicious: True
2025-03-17 09:01:26,298 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-17 09:01:26,298 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 09:01:26,298 - INFO - error_apis: []
2025-03-17 09:01:26,298 - INFO - Simulated traffic data for 6/12 user collected：user: adminuser malicious: False
2025-03-17 09:01:26,299 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-17 09:01:26,299 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 09:01:26,299 - INFO - error_apis: []
2025-03-17 09:01:26,299 - INFO - Simulated traffic data for 7/12 user collected：user: normaluser malicious: False
2025-03-17 09:01:26,299 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-17 09:01:26,299 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 09:01:26,299 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-17 09:01:26,299 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-17 09:01:26,299 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-17 09:01:26,299 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：False
2025-03-17 09:01:26,299 - INFO - error_apis: []
2025-03-17 09:01:26,299 - INFO - Simulated traffic data for 8/12 user collected：user: unloggeduser malicious: True
2025-03-17 09:01:26,300 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-17 09:01:26,300 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 09:01:26,300 - INFO - error_apis: []
2025-03-17 09:01:26,300 - INFO - Simulated traffic data for 9/12 user collected：user: adminuser malicious: False
2025-03-17 09:01:26,300 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-17 09:01:26,300 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 09:01:26,300 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-17 09:01:26,300 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-17 09:01:26,300 - INFO - error_apis: []
2025-03-17 09:01:26,300 - INFO - Simulated traffic data for 10/12 user collected：user: unloggeduser malicious: True
2025-03-17 09:01:26,300 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-17 09:01:26,301 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 09:01:26,301 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-17 09:01:26,301 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-17 09:01:26,301 - INFO - error_apis: []
2025-03-17 09:01:26,301 - INFO - Simulated traffic data for 11/12 user collected：user: normaluser malicious: True
2025-03-17 09:01:26,301 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-17 09:01:26,301 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 09:01:26,301 - INFO - error_apis: []
2025-03-17 09:01:26,301 - INFO - Simulated traffic data for 12/12 user collected：user: normaluser malicious: False
2025-03-17 09:01:26,303 - INFO - All simulated traffic data collected：/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/simulated_traffic_data.csv
2025-03-17 09:01:26,304 - INFO - error_apis: []
2025-03-17 09:02:07,560 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-17 09:02:07,604 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-17 09:02:07,746 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-17 09:02:07,746 - INFO - Starting data generation...
2025-03-17 09:02:07,746 - INFO - API_KNOWLEDGE: [{'number': 'API_2959', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_2960', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}]
2025-03-17 09:02:07,746 - INFO - APP_KNOWLEDGE: {'func_description': 'This is an updated test application', 'normal_seqs': ['There are no example normal seqs'], 'malicious_seqs': ['There are no example malicious seqs'], 'roles': ['admin', 'ordinary_user', 'unlogged_in_user']}
2025-03-17 09:02:07,798 - INFO - Generating simulated API sequences...
2025-03-17 09:02:07,799 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 09:02:07,799 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 09:02:07,799 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 09:02:07,799 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 09:02:07,799 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 09:02:07,799 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 09:02:07,799 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 09:02:07,799 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 09:02:08,950 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 09:02:08,951 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 09:02:08,951 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 09:02:08,951 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 09:02:08,951 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 09:02:08,951 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 09:02:08,951 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 09:02:08,951 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 09:02:08,951 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 09:02:08,952 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2959', 'API_2960'], 'ordinary_user': [], 'admin': ['API_2959', 'API_2960'], 'oridinary_user': ['API_2959', 'API_2960']}
2025-03-17 09:02:08,952 - INFO - API sequence 1/12 generated
2025-03-17 09:02:08,952 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 09:02:08,952 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 09:02:08,952 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 09:02:08,952 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 09:02:08,952 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 09:02:08,952 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 09:02:08,952 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 09:02:08,952 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 09:02:10,877 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 09:02:10,878 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 09:02:10,878 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 09:02:10,878 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 09:02:10,878 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 09:02:10,878 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 09:02:10,878 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 09:02:10,878 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 09:02:10,878 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 09:02:10,879 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2959', 'API_2960'], 'ordinary_user': [], 'admin': ['API_2959', 'API_2960'], 'oridinary_user': ['API_2959', 'API_2960']}
2025-03-17 09:02:10,879 - INFO - API sequence 2/12 generated
2025-03-17 09:02:10,879 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 09:02:10,879 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 09:02:10,879 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 09:02:10,879 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 09:02:10,879 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 09:02:10,879 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 09:02:10,879 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 09:02:10,879 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 09:02:11,874 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 09:02:11,875 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-17 09:02:11,875 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-17 09:02:11,875 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-17 09:02:11,875 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-17 09:02:11,875 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-17 09:02:11,875 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-17 09:02:11,875 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-17 09:02:11,875 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-17 09:02:11,875 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2959', 'API_2960'], 'ordinary_user': [], 'admin': ['API_2959', 'API_2960'], 'oridinary_user': ['API_2959', 'API_2960']}
2025-03-17 09:02:11,875 - INFO - API sequence 3/12 generated
2025-03-17 09:02:11,875 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 09:02:11,875 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 09:02:11,875 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 09:02:11,875 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 09:02:11,875 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 09:02:11,875 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 09:02:11,875 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 09:02:11,875 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 09:02:13,764 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 09:02:13,765 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 09:02:13,765 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 09:02:13,765 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 09:02:13,765 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 09:02:13,765 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 09:02:13,765 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 09:02:13,765 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 09:02:13,765 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 09:02:13,765 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2959', 'API_2960'], 'ordinary_user': [], 'admin': ['API_2959', 'API_2960'], 'oridinary_user': ['API_2959', 'API_2960']}
2025-03-17 09:02:13,765 - INFO - API sequence 4/12 generated
2025-03-17 09:02:13,765 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 09:02:13,765 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 09:02:13,765 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 09:02:13,765 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 09:02:13,765 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 09:02:13,765 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 09:02:13,765 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 09:02:13,765 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 09:02:14,716 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 09:02:14,717 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:02:14,717 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:02:14,717 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:02:14,717 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:02:14,717 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:02:14,717 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:02:14,717 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:02:14,717 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:02:14,718 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2959', 'API_2960'], 'ordinary_user': [], 'admin': ['API_2959', 'API_2960'], 'oridinary_user': ['API_2959', 'API_2960']}
2025-03-17 09:02:14,718 - INFO - API sequence 5/12 generated
2025-03-17 09:02:14,718 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 09:02:14,718 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 09:02:14,718 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 09:02:14,718 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 09:02:14,718 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 09:02:14,718 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 09:02:14,718 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 09:02:14,718 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 09:02:15,811 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 09:02:15,812 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:02:15,812 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:02:15,812 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:02:15,812 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:02:15,812 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:02:15,812 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:02:15,812 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:02:15,812 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:02:15,812 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2959', 'API_2960'], 'ordinary_user': [], 'admin': ['API_2959', 'API_2960'], 'oridinary_user': ['API_2959', 'API_2960']}
2025-03-17 09:02:15,812 - INFO - API sequence 6/12 generated
2025-03-17 09:02:15,812 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 09:02:15,812 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 09:02:15,812 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 09:02:15,812 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 09:02:15,812 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 09:02:15,812 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 09:02:15,812 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 09:02:15,812 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 09:02:16,860 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 09:02:16,862 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 09:02:16,862 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 09:02:16,862 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 09:02:16,862 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 09:02:16,862 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 09:02:16,862 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 09:02:16,862 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 09:02:16,862 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 09:02:16,863 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2959', 'API_2960'], 'ordinary_user': [], 'admin': ['API_2959', 'API_2960'], 'oridinary_user': ['API_2959', 'API_2960']}
2025-03-17 09:02:16,863 - INFO - API sequence 7/12 generated
2025-03-17 09:02:16,863 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 09:02:16,863 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 09:02:16,863 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 09:02:16,863 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 09:02:16,863 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 09:02:16,863 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 09:02:16,863 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 09:02:16,863 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 09:02:17,820 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 09:02:17,821 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:02:17,821 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:02:17,821 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:02:17,821 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:02:17,821 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:02:17,821 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:02:17,821 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:02:17,821 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:02:17,822 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2959', 'API_2960'], 'ordinary_user': [], 'admin': ['API_2959', 'API_2960'], 'oridinary_user': ['API_2959', 'API_2960']}
2025-03-17 09:02:17,822 - INFO - API sequence 8/12 generated
2025-03-17 09:02:17,822 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 09:02:17,822 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 09:02:17,822 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 09:02:17,822 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 09:02:17,822 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 09:02:17,822 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 09:02:17,822 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 09:02:17,822 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 09:02:18,724 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 09:02:18,725 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 09:02:18,725 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 09:02:18,725 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 09:02:18,725 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 09:02:18,725 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 09:02:18,725 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 09:02:18,725 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 09:02:18,725 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 09:02:18,725 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2959', 'API_2960'], 'ordinary_user': [], 'admin': ['API_2959', 'API_2960'], 'oridinary_user': ['API_2959', 'API_2960']}
2025-03-17 09:02:18,725 - INFO - API sequence 9/12 generated
2025-03-17 09:02:18,725 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 09:02:18,725 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 09:02:18,725 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 09:02:18,725 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 09:02:18,725 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 09:02:18,725 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 09:02:18,725 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 09:02:18,725 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 09:02:19,561 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 09:02:19,562 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:02:19,562 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:02:19,562 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:02:19,562 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:02:19,562 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:02:19,562 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:02:19,562 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:02:19,562 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:02:19,562 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2959', 'API_2960'], 'ordinary_user': [], 'admin': ['API_2959', 'API_2960'], 'oridinary_user': ['API_2959', 'API_2960']}
2025-03-17 09:02:19,562 - INFO - API sequence 10/12 generated
2025-03-17 09:02:19,562 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 09:02:19,562 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 09:02:19,562 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 09:02:19,562 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 09:02:19,562 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 09:02:19,562 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 09:02:19,562 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 09:02:19,562 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 09:02:21,097 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 09:02:21,098 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:02:21,098 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:02:21,098 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:02:21,098 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:02:21,098 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:02:21,098 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:02:21,098 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:02:21,098 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:02:21,099 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2959', 'API_2960'], 'ordinary_user': [], 'admin': ['API_2959', 'API_2960'], 'oridinary_user': ['API_2959', 'API_2960']}
2025-03-17 09:02:21,099 - INFO - API sequence 11/12 generated
2025-03-17 09:02:21,099 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 09:02:21,099 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 09:02:21,099 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 09:02:21,099 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 09:02:21,099 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 09:02:21,099 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 09:02:21,099 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 09:02:21,099 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 09:02:22,751 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 09:02:22,752 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:02:22,752 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:02:22,752 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:02:22,752 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:02:22,752 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:02:22,752 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:02:22,752 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:02:22,752 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 09:02:22,752 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_2959', 'API_2960'], 'ordinary_user': [], 'admin': ['API_2959', 'API_2960'], 'oridinary_user': ['API_2959', 'API_2960']}
2025-03-17 09:02:22,753 - INFO - API sequence 12/12 generated
2025-03-17 09:02:22,754 - INFO - API sequences serialized to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py/serialized_llm_agents.json
2025-03-17 09:02:22,754 - INFO - Generating simulated traffic data set...
2025-03-17 09:02:22,754 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-17 09:02:22,754 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 09:02:22,754 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-17 09:02:22,754 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-17 09:02:22,754 - INFO - error_apis: []
2025-03-17 09:02:22,755 - INFO - Simulated traffic data for 1/12 user collected：user: normaluser malicious: True
2025-03-17 09:02:22,755 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-17 09:02:22,755 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 09:02:22,755 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-17 09:02:22,755 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-17 09:02:22,755 - INFO - error_apis: []
2025-03-17 09:02:22,755 - INFO - Simulated traffic data for 2/12 user collected：user: normaluser malicious: True
2025-03-17 09:02:22,755 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-17 09:02:22,755 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 09:02:22,755 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-17 09:02:22,756 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-17 09:02:22,756 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-17 09:02:22,756 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：False
2025-03-17 09:02:22,756 - INFO - error_apis: []
2025-03-17 09:02:22,756 - INFO - Simulated traffic data for 3/12 user collected：user: normaluser malicious: True
2025-03-17 09:02:22,756 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-17 09:02:22,756 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 09:02:22,756 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-17 09:02:22,756 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-17 09:02:22,756 - INFO - error_apis: []
2025-03-17 09:02:22,756 - INFO - Simulated traffic data for 4/12 user collected：user: unloggeduser malicious: True
2025-03-17 09:02:22,757 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-17 09:02:22,757 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 09:02:22,757 - INFO - error_apis: []
2025-03-17 09:02:22,757 - INFO - Simulated traffic data for 5/12 user collected：user: normaluser malicious: False
2025-03-17 09:02:22,757 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-17 09:02:22,757 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 09:02:22,757 - INFO - error_apis: []
2025-03-17 09:02:22,757 - INFO - Simulated traffic data for 6/12 user collected：user: adminuser malicious: False
2025-03-17 09:02:22,757 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-17 09:02:22,757 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 09:02:22,757 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-17 09:02:22,757 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-17 09:02:22,758 - INFO - error_apis: []
2025-03-17 09:02:22,758 - INFO - Simulated traffic data for 7/12 user collected：user: unloggeduser malicious: True
2025-03-17 09:02:22,758 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-17 09:02:22,758 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 09:02:22,758 - INFO - error_apis: []
2025-03-17 09:02:22,758 - INFO - Simulated traffic data for 8/12 user collected：user: adminuser malicious: False
2025-03-17 09:02:22,758 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-17 09:02:22,758 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 09:02:22,758 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-17 09:02:22,758 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-17 09:02:22,758 - INFO - error_apis: []
2025-03-17 09:02:22,758 - INFO - Simulated traffic data for 9/12 user collected：user: unloggeduser malicious: True
2025-03-17 09:02:22,759 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-17 09:02:22,759 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 09:02:22,759 - INFO - error_apis: []
2025-03-17 09:02:22,759 - INFO - Simulated traffic data for 10/12 user collected：user: normaluser malicious: False
2025-03-17 09:02:22,759 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-17 09:02:22,759 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 09:02:22,759 - INFO - error_apis: []
2025-03-17 09:02:22,759 - INFO - Simulated traffic data for 11/12 user collected：user: normaluser malicious: False
2025-03-17 09:02:22,759 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-17 09:02:22,759 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 09:02:22,759 - INFO - error_apis: []
2025-03-17 09:02:22,759 - INFO - Simulated traffic data for 12/12 user collected：user: normaluser malicious: False
2025-03-17 09:02:22,762 - INFO - All simulated traffic data collected：/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/simulated_traffic_data.csv
2025-03-17 09:02:22,762 - INFO - error_apis: []
2025-03-17 09:05:43,780 - INFO - Trying to construct model...
2025-03-17 09:05:43,780 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-17 09:05:43,810 - INFO - Training model... Size of feature_list: 7
2025-03-17 09:05:43,819 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 09:05:43,821 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 09:05:43,822 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 09:05:43,824 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 09:05:43,825 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 09:05:43,826 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 09:05:43,827 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 09:05:43,828 - INFO - Extracting features... Size of feature_list: 7
[09:05:43] WARNING: /workspace/src/learner.cc:740: 
Parameters: { "use_label_encoder" } are not used.

2025-03-17 09:05:43,857 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 09:05:43,859 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 09:05:43,860 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 09:05:43,861 - INFO - Extracting features... Size of feature_list: 7
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
2025-03-17 09:05:43,872 - INFO - Model constructed.
2025-03-17 09:18:03,270 - INFO - Detection started. Combined data duration: 10
2025-03-17 09:24:07,569 - INFO - Detection paused.
2025-03-17 09:26:20,694 - INFO - Detection started. Combined data duration: 10
2025-03-17 09:26:22,364 - INFO - Detection paused.
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-03-17 09:50:57,700 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-15 02:16:38', 'last_model_construction_at': '2025-03-17 01:05:43', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.0, 0.0, 0.0, 2.0, 0.5, 1.0, 0.67, 2.0, 0.5, 4.0, 0.25, 0.5, 0.33, 4.0, 0.25, 0.5, 0.33, 4.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-17 09:50:57,713 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-03-17 10:01:31,952 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-15 02:16:38', 'last_model_construction_at': '2025-03-17 01:05:43', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.0, 0.0, 0.0, 2.0, 0.5, 1.0, 0.67, 2.0, 0.5, 4.0, 0.25, 0.5, 0.33, 4.0, 0.25, 0.5, 0.33, 4.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-17 10:01:31,953 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
 * Serving Flask app 'app'
 * Debug mode: on
 
 -------------- celery@VM-16-2-ubuntu v5.4.0 (opalescent)
--- ***** ----- 
-- ******* ---- Linux-5.15.0-130-generic-x86_64-with-glibc2.35 2025-03-17 10:01:35
- *** --- * --- 
- ** ---------- [config]
- ** ---------- .> app:         tasks:0x7f3ba5f5bfd0
- ** ---------- .> transport:   redis://localhost:6379/0
- ** ---------- .> results:     disabled://
- *** --- * --- .> concurrency: 2 (prefork)
-- ******* ---- .> task events: OFF (enable -E to monitor tasks in this worker)
--- ***** ----- 
 -------------- [queues]
                .> celery           exchange=celery(direct) key=celery
                

[tasks]
  . traffic_collector.consume_traffic_periodically

None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-03-17 10:01:35,742 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-15 02:16:38', 'last_model_construction_at': '2025-03-17 01:05:43', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.0, 0.0, 0.0, 2.0, 0.5, 1.0, 0.67, 2.0, 0.5, 4.0, 0.25, 0.5, 0.33, 4.0, 0.25, 0.5, 0.33, 4.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-17 10:01:35,742 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
[2025-03-17 10:01:35,845: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

[2025-03-17 10:01:35,858: INFO/MainProcess] Connected to redis://localhost:6379/0
[2025-03-17 10:01:35,859: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

[2025-03-17 10:01:35,865: INFO/MainProcess] mingle: searching for neighbors
[2025-03-17 10:01:36,871: INFO/MainProcess] mingle: all alone
[2025-03-17 10:01:36,879: INFO/MainProcess] celery@VM-16-2-ubuntu ready.
[2025-03-17 10:01:36,882: INFO/MainProcess] Task traffic_collector.consume_traffic_periodically[4e95f885-c612-44e0-bdb2-ebc0097ab21f] received
[2025-03-17 10:01:36,887: ERROR/MainProcess] Received unregistered task of type '__mitmproxy_script__.traffic_collector.consume_traffic_periodically'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[[], {}, {"callbacks": null, "errbacks": null, "chain": null, "chord": null}]' (77b)

The full contents of the message headers:
{'lang': 'py', 'task': '__mitmproxy_script__.traffic_collector.consume_traffic_periodically', 'id': '8faef45d-60a7-4481-a139-4a25c0ee61a6', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': '8faef45d-60a7-4481-a139-4a25c0ee61a6', 'parent_id': None, 'argsrepr': '()', 'kwargsrepr': '{}', 'origin': 'gen3450@VM-16-2-ubuntu', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "/home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
KeyError: '__mitmproxy_script__.traffic_collector.consume_traffic_periodically'
2025-03-17 10:02:09,134 - INFO - Detection started. Combined data duration: 10
2025-03-17 10:02:46,945 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 7
2025-03-17 10:02:47,000 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 10:02:47,014 - INFO - [{'MeanUrlParamsCount': 0.0, 'RepeatUrlVisitCount': 0.0, 'DeepPageVisitRate': 0.0, 'MeanUrlPathDepth': 0.0, 'MeanUrlLength': 25.0, 'UniquePageVisitCount': 1, 'SeqOccurTime_38164fbd17603d73f696b8b4d72664d735bb6a7c88577687fd2ae33fd6964153': 0}]
2025-03-17 10:02:47,014 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 10:02:47,049 - INFO - A new detect record generated; Traffic data size: 1
2025-03-17 10:02:57,156 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 7
2025-03-17 10:02:57,157 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 10:02:57,173 - INFO - [{'MeanUrlParamsCount': 0.0, 'RepeatUrlVisitCount': 1.0, 'DeepPageVisitRate': 0.0, 'MeanUrlPathDepth': 0.9, 'MeanUrlLength': 64.8, 'UniquePageVisitCount': 9, 'SeqOccurTime_38164fbd17603d73f696b8b4d72664d735bb6a7c88577687fd2ae33fd6964153': 0}]
2025-03-17 10:02:57,173 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 10:02:57,204 - INFO - A new detect record generated; Traffic data size: 10
2025-03-17 10:03:07,219 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 7
2025-03-17 10:03:07,221 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 10:03:07,226 - INFO - [{'MeanUrlParamsCount': 0.0, 'RepeatUrlVisitCount': 1.0, 'DeepPageVisitRate': 0.0, 'MeanUrlPathDepth': 1.0, 'MeanUrlLength': 62.6, 'UniquePageVisitCount': 4, 'SeqOccurTime_38164fbd17603d73f696b8b4d72664d735bb6a7c88577687fd2ae33fd6964153': 1}]
2025-03-17 10:03:07,226 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 10:03:07,285 - INFO - A new detect record generated; Traffic data size: 5
2025-03-17 10:03:17,302 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 7
2025-03-17 10:03:17,303 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 10:03:17,344 - INFO - [{'MeanUrlParamsCount': 0.0, 'RepeatUrlVisitCount': 5.0, 'DeepPageVisitRate': 0.0, 'MeanUrlPathDepth': 1.0, 'MeanUrlLength': 62.333333333333336, 'UniquePageVisitCount': 7, 'SeqOccurTime_38164fbd17603d73f696b8b4d72664d735bb6a7c88577687fd2ae33fd6964153': 2}]
2025-03-17 10:03:17,344 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 10:03:17,404 - INFO - A new detect record generated; Traffic data size: 18
2025-03-17 10:03:27,422 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 7
2025-03-17 10:03:27,424 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 10:03:27,482 - INFO - [{'MeanUrlParamsCount': 0.0, 'RepeatUrlVisitCount': 7.0, 'DeepPageVisitRate': 0.0, 'MeanUrlPathDepth': 1.0, 'MeanUrlLength': 62.36363636363637, 'UniquePageVisitCount': 8, 'SeqOccurTime_38164fbd17603d73f696b8b4d72664d735bb6a7c88577687fd2ae33fd6964153': 3}]
2025-03-17 10:03:27,482 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 10:03:27,562 - INFO - A new detect record generated; Traffic data size: 22
2025-03-17 10:03:37,574 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 7
2025-03-17 10:03:37,576 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 10:03:37,578 - INFO - [{'MeanUrlParamsCount': 0.0, 'RepeatUrlVisitCount': 0.0, 'DeepPageVisitRate': 0.0, 'MeanUrlPathDepth': 1.0, 'MeanUrlLength': 62.0, 'UniquePageVisitCount': 1, 'SeqOccurTime_38164fbd17603d73f696b8b4d72664d735bb6a7c88577687fd2ae33fd6964153': 0}]
2025-03-17 10:03:37,578 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 10:03:37,607 - INFO - A new detect record generated; Traffic data size: 1
2025-03-17 10:04:01,058 - INFO - Detection paused.
2025-03-17 10:08:41,338 - INFO - Detection started. Combined data duration: 10
2025-03-17 10:09:17,891 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 7
2025-03-17 10:09:17,892 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 10:09:17,969 - INFO - [{'MeanUrlParamsCount': 0.0, 'RepeatUrlVisitCount': 2.0, 'DeepPageVisitRate': 0.0, 'MeanUrlPathDepth': 1.0, 'MeanUrlLength': 60.69230769230769, 'UniquePageVisitCount': 2, 'SeqOccurTime_38164fbd17603d73f696b8b4d72664d735bb6a7c88577687fd2ae33fd6964153': 0}]
2025-03-17 10:09:17,969 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 10:09:18,068 - INFO - A new detect record generated; Traffic data size: 26
2025-03-17 10:09:28,081 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 7
2025-03-17 10:09:28,083 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 10:09:28,084 - INFO - [{'MeanUrlParamsCount': 0.0, 'RepeatUrlVisitCount': 0.0, 'DeepPageVisitRate': 0.0, 'MeanUrlPathDepth': 1.0, 'MeanUrlLength': 62.0, 'UniquePageVisitCount': 1, 'SeqOccurTime_38164fbd17603d73f696b8b4d72664d735bb6a7c88577687fd2ae33fd6964153': 0}]
2025-03-17 10:09:28,084 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 10:09:28,105 - INFO - A new detect record generated; Traffic data size: 1
2025-03-17 10:09:38,117 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 7
2025-03-17 10:09:38,119 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 10:09:38,120 - INFO - [{'MeanUrlParamsCount': 0.0, 'RepeatUrlVisitCount': 0.0, 'DeepPageVisitRate': 0.0, 'MeanUrlPathDepth': 1.0, 'MeanUrlLength': 66.0, 'UniquePageVisitCount': 1, 'SeqOccurTime_38164fbd17603d73f696b8b4d72664d735bb6a7c88577687fd2ae33fd6964153': 0}]
2025-03-17 10:09:38,120 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 10:09:38,141 - INFO - A new detect record generated; Traffic data size: 1
2025-03-17 10:09:48,155 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 7
2025-03-17 10:09:48,156 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 10:09:48,159 - INFO - [{'MeanUrlParamsCount': 0.0, 'RepeatUrlVisitCount': 1.0, 'DeepPageVisitRate': 0.0, 'MeanUrlPathDepth': 0.5, 'MeanUrlLength': 42.25, 'UniquePageVisitCount': 3, 'SeqOccurTime_38164fbd17603d73f696b8b4d72664d735bb6a7c88577687fd2ae33fd6964153': 0}]
2025-03-17 10:09:48,159 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 10:09:48,182 - INFO - A new detect record generated; Traffic data size: 4
2025-03-17 10:09:58,273 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 7
2025-03-17 10:09:58,274 - INFO - Extracting features... Size of feature_list: 7
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 1536, in __call__
    return self.wsgi_app(environ, start_response)
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/./app.py", line 599, in detect_traffic_data_seq
    anomaly_detection(app_data_seq)
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/enhanced_detector.py", line 115, in anomaly_detection
    detection_result = xgboost_user_classification(
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/enhanced_detector.py", line 88, in xgboost_user_classification
    LOGGER.info([extract_features(real_data, features=algorithm.entity.feature.APP_FEATURES)])
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/model_training.py", line 22, in extract_features
    feats[feature.signature] = feature.get_val(df)
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/entity/feature.py", line 35, in get_val
    return float(data_seq['url'].apply(lambda url: len(parse_qsl(urlparse(url).query))).mean())
  File "/usr/local/lib/python3.10/dist-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/usr/local/lib/python3.10/dist-packages/pandas/core/indexes/range.py", line 417, in get_loc
    raise KeyError(key)
KeyError: 'url'
2025-03-17 10:10:08,393 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 7
2025-03-17 10:10:08,395 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 10:10:08,399 - INFO - [{'MeanUrlParamsCount': 0.0, 'RepeatUrlVisitCount': 1.0, 'DeepPageVisitRate': 0.0, 'MeanUrlPathDepth': 0.8, 'MeanUrlLength': 66.2, 'UniquePageVisitCount': 4, 'SeqOccurTime_38164fbd17603d73f696b8b4d72664d735bb6a7c88577687fd2ae33fd6964153': 0}]
2025-03-17 10:10:08,399 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 10:10:08,424 - INFO - A new detect record generated; Traffic data size: 5
2025-03-17 10:10:18,444 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 7
2025-03-17 10:10:18,445 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 10:10:18,453 - INFO - [{'MeanUrlParamsCount': 0.0, 'RepeatUrlVisitCount': 1.0, 'DeepPageVisitRate': 0.0, 'MeanUrlPathDepth': 0.875, 'MeanUrlLength': 68.0, 'UniquePageVisitCount': 6, 'SeqOccurTime_38164fbd17603d73f696b8b4d72664d735bb6a7c88577687fd2ae33fd6964153': 0}]
2025-03-17 10:10:18,453 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 10:10:18,553 - INFO - A new detect record generated; Traffic data size: 8
2025-03-17 10:10:48,573 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 7
2025-03-17 10:10:48,574 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 10:10:48,575 - INFO - [{'MeanUrlParamsCount': 0.0, 'RepeatUrlVisitCount': 0.0, 'DeepPageVisitRate': 0.0, 'MeanUrlPathDepth': 1.0, 'MeanUrlLength': 57.0, 'UniquePageVisitCount': 1, 'SeqOccurTime_38164fbd17603d73f696b8b4d72664d735bb6a7c88577687fd2ae33fd6964153': 0}]
2025-03-17 10:10:48,575 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 10:10:48,597 - INFO - A new detect record generated; Traffic data size: 1
2025-03-17 10:11:18,628 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 7
2025-03-17 10:11:18,630 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 10:11:18,631 - INFO - [{'MeanUrlParamsCount': 0.0, 'RepeatUrlVisitCount': 0.0, 'DeepPageVisitRate': 0.0, 'MeanUrlPathDepth': 1.0, 'MeanUrlLength': 63.0, 'UniquePageVisitCount': 1, 'SeqOccurTime_38164fbd17603d73f696b8b4d72664d735bb6a7c88577687fd2ae33fd6964153': 0}]
2025-03-17 10:11:18,631 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 10:11:18,652 - INFO - A new detect record generated; Traffic data size: 1
2025-03-17 10:11:28,663 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 7
2025-03-17 10:11:28,664 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 10:11:28,674 - INFO - [{'MeanUrlParamsCount': 0.0, 'RepeatUrlVisitCount': 2.0, 'DeepPageVisitRate': 0.0, 'MeanUrlPathDepth': 1.0, 'MeanUrlLength': 62.77777777777778, 'UniquePageVisitCount': 7, 'SeqOccurTime_38164fbd17603d73f696b8b4d72664d735bb6a7c88577687fd2ae33fd6964153': 1}]
2025-03-17 10:11:28,674 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 10:11:28,705 - INFO - A new detect record generated; Traffic data size: 9
2025-03-17 10:12:08,747 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 7
2025-03-17 10:12:08,748 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 10:12:08,758 - INFO - [{'MeanUrlParamsCount': 0.0, 'RepeatUrlVisitCount': 2.0, 'DeepPageVisitRate': 0.0, 'MeanUrlPathDepth': 1.0, 'MeanUrlLength': 62.44444444444444, 'UniquePageVisitCount': 6, 'SeqOccurTime_38164fbd17603d73f696b8b4d72664d735bb6a7c88577687fd2ae33fd6964153': 1}]
2025-03-17 10:12:08,758 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 10:12:08,790 - INFO - A new detect record generated; Traffic data size: 9
2025-03-17 10:12:18,801 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 7
2025-03-17 10:12:18,802 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 10:12:18,804 - INFO - [{'MeanUrlParamsCount': 0.0, 'RepeatUrlVisitCount': 0.0, 'DeepPageVisitRate': 0.0, 'MeanUrlPathDepth': 1.0, 'MeanUrlLength': 66.5, 'UniquePageVisitCount': 2, 'SeqOccurTime_38164fbd17603d73f696b8b4d72664d735bb6a7c88577687fd2ae33fd6964153': 0}]
2025-03-17 10:12:18,804 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 10:12:18,826 - INFO - A new detect record generated; Traffic data size: 2
2025-03-17 10:12:58,869 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 7
2025-03-17 10:12:58,870 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 10:12:58,871 - INFO - [{'MeanUrlParamsCount': 0.0, 'RepeatUrlVisitCount': 0.0, 'DeepPageVisitRate': 0.0, 'MeanUrlPathDepth': 1.0, 'MeanUrlLength': 62.0, 'UniquePageVisitCount': 1, 'SeqOccurTime_38164fbd17603d73f696b8b4d72664d735bb6a7c88577687fd2ae33fd6964153': 0}]
2025-03-17 10:12:58,871 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 10:12:58,894 - INFO - A new detect record generated; Traffic data size: 1
2025-03-17 10:13:27,695 - INFO - Detection paused.
2025-03-17 10:13:28,918 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 7
2025-03-17 10:13:28,920 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 10:13:28,921 - INFO - [{'MeanUrlParamsCount': 0.0, 'RepeatUrlVisitCount': 0.0, 'DeepPageVisitRate': 0.0, 'MeanUrlPathDepth': 1.0, 'MeanUrlLength': 74.0, 'UniquePageVisitCount': 1, 'SeqOccurTime_38164fbd17603d73f696b8b4d72664d735bb6a7c88577687fd2ae33fd6964153': 0}]
2025-03-17 10:13:28,921 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 10:13:28,943 - INFO - A new detect record generated; Traffic data size: 1
2025-03-17 11:59:26,252 - INFO - Detection started. Combined data duration: 10
2025-03-17 12:23:44,717 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 7
2025-03-17 12:23:44,718 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 12:23:44,719 - INFO - [{'MeanUrlParamsCount': 0.0, 'RepeatUrlVisitCount': 0.0, 'DeepPageVisitRate': 0.0, 'MeanUrlPathDepth': 1.0, 'MeanUrlLength': 62.0, 'UniquePageVisitCount': 1, 'SeqOccurTime_38164fbd17603d73f696b8b4d72664d735bb6a7c88577687fd2ae33fd6964153': 0}]
2025-03-17 12:23:44,720 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 12:23:44,742 - INFO - A new detect record generated; Traffic data size: 1
2025-03-17 12:24:44,779 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 7
2025-03-17 12:24:44,781 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 12:24:44,782 - INFO - [{'MeanUrlParamsCount': 0.0, 'RepeatUrlVisitCount': 0.0, 'DeepPageVisitRate': 0.0, 'MeanUrlPathDepth': 1.0, 'MeanUrlLength': 62.0, 'UniquePageVisitCount': 1, 'SeqOccurTime_38164fbd17603d73f696b8b4d72664d735bb6a7c88577687fd2ae33fd6964153': 0}]
2025-03-17 12:24:44,782 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 12:24:44,805 - INFO - A new detect record generated; Traffic data size: 1
2025-03-17 15:30:58,984 - INFO - Detection paused.
2025-03-17 15:54:01,145 - INFO - Trying to construct model...
2025-03-17 15:54:01,148 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-17 15:54:01,311 - INFO - Training model... Size of feature_list: 7
2025-03-17 15:54:01,338 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 15:54:01,342 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 15:54:01,344 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 15:54:01,345 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 15:54:01,347 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 15:54:01,348 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 15:54:01,349 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 15:54:01,351 - INFO - Extracting features... Size of feature_list: 7
[15:54:01] WARNING: /workspace/src/learner.cc:740: 
Parameters: { "use_label_encoder" } are not used.

2025-03-17 15:54:01,551 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 15:54:01,553 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 15:54:01,556 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 15:54:01,557 - INFO - Extracting features... Size of feature_list: 7
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
2025-03-17 15:54:01,575 - INFO - Model constructed.

Restarting celery worker (/home/ubuntu/.local/bin/celery -A traffic_collector.celery worker --loglevel=info)
[2025-03-17 16:21:21,499: ERROR/MainProcess] Process 'ForkPoolWorker-2' pid:3517 exited with 'exitcode 70'
[2025-03-17 16:21:21,510: ERROR/MainProcess] Process 'ForkPoolWorker-1' pid:3501 exited with 'exitcode 70'
[2025-03-17 16:21:21,526: ERROR/MainProcess] Task handler raised error: WorkerLostError('Worker exited prematurely: exitcode 70 Job: 0.')
Traceback (most recent call last):
  File "/home/ubuntu/.local/lib/python3.10/site-packages/billiard/pool.py", line 1265, in mark_as_worker_lost
    raise WorkerLostError(
billiard.einfo.ExceptionWithTraceback: 
"""
Traceback (most recent call last):
  File "/home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/worker.py", line 202, in start
    self.blueprint.start(self)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/celery/bootsteps.py", line 365, in start
    return self.obj.start()
  File "/home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py", line 340, in start
    blueprint.start(self)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py", line 746, in start
    c.loop(*c.loop_args())
  File "/home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/loops.py", line 86, in asynloop
    state.maybe_shutdown()
  File "/home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/state.py", line 93, in maybe_shutdown
    raise WorkerShutdown(should_stop)
celery.exceptions.WorkerShutdown: 0

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ubuntu/.local/lib/python3.10/site-packages/billiard/pool.py", line 1265, in mark_as_worker_lost
    raise WorkerLostError(
billiard.exceptions.WorkerLostError: Worker exited prematurely: exitcode 70 Job: 0.
"""
 
 -------------- celery@VM-16-2-ubuntu v5.4.0 (opalescent)
--- ***** ----- 
-- ******* ---- Linux-5.15.0-130-generic-x86_64-with-glibc2.35 2025-03-17 16:21:26
- *** --- * --- 
- ** ---------- [config]
- ** ---------- .> app:         tasks:0x7f4b4f75e830
- ** ---------- .> transport:   redis://localhost:6379/0
- ** ---------- .> results:     disabled://
- *** --- * --- .> concurrency: 2 (prefork)
-- ******* ---- .> task events: OFF (enable -E to monitor tasks in this worker)
--- ***** ----- 
 -------------- [queues]
                .> celery           exchange=celery(direct) key=celery
                

[tasks]
  . traffic_collector.consume_traffic_periodically

[2025-03-17 16:21:27,196: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

[2025-03-17 16:21:27,201: INFO/MainProcess] Connected to redis://localhost:6379/0
[2025-03-17 16:21:27,201: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

[2025-03-17 16:21:27,204: INFO/MainProcess] mingle: searching for neighbors
[2025-03-17 16:21:28,209: INFO/MainProcess] mingle: all alone
[2025-03-17 16:21:28,215: INFO/MainProcess] celery@VM-16-2-ubuntu ready.
[2025-03-17 16:21:28,217: INFO/MainProcess] Task traffic_collector.consume_traffic_periodically[9f0c102a-a844-4e96-a3a9-9efbd21314e0] received
2025-03-17 16:31:07,078 - INFO - Detection started. Combined data duration: 10
2025-03-17 16:33:08,051 - INFO - Detection paused.
2025-03-17 16:33:09,629 - INFO - Detection started. Combined data duration: 10
2025-03-17 16:35:49,239 - INFO - Detection paused.
2025-03-17 16:35:50,261 - INFO - Detection started. Combined data duration: 10
2025-03-17 16:35:51,199 - INFO - Detection paused.
2025-03-17 16:35:53,150 - INFO - Detection started. Combined data duration: 10
2025-03-17 16:35:54,057 - INFO - Detection paused.
2025-03-17 16:46:16,443 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-17 16:46:16,615 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-17 16:46:16,615 - INFO - Extracting API list with API discovery algorithm...
2025-03-17 16:46:16,684 - INFO - Starting Drain3 template miner
2025-03-17 16:46:16,688 - INFO - Starting Drain3 template miner
2025-03-17 16:46:16,691 - INFO - Starting Drain3 template miner
2025-03-17 16:46:16,692 - INFO - Starting Drain3 template miner
2025-03-17 16:46:16,692 - INFO - Starting Drain3 template miner
2025-03-17 16:46:18,459 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-17 16:46:46,933 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-17 16:46:46,980 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-17 16:46:46,980 - INFO - Extracting API list with API discovery algorithm...
2025-03-17 16:46:47,043 - INFO - Starting Drain3 template miner
2025-03-17 16:46:47,046 - INFO - Starting Drain3 template miner
2025-03-17 16:46:47,048 - INFO - Starting Drain3 template miner
2025-03-17 16:46:47,048 - INFO - Starting Drain3 template miner
2025-03-17 16:46:47,049 - INFO - Starting Drain3 template miner
2025-03-17 16:46:48,798 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-17 16:47:19,366 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-17 16:47:19,411 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-17 16:47:19,411 - INFO - Extracting API list with API discovery algorithm...
2025-03-17 16:47:19,474 - INFO - Starting Drain3 template miner
2025-03-17 16:47:19,477 - INFO - Starting Drain3 template miner
2025-03-17 16:47:19,479 - INFO - Starting Drain3 template miner
2025-03-17 16:47:19,480 - INFO - Starting Drain3 template miner
2025-03-17 16:47:19,480 - INFO - Starting Drain3 template miner
2025-03-17 16:47:21,217 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-17 16:47:39,937 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-17 16:47:39,982 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-17 16:47:39,982 - INFO - Extracting API list with API discovery algorithm...
2025-03-17 16:47:40,046 - INFO - Starting Drain3 template miner
2025-03-17 16:47:40,048 - INFO - Starting Drain3 template miner
2025-03-17 16:47:40,051 - INFO - Starting Drain3 template miner
2025-03-17 16:47:40,051 - INFO - Starting Drain3 template miner
2025-03-17 16:47:40,052 - INFO - Starting Drain3 template miner
2025-03-17 16:47:41,804 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-17 16:47:51,019 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-17 16:47:51,063 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-17 16:47:51,063 - INFO - Extracting API list with API discovery algorithm...
2025-03-17 16:47:51,125 - INFO - Starting Drain3 template miner
2025-03-17 16:47:51,128 - INFO - Starting Drain3 template miner
2025-03-17 16:47:51,130 - INFO - Starting Drain3 template miner
2025-03-17 16:47:51,131 - INFO - Starting Drain3 template miner
2025-03-17 16:47:51,131 - INFO - Starting Drain3 template miner
2025-03-17 16:47:52,898 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-17 16:48:57,982 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-17 16:48:58,026 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-17 16:48:58,198 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-17 16:48:58,198 - INFO - Starting data generation...
2025-03-17 16:48:58,199 - INFO - API_KNOWLEDGE: [{'number': 'API_3282', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_3283', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}]
2025-03-17 16:48:58,199 - INFO - APP_KNOWLEDGE: {'func_description': 'This is an updated test application', 'normal_seqs': ['There are no example normal seqs'], 'malicious_seqs': ['There are no example malicious seqs'], 'roles': ['admin', 'ordinary_user', 'unlogged_in_user']}
2025-03-17 16:48:58,411 - INFO - Generating simulated API sequences...
2025-03-17 16:48:58,411 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 16:48:58,411 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 16:48:59,839 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 16:48:59,878 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:48:59,878 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:48:59,878 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3282', 'API_3283'], 'ordinary_user': [], 'admin': ['API_3282', 'API_3283'], 'oridinary_user': ['API_3282', 'API_3283']}
2025-03-17 16:48:59,878 - INFO - API sequence 1/12 generated
2025-03-17 16:48:59,878 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 16:48:59,878 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 16:49:02,183 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 16:49:02,184 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:49:02,184 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:49:02,184 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3282', 'API_3283'], 'ordinary_user': [], 'admin': ['API_3282', 'API_3283'], 'oridinary_user': ['API_3282', 'API_3283']}
2025-03-17 16:49:02,184 - INFO - API sequence 2/12 generated
2025-03-17 16:49:02,184 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 16:49:02,184 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 16:49:03,813 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 16:49:03,813 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-17 16:49:03,813 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-17 16:49:03,814 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3282', 'API_3283'], 'ordinary_user': [], 'admin': ['API_3282', 'API_3283'], 'oridinary_user': ['API_3282', 'API_3283']}
2025-03-17 16:49:03,814 - INFO - API sequence 3/12 generated
2025-03-17 16:49:03,814 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 16:49:03,814 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 16:49:06,813 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 16:49:06,814 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:49:06,814 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:49:06,814 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3282', 'API_3283'], 'ordinary_user': [], 'admin': ['API_3282', 'API_3283'], 'oridinary_user': ['API_3282', 'API_3283']}
2025-03-17 16:49:06,814 - INFO - API sequence 4/12 generated
2025-03-17 16:49:06,814 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 16:49:06,814 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 16:49:09,497 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 16:49:09,498 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:49:09,498 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:49:09,498 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3282', 'API_3283'], 'ordinary_user': [], 'admin': ['API_3282', 'API_3283'], 'oridinary_user': ['API_3282', 'API_3283']}
2025-03-17 16:49:09,498 - INFO - API sequence 5/12 generated
2025-03-17 16:49:09,498 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 16:49:09,498 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 16:49:13,558 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 16:49:13,559 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:49:13,559 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:49:13,559 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3282', 'API_3283'], 'ordinary_user': [], 'admin': ['API_3282', 'API_3283'], 'oridinary_user': ['API_3282', 'API_3283']}
2025-03-17 16:49:13,559 - INFO - API sequence 6/12 generated
2025-03-17 16:49:13,559 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 16:49:13,559 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 16:49:15,122 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 16:49:15,123 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:49:15,123 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:49:15,123 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3282', 'API_3283'], 'ordinary_user': [], 'admin': ['API_3282', 'API_3283'], 'oridinary_user': ['API_3282', 'API_3283']}
2025-03-17 16:49:15,124 - INFO - API sequence 7/12 generated
2025-03-17 16:49:15,124 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 16:49:15,124 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 16:49:17,094 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 16:49:17,095 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:49:17,095 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:49:17,095 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3282', 'API_3283'], 'ordinary_user': [], 'admin': ['API_3282', 'API_3283'], 'oridinary_user': ['API_3282', 'API_3283']}
2025-03-17 16:49:17,095 - INFO - API sequence 8/12 generated
2025-03-17 16:49:17,095 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 16:49:17,095 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 16:49:19,065 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 16:49:19,066 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:49:19,066 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:49:19,066 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3282', 'API_3283'], 'ordinary_user': [], 'admin': ['API_3282', 'API_3283'], 'oridinary_user': ['API_3282', 'API_3283']}
2025-03-17 16:49:19,066 - INFO - API sequence 9/12 generated
2025-03-17 16:49:19,066 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 16:49:19,066 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 16:49:21,478 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 16:49:21,479 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:49:21,479 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:49:21,480 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3282', 'API_3283'], 'ordinary_user': [], 'admin': ['API_3282', 'API_3283'], 'oridinary_user': ['API_3282', 'API_3283']}
2025-03-17 16:49:21,480 - INFO - API sequence 10/12 generated
2025-03-17 16:49:21,480 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 16:49:21,480 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 16:49:23,513 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 16:49:23,513 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:49:23,513 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:49:23,514 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3282', 'API_3283'], 'ordinary_user': [], 'admin': ['API_3282', 'API_3283'], 'oridinary_user': ['API_3282', 'API_3283']}
2025-03-17 16:49:23,514 - INFO - API sequence 11/12 generated
2025-03-17 16:49:23,514 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 16:49:23,514 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 16:49:26,564 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 16:49:26,565 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:49:26,565 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:49:26,566 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3282', 'API_3283'], 'ordinary_user': [], 'admin': ['API_3282', 'API_3283'], 'oridinary_user': ['API_3282', 'API_3283']}
2025-03-17 16:49:26,566 - INFO - API sequence 12/12 generated
2025-03-17 16:49:26,567 - INFO - API sequences serialized to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py/serialized_llm_agents.json
2025-03-17 16:49:26,567 - INFO - Generating simulated traffic data set...
2025-03-17 16:49:26,571 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-17 16:49:26,571 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 16:49:26,574 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-17 16:49:26,574 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-17 16:49:26,574 - INFO - error_apis: []
2025-03-17 16:49:26,574 - INFO - Simulated traffic data for 1/12 user collected：user: unloggeduser malicious: True
2025-03-17 16:49:26,577 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-17 16:49:26,577 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 16:49:26,577 - INFO - error_apis: []
2025-03-17 16:49:26,577 - INFO - Simulated traffic data for 2/12 user collected：user: normaluser malicious: False
2025-03-17 16:49:26,580 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-17 16:49:26,580 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 16:49:26,583 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-17 16:49:26,584 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-17 16:49:26,586 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-17 16:49:26,587 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：False
2025-03-17 16:49:26,587 - INFO - error_apis: []
2025-03-17 16:49:26,587 - INFO - Simulated traffic data for 3/12 user collected：user: normaluser malicious: True
2025-03-17 16:49:26,590 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-17 16:49:26,590 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 16:49:26,593 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-17 16:49:26,593 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-17 16:49:26,593 - INFO - error_apis: []
2025-03-17 16:49:26,593 - INFO - Simulated traffic data for 4/12 user collected：user: unloggeduser malicious: True
2025-03-17 16:49:26,596 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-17 16:49:26,596 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 16:49:26,596 - INFO - error_apis: []
2025-03-17 16:49:26,596 - INFO - Simulated traffic data for 5/12 user collected：user: adminuser malicious: False
2025-03-17 16:49:26,599 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-17 16:49:26,599 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 16:49:26,602 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-17 16:49:26,602 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-17 16:49:26,602 - INFO - error_apis: []
2025-03-17 16:49:26,602 - INFO - Simulated traffic data for 6/12 user collected：user: normaluser malicious: True
2025-03-17 16:49:26,606 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-17 16:49:26,606 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 16:49:26,606 - INFO - error_apis: []
2025-03-17 16:49:26,606 - INFO - Simulated traffic data for 7/12 user collected：user: normaluser malicious: False
2025-03-17 16:49:26,609 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-17 16:49:26,609 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 16:49:26,609 - INFO - error_apis: []
2025-03-17 16:49:26,609 - INFO - Simulated traffic data for 8/12 user collected：user: normaluser malicious: False
2025-03-17 16:49:26,612 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-17 16:49:26,612 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 16:49:26,612 - INFO - error_apis: []
2025-03-17 16:49:26,612 - INFO - Simulated traffic data for 9/12 user collected：user: normaluser malicious: False
2025-03-17 16:49:26,615 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-17 16:49:26,615 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 16:49:26,618 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-17 16:49:26,618 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-17 16:49:26,618 - INFO - error_apis: []
2025-03-17 16:49:26,618 - INFO - Simulated traffic data for 10/12 user collected：user: normaluser malicious: True
2025-03-17 16:49:26,621 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-17 16:49:26,621 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 16:49:26,622 - INFO - error_apis: []
2025-03-17 16:49:26,622 - INFO - Simulated traffic data for 11/12 user collected：user: adminuser malicious: False
2025-03-17 16:49:26,625 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-17 16:49:26,625 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 16:49:26,628 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-17 16:49:26,628 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-17 16:49:26,628 - INFO - error_apis: []
2025-03-17 16:49:26,628 - INFO - Simulated traffic data for 12/12 user collected：user: unloggeduser malicious: True
2025-03-17 16:49:26,642 - INFO - All simulated traffic data collected：/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/simulated_traffic_data.csv
2025-03-17 16:49:26,642 - INFO - error_apis: []
2025-03-17 16:57:11,928 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-17 16:57:11,980 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-17 16:57:12,163 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-17 16:57:12,164 - INFO - Starting data generation...
2025-03-17 16:57:12,164 - INFO - API_KNOWLEDGE: [{'number': 'API_3285', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_3286', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}]
2025-03-17 16:57:12,164 - INFO - APP_KNOWLEDGE: {'func_description': 'This is an updated test application', 'normal_seqs': ['There are no example normal seqs'], 'malicious_seqs': ['There are no example malicious seqs'], 'roles': ['admin', 'ordinary_user', 'unlogged_in_user']}
2025-03-17 16:57:12,225 - INFO - Generating simulated API sequences...
2025-03-17 16:57:12,225 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 16:57:12,225 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 16:57:12,225 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 16:57:14,088 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 16:57:14,089 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:57:14,089 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:57:14,089 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:57:14,089 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3285', 'API_3286'], 'ordinary_user': [], 'admin': ['API_3285', 'API_3286'], 'oridinary_user': ['API_3285', 'API_3286']}
2025-03-17 16:57:14,089 - INFO - API sequence 1/12 generated
Exception in thread Thread-348 (async_data_collect):
Traceback (most recent call last):
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/./app.py", line 548, in async_data_collect
    ERROR_APIS.extend(error_apis)
TypeError: 'NoneType' object is not iterable

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/threading.py", line 1016, in _bootstrap_inner
    self.run()
  File "/usr/lib/python3.10/threading.py", line 953, in run
    self._target(*self._args, **self._kwargs)
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/./app.py", line 556, in async_data_collect
    LOGGER.error(f"Error in data collection: {e.with_traceback(10)}")
TypeError: __traceback__ must be a traceback or None
2025-03-17 16:57:14,092 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-17 16:57:14,136 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-17 16:57:14,322 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-17 16:57:14,323 - INFO - Starting data generation...
2025-03-17 16:57:14,323 - INFO - API_KNOWLEDGE: [{'number': 'API_3288', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_3289', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}]
2025-03-17 16:57:14,323 - INFO - APP_KNOWLEDGE: {'func_description': 'This is an updated test application', 'normal_seqs': ['There are no example normal seqs'], 'malicious_seqs': ['There are no example malicious seqs'], 'roles': ['admin', 'ordinary_user', 'unlogged_in_user']}
2025-03-17 16:57:14,388 - INFO - Generating simulated API sequences...
2025-03-17 16:57:14,388 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 16:57:14,388 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 16:57:14,388 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 16:57:14,388 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 16:57:15,919 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 16:57:15,920 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:57:15,920 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:57:15,920 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:57:15,920 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:57:15,920 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3288', 'API_3289'], 'ordinary_user': [], 'admin': ['API_3288', 'API_3289'], 'oridinary_user': ['API_3288', 'API_3289']}
2025-03-17 16:57:15,920 - INFO - API sequence 1/12 generated
2025-03-17 16:57:15,920 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 16:57:15,920 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 16:57:15,920 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 16:57:15,920 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 16:57:18,369 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 16:57:18,370 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:57:18,370 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:57:18,370 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:57:18,370 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:57:18,371 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3288', 'API_3289'], 'ordinary_user': [], 'admin': ['API_3288', 'API_3289'], 'oridinary_user': ['API_3288', 'API_3289']}
2025-03-17 16:57:18,371 - INFO - API sequence 2/12 generated
2025-03-17 16:57:18,371 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 16:57:18,371 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 16:57:18,371 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 16:57:18,371 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 16:57:20,448 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 16:57:20,449 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:57:20,449 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:57:20,449 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:57:20,449 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:57:20,449 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3288', 'API_3289'], 'ordinary_user': [], 'admin': ['API_3288', 'API_3289'], 'oridinary_user': ['API_3288', 'API_3289']}
2025-03-17 16:57:20,449 - INFO - API sequence 3/12 generated
2025-03-17 16:57:20,449 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 16:57:20,449 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 16:57:20,449 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 16:57:20,449 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 16:57:22,112 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 16:57:22,113 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:57:22,113 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:57:22,113 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:57:22,113 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:57:22,113 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3288', 'API_3289'], 'ordinary_user': [], 'admin': ['API_3288', 'API_3289'], 'oridinary_user': ['API_3288', 'API_3289']}
2025-03-17 16:57:22,113 - INFO - API sequence 4/12 generated
2025-03-17 16:57:22,113 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 16:57:22,113 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 16:57:22,113 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 16:57:22,113 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 16:57:23,934 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 16:57:23,935 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:57:23,935 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:57:23,935 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:57:23,935 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:57:23,935 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3288', 'API_3289'], 'ordinary_user': [], 'admin': ['API_3288', 'API_3289'], 'oridinary_user': ['API_3288', 'API_3289']}
2025-03-17 16:57:23,935 - INFO - API sequence 5/12 generated
2025-03-17 16:57:23,935 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 16:57:23,935 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 16:57:23,935 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 16:57:23,935 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 16:57:25,387 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 16:57:25,388 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:57:25,388 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:57:25,388 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:57:25,388 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:57:25,388 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3288', 'API_3289'], 'ordinary_user': [], 'admin': ['API_3288', 'API_3289'], 'oridinary_user': ['API_3288', 'API_3289']}
2025-03-17 16:57:25,388 - INFO - API sequence 6/12 generated
2025-03-17 16:57:25,388 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 16:57:25,388 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 16:57:25,388 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 16:57:25,388 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 16:57:27,484 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 16:57:27,485 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:57:27,485 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:57:27,485 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:57:27,485 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:57:27,485 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3288', 'API_3289'], 'ordinary_user': [], 'admin': ['API_3288', 'API_3289'], 'oridinary_user': ['API_3288', 'API_3289']}
2025-03-17 16:57:27,485 - INFO - API sequence 7/12 generated
2025-03-17 16:57:27,485 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 16:57:27,485 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 16:57:27,485 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 16:57:27,485 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 16:57:29,203 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 16:57:29,204 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:57:29,204 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:57:29,204 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:57:29,204 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:57:29,204 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3288', 'API_3289'], 'ordinary_user': [], 'admin': ['API_3288', 'API_3289'], 'oridinary_user': ['API_3288', 'API_3289']}
2025-03-17 16:57:29,204 - INFO - API sequence 8/12 generated
Exception in thread Thread-350 (async_data_collect):
Traceback (most recent call last):
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/./app.py", line 548, in async_data_collect
    ERROR_APIS.extend(error_apis)
TypeError: 'NoneType' object is not iterable

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/threading.py", line 1016, in _bootstrap_inner
    self.run()
  File "/usr/lib/python3.10/threading.py", line 953, in run
    self._target(*self._args, **self._kwargs)
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/./app.py", line 556, in async_data_collect
    LOGGER.error(f"Error in data collection: {e.with_traceback(10)}")
TypeError: __traceback__ must be a traceback or None
2025-03-17 16:57:29,206 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-17 16:57:29,251 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-17 16:57:29,423 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-17 16:57:29,423 - INFO - Starting data generation...
2025-03-17 16:57:29,423 - INFO - API_KNOWLEDGE: [{'number': 'API_3291', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_3292', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}]
2025-03-17 16:57:29,423 - INFO - APP_KNOWLEDGE: {'func_description': 'This is an updated test application', 'normal_seqs': ['There are no example normal seqs'], 'malicious_seqs': ['There are no example malicious seqs'], 'roles': ['admin', 'ordinary_user', 'unlogged_in_user']}
2025-03-17 16:57:29,473 - INFO - Generating simulated API sequences...
2025-03-17 16:57:29,473 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 16:57:29,473 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 16:57:29,473 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 16:57:29,473 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 16:57:29,473 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 16:57:30,912 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 16:57:30,913 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:57:30,913 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:57:30,913 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:57:30,913 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:57:30,913 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:57:30,913 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3291', 'API_3292'], 'ordinary_user': [], 'admin': ['API_3291', 'API_3292'], 'oridinary_user': ['API_3291', 'API_3292']}
2025-03-17 16:57:30,913 - INFO - API sequence 1/12 generated
2025-03-17 16:57:30,913 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 16:57:30,913 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 16:57:30,913 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 16:57:30,913 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 16:57:30,913 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 16:57:32,355 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 16:57:32,356 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:57:32,356 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:57:32,356 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:57:32,356 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:57:32,356 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:57:32,356 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3291', 'API_3292'], 'ordinary_user': [], 'admin': ['API_3291', 'API_3292'], 'oridinary_user': ['API_3291', 'API_3292']}
2025-03-17 16:57:32,356 - INFO - API sequence 2/12 generated
2025-03-17 16:57:32,356 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 16:57:32,356 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 16:57:32,356 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 16:57:32,356 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 16:57:32,356 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 16:57:34,176 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 16:57:34,177 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:57:34,177 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:57:34,177 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:57:34,177 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:57:34,177 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:57:34,177 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3291', 'API_3292'], 'ordinary_user': [], 'admin': ['API_3291', 'API_3292'], 'oridinary_user': ['API_3291', 'API_3292']}
2025-03-17 16:57:34,177 - INFO - API sequence 3/12 generated
2025-03-17 16:57:34,177 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 16:57:34,177 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 16:57:34,177 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 16:57:34,177 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 16:57:34,177 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 16:57:35,703 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 16:57:35,704 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:57:35,704 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:57:35,704 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:57:35,704 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:57:35,704 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:57:35,704 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3291', 'API_3292'], 'ordinary_user': [], 'admin': ['API_3291', 'API_3292'], 'oridinary_user': ['API_3291', 'API_3292']}
2025-03-17 16:57:35,704 - INFO - API sequence 4/12 generated
2025-03-17 16:57:35,704 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 16:57:35,704 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 16:57:35,704 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 16:57:35,704 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 16:57:35,704 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 16:57:39,331 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 16:57:39,332 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:57:39,332 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:57:39,332 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:57:39,332 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:57:39,332 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:57:39,333 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3291', 'API_3292'], 'ordinary_user': [], 'admin': ['API_3291', 'API_3292'], 'oridinary_user': ['API_3291', 'API_3292']}
2025-03-17 16:57:39,333 - INFO - API sequence 5/12 generated
Exception in thread Thread-352 (async_data_collect):
Traceback (most recent call last):
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/./app.py", line 548, in async_data_collect
    ERROR_APIS.extend(error_apis)
TypeError: 'NoneType' object is not iterable

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/threading.py", line 1016, in _bootstrap_inner
    self.run()
  File "/usr/lib/python3.10/threading.py", line 953, in run
    self._target(*self._args, **self._kwargs)
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/./app.py", line 556, in async_data_collect
    LOGGER.error(f"Error in data collection: {e.with_traceback(10)}")
TypeError: __traceback__ must be a traceback or None
2025-03-17 16:57:39,334 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-17 16:57:39,338 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-17 16:57:39,425 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-17 16:57:39,486 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
Exception in thread Thread-356 (async_data_collect):
Traceback (most recent call last):
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/./app.py", line 522, in async_data_collect
    algorithm.api_discovery.collect_param_set(api_log, user_api_set)
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py", line 44, in collect_param_set
    param_set_to_file()
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py", line 29, in param_set_to_file
    json.dump(param_set, json_file, indent=2)
  File "/usr/lib/python3.10/json/__init__.py", line 179, in dump
    for chunk in iterable:
  File "/usr/lib/python3.10/json/encoder.py", line 431, in _iterencode
    yield from _iterencode_dict(o, _current_indent_level)
  File "/usr/lib/python3.10/json/encoder.py", line 356, in _iterencode_dict
    for key, value in items:
RuntimeError: dictionary changed size during iteration

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.10/threading.py", line 1016, in _bootstrap_inner
    self.run()
  File "/usr/lib/python3.10/threading.py", line 953, in run
    self._target(*self._args, **self._kwargs)
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/./app.py", line 556, in async_data_collect
    LOGGER.error(f"Error in data collection: {e.with_traceback(10)}")
TypeError: __traceback__ must be a traceback or None
2025-03-17 16:57:39,770 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-17 16:57:39,770 - INFO - Starting data generation...
2025-03-17 16:57:39,771 - INFO - API_KNOWLEDGE: [{'number': 'API_3294', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_3295', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}]
2025-03-17 16:57:39,771 - INFO - APP_KNOWLEDGE: {'func_description': 'This is an updated test application', 'normal_seqs': ['There are no example normal seqs'], 'malicious_seqs': ['There are no example malicious seqs'], 'roles': ['admin', 'ordinary_user', 'unlogged_in_user']}
2025-03-17 16:57:39,833 - INFO - Generating simulated API sequences...
2025-03-17 16:57:39,833 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 16:57:39,833 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 16:57:39,833 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 16:57:39,833 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 16:57:39,833 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 16:57:39,833 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 16:57:42,381 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 16:57:42,382 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:57:42,382 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:57:42,382 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:57:42,382 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:57:42,382 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:57:42,382 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:57:42,382 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3297', 'API_3298', 'API_3294', 'API_3295'], 'ordinary_user': [], 'admin': ['API_3297', 'API_3298', 'API_3294', 'API_3295'], 'oridinary_user': ['API_3297', 'API_3298', 'API_3294', 'API_3295']}
2025-03-17 16:57:42,382 - INFO - API sequence 1/12 generated
2025-03-17 16:57:42,382 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 16:57:42,382 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 16:57:42,382 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 16:57:42,382 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 16:57:42,382 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 16:57:42,382 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 16:57:47,252 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 16:57:47,253 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:57:47,253 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:57:47,253 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:57:47,253 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:57:47,253 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:57:47,253 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:57:47,254 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3297', 'API_3298', 'API_3294', 'API_3295'], 'ordinary_user': [], 'admin': ['API_3297', 'API_3298', 'API_3294', 'API_3295'], 'oridinary_user': ['API_3297', 'API_3298', 'API_3294', 'API_3295']}
2025-03-17 16:57:47,254 - INFO - API sequence 2/12 generated
2025-03-17 16:57:47,254 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 16:57:47,254 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 16:57:47,254 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 16:57:47,254 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 16:57:47,254 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 16:57:47,254 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 16:57:48,629 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 16:57:48,630 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:57:48,630 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:57:48,630 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:57:48,630 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:57:48,630 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:57:48,630 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:57:48,631 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3297', 'API_3298', 'API_3294', 'API_3295'], 'ordinary_user': [], 'admin': ['API_3297', 'API_3298', 'API_3294', 'API_3295'], 'oridinary_user': ['API_3297', 'API_3298', 'API_3294', 'API_3295']}
2025-03-17 16:57:48,631 - INFO - API sequence 3/12 generated
2025-03-17 16:57:48,631 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 16:57:48,631 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 16:57:48,631 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 16:57:48,631 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 16:57:48,631 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 16:57:48,631 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 16:57:50,340 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 16:57:50,341 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:57:50,341 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:57:50,341 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:57:50,341 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:57:50,341 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:57:50,341 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:57:50,341 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3297', 'API_3298', 'API_3294', 'API_3295'], 'ordinary_user': [], 'admin': ['API_3297', 'API_3298', 'API_3294', 'API_3295'], 'oridinary_user': ['API_3297', 'API_3298', 'API_3294', 'API_3295']}
2025-03-17 16:57:50,341 - INFO - API sequence 4/12 generated
2025-03-17 16:57:50,341 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 16:57:50,341 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 16:57:50,341 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 16:57:50,341 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 16:57:50,341 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 16:57:50,341 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 16:57:52,512 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 16:57:52,513 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:57:52,513 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:57:52,513 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:57:52,513 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:57:52,513 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:57:52,513 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:57:52,513 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3297', 'API_3298', 'API_3294', 'API_3295'], 'ordinary_user': [], 'admin': ['API_3297', 'API_3298', 'API_3294', 'API_3295'], 'oridinary_user': ['API_3297', 'API_3298', 'API_3294', 'API_3295']}
2025-03-17 16:57:52,513 - INFO - API sequence 5/12 generated
2025-03-17 16:57:52,513 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 16:57:52,513 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 16:57:52,513 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 16:57:52,513 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 16:57:52,513 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 16:57:52,513 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 16:57:56,076 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 16:57:56,076 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-17 16:57:56,076 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-17 16:57:56,076 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-17 16:57:56,076 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-17 16:57:56,076 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-17 16:57:56,076 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-17 16:57:56,077 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3297', 'API_3298', 'API_3294', 'API_3295'], 'ordinary_user': [], 'admin': ['API_3297', 'API_3298', 'API_3294', 'API_3295'], 'oridinary_user': ['API_3297', 'API_3298', 'API_3294', 'API_3295']}
2025-03-17 16:57:56,077 - INFO - API sequence 6/12 generated
2025-03-17 16:57:56,077 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 16:57:56,077 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 16:57:56,077 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 16:57:56,077 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 16:57:56,077 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 16:57:56,077 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 16:57:57,448 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 16:57:57,449 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:57:57,449 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:57:57,449 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:57:57,449 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:57:57,449 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:57:57,449 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:57:57,450 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3297', 'API_3298', 'API_3294', 'API_3295'], 'ordinary_user': [], 'admin': ['API_3297', 'API_3298', 'API_3294', 'API_3295'], 'oridinary_user': ['API_3297', 'API_3298', 'API_3294', 'API_3295']}
2025-03-17 16:57:57,450 - INFO - API sequence 7/12 generated
2025-03-17 16:57:57,450 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 16:57:57,450 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 16:57:57,450 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 16:57:57,450 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 16:57:57,450 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 16:57:57,450 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 16:57:58,990 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 16:57:58,991 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:57:58,991 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:57:58,991 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:57:58,991 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:57:58,991 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:57:58,991 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:57:58,992 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3297', 'API_3298', 'API_3294', 'API_3295'], 'ordinary_user': [], 'admin': ['API_3297', 'API_3298', 'API_3294', 'API_3295'], 'oridinary_user': ['API_3297', 'API_3298', 'API_3294', 'API_3295']}
2025-03-17 16:57:58,992 - INFO - API sequence 8/12 generated
2025-03-17 16:57:58,992 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 16:57:58,992 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 16:57:58,992 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 16:57:58,992 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 16:57:58,992 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 16:57:58,992 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 16:58:00,618 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 16:58:00,619 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:58:00,619 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:58:00,619 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:58:00,619 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:58:00,619 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:58:00,619 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 16:58:00,619 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3297', 'API_3298', 'API_3294', 'API_3295'], 'ordinary_user': [], 'admin': ['API_3297', 'API_3298', 'API_3294', 'API_3295'], 'oridinary_user': ['API_3297', 'API_3298', 'API_3294', 'API_3295']}
2025-03-17 16:58:00,619 - INFO - API sequence 9/12 generated
2025-03-17 16:58:00,619 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 16:58:00,619 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 16:58:00,619 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 16:58:00,619 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 16:58:00,619 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 16:58:00,619 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 16:58:01,928 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 16:58:01,929 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:58:01,929 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:58:01,929 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:58:01,929 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:58:01,929 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:58:01,929 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:58:01,930 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3297', 'API_3298', 'API_3294', 'API_3295'], 'ordinary_user': [], 'admin': ['API_3297', 'API_3298', 'API_3294', 'API_3295'], 'oridinary_user': ['API_3297', 'API_3298', 'API_3294', 'API_3295']}
2025-03-17 16:58:01,930 - INFO - API sequence 10/12 generated
2025-03-17 16:58:01,930 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 16:58:01,930 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 16:58:01,930 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 16:58:01,930 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 16:58:01,930 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 16:58:01,930 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 16:58:03,400 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 16:58:03,401 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:58:03,401 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:58:03,401 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:58:03,401 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:58:03,401 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:58:03,401 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:58:03,401 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3297', 'API_3298', 'API_3294', 'API_3295'], 'ordinary_user': [], 'admin': ['API_3297', 'API_3298', 'API_3294', 'API_3295'], 'oridinary_user': ['API_3297', 'API_3298', 'API_3294', 'API_3295']}
2025-03-17 16:58:03,401 - INFO - API sequence 11/12 generated
2025-03-17 16:58:03,402 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 16:58:03,402 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 16:58:03,402 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 16:58:03,402 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 16:58:03,402 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 16:58:03,402 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 16:58:05,086 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 16:58:05,087 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:58:05,087 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:58:05,087 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:58:05,087 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:58:05,087 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:58:05,087 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 16:58:05,087 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3297', 'API_3298', 'API_3294', 'API_3295'], 'ordinary_user': [], 'admin': ['API_3297', 'API_3298', 'API_3294', 'API_3295'], 'oridinary_user': ['API_3297', 'API_3298', 'API_3294', 'API_3295']}
2025-03-17 16:58:05,087 - INFO - API sequence 12/12 generated
2025-03-17 16:58:05,088 - INFO - API sequences serialized to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py/serialized_llm_agents.json
2025-03-17 16:58:05,088 - INFO - Generating simulated traffic data set...
2025-03-17 16:58:05,093 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-17 16:58:05,093 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 16:58:05,096 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-17 16:58:05,096 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-17 16:58:05,096 - INFO - error_apis: []
2025-03-17 16:58:05,096 - INFO - Simulated traffic data for 1/12 user collected：user: normaluser malicious: True
2025-03-17 16:58:05,099 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-17 16:58:05,099 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 16:58:05,102 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-17 16:58:05,102 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-17 16:58:05,102 - INFO - error_apis: []
2025-03-17 16:58:05,103 - INFO - Simulated traffic data for 2/12 user collected：user: normaluser malicious: True
2025-03-17 16:58:05,106 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-17 16:58:05,106 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 16:58:05,109 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-17 16:58:05,109 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-17 16:58:05,109 - INFO - error_apis: []
2025-03-17 16:58:05,109 - INFO - Simulated traffic data for 3/12 user collected：user: unloggeduser malicious: True
2025-03-17 16:58:05,112 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-17 16:58:05,112 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 16:58:05,112 - INFO - error_apis: []
2025-03-17 16:58:05,112 - INFO - Simulated traffic data for 4/12 user collected：user: normaluser malicious: False
2025-03-17 16:58:05,115 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-17 16:58:05,116 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 16:58:05,116 - INFO - error_apis: []
2025-03-17 16:58:05,116 - INFO - Simulated traffic data for 5/12 user collected：user: adminuser malicious: False
2025-03-17 16:58:05,119 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-17 16:58:05,119 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 16:58:05,122 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-17 16:58:05,122 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-17 16:58:05,125 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-17 16:58:05,125 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：False
2025-03-17 16:58:05,125 - INFO - error_apis: []
2025-03-17 16:58:05,125 - INFO - Simulated traffic data for 6/12 user collected：user: normaluser malicious: True
2025-03-17 16:58:05,128 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-17 16:58:05,128 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 16:58:05,128 - INFO - error_apis: []
2025-03-17 16:58:05,128 - INFO - Simulated traffic data for 7/12 user collected：user: normaluser malicious: False
2025-03-17 16:58:05,132 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-17 16:58:05,132 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 16:58:05,135 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-17 16:58:05,135 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-17 16:58:05,135 - INFO - error_apis: []
2025-03-17 16:58:05,135 - INFO - Simulated traffic data for 8/12 user collected：user: unloggeduser malicious: True
2025-03-17 16:58:05,138 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-17 16:58:05,138 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 16:58:05,141 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-17 16:58:05,141 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-17 16:58:05,141 - INFO - error_apis: []
2025-03-17 16:58:05,141 - INFO - Simulated traffic data for 9/12 user collected：user: unloggeduser malicious: True
2025-03-17 16:58:05,144 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-17 16:58:05,144 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 16:58:05,145 - INFO - error_apis: []
2025-03-17 16:58:05,145 - INFO - Simulated traffic data for 10/12 user collected：user: normaluser malicious: False
2025-03-17 16:58:05,148 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-17 16:58:05,148 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 16:58:05,148 - INFO - error_apis: []
2025-03-17 16:58:05,148 - INFO - Simulated traffic data for 11/12 user collected：user: normaluser malicious: False
2025-03-17 16:58:05,151 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-17 16:58:05,151 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 16:58:05,151 - INFO - error_apis: []
2025-03-17 16:58:05,151 - INFO - Simulated traffic data for 12/12 user collected：user: adminuser malicious: False
2025-03-17 16:58:05,153 - INFO - All simulated traffic data collected：/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/simulated_traffic_data.csv
2025-03-17 16:58:05,153 - INFO - error_apis: []
2025-03-17 17:21:32,768 - INFO - Detection started. Combined data duration: 10
2025-03-17 17:21:40,932 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 7
2025-03-17 17:21:40,933 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 17:21:40,939 - INFO - [{'MeanUrlParamsCount': 0.0, 'RepeatUrlVisitCount': 0.0, 'DeepPageVisitRate': 0.0, 'MeanUrlPathDepth': 0.0, 'MeanUrlLength': 25.0, 'UniquePageVisitCount': 1, 'SeqOccurTime_38164fbd17603d73f696b8b4d72664d735bb6a7c88577687fd2ae33fd6964153': 0}]
2025-03-17 17:21:40,939 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 17:21:41,030 - INFO - A new detect record generated; Traffic data size: 1
2025-03-17 17:21:51,140 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 7
2025-03-17 17:21:51,142 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 17:21:51,156 - INFO - [{'MeanUrlParamsCount': 0.0, 'RepeatUrlVisitCount': 1.0, 'DeepPageVisitRate': 0.0, 'MeanUrlPathDepth': 0.9, 'MeanUrlLength': 64.8, 'UniquePageVisitCount': 9, 'SeqOccurTime_38164fbd17603d73f696b8b4d72664d735bb6a7c88577687fd2ae33fd6964153': 0}]
2025-03-17 17:21:51,156 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 17:21:51,190 - INFO - A new detect record generated; Traffic data size: 10
2025-03-17 17:22:01,209 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 7
2025-03-17 17:22:01,210 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 17:22:01,342 - INFO - [{'MeanUrlParamsCount': 0.0, 'RepeatUrlVisitCount': 3.0, 'DeepPageVisitRate': 0.0, 'MeanUrlPathDepth': 1.0, 'MeanUrlLength': 63.392857142857146, 'UniquePageVisitCount': 7, 'SeqOccurTime_38164fbd17603d73f696b8b4d72664d735bb6a7c88577687fd2ae33fd6964153': 0}]
2025-03-17 17:22:01,342 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 17:22:01,505 - INFO - A new detect record generated; Traffic data size: 28
2025-03-17 17:22:11,525 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 7
2025-03-17 17:22:11,526 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 17:22:11,591 - INFO - [{'MeanUrlParamsCount': 0.0, 'RepeatUrlVisitCount': 8.0, 'DeepPageVisitRate': 0.0, 'MeanUrlPathDepth': 1.0, 'MeanUrlLength': 68.75, 'UniquePageVisitCount': 11, 'SeqOccurTime_38164fbd17603d73f696b8b4d72664d735bb6a7c88577687fd2ae33fd6964153': 0}]
2025-03-17 17:22:11,592 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 17:22:11,682 - INFO - A new detect record generated; Traffic data size: 24
2025-03-17 17:22:16,908 - INFO - Detection paused.
2025-03-17 17:26:04,770 - INFO - Detection started. Combined data duration: 10
2025-03-17 17:26:11,876 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 7
2025-03-17 17:26:11,878 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 17:26:11,880 - INFO - [{'MeanUrlParamsCount': 0.0, 'RepeatUrlVisitCount': 0.0, 'DeepPageVisitRate': 0.0, 'MeanUrlPathDepth': 0.0, 'MeanUrlLength': 39.0, 'UniquePageVisitCount': 1, 'SeqOccurTime_38164fbd17603d73f696b8b4d72664d735bb6a7c88577687fd2ae33fd6964153': 0}]
2025-03-17 17:26:11,880 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 17:26:11,905 - INFO - A new detect record generated; Traffic data size: 1
2025-03-17 17:26:12,323 - INFO - Detection paused.
2025-03-17 17:26:35,993 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-17 17:26:36,039 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-17 17:26:36,213 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-17 17:26:36,213 - INFO - Starting data generation...
2025-03-17 17:26:36,213 - INFO - API_KNOWLEDGE: [{'number': 'API_3300', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_3301', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}]
2025-03-17 17:26:36,213 - INFO - APP_KNOWLEDGE: {'func_description': 'This is an updated test application', 'normal_seqs': ['There are no example normal seqs'], 'malicious_seqs': ['There are no example malicious seqs'], 'roles': ['admin', 'ordinary_user', 'unlogged_in_user']}
2025-03-17 17:26:36,265 - INFO - Generating simulated API sequences...
2025-03-17 17:26:36,266 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 17:26:36,266 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 17:26:36,266 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 17:26:36,266 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 17:26:36,266 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 17:26:36,266 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 17:26:36,266 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 17:26:38,421 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 17:26:38,421 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 17:26:38,421 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 17:26:38,421 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 17:26:38,421 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 17:26:38,421 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 17:26:38,421 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 17:26:38,421 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 17:26:38,422 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3300', 'API_3301'], 'ordinary_user': [], 'admin': ['API_3300', 'API_3301'], 'oridinary_user': ['API_3300', 'API_3301']}
2025-03-17 17:26:38,422 - INFO - API sequence 1/12 generated
2025-03-17 17:26:38,422 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 17:26:38,422 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 17:26:38,422 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 17:26:38,422 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 17:26:38,422 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 17:26:38,422 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 17:26:38,422 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 17:26:41,670 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 17:26:41,671 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 17:26:41,671 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 17:26:41,671 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 17:26:41,671 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 17:26:41,671 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 17:26:41,671 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 17:26:41,671 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 17:26:41,672 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3300', 'API_3301'], 'ordinary_user': [], 'admin': ['API_3300', 'API_3301'], 'oridinary_user': ['API_3300', 'API_3301']}
2025-03-17 17:26:41,672 - INFO - API sequence 2/12 generated
2025-03-17 17:26:41,672 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 17:26:41,672 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 17:26:41,672 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 17:26:41,672 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 17:26:41,672 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 17:26:41,672 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 17:26:41,672 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 17:26:44,273 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 17:26:44,274 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 17:26:44,274 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 17:26:44,274 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 17:26:44,274 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 17:26:44,274 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 17:26:44,274 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 17:26:44,274 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 17:26:44,274 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3300', 'API_3301'], 'ordinary_user': [], 'admin': ['API_3300', 'API_3301'], 'oridinary_user': ['API_3300', 'API_3301']}
2025-03-17 17:26:44,274 - INFO - API sequence 3/12 generated
2025-03-17 17:26:44,274 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 17:26:44,274 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 17:26:44,274 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 17:26:44,274 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 17:26:44,274 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 17:26:44,274 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 17:26:44,274 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 17:26:45,473 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 17:26:45,474 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 17:26:45,474 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 17:26:45,474 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 17:26:45,474 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 17:26:45,474 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 17:26:45,474 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 17:26:45,474 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 17:26:45,474 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3300', 'API_3301'], 'ordinary_user': [], 'admin': ['API_3300', 'API_3301'], 'oridinary_user': ['API_3300', 'API_3301']}
2025-03-17 17:26:45,474 - INFO - API sequence 4/12 generated
2025-03-17 17:26:45,474 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 17:26:45,474 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 17:26:45,474 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 17:26:45,474 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 17:26:45,474 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 17:26:45,474 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 17:26:45,474 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 17:26:47,522 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 17:26:47,523 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 17:26:47,523 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 17:26:47,523 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 17:26:47,523 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 17:26:47,523 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 17:26:47,523 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 17:26:47,523 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 17:26:47,523 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3300', 'API_3301'], 'ordinary_user': [], 'admin': ['API_3300', 'API_3301'], 'oridinary_user': ['API_3300', 'API_3301']}
2025-03-17 17:26:47,523 - INFO - API sequence 5/12 generated
2025-03-17 17:26:47,523 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 17:26:47,523 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 17:26:47,523 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 17:26:47,523 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 17:26:47,523 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 17:26:47,523 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 17:26:47,523 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 17:26:48,749 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 17:26:48,750 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 17:26:48,750 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 17:26:48,750 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 17:26:48,750 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 17:26:48,750 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 17:26:48,750 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 17:26:48,750 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 17:26:48,750 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3300', 'API_3301'], 'ordinary_user': [], 'admin': ['API_3300', 'API_3301'], 'oridinary_user': ['API_3300', 'API_3301']}
2025-03-17 17:26:48,750 - INFO - API sequence 6/12 generated
2025-03-17 17:26:48,750 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 17:26:48,750 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 17:26:48,750 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 17:26:48,750 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 17:26:48,750 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 17:26:48,750 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 17:26:48,750 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 17:26:49,866 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 17:26:49,867 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 17:26:49,867 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 17:26:49,867 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 17:26:49,867 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 17:26:49,867 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 17:26:49,867 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 17:26:49,867 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 17:26:49,867 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3300', 'API_3301'], 'ordinary_user': [], 'admin': ['API_3300', 'API_3301'], 'oridinary_user': ['API_3300', 'API_3301']}
2025-03-17 17:26:49,867 - INFO - API sequence 7/12 generated
2025-03-17 17:26:49,867 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 17:26:49,867 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 17:26:49,867 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 17:26:49,867 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 17:26:49,867 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 17:26:49,867 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 17:26:49,867 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 17:26:51,962 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 17:26:51,963 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 17:26:51,963 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 17:26:51,963 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 17:26:51,963 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 17:26:51,963 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 17:26:51,963 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 17:26:51,963 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 17:26:51,964 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3300', 'API_3301'], 'ordinary_user': [], 'admin': ['API_3300', 'API_3301'], 'oridinary_user': ['API_3300', 'API_3301']}
2025-03-17 17:26:51,964 - INFO - API sequence 8/12 generated
2025-03-17 17:26:51,964 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 17:26:51,964 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 17:26:51,964 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 17:26:51,964 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 17:26:51,964 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 17:26:51,964 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 17:26:51,964 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 17:26:53,299 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 17:26:53,300 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 17:26:53,300 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 17:26:53,300 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 17:26:53,300 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 17:26:53,300 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 17:26:53,300 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 17:26:53,300 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 17:26:53,301 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3300', 'API_3301'], 'ordinary_user': [], 'admin': ['API_3300', 'API_3301'], 'oridinary_user': ['API_3300', 'API_3301']}
2025-03-17 17:26:53,301 - INFO - API sequence 9/12 generated
2025-03-17 17:26:53,301 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 17:26:53,301 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 17:26:53,301 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 17:26:53,301 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 17:26:53,301 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 17:26:53,301 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 17:26:53,301 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 17:26:55,601 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 17:26:55,602 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 17:26:55,602 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 17:26:55,602 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 17:26:55,602 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 17:26:55,602 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 17:26:55,602 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 17:26:55,602 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 17:26:55,603 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3300', 'API_3301'], 'ordinary_user': [], 'admin': ['API_3300', 'API_3301'], 'oridinary_user': ['API_3300', 'API_3301']}
2025-03-17 17:26:55,603 - INFO - API sequence 10/12 generated
2025-03-17 17:26:55,603 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 17:26:55,603 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 17:26:55,603 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 17:26:55,603 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 17:26:55,603 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 17:26:55,603 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 17:26:55,603 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 17:26:57,823 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 17:26:57,824 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 17:26:57,824 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 17:26:57,824 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 17:26:57,824 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 17:26:57,824 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 17:26:57,824 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 17:26:57,824 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 17:26:57,824 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3300', 'API_3301'], 'ordinary_user': [], 'admin': ['API_3300', 'API_3301'], 'oridinary_user': ['API_3300', 'API_3301']}
2025-03-17 17:26:57,824 - INFO - API sequence 11/12 generated
2025-03-17 17:26:57,824 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 17:26:57,824 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 17:26:57,824 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 17:26:57,824 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 17:26:57,824 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 17:26:57,824 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 17:26:57,824 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 17:26:58,967 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 17:26:58,968 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 17:26:58,968 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 17:26:58,968 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 17:26:58,968 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 17:26:58,968 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 17:26:58,968 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 17:26:58,968 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 17:26:58,968 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3300', 'API_3301'], 'ordinary_user': [], 'admin': ['API_3300', 'API_3301'], 'oridinary_user': ['API_3300', 'API_3301']}
2025-03-17 17:26:58,968 - INFO - API sequence 12/12 generated
2025-03-17 17:26:58,969 - INFO - API sequences serialized to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py/serialized_llm_agents.json
2025-03-17 17:26:58,969 - INFO - Generating simulated traffic data set...
2025-03-17 17:26:58,973 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-17 17:26:58,973 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 17:26:58,973 - INFO - error_apis: []
2025-03-17 17:26:58,973 - INFO - Simulated traffic data for 1/12 user collected：user: normaluser malicious: False
2025-03-17 17:26:58,976 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-17 17:26:58,976 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 17:26:58,979 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-17 17:26:58,979 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-17 17:26:58,979 - INFO - error_apis: []
2025-03-17 17:26:58,979 - INFO - Simulated traffic data for 2/12 user collected：user: unloggeduser malicious: True
2025-03-17 17:26:58,982 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-17 17:26:58,983 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 17:26:58,986 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-17 17:26:58,986 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-17 17:26:58,986 - INFO - error_apis: []
2025-03-17 17:26:58,986 - INFO - Simulated traffic data for 3/12 user collected：user: normaluser malicious: True
2025-03-17 17:26:58,989 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-17 17:26:58,989 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 17:26:58,989 - INFO - error_apis: []
2025-03-17 17:26:58,989 - INFO - Simulated traffic data for 4/12 user collected：user: adminuser malicious: False
2025-03-17 17:26:58,992 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-17 17:26:58,992 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 17:26:58,992 - INFO - error_apis: []
2025-03-17 17:26:58,992 - INFO - Simulated traffic data for 5/12 user collected：user: adminuser malicious: False
2025-03-17 17:26:58,995 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-17 17:26:58,995 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 17:26:58,995 - INFO - error_apis: []
2025-03-17 17:26:58,995 - INFO - Simulated traffic data for 6/12 user collected：user: normaluser malicious: False
2025-03-17 17:26:58,998 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-17 17:26:58,999 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 17:26:58,999 - INFO - error_apis: []
2025-03-17 17:26:58,999 - INFO - Simulated traffic data for 7/12 user collected：user: normaluser malicious: False
2025-03-17 17:26:59,002 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-17 17:26:59,002 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 17:26:59,005 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-17 17:26:59,005 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-17 17:26:59,005 - INFO - error_apis: []
2025-03-17 17:26:59,005 - INFO - Simulated traffic data for 8/12 user collected：user: unloggeduser malicious: True
2025-03-17 17:26:59,008 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-17 17:26:59,008 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 17:26:59,008 - INFO - error_apis: []
2025-03-17 17:26:59,008 - INFO - Simulated traffic data for 9/12 user collected：user: normaluser malicious: False
2025-03-17 17:26:59,011 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-17 17:26:59,011 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 17:26:59,014 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-17 17:26:59,015 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-17 17:26:59,015 - INFO - error_apis: []
2025-03-17 17:26:59,015 - INFO - Simulated traffic data for 10/12 user collected：user: unloggeduser malicious: True
2025-03-17 17:26:59,018 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-17 17:26:59,018 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 17:26:59,021 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-17 17:26:59,021 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-17 17:26:59,021 - INFO - error_apis: []
2025-03-17 17:26:59,021 - INFO - Simulated traffic data for 11/12 user collected：user: normaluser malicious: True
2025-03-17 17:26:59,024 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-17 17:26:59,024 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 17:26:59,027 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-17 17:26:59,027 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-17 17:26:59,027 - INFO - error_apis: []
2025-03-17 17:26:59,027 - INFO - Simulated traffic data for 12/12 user collected：user: normaluser malicious: True
2025-03-17 17:26:59,029 - INFO - All simulated traffic data collected：/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/simulated_traffic_data.csv
2025-03-17 17:26:59,029 - INFO - error_apis: []
2025-03-17 17:27:42,500 - INFO - Detection started. Combined data duration: 10
2025-03-17 17:28:02,062 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 7
2025-03-17 17:28:02,064 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 17:28:02,065 - INFO - [{'MeanUrlParamsCount': 0.0, 'RepeatUrlVisitCount': 0.0, 'DeepPageVisitRate': 0.0, 'MeanUrlPathDepth': 0.0, 'MeanUrlLength': 25.0, 'UniquePageVisitCount': 1, 'SeqOccurTime_38164fbd17603d73f696b8b4d72664d735bb6a7c88577687fd2ae33fd6964153': 0}]
2025-03-17 17:28:02,065 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 17:28:02,090 - INFO - A new detect record generated; Traffic data size: 1
2025-03-17 17:28:39,348 - INFO - Detection paused.
2025-03-17 17:28:41,860 - INFO - Detection started. Combined data duration: 10
2025-03-17 17:28:42,130 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 7
2025-03-17 17:28:42,132 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 17:28:42,182 - INFO - [{'MeanUrlParamsCount': 0.0, 'RepeatUrlVisitCount': 3.0, 'DeepPageVisitRate': 0.0, 'MeanUrlPathDepth': 0.9523809523809523, 'MeanUrlLength': 62.76190476190476, 'UniquePageVisitCount': 10, 'SeqOccurTime_38164fbd17603d73f696b8b4d72664d735bb6a7c88577687fd2ae33fd6964153': 0}]
2025-03-17 17:28:42,182 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 17:28:42,261 - INFO - A new detect record generated; Traffic data size: 21
2025-03-17 17:28:43,490 - INFO - Detection paused.
2025-03-17 17:28:52,273 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 7
2025-03-17 17:28:52,275 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 17:28:52,277 - INFO - [{'MeanUrlParamsCount': 0.0, 'RepeatUrlVisitCount': 1.0, 'DeepPageVisitRate': 0.0, 'MeanUrlPathDepth': 1.0, 'MeanUrlLength': 61.333333333333336, 'UniquePageVisitCount': 2, 'SeqOccurTime_38164fbd17603d73f696b8b4d72664d735bb6a7c88577687fd2ae33fd6964153': 0}]
2025-03-17 17:28:52,277 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 17:28:52,302 - INFO - A new detect record generated; Traffic data size: 3
2025-03-17 17:31:58,407 - INFO - Detection started. Combined data duration: 10
2025-03-17 17:32:12,456 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 7
2025-03-17 17:32:12,457 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 17:32:12,458 - INFO - [{'MeanUrlParamsCount': 0.0, 'RepeatUrlVisitCount': 0.0, 'DeepPageVisitRate': 0.0, 'MeanUrlPathDepth': 1.0, 'MeanUrlLength': 66.0, 'UniquePageVisitCount': 1, 'SeqOccurTime_38164fbd17603d73f696b8b4d72664d735bb6a7c88577687fd2ae33fd6964153': 0}]
2025-03-17 17:32:12,459 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 17:32:12,483 - INFO - A new detect record generated; Traffic data size: 1
2025-03-17 17:32:15,582 - INFO - Detection paused.
2025-03-17 17:32:22,496 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 7
2025-03-17 17:32:22,498 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 17:32:22,499 - INFO - [{'MeanUrlParamsCount': 0.0, 'RepeatUrlVisitCount': 0.0, 'DeepPageVisitRate': 0.0, 'MeanUrlPathDepth': 1.0, 'MeanUrlLength': 63.0, 'UniquePageVisitCount': 1, 'SeqOccurTime_38164fbd17603d73f696b8b4d72664d735bb6a7c88577687fd2ae33fd6964153': 0}]
2025-03-17 17:32:22,499 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 17:32:22,524 - INFO - A new detect record generated; Traffic data size: 1
2025-03-17 17:35:41,863 - INFO - Detection started. Combined data duration: 10
2025-03-17 17:35:52,415 - INFO - Detection paused.
2025-03-17 17:36:46,061 - INFO - Detection started. Combined data duration: 10
2025-03-17 17:38:42,827 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 7
2025-03-17 17:38:42,828 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 17:38:42,829 - INFO - [{'MeanUrlParamsCount': 0.0, 'RepeatUrlVisitCount': 0.0, 'DeepPageVisitRate': 0.0, 'MeanUrlPathDepth': 1.0, 'MeanUrlLength': 62.0, 'UniquePageVisitCount': 1, 'SeqOccurTime_38164fbd17603d73f696b8b4d72664d735bb6a7c88577687fd2ae33fd6964153': 0}]
2025-03-17 17:38:42,829 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 17:38:42,854 - INFO - A new detect record generated; Traffic data size: 1
2025-03-17 17:39:02,877 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 7
2025-03-17 17:39:02,879 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 17:39:02,880 - INFO - [{'MeanUrlParamsCount': 0.0, 'RepeatUrlVisitCount': 0.0, 'DeepPageVisitRate': 0.0, 'MeanUrlPathDepth': 1.0, 'MeanUrlLength': 60.5, 'UniquePageVisitCount': 2, 'SeqOccurTime_38164fbd17603d73f696b8b4d72664d735bb6a7c88577687fd2ae33fd6964153': 0}]
2025-03-17 17:39:02,880 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 17:39:02,905 - INFO - A new detect record generated; Traffic data size: 2
2025-03-17 17:39:53,088 - INFO - Detection paused.
2025-03-17 17:39:55,560 - INFO - Detection started. Combined data duration: 10
2025-03-17 17:41:26,372 - INFO - Detection paused.
2025-03-17 17:42:56,838 - INFO - Trying to construct model...
2025-03-17 17:42:56,839 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-17 17:42:56,888 - INFO - Training model... Size of feature_list: 7
2025-03-17 17:42:56,901 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 17:42:56,903 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 17:42:56,904 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 17:42:56,905 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 17:42:56,906 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 17:42:56,907 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 17:42:56,908 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 17:42:56,909 - INFO - Extracting features... Size of feature_list: 7
[17:42:57] WARNING: /workspace/src/learner.cc:740: 
Parameters: { "use_label_encoder" } are not used.

2025-03-17 17:42:57,061 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 17:42:57,062 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 17:42:57,064 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 17:42:57,065 - INFO - Extracting features... Size of feature_list: 7
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
2025-03-17 17:42:57,076 - INFO - Model constructed.
2025-03-17 17:55:25,119 - INFO - Detection started. Combined data duration: 10
2025-03-17 17:55:26,035 - INFO - Detection paused.
2025-03-17 23:12:04,005 - INFO - Detection started. Combined data duration: 10
2025-03-17 23:12:10,872 - INFO - Detection paused.
2025-03-17 23:17:16,276 - INFO - Detection started. Combined data duration: 10
2025-03-17 23:17:22,026 - INFO - Detection paused.
2025-03-17 23:37:20,374 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-17 23:37:20,413 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-17 23:37:20,580 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-17 23:37:20,580 - INFO - Starting data generation...
2025-03-17 23:37:20,580 - INFO - API_KNOWLEDGE: [{'number': 'API_3303', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_3304', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}]
2025-03-17 23:37:20,580 - INFO - APP_KNOWLEDGE: {'func_description': 'This is an updated test application', 'normal_seqs': ['There are no example normal seqs'], 'malicious_seqs': ['There are no example malicious seqs'], 'roles': ['admin', 'ordinary_user', 'unlogged_in_user']}
2025-03-17 23:37:20,635 - INFO - Generating simulated API sequences...
2025-03-17 23:37:20,635 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 23:37:20,635 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 23:37:20,635 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 23:37:20,635 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 23:37:20,635 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 23:37:20,635 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 23:37:20,635 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 23:37:20,635 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 23:37:21,889 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 23:37:21,890 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 23:37:21,890 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 23:37:21,890 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 23:37:21,890 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 23:37:21,890 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 23:37:21,890 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 23:37:21,890 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 23:37:21,890 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 23:37:21,890 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3303', 'API_3304'], 'ordinary_user': [], 'admin': ['API_3303', 'API_3304'], 'oridinary_user': ['API_3303', 'API_3304']}
2025-03-17 23:37:21,890 - INFO - API sequence 1/12 generated
2025-03-17 23:37:21,890 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 23:37:21,890 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 23:37:21,890 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 23:37:21,890 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 23:37:21,890 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 23:37:21,890 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 23:37:21,890 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 23:37:21,890 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 23:37:23,973 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 23:37:23,974 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 23:37:23,974 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 23:37:23,974 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 23:37:23,974 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 23:37:23,974 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 23:37:23,974 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 23:37:23,974 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 23:37:23,974 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 23:37:23,974 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3303', 'API_3304'], 'ordinary_user': [], 'admin': ['API_3303', 'API_3304'], 'oridinary_user': ['API_3303', 'API_3304']}
2025-03-17 23:37:23,974 - INFO - API sequence 2/12 generated
2025-03-17 23:37:23,974 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 23:37:23,974 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 23:37:23,974 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 23:37:23,974 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 23:37:23,974 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 23:37:23,974 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 23:37:23,974 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 23:37:23,974 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 23:37:25,004 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 23:37:25,004 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 23:37:25,004 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 23:37:25,004 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 23:37:25,004 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 23:37:25,004 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 23:37:25,004 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 23:37:25,004 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 23:37:25,004 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 23:37:25,005 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3303', 'API_3304'], 'ordinary_user': [], 'admin': ['API_3303', 'API_3304'], 'oridinary_user': ['API_3303', 'API_3304']}
2025-03-17 23:37:25,005 - INFO - API sequence 3/12 generated
2025-03-17 23:37:25,005 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 23:37:25,005 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 23:37:25,005 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 23:37:25,005 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 23:37:25,005 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 23:37:25,005 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 23:37:25,005 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 23:37:25,005 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-17 23:37:28,972 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 23:37:28,972 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 23:37:28,972 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 23:37:28,972 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 23:37:28,972 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 23:37:28,972 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 23:37:28,972 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 23:37:28,972 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 23:37:28,972 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 23:37:28,973 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3303', 'API_3304'], 'ordinary_user': [], 'admin': ['API_3303', 'API_3304'], 'oridinary_user': ['API_3303', 'API_3304']}
2025-03-17 23:37:28,973 - INFO - API sequence 4/12 generated
2025-03-17 23:37:28,973 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 23:37:28,973 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 23:37:28,973 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 23:37:28,973 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 23:37:28,973 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 23:37:28,973 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 23:37:28,973 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 23:37:28,973 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 23:37:30,933 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 23:37:30,934 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 23:37:30,934 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 23:37:30,934 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 23:37:30,934 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 23:37:30,934 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 23:37:30,934 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 23:37:30,934 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 23:37:30,934 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 23:37:30,934 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3303', 'API_3304'], 'ordinary_user': [], 'admin': ['API_3303', 'API_3304'], 'oridinary_user': ['API_3303', 'API_3304']}
2025-03-17 23:37:30,934 - INFO - API sequence 5/12 generated
2025-03-17 23:37:30,934 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 23:37:30,934 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 23:37:30,934 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 23:37:30,934 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 23:37:30,934 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 23:37:30,934 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 23:37:30,934 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 23:37:30,934 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 23:37:32,024 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 23:37:32,025 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 23:37:32,025 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 23:37:32,025 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 23:37:32,025 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 23:37:32,025 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 23:37:32,025 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 23:37:32,025 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 23:37:32,025 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 23:37:32,025 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3303', 'API_3304'], 'ordinary_user': [], 'admin': ['API_3303', 'API_3304'], 'oridinary_user': ['API_3303', 'API_3304']}
2025-03-17 23:37:32,025 - INFO - API sequence 6/12 generated
2025-03-17 23:37:32,025 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 23:37:32,025 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 23:37:32,025 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 23:37:32,025 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 23:37:32,025 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 23:37:32,025 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 23:37:32,025 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 23:37:32,025 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 23:37:33,875 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 23:37:33,876 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 23:37:33,876 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 23:37:33,876 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 23:37:33,876 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 23:37:33,876 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 23:37:33,876 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 23:37:33,876 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 23:37:33,876 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 23:37:33,876 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3303', 'API_3304'], 'ordinary_user': [], 'admin': ['API_3303', 'API_3304'], 'oridinary_user': ['API_3303', 'API_3304']}
2025-03-17 23:37:33,876 - INFO - API sequence 7/12 generated
2025-03-17 23:37:33,876 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 23:37:33,876 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 23:37:33,876 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 23:37:33,876 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 23:37:33,876 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 23:37:33,876 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 23:37:33,876 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 23:37:33,876 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-17 23:37:34,755 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 23:37:34,756 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 23:37:34,756 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 23:37:34,756 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 23:37:34,756 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 23:37:34,756 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 23:37:34,756 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 23:37:34,756 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 23:37:34,756 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 23:37:34,756 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3303', 'API_3304'], 'ordinary_user': [], 'admin': ['API_3303', 'API_3304'], 'oridinary_user': ['API_3303', 'API_3304']}
2025-03-17 23:37:34,756 - INFO - API sequence 8/12 generated
2025-03-17 23:37:34,756 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 23:37:34,756 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 23:37:34,756 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 23:37:34,756 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 23:37:34,756 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 23:37:34,756 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 23:37:34,756 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 23:37:34,756 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 23:37:36,930 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 23:37:36,931 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 23:37:36,931 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 23:37:36,931 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 23:37:36,931 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 23:37:36,931 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 23:37:36,931 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 23:37:36,931 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 23:37:36,931 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 23:37:36,931 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3303', 'API_3304'], 'ordinary_user': [], 'admin': ['API_3303', 'API_3304'], 'oridinary_user': ['API_3303', 'API_3304']}
2025-03-17 23:37:36,931 - INFO - API sequence 9/12 generated
2025-03-17 23:37:36,931 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 23:37:36,931 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 23:37:36,931 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 23:37:36,931 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 23:37:36,931 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 23:37:36,931 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 23:37:36,931 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 23:37:36,931 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-17 23:37:38,116 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 23:37:38,117 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 23:37:38,117 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 23:37:38,117 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 23:37:38,117 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 23:37:38,117 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 23:37:38,117 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 23:37:38,117 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 23:37:38,117 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-17 23:37:38,117 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3303', 'API_3304'], 'ordinary_user': [], 'admin': ['API_3303', 'API_3304'], 'oridinary_user': ['API_3303', 'API_3304']}
2025-03-17 23:37:38,117 - INFO - API sequence 10/12 generated
2025-03-17 23:37:38,117 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 23:37:38,117 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 23:37:38,117 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 23:37:38,117 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 23:37:38,117 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 23:37:38,117 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 23:37:38,117 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 23:37:38,117 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 23:37:39,123 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 23:37:39,124 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 23:37:39,124 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 23:37:39,124 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 23:37:39,124 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 23:37:39,124 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 23:37:39,124 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 23:37:39,124 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 23:37:39,124 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 23:37:39,124 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3303', 'API_3304'], 'ordinary_user': [], 'admin': ['API_3303', 'API_3304'], 'oridinary_user': ['API_3303', 'API_3304']}
2025-03-17 23:37:39,125 - INFO - API sequence 11/12 generated
2025-03-17 23:37:39,125 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 23:37:39,125 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 23:37:39,125 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 23:37:39,125 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 23:37:39,125 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 23:37:39,125 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 23:37:39,125 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 23:37:39,125 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-17 23:37:40,740 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-17 23:37:40,743 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 23:37:40,743 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 23:37:40,743 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 23:37:40,743 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 23:37:40,743 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 23:37:40,743 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 23:37:40,743 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 23:37:40,743 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-17 23:37:40,744 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3303', 'API_3304'], 'ordinary_user': [], 'admin': ['API_3303', 'API_3304'], 'oridinary_user': ['API_3303', 'API_3304']}
2025-03-17 23:37:40,744 - INFO - API sequence 12/12 generated
2025-03-17 23:37:40,744 - INFO - API sequences serialized to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py/serialized_llm_agents.json
2025-03-17 23:37:40,745 - INFO - Generating simulated traffic data set...
2025-03-17 23:37:40,748 - INFO - Error when injecting params for API_1
2025-03-17 23:37:40,752 - INFO - Error when injecting params for API_3
2025-03-17 23:37:40,752 - INFO - error_apis: ['3303', '3303']
2025-03-17 23:37:40,752 - INFO - Simulated traffic data for 1/12 user collected：user: normaluser malicious: True
2025-03-17 23:37:40,755 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-17 23:37:40,755 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 23:37:40,758 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-17 23:37:40,758 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-17 23:37:40,758 - INFO - error_apis: []
2025-03-17 23:37:40,758 - INFO - Simulated traffic data for 2/12 user collected：user: unloggeduser malicious: True
2025-03-17 23:37:40,762 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-17 23:37:40,762 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 23:37:40,765 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-17 23:37:40,765 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-17 23:37:40,765 - INFO - error_apis: []
2025-03-17 23:37:40,765 - INFO - Simulated traffic data for 3/12 user collected：user: unloggeduser malicious: True
2025-03-17 23:37:40,768 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-17 23:37:40,768 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 23:37:40,771 - INFO - Error when injecting params for API_3
2025-03-17 23:37:40,771 - INFO - error_apis: ['3303']
2025-03-17 23:37:40,771 - INFO - Simulated traffic data for 4/12 user collected：user: unloggeduser malicious: True
2025-03-17 23:37:40,775 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-17 23:37:40,775 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 23:37:40,775 - INFO - error_apis: []
2025-03-17 23:37:40,775 - INFO - Simulated traffic data for 5/12 user collected：user: adminuser malicious: False
2025-03-17 23:37:40,778 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-17 23:37:40,778 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 23:37:40,778 - INFO - error_apis: []
2025-03-17 23:37:40,778 - INFO - Simulated traffic data for 6/12 user collected：user: normaluser malicious: False
2025-03-17 23:37:40,781 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-17 23:37:40,781 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 23:37:40,781 - INFO - error_apis: []
2025-03-17 23:37:40,781 - INFO - Simulated traffic data for 7/12 user collected：user: normaluser malicious: False
2025-03-17 23:37:40,784 - INFO - Error when injecting params for API_1
2025-03-17 23:37:40,784 - INFO - error_apis: ['3303']
2025-03-17 23:37:40,785 - INFO - Simulated traffic data for 8/12 user collected：user: adminuser malicious: False
2025-03-17 23:37:40,788 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-17 23:37:40,788 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 23:37:40,790 - INFO - Error when injecting params for API_3
2025-03-17 23:37:40,791 - INFO - error_apis: ['3303']
2025-03-17 23:37:40,791 - INFO - Simulated traffic data for 9/12 user collected：user: normaluser malicious: True
2025-03-17 23:37:40,794 - INFO - Error when injecting params for API_1
2025-03-17 23:37:40,797 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-17 23:37:40,797 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-17 23:37:40,797 - INFO - error_apis: ['3303']
2025-03-17 23:37:40,797 - INFO - Simulated traffic data for 10/12 user collected：user: normaluser malicious: True
2025-03-17 23:37:40,800 - INFO - Error when injecting params for API_1
2025-03-17 23:37:40,800 - INFO - error_apis: ['3303']
2025-03-17 23:37:40,800 - INFO - Simulated traffic data for 11/12 user collected：user: normaluser malicious: False
2025-03-17 23:37:40,803 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-17 23:37:40,803 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-17 23:37:40,804 - INFO - error_apis: []
2025-03-17 23:37:40,804 - INFO - Simulated traffic data for 12/12 user collected：user: normaluser malicious: False
2025-03-17 23:37:40,806 - INFO - All simulated traffic data collected：/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/simulated_traffic_data.csv
2025-03-17 23:37:40,806 - INFO - error_apis: ['3303']
2025-03-17 23:48:03,672 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-17 23:48:03,712 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-17 23:48:03,712 - INFO - Extracting API list with API discovery algorithm...
2025-03-17 23:48:03,779 - INFO - Starting Drain3 template miner
2025-03-17 23:48:03,782 - INFO - Starting Drain3 template miner
2025-03-17 23:48:03,784 - INFO - Starting Drain3 template miner
2025-03-17 23:48:03,785 - INFO - Starting Drain3 template miner
2025-03-17 23:48:03,785 - INFO - Starting Drain3 template miner
2025-03-17 23:48:05,536 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-17 23:50:10,507 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-17 23:50:10,546 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-17 23:50:10,547 - INFO - Extracting API list with API discovery algorithm...
2025-03-17 23:50:10,614 - INFO - Starting Drain3 template miner
2025-03-17 23:50:10,617 - INFO - Starting Drain3 template miner
2025-03-17 23:50:10,619 - INFO - Starting Drain3 template miner
2025-03-17 23:50:10,620 - INFO - Starting Drain3 template miner
2025-03-17 23:50:10,620 - INFO - Starting Drain3 template miner
2025-03-17 23:50:12,414 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-17 23:51:04,590 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-17 23:51:04,640 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-17 23:51:04,640 - INFO - Extracting API list with API discovery algorithm...
2025-03-17 23:51:04,708 - INFO - Starting Drain3 template miner
2025-03-17 23:51:04,711 - INFO - Starting Drain3 template miner
2025-03-17 23:51:04,713 - INFO - Starting Drain3 template miner
2025-03-17 23:51:04,713 - INFO - Starting Drain3 template miner
2025-03-17 23:51:04,714 - INFO - Starting Drain3 template miner
2025-03-17 23:51:06,488 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-17 23:51:14,832 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-17 23:51:14,875 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-17 23:51:14,875 - INFO - Extracting API list with API discovery algorithm...
2025-03-17 23:51:14,944 - INFO - Starting Drain3 template miner
2025-03-17 23:51:14,947 - INFO - Starting Drain3 template miner
2025-03-17 23:51:14,949 - INFO - Starting Drain3 template miner
2025-03-17 23:51:14,949 - INFO - Starting Drain3 template miner
2025-03-17 23:51:14,950 - INFO - Starting Drain3 template miner
2025-03-17 23:51:16,730 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-17 23:51:36,698 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-17 23:51:36,737 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-17 23:51:36,737 - INFO - Extracting API list with API discovery algorithm...
2025-03-17 23:51:36,806 - INFO - Starting Drain3 template miner
2025-03-17 23:51:36,809 - INFO - Starting Drain3 template miner
2025-03-17 23:51:36,811 - INFO - Starting Drain3 template miner
2025-03-17 23:51:36,812 - INFO - Starting Drain3 template miner
2025-03-17 23:51:36,812 - INFO - Starting Drain3 template miner
2025-03-17 23:51:38,593 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-17 23:52:29,980 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-17 23:52:30,019 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-17 23:52:30,020 - INFO - Extracting API list with API discovery algorithm...
2025-03-17 23:52:30,087 - INFO - Starting Drain3 template miner
2025-03-17 23:52:30,090 - INFO - Starting Drain3 template miner
2025-03-17 23:52:30,092 - INFO - Starting Drain3 template miner
2025-03-17 23:52:30,092 - INFO - Starting Drain3 template miner
2025-03-17 23:52:30,093 - INFO - Starting Drain3 template miner
2025-03-17 23:52:31,867 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-17 23:52:44,797 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-17 23:52:44,836 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-17 23:52:44,836 - INFO - Extracting API list with API discovery algorithm...
2025-03-17 23:52:44,905 - INFO - Starting Drain3 template miner
2025-03-17 23:52:44,908 - INFO - Starting Drain3 template miner
2025-03-17 23:52:44,910 - INFO - Starting Drain3 template miner
2025-03-17 23:52:44,910 - INFO - Starting Drain3 template miner
2025-03-17 23:52:44,911 - INFO - Starting Drain3 template miner
2025-03-17 23:52:46,705 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-17 23:53:57,032 - INFO - Trying to construct model...
2025-03-17 23:53:57,032 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-17 23:53:57,057 - INFO - Training model... Size of feature_list: 7
2025-03-17 23:53:57,065 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 23:53:57,067 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 23:53:57,068 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 23:53:57,069 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 23:53:57,070 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 23:53:57,071 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 23:53:57,071 - INFO - Extracting features... Size of feature_list: 7
[23:53:57] WARNING: /workspace/src/learner.cc:740: 
Parameters: { "use_label_encoder" } are not used.

2025-03-17 23:53:57,099 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 23:53:57,101 - INFO - Extracting features... Size of feature_list: 7
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
2025-03-17 23:53:57,112 - INFO - Model constructed.
2025-03-17 23:54:00,500 - INFO - Trying to construct model...
2025-03-17 23:54:00,500 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-17 23:54:00,526 - INFO - Training model... Size of feature_list: 7
2025-03-17 23:54:00,534 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 23:54:00,535 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 23:54:00,536 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 23:54:00,537 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 23:54:00,538 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 23:54:00,539 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 23:54:00,540 - INFO - Extracting features... Size of feature_list: 7
[23:54:00] WARNING: /workspace/src/learner.cc:740: 
Parameters: { "use_label_encoder" } are not used.

2025-03-17 23:54:00,567 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 23:54:00,569 - INFO - Extracting features... Size of feature_list: 7
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
2025-03-17 23:54:00,580 - INFO - Model constructed.
2025-03-17 23:54:51,001 - INFO - Trying to construct model...
2025-03-17 23:54:51,001 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-17 23:54:51,027 - INFO - Training model... Size of feature_list: 7
2025-03-17 23:54:51,035 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 23:54:51,037 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 23:54:51,037 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 23:54:51,038 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 23:54:51,039 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 23:54:51,040 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 23:54:51,041 - INFO - Extracting features... Size of feature_list: 7
[23:54:51] WARNING: /workspace/src/learner.cc:740: 
Parameters: { "use_label_encoder" } are not used.

2025-03-17 23:54:51,068 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 23:54:51,070 - INFO - Extracting features... Size of feature_list: 7
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
2025-03-17 23:54:51,081 - INFO - Model constructed.
2025-03-17 23:56:43,279 - INFO - Trying to construct model...
2025-03-17 23:56:43,279 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-17 23:56:43,306 - INFO - Training model... Size of feature_list: 7
2025-03-17 23:56:43,314 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 23:56:43,315 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 23:56:43,316 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 23:56:43,317 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 23:56:43,318 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 23:56:43,319 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 23:56:43,320 - INFO - Extracting features... Size of feature_list: 7
[23:56:43] WARNING: /workspace/src/learner.cc:740: 
Parameters: { "use_label_encoder" } are not used.

2025-03-17 23:56:43,347 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 23:56:43,348 - INFO - Extracting features... Size of feature_list: 7
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
2025-03-17 23:56:43,359 - INFO - Model constructed.
2025-03-17 23:56:48,201 - INFO - Trying to construct model...
2025-03-17 23:56:48,201 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-17 23:56:48,231 - INFO - Training model... Size of feature_list: 7
2025-03-17 23:56:48,245 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 23:56:48,247 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 23:56:48,248 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 23:56:48,249 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 23:56:48,250 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 23:56:48,251 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 23:56:48,252 - INFO - Extracting features... Size of feature_list: 7
[23:56:48] WARNING: /workspace/src/learner.cc:740: 
Parameters: { "use_label_encoder" } are not used.

2025-03-17 23:56:48,285 - INFO - Extracting features... Size of feature_list: 7
2025-03-17 23:56:48,286 - INFO - Extracting features... Size of feature_list: 7
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
2025-03-17 23:56:48,297 - INFO - Model constructed.
2025-03-18 11:45:36,473 - INFO - Detection started. Combined data duration: 10
2025-03-18 11:45:51,017 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 7
2025-03-18 11:45:51,064 - INFO - Extracting features... Size of feature_list: 7
2025-03-18 11:45:51,105 - INFO - [{'MeanUrlParamsCount': 0.0, 'RepeatUrlVisitCount': 0.0, 'DeepPageVisitRate': 0.0, 'MeanUrlPathDepth': 0.0, 'MeanUrlLength': 25.0, 'UniquePageVisitCount': 1, 'SeqOccurTime_38164fbd17603d73f696b8b4d72664d735bb6a7c88577687fd2ae33fd6964153': 0}]
2025-03-18 11:45:51,105 - INFO - Extracting features... Size of feature_list: 7
2025-03-18 11:45:51,212 - INFO - A new detect record generated; Traffic data size: 1
2025-03-18 11:46:01,324 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 7
2025-03-18 11:46:01,326 - INFO - Extracting features... Size of feature_list: 7
2025-03-18 11:46:01,353 - INFO - [{'MeanUrlParamsCount': 0.0, 'RepeatUrlVisitCount': 2.0, 'DeepPageVisitRate': 0.0, 'MeanUrlPathDepth': 0.9166666666666666, 'MeanUrlLength': 64.16666666666667, 'UniquePageVisitCount': 10, 'SeqOccurTime_38164fbd17603d73f696b8b4d72664d735bb6a7c88577687fd2ae33fd6964153': 0}]
2025-03-18 11:46:01,353 - INFO - Extracting features... Size of feature_list: 7
2025-03-18 11:46:01,395 - INFO - A new detect record generated; Traffic data size: 12
2025-03-18 11:46:11,415 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 7
2025-03-18 11:46:11,416 - INFO - Extracting features... Size of feature_list: 7
2025-03-18 11:46:11,640 - INFO - [{'MeanUrlParamsCount': 0.0, 'RepeatUrlVisitCount': 2.0, 'DeepPageVisitRate': 0.0, 'MeanUrlPathDepth': 1.0, 'MeanUrlLength': 60.59090909090909, 'UniquePageVisitCount': 2, 'SeqOccurTime_38164fbd17603d73f696b8b4d72664d735bb6a7c88577687fd2ae33fd6964153': 0}]
2025-03-18 11:46:11,641 - INFO - Extracting features... Size of feature_list: 7
2025-03-18 11:46:11,896 - INFO - A new detect record generated; Traffic data size: 44
2025-03-18 11:46:17,130 - INFO - Detection paused.
2025-03-18 11:46:21,902 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 7
2025-03-18 11:46:21,904 - INFO - Extracting features... Size of feature_list: 7
2025-03-18 11:46:21,913 - INFO - [{'MeanUrlParamsCount': 0.0, 'RepeatUrlVisitCount': 1.0, 'DeepPageVisitRate': 0.0, 'MeanUrlPathDepth': 1.0, 'MeanUrlLength': 60.22222222222222, 'UniquePageVisitCount': 2, 'SeqOccurTime_38164fbd17603d73f696b8b4d72664d735bb6a7c88577687fd2ae33fd6964153': 0}]
2025-03-18 11:46:21,913 - INFO - Extracting features... Size of feature_list: 7
2025-03-18 11:46:21,951 - INFO - A new detect record generated; Traffic data size: 9
2025-03-18 11:52:48,759 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-18 11:52:48,848 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-18 11:52:48,848 - INFO - Extracting API list with API discovery algorithm...
2025-03-18 11:52:48,920 - INFO - Starting Drain3 template miner
2025-03-18 11:52:48,923 - INFO - Starting Drain3 template miner
2025-03-18 11:52:48,925 - INFO - Starting Drain3 template miner
2025-03-18 11:52:48,926 - INFO - Starting Drain3 template miner
2025-03-18 11:52:48,926 - INFO - Starting Drain3 template miner
2025-03-18 11:52:50,761 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-18 11:53:16,572 - INFO - Trying to construct model...
2025-03-18 11:53:16,573 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-18 11:53:16,616 - INFO - Training model... Size of feature_list: 7
2025-03-18 11:53:16,635 - INFO - Extracting features... Size of feature_list: 7
2025-03-18 11:53:16,637 - INFO - Extracting features... Size of feature_list: 7
2025-03-18 11:53:16,638 - INFO - Extracting features... Size of feature_list: 7
2025-03-18 11:53:16,639 - INFO - Extracting features... Size of feature_list: 7
2025-03-18 11:53:16,640 - INFO - Extracting features... Size of feature_list: 7
2025-03-18 11:53:16,641 - INFO - Extracting features... Size of feature_list: 7
2025-03-18 11:53:16,642 - INFO - Extracting features... Size of feature_list: 7
[11:53:16] WARNING: /workspace/src/learner.cc:740: 
Parameters: { "use_label_encoder" } are not used.

2025-03-18 11:53:16,747 - INFO - Extracting features... Size of feature_list: 7
2025-03-18 11:53:16,749 - INFO - Extracting features... Size of feature_list: 7
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
2025-03-18 11:53:16,760 - INFO - Model constructed.
2025-03-18 11:56:26,560 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-18 11:56:26,604 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-18 11:56:26,605 - INFO - Extracting API list with API discovery algorithm...
2025-03-18 11:56:26,672 - INFO - Starting Drain3 template miner
2025-03-18 11:56:26,676 - INFO - Starting Drain3 template miner
2025-03-18 11:56:26,678 - INFO - Starting Drain3 template miner
2025-03-18 11:56:26,678 - INFO - Starting Drain3 template miner
2025-03-18 11:56:26,679 - INFO - Starting Drain3 template miner
2025-03-18 11:56:28,514 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-18 11:56:35,972 - INFO - Trying to construct model...
2025-03-18 11:56:35,972 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-18 11:56:35,998 - INFO - Training model... Size of feature_list: 7
2025-03-18 11:56:36,006 - INFO - Extracting features... Size of feature_list: 7
2025-03-18 11:56:36,008 - INFO - Extracting features... Size of feature_list: 7
2025-03-18 11:56:36,009 - INFO - Extracting features... Size of feature_list: 7
2025-03-18 11:56:36,010 - INFO - Extracting features... Size of feature_list: 7
2025-03-18 11:56:36,011 - INFO - Extracting features... Size of feature_list: 7
2025-03-18 11:56:36,012 - INFO - Extracting features... Size of feature_list: 7
2025-03-18 11:56:36,013 - INFO - Extracting features... Size of feature_list: 7
[11:56:36] WARNING: /workspace/src/learner.cc:740: 
Parameters: { "use_label_encoder" } are not used.

2025-03-18 11:56:36,040 - INFO - Extracting features... Size of feature_list: 7
2025-03-18 11:56:36,042 - INFO - Extracting features... Size of feature_list: 7
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
2025-03-18 11:56:36,054 - INFO - Model constructed.
2025-03-18 11:56:45,818 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-18 11:56:45,862 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-18 11:56:46,089 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-18 11:56:46,090 - INFO - Starting data generation...
2025-03-18 11:56:46,090 - INFO - API_KNOWLEDGE: [{'number': 'API_3882', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_3883', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}]
2025-03-18 11:56:46,090 - INFO - APP_KNOWLEDGE: {'func_description': 'This is an updated test application', 'normal_seqs': ['There are no example normal seqs'], 'malicious_seqs': ['There are no example malicious seqs'], 'roles': ['admin', 'ordinary_user', 'unlogged_in_user']}
2025-03-18 11:56:46,140 - INFO - Generating simulated API sequences...
2025-03-18 11:56:46,140 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 11:56:46,140 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 11:56:46,140 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 11:56:46,140 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 11:56:46,140 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 11:56:46,140 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 11:56:46,140 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 11:56:46,140 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 11:56:46,140 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 11:56:48,486 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-18 11:56:48,502 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 11:56:48,502 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 11:56:48,502 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 11:56:48,502 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 11:56:48,502 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 11:56:48,502 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 11:56:48,502 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 11:56:48,502 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 11:56:48,502 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 11:56:48,502 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3882', 'API_3883'], 'ordinary_user': [], 'admin': ['API_3882', 'API_3883'], 'oridinary_user': ['API_3882', 'API_3883']}
2025-03-18 11:56:48,502 - INFO - API sequence 1/12 generated
2025-03-18 11:56:48,502 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 11:56:48,502 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 11:56:48,502 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 11:56:48,502 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 11:56:48,502 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 11:56:48,502 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 11:56:48,502 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 11:56:48,502 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 11:56:48,502 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 11:56:49,709 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-18 11:56:49,711 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 11:56:49,711 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 11:56:49,711 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 11:56:49,711 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 11:56:49,711 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 11:56:49,711 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 11:56:49,711 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 11:56:49,711 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 11:56:49,711 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 11:56:49,711 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3882', 'API_3883'], 'ordinary_user': [], 'admin': ['API_3882', 'API_3883'], 'oridinary_user': ['API_3882', 'API_3883']}
2025-03-18 11:56:49,711 - INFO - API sequence 2/12 generated
2025-03-18 11:56:49,711 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 11:56:49,711 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 11:56:49,711 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 11:56:49,711 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 11:56:49,711 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 11:56:49,711 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 11:56:49,711 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 11:56:49,711 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 11:56:49,711 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 11:56:51,125 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-18 11:56:51,126 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 11:56:51,126 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 11:56:51,126 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 11:56:51,126 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 11:56:51,126 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 11:56:51,126 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 11:56:51,126 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 11:56:51,126 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 11:56:51,126 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 11:56:51,127 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3882', 'API_3883'], 'ordinary_user': [], 'admin': ['API_3882', 'API_3883'], 'oridinary_user': ['API_3882', 'API_3883']}
2025-03-18 11:56:51,127 - INFO - API sequence 3/12 generated
2025-03-18 11:56:51,127 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 11:56:51,127 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 11:56:51,127 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 11:56:51,127 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 11:56:51,127 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 11:56:51,127 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 11:56:51,127 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 11:56:51,127 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 11:56:51,127 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 11:56:52,853 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-18 11:56:52,853 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 11:56:52,853 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 11:56:52,853 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 11:56:52,853 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 11:56:52,853 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 11:56:52,853 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 11:56:52,853 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 11:56:52,853 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 11:56:52,853 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 11:56:52,854 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3882', 'API_3883'], 'ordinary_user': [], 'admin': ['API_3882', 'API_3883'], 'oridinary_user': ['API_3882', 'API_3883']}
2025-03-18 11:56:52,854 - INFO - API sequence 4/12 generated
2025-03-18 11:56:52,854 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 11:56:52,854 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 11:56:52,854 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 11:56:52,854 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 11:56:52,854 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 11:56:52,854 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 11:56:52,854 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 11:56:52,854 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 11:56:52,854 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 11:56:56,177 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-18 11:56:56,178 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 11:56:56,178 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 11:56:56,178 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 11:56:56,178 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 11:56:56,178 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 11:56:56,178 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 11:56:56,178 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 11:56:56,178 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 11:56:56,178 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 11:56:56,179 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3882', 'API_3883'], 'ordinary_user': [], 'admin': ['API_3882', 'API_3883'], 'oridinary_user': ['API_3882', 'API_3883']}
2025-03-18 11:56:56,179 - INFO - API sequence 5/12 generated
2025-03-18 11:56:56,179 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 11:56:56,179 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 11:56:56,179 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 11:56:56,179 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 11:56:56,179 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 11:56:56,179 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 11:56:56,179 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 11:56:56,179 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 11:56:56,179 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 11:56:57,679 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-18 11:56:57,680 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 11:56:57,680 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 11:56:57,680 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 11:56:57,680 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 11:56:57,680 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 11:56:57,680 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 11:56:57,680 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 11:56:57,680 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 11:56:57,680 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 11:56:57,680 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3882', 'API_3883'], 'ordinary_user': [], 'admin': ['API_3882', 'API_3883'], 'oridinary_user': ['API_3882', 'API_3883']}
2025-03-18 11:56:57,680 - INFO - API sequence 6/12 generated
2025-03-18 11:56:57,680 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 11:56:57,680 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 11:56:57,680 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 11:56:57,680 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 11:56:57,680 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 11:56:57,680 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 11:56:57,680 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 11:56:57,680 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 11:56:57,680 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 11:57:01,165 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-18 11:57:01,166 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 11:57:01,166 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 11:57:01,166 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 11:57:01,166 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 11:57:01,166 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 11:57:01,166 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 11:57:01,166 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 11:57:01,166 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 11:57:01,166 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 11:57:01,166 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3882', 'API_3883'], 'ordinary_user': [], 'admin': ['API_3882', 'API_3883'], 'oridinary_user': ['API_3882', 'API_3883']}
2025-03-18 11:57:01,166 - INFO - API sequence 7/12 generated
2025-03-18 11:57:01,166 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 11:57:01,166 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 11:57:01,166 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 11:57:01,166 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 11:57:01,166 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 11:57:01,166 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 11:57:01,166 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 11:57:01,166 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 11:57:01,166 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 11:57:02,925 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-18 11:57:02,926 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 11:57:02,926 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 11:57:02,926 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 11:57:02,926 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 11:57:02,926 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 11:57:02,926 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 11:57:02,926 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 11:57:02,926 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 11:57:02,926 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 11:57:02,927 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3882', 'API_3883'], 'ordinary_user': [], 'admin': ['API_3882', 'API_3883'], 'oridinary_user': ['API_3882', 'API_3883']}
2025-03-18 11:57:02,927 - INFO - API sequence 8/12 generated
2025-03-18 11:57:02,927 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 11:57:02,927 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 11:57:02,927 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 11:57:02,927 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 11:57:02,927 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 11:57:02,927 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 11:57:02,927 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 11:57:02,927 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 11:57:02,927 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 11:57:04,046 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-18 11:57:04,047 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 11:57:04,047 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 11:57:04,047 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 11:57:04,047 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 11:57:04,047 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 11:57:04,047 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 11:57:04,047 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 11:57:04,047 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 11:57:04,047 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 11:57:04,047 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3882', 'API_3883'], 'ordinary_user': [], 'admin': ['API_3882', 'API_3883'], 'oridinary_user': ['API_3882', 'API_3883']}
2025-03-18 11:57:04,047 - INFO - API sequence 9/12 generated
2025-03-18 11:57:04,047 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 11:57:04,047 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 11:57:04,047 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 11:57:04,047 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 11:57:04,047 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 11:57:04,047 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 11:57:04,047 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 11:57:04,047 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 11:57:04,047 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 11:57:06,031 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-18 11:57:06,032 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 11:57:06,032 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 11:57:06,032 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 11:57:06,032 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 11:57:06,032 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 11:57:06,032 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 11:57:06,032 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 11:57:06,032 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 11:57:06,032 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 11:57:06,033 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3882', 'API_3883'], 'ordinary_user': [], 'admin': ['API_3882', 'API_3883'], 'oridinary_user': ['API_3882', 'API_3883']}
2025-03-18 11:57:06,033 - INFO - API sequence 10/12 generated
2025-03-18 11:57:06,033 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 11:57:06,033 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 11:57:06,033 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 11:57:06,033 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 11:57:06,033 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 11:57:06,033 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 11:57:06,033 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 11:57:06,033 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 11:57:06,033 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 11:57:09,912 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-18 11:57:09,913 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 11:57:09,913 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 11:57:09,913 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 11:57:09,913 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 11:57:09,913 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 11:57:09,913 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 11:57:09,913 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 11:57:09,913 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 11:57:09,913 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 11:57:09,913 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3882', 'API_3883'], 'ordinary_user': [], 'admin': ['API_3882', 'API_3883'], 'oridinary_user': ['API_3882', 'API_3883']}
2025-03-18 11:57:09,913 - INFO - API sequence 11/12 generated
2025-03-18 11:57:09,913 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 11:57:09,913 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 11:57:09,913 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 11:57:09,913 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 11:57:09,913 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 11:57:09,913 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 11:57:09,913 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 11:57:09,913 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 11:57:09,913 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 11:57:12,538 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-18 11:57:12,539 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-18 11:57:12,539 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-18 11:57:12,539 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-18 11:57:12,539 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-18 11:57:12,539 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-18 11:57:12,539 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-18 11:57:12,539 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-18 11:57:12,539 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-18 11:57:12,539 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-18 11:57:12,539 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_3882', 'API_3883'], 'ordinary_user': [], 'admin': ['API_3882', 'API_3883'], 'oridinary_user': ['API_3882', 'API_3883']}
2025-03-18 11:57:12,539 - INFO - API sequence 12/12 generated
2025-03-18 11:57:12,540 - INFO - API sequences serialized to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py/serialized_llm_agents.json
2025-03-18 11:57:12,540 - INFO - Generating simulated traffic data set...
2025-03-18 11:57:12,549 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-18 11:57:12,549 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-18 11:57:12,822 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-18 11:57:12,823 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-18 11:57:12,823 - INFO - error_apis: []
2025-03-18 11:57:12,823 - INFO - Simulated traffic data for 1/12 user collected：user: unloggeduser malicious: True
2025-03-18 11:57:12,831 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-18 11:57:12,832 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-18 11:57:12,832 - INFO - error_apis: []
2025-03-18 11:57:12,832 - INFO - Simulated traffic data for 2/12 user collected：user: normaluser malicious: False
2025-03-18 11:57:12,840 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-18 11:57:12,841 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-18 11:57:12,848 - INFO - Error when injecting params for API_3
2025-03-18 11:57:12,849 - INFO - error_apis: ['3882']
2025-03-18 11:57:12,849 - INFO - Simulated traffic data for 3/12 user collected：user: unloggeduser malicious: True
2025-03-18 11:57:12,858 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-18 11:57:12,859 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-18 11:57:12,859 - INFO - error_apis: []
2025-03-18 11:57:12,859 - INFO - Simulated traffic data for 4/12 user collected：user: adminuser malicious: False
2025-03-18 11:57:12,867 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-18 11:57:12,867 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-18 11:57:12,877 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-18 11:57:12,877 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-18 11:57:12,877 - INFO - error_apis: []
2025-03-18 11:57:12,877 - INFO - Simulated traffic data for 5/12 user collected：user: normaluser malicious: True
2025-03-18 11:57:12,886 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-18 11:57:12,886 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-18 11:57:12,886 - INFO - error_apis: []
2025-03-18 11:57:12,886 - INFO - Simulated traffic data for 6/12 user collected：user: adminuser malicious: False
2025-03-18 11:57:12,894 - INFO - Error when injecting params for API_1
2025-03-18 11:57:12,909 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-18 11:57:12,909 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-18 11:57:12,909 - INFO - error_apis: ['3882']
2025-03-18 11:57:12,909 - INFO - Simulated traffic data for 7/12 user collected：user: unloggeduser malicious: True
2025-03-18 11:57:12,917 - INFO - Error when injecting params for API_1
2025-03-18 11:57:12,918 - INFO - error_apis: ['3882']
2025-03-18 11:57:12,918 - INFO - Simulated traffic data for 8/12 user collected：user: normaluser malicious: False
2025-03-18 11:57:12,927 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-18 11:57:12,927 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-18 11:57:12,936 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-18 11:57:12,936 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-18 11:57:12,936 - INFO - error_apis: []
2025-03-18 11:57:12,936 - INFO - Simulated traffic data for 9/12 user collected：user: normaluser malicious: True
2025-03-18 11:57:12,944 - INFO - Error when injecting params for API_1
2025-03-18 11:57:12,945 - INFO - error_apis: ['3882']
2025-03-18 11:57:12,945 - INFO - Simulated traffic data for 10/12 user collected：user: normaluser malicious: False
2025-03-18 11:57:12,953 - INFO - Error when injecting params for API_1
2025-03-18 11:57:12,954 - INFO - error_apis: ['3882']
2025-03-18 11:57:12,954 - INFO - Simulated traffic data for 11/12 user collected：user: normaluser malicious: False
2025-03-18 11:57:12,962 - INFO - Error when injecting params for API_1
2025-03-18 11:57:12,971 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-18 11:57:12,972 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-18 11:57:12,981 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-18 11:57:12,981 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：False
2025-03-18 11:57:12,981 - INFO - error_apis: ['3882']
2025-03-18 11:57:12,981 - INFO - Simulated traffic data for 12/12 user collected：user: normaluser malicious: True
2025-03-18 11:57:12,984 - INFO - All simulated traffic data collected：/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/simulated_traffic_data.csv
2025-03-18 11:57:12,984 - INFO - error_apis: ['3882']
2025-03-18 11:57:14,879 - INFO - Trying to construct model...
2025-03-18 11:57:14,880 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-18 11:57:14,906 - INFO - Training model... Size of feature_list: 7
2025-03-18 11:57:14,914 - INFO - Extracting features... Size of feature_list: 7
2025-03-18 11:57:14,915 - INFO - Extracting features... Size of feature_list: 7
2025-03-18 11:57:14,917 - INFO - Extracting features... Size of feature_list: 7
2025-03-18 11:57:14,918 - INFO - Extracting features... Size of feature_list: 7
2025-03-18 11:57:14,919 - INFO - Extracting features... Size of feature_list: 7
2025-03-18 11:57:14,920 - INFO - Extracting features... Size of feature_list: 7
[11:57:14] WARNING: /workspace/src/learner.cc:740: 
Parameters: { "use_label_encoder" } are not used.

2025-03-18 11:57:14,958 - INFO - Extracting features... Size of feature_list: 7
2025-03-18 11:57:14,960 - INFO - Extracting features... Size of feature_list: 7
2025-03-18 11:57:14,961 - INFO - Extracting features... Size of feature_list: 7
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
2025-03-18 11:57:14,972 - INFO - Model constructed.
2025-03-18 12:32:04,877 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-18 12:32:04,920 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-18 12:32:04,920 - INFO - Extracting API list with API discovery algorithm...
2025-03-18 12:32:04,985 - INFO - Starting Drain3 template miner
2025-03-18 12:32:04,988 - INFO - Starting Drain3 template miner
2025-03-18 12:32:04,990 - INFO - Starting Drain3 template miner
2025-03-18 12:32:04,991 - INFO - Starting Drain3 template miner
2025-03-18 12:32:04,991 - INFO - Starting Drain3 template miner
2025-03-18 12:32:06,840 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-18 14:05:49,806 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-18 14:05:49,850 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-18 14:05:49,850 - INFO - Extracting API list with API discovery algorithm...
2025-03-18 14:05:49,914 - INFO - Starting Drain3 template miner
2025-03-18 14:05:49,917 - INFO - Starting Drain3 template miner
2025-03-18 14:05:49,919 - INFO - Starting Drain3 template miner
2025-03-18 14:05:49,919 - INFO - Starting Drain3 template miner
2025-03-18 14:05:49,920 - INFO - Starting Drain3 template miner
2025-03-18 14:05:51,769 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-18 14:06:06,467 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-18 14:06:06,520 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-18 14:06:06,520 - INFO - Extracting API list with API discovery algorithm...
2025-03-18 14:06:06,589 - INFO - Starting Drain3 template miner
2025-03-18 14:06:06,595 - INFO - Starting Drain3 template miner
2025-03-18 14:06:06,603 - INFO - Starting Drain3 template miner
2025-03-18 14:06:06,603 - INFO - Starting Drain3 template miner
2025-03-18 14:06:06,604 - INFO - Starting Drain3 template miner
2025-03-18 14:06:08,484 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-18 14:39:02,816 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-18 14:39:02,861 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-18 14:39:03,110 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-18 14:39:03,111 - INFO - Starting data generation...
2025-03-18 14:39:03,111 - INFO - API_KNOWLEDGE: [{'number': 'API_4077', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_4078', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}]
2025-03-18 14:39:03,111 - INFO - APP_KNOWLEDGE: {'func_description': 'This is an updated test application', 'normal_seqs': ['Role: role1; API_4077(); API_4078()', 'Role: role2; API_4077(); API_4078()'], 'malicious_seqs': ['Role: role3; API_4077(); API_4078()', 'Role: role4; API_4077(); API_4078()'], 'roles': ['admin', 'ordinary_user', 'unlogged_in_user']}
2025-03-18 14:39:03,175 - INFO - Generating simulated API sequences...
2025-03-18 14:39:03,175 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 14:39:03,175 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 14:39:03,175 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 14:39:03,175 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 14:39:03,175 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 14:39:03,175 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 14:39:03,175 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 14:39:03,175 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 14:39:03,175 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 14:39:03,175 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 14:39:05,550 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-18 14:39:05,551 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:39:05,551 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:39:05,551 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:39:05,551 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:39:05,551 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:39:05,551 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:39:05,551 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:39:05,551 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:39:05,551 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:39:05,551 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:39:05,551 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_4077', 'API_4078'], 'ordinary_user': [], 'admin': ['API_4077', 'API_4078'], 'oridinary_user': ['API_4077', 'API_4078']}
2025-03-18 14:39:05,551 - INFO - API sequence 1/12 generated
2025-03-18 14:39:05,551 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 14:39:05,551 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 14:39:05,551 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 14:39:05,551 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 14:39:05,551 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 14:39:05,551 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 14:39:05,551 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 14:39:05,551 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 14:39:05,551 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 14:39:05,551 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 14:39:08,114 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-18 14:39:08,115 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:39:08,115 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:39:08,115 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:39:08,115 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:39:08,115 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:39:08,115 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:39:08,115 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:39:08,115 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:39:08,115 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:39:08,115 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:39:08,115 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_4077', 'API_4078'], 'ordinary_user': [], 'admin': ['API_4077', 'API_4078'], 'oridinary_user': ['API_4077', 'API_4078']}
2025-03-18 14:39:08,115 - INFO - API sequence 2/12 generated
2025-03-18 14:39:08,116 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:08,116 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:08,116 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:08,116 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:08,116 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:08,116 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:08,116 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:08,116 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:08,116 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:08,116 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:12,373 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-18 14:39:12,373 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078', 'API_5'], malicious_sign_seq=[0, 0, 1] ==========
2025-03-18 14:39:12,373 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078', 'API_5'], malicious_sign_seq=[0, 0, 1] ==========
2025-03-18 14:39:12,373 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078', 'API_5'], malicious_sign_seq=[0, 0, 1] ==========
2025-03-18 14:39:12,373 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078', 'API_5'], malicious_sign_seq=[0, 0, 1] ==========
2025-03-18 14:39:12,373 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078', 'API_5'], malicious_sign_seq=[0, 0, 1] ==========
2025-03-18 14:39:12,373 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078', 'API_5'], malicious_sign_seq=[0, 0, 1] ==========
2025-03-18 14:39:12,373 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078', 'API_5'], malicious_sign_seq=[0, 0, 1] ==========
2025-03-18 14:39:12,373 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078', 'API_5'], malicious_sign_seq=[0, 0, 1] ==========
2025-03-18 14:39:12,373 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078', 'API_5'], malicious_sign_seq=[0, 0, 1] ==========
2025-03-18 14:39:12,373 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078', 'API_5'], malicious_sign_seq=[0, 0, 1] ==========
2025-03-18 14:39:12,374 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_4077', 'API_4078'], 'ordinary_user': [], 'admin': ['API_4077', 'API_4078'], 'oridinary_user': ['API_4077', 'API_4078']}
2025-03-18 14:39:12,374 - INFO - API sequence 3/12 generated
2025-03-18 14:39:12,374 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:12,374 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:12,374 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:12,374 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:12,374 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:12,374 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:12,374 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:12,374 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:12,374 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:12,374 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:14,906 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-18 14:39:14,907 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077'], malicious_sign_seq=[0] ==========
2025-03-18 14:39:14,907 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077'], malicious_sign_seq=[0] ==========
2025-03-18 14:39:14,907 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077'], malicious_sign_seq=[0] ==========
2025-03-18 14:39:14,907 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077'], malicious_sign_seq=[0] ==========
2025-03-18 14:39:14,907 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077'], malicious_sign_seq=[0] ==========
2025-03-18 14:39:14,907 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077'], malicious_sign_seq=[0] ==========
2025-03-18 14:39:14,907 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077'], malicious_sign_seq=[0] ==========
2025-03-18 14:39:14,907 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077'], malicious_sign_seq=[0] ==========
2025-03-18 14:39:14,907 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077'], malicious_sign_seq=[0] ==========
2025-03-18 14:39:14,907 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077'], malicious_sign_seq=[0] ==========
2025-03-18 14:39:14,907 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_4077', 'API_4078'], 'ordinary_user': [], 'admin': ['API_4077', 'API_4078'], 'oridinary_user': ['API_4077', 'API_4078']}
2025-03-18 14:39:14,907 - INFO - API sequence 4/12 generated
2025-03-18 14:39:14,907 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:14,907 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:14,907 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:14,907 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:14,907 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:14,907 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:14,907 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:14,907 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:14,907 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:14,907 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:18,458 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-18 14:39:18,459 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078', 'API_5'], malicious_sign_seq=[0, 0, 1] ==========
2025-03-18 14:39:18,459 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078', 'API_5'], malicious_sign_seq=[0, 0, 1] ==========
2025-03-18 14:39:18,459 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078', 'API_5'], malicious_sign_seq=[0, 0, 1] ==========
2025-03-18 14:39:18,459 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078', 'API_5'], malicious_sign_seq=[0, 0, 1] ==========
2025-03-18 14:39:18,459 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078', 'API_5'], malicious_sign_seq=[0, 0, 1] ==========
2025-03-18 14:39:18,459 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078', 'API_5'], malicious_sign_seq=[0, 0, 1] ==========
2025-03-18 14:39:18,459 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078', 'API_5'], malicious_sign_seq=[0, 0, 1] ==========
2025-03-18 14:39:18,459 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078', 'API_5'], malicious_sign_seq=[0, 0, 1] ==========
2025-03-18 14:39:18,459 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078', 'API_5'], malicious_sign_seq=[0, 0, 1] ==========
2025-03-18 14:39:18,459 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078', 'API_5'], malicious_sign_seq=[0, 0, 1] ==========
2025-03-18 14:39:18,459 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_4077', 'API_4078'], 'ordinary_user': [], 'admin': ['API_4077', 'API_4078'], 'oridinary_user': ['API_4077', 'API_4078']}
2025-03-18 14:39:18,459 - INFO - API sequence 5/12 generated
2025-03-18 14:39:18,459 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 14:39:18,459 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 14:39:18,459 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 14:39:18,459 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 14:39:18,459 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 14:39:18,459 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 14:39:18,459 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 14:39:18,459 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 14:39:18,459 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 14:39:18,459 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 14:39:21,372 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-18 14:39:21,373 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:39:21,373 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:39:21,373 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:39:21,373 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:39:21,373 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:39:21,373 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:39:21,373 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:39:21,373 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:39:21,373 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:39:21,373 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:39:21,373 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_4077', 'API_4078'], 'ordinary_user': [], 'admin': ['API_4077', 'API_4078'], 'oridinary_user': ['API_4077', 'API_4078']}
2025-03-18 14:39:21,374 - INFO - API sequence 6/12 generated
2025-03-18 14:39:21,374 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:21,374 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:21,374 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:21,374 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:21,374 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:21,374 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:21,374 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:21,374 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:21,374 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:21,374 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:24,284 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-18 14:39:24,285 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078', 'API_5'], malicious_sign_seq=[0, 0, 1] ==========
2025-03-18 14:39:24,285 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078', 'API_5'], malicious_sign_seq=[0, 0, 1] ==========
2025-03-18 14:39:24,285 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078', 'API_5'], malicious_sign_seq=[0, 0, 1] ==========
2025-03-18 14:39:24,285 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078', 'API_5'], malicious_sign_seq=[0, 0, 1] ==========
2025-03-18 14:39:24,285 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078', 'API_5'], malicious_sign_seq=[0, 0, 1] ==========
2025-03-18 14:39:24,285 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078', 'API_5'], malicious_sign_seq=[0, 0, 1] ==========
2025-03-18 14:39:24,285 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078', 'API_5'], malicious_sign_seq=[0, 0, 1] ==========
2025-03-18 14:39:24,285 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078', 'API_5'], malicious_sign_seq=[0, 0, 1] ==========
2025-03-18 14:39:24,285 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078', 'API_5'], malicious_sign_seq=[0, 0, 1] ==========
2025-03-18 14:39:24,285 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078', 'API_5'], malicious_sign_seq=[0, 0, 1] ==========
2025-03-18 14:39:24,285 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_4077', 'API_4078'], 'ordinary_user': [], 'admin': ['API_4077', 'API_4078'], 'oridinary_user': ['API_4077', 'API_4078']}
2025-03-18 14:39:24,286 - INFO - API sequence 7/12 generated
2025-03-18 14:39:24,286 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 14:39:24,286 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 14:39:24,286 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 14:39:24,286 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 14:39:24,286 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 14:39:24,286 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 14:39:24,286 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 14:39:24,286 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 14:39:24,286 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 14:39:24,286 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 14:39:26,261 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-18 14:39:26,262 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077'], malicious_sign_seq=[0] ==========
2025-03-18 14:39:26,262 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077'], malicious_sign_seq=[0] ==========
2025-03-18 14:39:26,262 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077'], malicious_sign_seq=[0] ==========
2025-03-18 14:39:26,262 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077'], malicious_sign_seq=[0] ==========
2025-03-18 14:39:26,262 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077'], malicious_sign_seq=[0] ==========
2025-03-18 14:39:26,262 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077'], malicious_sign_seq=[0] ==========
2025-03-18 14:39:26,262 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077'], malicious_sign_seq=[0] ==========
2025-03-18 14:39:26,262 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077'], malicious_sign_seq=[0] ==========
2025-03-18 14:39:26,262 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077'], malicious_sign_seq=[0] ==========
2025-03-18 14:39:26,262 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077'], malicious_sign_seq=[0] ==========
2025-03-18 14:39:26,264 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_4077', 'API_4078'], 'ordinary_user': [], 'admin': ['API_4077', 'API_4078'], 'oridinary_user': ['API_4077', 'API_4078']}
2025-03-18 14:39:26,264 - INFO - API sequence 8/12 generated
2025-03-18 14:39:26,264 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:26,264 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:26,264 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:26,264 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:26,264 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:26,264 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:26,264 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:26,264 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:26,264 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:26,264 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:28,312 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-18 14:39:28,312 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077'], malicious_sign_seq=[0] ==========
2025-03-18 14:39:28,312 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077'], malicious_sign_seq=[0] ==========
2025-03-18 14:39:28,312 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077'], malicious_sign_seq=[0] ==========
2025-03-18 14:39:28,312 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077'], malicious_sign_seq=[0] ==========
2025-03-18 14:39:28,312 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077'], malicious_sign_seq=[0] ==========
2025-03-18 14:39:28,312 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077'], malicious_sign_seq=[0] ==========
2025-03-18 14:39:28,312 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077'], malicious_sign_seq=[0] ==========
2025-03-18 14:39:28,312 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077'], malicious_sign_seq=[0] ==========
2025-03-18 14:39:28,312 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077'], malicious_sign_seq=[0] ==========
2025-03-18 14:39:28,312 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077'], malicious_sign_seq=[0] ==========
2025-03-18 14:39:28,313 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_4077', 'API_4078'], 'ordinary_user': [], 'admin': ['API_4077', 'API_4078'], 'oridinary_user': ['API_4077', 'API_4078']}
2025-03-18 14:39:28,313 - INFO - API sequence 9/12 generated
2025-03-18 14:39:28,313 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 14:39:28,313 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 14:39:28,313 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 14:39:28,313 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 14:39:28,313 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 14:39:28,313 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 14:39:28,313 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 14:39:28,313 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 14:39:28,313 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 14:39:28,313 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 14:39:29,940 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-18 14:39:29,941 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:39:29,941 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:39:29,941 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:39:29,941 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:39:29,941 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:39:29,941 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:39:29,941 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:39:29,941 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:39:29,941 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:39:29,941 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:39:29,942 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_4077', 'API_4078'], 'ordinary_user': [], 'admin': ['API_4077', 'API_4078'], 'oridinary_user': ['API_4077', 'API_4078']}
2025-03-18 14:39:29,942 - INFO - API sequence 10/12 generated
2025-03-18 14:39:29,942 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:29,942 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:29,942 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:29,942 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:29,942 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:29,942 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:29,942 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:29,942 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:29,942 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:29,942 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:31,551 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-18 14:39:31,552 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078'], malicious_sign_seq=[0, 0] ==========
2025-03-18 14:39:31,552 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078'], malicious_sign_seq=[0, 0] ==========
2025-03-18 14:39:31,552 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078'], malicious_sign_seq=[0, 0] ==========
2025-03-18 14:39:31,552 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078'], malicious_sign_seq=[0, 0] ==========
2025-03-18 14:39:31,552 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078'], malicious_sign_seq=[0, 0] ==========
2025-03-18 14:39:31,552 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078'], malicious_sign_seq=[0, 0] ==========
2025-03-18 14:39:31,552 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078'], malicious_sign_seq=[0, 0] ==========
2025-03-18 14:39:31,552 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078'], malicious_sign_seq=[0, 0] ==========
2025-03-18 14:39:31,552 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078'], malicious_sign_seq=[0, 0] ==========
2025-03-18 14:39:31,552 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077', 'API_4078'], malicious_sign_seq=[0, 0] ==========
2025-03-18 14:39:31,552 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_4077', 'API_4078'], 'ordinary_user': [], 'admin': ['API_4077', 'API_4078'], 'oridinary_user': ['API_4077', 'API_4078']}
2025-03-18 14:39:31,552 - INFO - API sequence 11/12 generated
2025-03-18 14:39:31,552 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:31,552 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:31,552 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:31,552 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:31,552 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:31,552 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:31,552 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:31,552 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:31,552 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:31,552 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:39:32,720 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-18 14:39:32,721 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077'], malicious_sign_seq=[0] ==========
2025-03-18 14:39:32,721 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077'], malicious_sign_seq=[0] ==========
2025-03-18 14:39:32,721 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077'], malicious_sign_seq=[0] ==========
2025-03-18 14:39:32,721 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077'], malicious_sign_seq=[0] ==========
2025-03-18 14:39:32,721 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077'], malicious_sign_seq=[0] ==========
2025-03-18 14:39:32,721 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077'], malicious_sign_seq=[0] ==========
2025-03-18 14:39:32,721 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077'], malicious_sign_seq=[0] ==========
2025-03-18 14:39:32,721 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077'], malicious_sign_seq=[0] ==========
2025-03-18 14:39:32,721 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077'], malicious_sign_seq=[0] ==========
2025-03-18 14:39:32,721 - INFO - ========== Method gen_api_seq() returned: seq=['API_4077'], malicious_sign_seq=[0] ==========
2025-03-18 14:39:32,721 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_4077', 'API_4078'], 'ordinary_user': [], 'admin': ['API_4077', 'API_4078'], 'oridinary_user': ['API_4077', 'API_4078']}
2025-03-18 14:39:32,721 - INFO - API sequence 12/12 generated
2025-03-18 14:39:32,722 - INFO - API sequences serialized to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py/serialized_llm_agents.json
2025-03-18 14:39:32,722 - INFO - Generating simulated traffic data set...
2025-03-18 14:39:32,732 - INFO - Error when injecting params for API_4077
2025-03-18 14:39:32,743 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-18 14:39:32,743 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-18 14:39:32,743 - INFO - error_apis: ['4077']
2025-03-18 14:39:32,743 - INFO - Simulated traffic data for 1/12 user collected：user: unloggeduser malicious: True
2025-03-18 14:39:32,754 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-18 14:39:32,754 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-18 14:39:32,754 - INFO - error_apis: []
2025-03-18 14:39:32,754 - INFO - Simulated traffic data for 2/12 user collected：user: adminuser malicious: False
2025-03-18 14:39:32,763 - INFO - Error when injecting params for API_4077
2025-03-18 14:39:32,775 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-18 14:39:32,775 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-18 14:39:32,784 - INFO - Error when injecting params for API_5
2025-03-18 14:39:32,785 - INFO - error_apis: ['4077', '4077']
2025-03-18 14:39:32,785 - INFO - Simulated traffic data for 3/12 user collected：user: normaluser malicious: True
2025-03-18 14:39:32,795 - INFO - Error when injecting params for API_4077
2025-03-18 14:39:32,796 - INFO - error_apis: ['4077']
2025-03-18 14:39:32,796 - INFO - Simulated traffic data for 4/12 user collected：user: normaluser malicious: False
2025-03-18 14:39:32,805 - INFO - Error when injecting params for API_4077
2025-03-18 14:39:32,818 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-18 14:39:32,818 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-18 14:39:32,827 - INFO - Error when injecting params for API_5
2025-03-18 14:39:32,828 - INFO - error_apis: ['4077', '4077']
2025-03-18 14:39:32,828 - INFO - Simulated traffic data for 5/12 user collected：user: normaluser malicious: True
2025-03-18 14:39:32,837 - INFO - Error when injecting params for API_4077
2025-03-18 14:39:32,848 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-18 14:39:32,848 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-18 14:39:32,848 - INFO - error_apis: ['4077']
2025-03-18 14:39:32,848 - INFO - Simulated traffic data for 6/12 user collected：user: unloggeduser malicious: True
2025-03-18 14:39:32,943 - INFO - Error when injecting params for API_4077
2025-03-18 14:39:32,955 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-18 14:39:32,955 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-18 14:39:32,965 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-18 14:39:32,965 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-18 14:39:32,965 - INFO - error_apis: ['4077']
2025-03-18 14:39:32,965 - INFO - Simulated traffic data for 7/12 user collected：user: normaluser malicious: True
2025-03-18 14:39:32,975 - INFO - Error when injecting params for API_4077
2025-03-18 14:39:32,977 - INFO - error_apis: ['4077']
2025-03-18 14:39:32,977 - INFO - Simulated traffic data for 8/12 user collected：user: adminuser malicious: False
2025-03-18 14:39:32,987 - INFO - Error when injecting params for API_4077
2025-03-18 14:39:32,988 - INFO - error_apis: ['4077']
2025-03-18 14:39:32,988 - INFO - Simulated traffic data for 9/12 user collected：user: normaluser malicious: False
2025-03-18 14:39:32,998 - INFO - Error when injecting params for API_4077
2025-03-18 14:39:33,010 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-18 14:39:33,010 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-18 14:39:33,010 - INFO - error_apis: ['4077']
2025-03-18 14:39:33,010 - INFO - Simulated traffic data for 10/12 user collected：user: unloggeduser malicious: True
2025-03-18 14:39:33,019 - INFO - Error when injecting params for API_4077
2025-03-18 14:39:33,031 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-18 14:39:33,031 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-18 14:39:33,031 - INFO - error_apis: ['4077']
2025-03-18 14:39:33,031 - INFO - Simulated traffic data for 11/12 user collected：user: normaluser malicious: False
2025-03-18 14:39:33,040 - INFO - Error when injecting params for API_4077
2025-03-18 14:39:33,042 - INFO - error_apis: ['4077']
2025-03-18 14:39:33,042 - INFO - Simulated traffic data for 12/12 user collected：user: normaluser malicious: False
2025-03-18 14:39:33,044 - INFO - All simulated traffic data collected：/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/simulated_traffic_data.csv
2025-03-18 14:39:33,044 - INFO - error_apis: ['4077']
2025-03-18 14:50:10,470 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-18 14:50:10,514 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-18 14:50:10,762 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-18 14:50:10,762 - INFO - Starting data generation...
2025-03-18 14:50:10,762 - INFO - API_KNOWLEDGE: [{'number': 'API_4080', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_4081', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}]
2025-03-18 14:50:10,762 - INFO - APP_KNOWLEDGE: {'func_description': 'This is an updated test application', 'normal_seqs': ['There are no example normal seqs'], 'malicious_seqs': ['There are no example malicious seqs'], 'roles': ['admin', 'ordinary_user', 'unlogged_in_user']}
2025-03-18 14:50:10,826 - INFO - Generating simulated API sequences...
2025-03-18 14:50:10,826 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:10,826 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:10,826 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:10,826 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:10,826 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:10,826 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:10,826 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:10,826 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:10,826 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:10,826 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:10,826 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:12,104 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-18 14:50:12,105 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:50:12,105 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:50:12,105 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:50:12,105 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:50:12,105 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:50:12,105 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:50:12,105 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:50:12,105 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:50:12,105 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:50:12,105 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:50:12,105 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:50:12,106 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_4080', 'API_4081'], 'ordinary_user': [], 'admin': ['API_4080', 'API_4081'], 'oridinary_user': ['API_4080', 'API_4081']}
2025-03-18 14:50:12,106 - INFO - API sequence 1/12 generated
2025-03-18 14:50:12,106 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:12,106 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:12,106 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:12,106 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:12,106 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:12,106 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:12,106 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:12,106 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:12,106 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:12,106 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:12,106 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:13,957 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-18 14:50:13,958 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:50:13,958 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:50:13,958 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:50:13,958 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:50:13,958 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:50:13,958 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:50:13,958 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:50:13,958 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:50:13,958 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:50:13,958 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:50:13,958 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:50:13,958 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_4080', 'API_4081'], 'ordinary_user': [], 'admin': ['API_4080', 'API_4081'], 'oridinary_user': ['API_4080', 'API_4081']}
2025-03-18 14:50:13,958 - INFO - API sequence 2/12 generated
2025-03-18 14:50:13,958 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 14:50:13,958 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 14:50:13,958 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 14:50:13,958 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 14:50:13,958 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 14:50:13,958 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 14:50:13,958 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 14:50:13,958 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 14:50:13,958 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 14:50:13,958 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 14:50:13,958 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 14:50:15,260 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-18 14:50:15,261 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:50:15,261 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:50:15,261 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:50:15,261 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:50:15,261 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:50:15,261 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:50:15,261 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:50:15,261 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:50:15,261 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:50:15,261 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:50:15,261 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:50:15,261 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_4080', 'API_4081'], 'ordinary_user': [], 'admin': ['API_4080', 'API_4081'], 'oridinary_user': ['API_4080', 'API_4081']}
2025-03-18 14:50:15,261 - INFO - API sequence 3/12 generated
2025-03-18 14:50:15,262 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 14:50:15,262 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 14:50:15,262 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 14:50:15,262 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 14:50:15,262 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 14:50:15,262 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 14:50:15,262 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 14:50:15,262 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 14:50:15,262 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 14:50:15,262 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 14:50:15,262 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 14:50:16,930 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-18 14:50:16,931 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:50:16,931 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:50:16,931 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:50:16,931 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:50:16,931 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:50:16,931 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:50:16,931 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:50:16,931 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:50:16,931 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:50:16,931 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:50:16,931 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:50:16,931 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_4080', 'API_4081'], 'ordinary_user': [], 'admin': ['API_4080', 'API_4081'], 'oridinary_user': ['API_4080', 'API_4081']}
2025-03-18 14:50:16,931 - INFO - API sequence 4/12 generated
2025-03-18 14:50:16,932 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:16,932 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:16,932 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:16,932 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:16,932 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:16,932 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:16,932 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:16,932 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:16,932 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:16,932 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:16,932 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:19,260 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-18 14:50:19,261 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:50:19,261 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:50:19,261 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:50:19,261 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:50:19,261 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:50:19,261 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:50:19,261 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:50:19,261 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:50:19,261 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:50:19,261 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:50:19,261 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:50:19,262 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_4080', 'API_4081'], 'ordinary_user': [], 'admin': ['API_4080', 'API_4081'], 'oridinary_user': ['API_4080', 'API_4081']}
2025-03-18 14:50:19,262 - INFO - API sequence 5/12 generated
2025-03-18 14:50:19,262 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:19,262 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:19,262 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:19,262 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:19,262 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:19,262 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:19,262 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:19,262 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:19,262 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:19,262 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:19,262 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:21,511 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-18 14:50:21,511 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:50:21,511 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:50:21,511 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:50:21,511 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:50:21,511 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:50:21,511 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:50:21,511 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:50:21,511 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:50:21,511 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:50:21,511 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:50:21,511 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:50:21,512 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_4080', 'API_4081'], 'ordinary_user': [], 'admin': ['API_4080', 'API_4081'], 'oridinary_user': ['API_4080', 'API_4081']}
2025-03-18 14:50:21,512 - INFO - API sequence 6/12 generated
2025-03-18 14:50:21,512 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 14:50:21,512 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 14:50:21,512 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 14:50:21,512 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 14:50:21,512 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 14:50:21,512 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 14:50:21,512 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 14:50:21,512 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 14:50:21,512 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 14:50:21,512 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 14:50:21,512 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 14:50:23,217 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-18 14:50:23,218 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:50:23,218 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:50:23,218 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:50:23,218 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:50:23,218 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:50:23,218 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:50:23,218 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:50:23,218 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:50:23,218 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:50:23,218 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:50:23,218 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:50:23,219 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_4080', 'API_4081'], 'ordinary_user': [], 'admin': ['API_4080', 'API_4081'], 'oridinary_user': ['API_4080', 'API_4081']}
2025-03-18 14:50:23,219 - INFO - API sequence 7/12 generated
2025-03-18 14:50:23,219 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 14:50:23,219 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 14:50:23,219 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 14:50:23,219 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 14:50:23,219 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 14:50:23,219 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 14:50:23,219 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 14:50:23,219 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 14:50:23,219 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 14:50:23,219 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 14:50:23,219 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 14:50:24,326 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-18 14:50:24,327 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:50:24,327 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:50:24,327 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:50:24,327 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:50:24,327 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:50:24,327 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:50:24,327 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:50:24,327 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:50:24,327 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:50:24,327 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:50:24,327 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:50:24,327 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_4080', 'API_4081'], 'ordinary_user': [], 'admin': ['API_4080', 'API_4081'], 'oridinary_user': ['API_4080', 'API_4081']}
2025-03-18 14:50:24,327 - INFO - API sequence 8/12 generated
2025-03-18 14:50:24,327 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 14:50:24,327 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 14:50:24,327 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 14:50:24,327 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 14:50:24,327 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 14:50:24,327 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 14:50:24,327 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 14:50:24,327 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 14:50:24,327 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 14:50:24,327 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 14:50:24,327 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 14:50:25,431 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-18 14:50:25,432 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:50:25,432 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:50:25,432 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:50:25,432 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:50:25,432 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:50:25,432 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:50:25,432 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:50:25,432 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:50:25,432 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:50:25,432 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:50:25,432 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:50:25,433 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_4080', 'API_4081'], 'ordinary_user': [], 'admin': ['API_4080', 'API_4081'], 'oridinary_user': ['API_4080', 'API_4081']}
2025-03-18 14:50:25,433 - INFO - API sequence 9/12 generated
2025-03-18 14:50:25,433 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:25,433 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:25,433 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:25,433 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:25,433 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:25,433 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:25,433 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:25,433 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:25,433 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:25,433 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:25,433 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:26,571 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-18 14:50:26,574 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:50:26,574 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:50:26,574 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:50:26,574 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:50:26,574 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:50:26,574 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:50:26,574 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:50:26,574 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:50:26,574 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:50:26,574 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:50:26,574 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:50:26,574 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_4080', 'API_4081'], 'ordinary_user': [], 'admin': ['API_4080', 'API_4081'], 'oridinary_user': ['API_4080', 'API_4081']}
2025-03-18 14:50:26,574 - INFO - API sequence 10/12 generated
2025-03-18 14:50:26,574 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:26,574 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:26,574 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:26,574 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:26,574 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:26,574 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:26,574 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:26,574 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:26,574 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:26,574 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:26,574 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:28,806 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-18 14:50:28,807 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:50:28,807 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:50:28,807 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:50:28,807 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:50:28,807 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:50:28,807 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:50:28,807 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:50:28,807 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:50:28,807 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:50:28,807 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:50:28,807 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 14:50:28,807 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_4080', 'API_4081'], 'ordinary_user': [], 'admin': ['API_4080', 'API_4081'], 'oridinary_user': ['API_4080', 'API_4081']}
2025-03-18 14:50:28,807 - INFO - API sequence 11/12 generated
2025-03-18 14:50:28,807 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:28,807 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:28,807 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:28,807 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:28,807 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:28,807 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:28,807 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:28,807 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:28,807 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:28,807 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:28,807 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 14:50:29,852 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-18 14:50:29,853 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:50:29,853 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:50:29,853 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:50:29,853 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:50:29,853 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:50:29,853 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:50:29,853 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:50:29,853 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:50:29,853 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:50:29,853 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:50:29,853 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 14:50:29,853 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_4080', 'API_4081'], 'ordinary_user': [], 'admin': ['API_4080', 'API_4081'], 'oridinary_user': ['API_4080', 'API_4081']}
2025-03-18 14:50:29,853 - INFO - API sequence 12/12 generated
2025-03-18 14:50:29,854 - INFO - API sequences serialized to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py/serialized_llm_agents.json
2025-03-18 14:50:29,854 - INFO - Generating simulated traffic data set...
2025-03-18 14:50:29,863 - INFO - Error when injecting params for API_1
2025-03-18 14:50:29,865 - INFO - error_apis: ['4080']
2025-03-18 14:50:29,865 - INFO - Simulated traffic data for 1/12 user collected：user: normaluser malicious: False
2025-03-18 14:50:29,874 - INFO - Error when injecting params for API_1
2025-03-18 14:50:29,876 - INFO - error_apis: ['4080']
2025-03-18 14:50:29,877 - INFO - Simulated traffic data for 2/12 user collected：user: normaluser malicious: False
2025-03-18 14:50:29,887 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-18 14:50:29,888 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-18 14:50:29,898 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-18 14:50:29,898 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-18 14:50:29,898 - INFO - error_apis: []
2025-03-18 14:50:29,898 - INFO - Simulated traffic data for 3/12 user collected：user: unloggeduser malicious: True
2025-03-18 14:50:29,907 - INFO - Error when injecting params for API_1
2025-03-18 14:50:29,909 - INFO - error_apis: ['4080']
2025-03-18 14:50:29,909 - INFO - Simulated traffic data for 4/12 user collected：user: adminuser malicious: False
2025-03-18 14:50:30,000 - INFO - Error when injecting params for API_1
2025-03-18 14:50:30,011 - INFO - Error when injecting params for API_3
2025-03-18 14:50:30,012 - INFO - error_apis: ['4080', '4080']
2025-03-18 14:50:30,012 - INFO - Simulated traffic data for 5/12 user collected：user: normaluser malicious: True
2025-03-18 14:50:30,022 - INFO - Error when injecting params for API_1
2025-03-18 14:50:30,033 - INFO - Error when injecting params for API_3
2025-03-18 14:50:30,034 - INFO - error_apis: ['4080', '4080']
2025-03-18 14:50:30,034 - INFO - Simulated traffic data for 6/12 user collected：user: normaluser malicious: True
2025-03-18 14:50:30,045 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-18 14:50:30,045 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-18 14:50:30,054 - INFO - Error when injecting params for API_3
2025-03-18 14:50:30,056 - INFO - error_apis: ['4080']
2025-03-18 14:50:30,056 - INFO - Simulated traffic data for 7/12 user collected：user: unloggeduser malicious: True
2025-03-18 14:50:30,067 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-18 14:50:30,067 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-18 14:50:30,067 - INFO - error_apis: []
2025-03-18 14:50:30,067 - INFO - Simulated traffic data for 8/12 user collected：user: adminuser malicious: False
2025-03-18 14:50:30,077 - INFO - Error when injecting params for API_1
2025-03-18 14:50:30,087 - INFO - Error when injecting params for API_3
2025-03-18 14:50:30,089 - INFO - error_apis: ['4080', '4080']
2025-03-18 14:50:30,089 - INFO - Simulated traffic data for 9/12 user collected：user: unloggeduser malicious: True
2025-03-18 14:50:30,101 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-18 14:50:30,101 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-18 14:50:30,101 - INFO - error_apis: []
2025-03-18 14:50:30,101 - INFO - Simulated traffic data for 10/12 user collected：user: normaluser malicious: False
2025-03-18 14:50:30,112 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-18 14:50:30,113 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-18 14:50:30,126 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-18 14:50:30,126 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-18 14:50:30,126 - INFO - error_apis: []
2025-03-18 14:50:30,126 - INFO - Simulated traffic data for 11/12 user collected：user: normaluser malicious: True
2025-03-18 14:50:30,143 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-18 14:50:30,143 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-18 14:50:30,143 - INFO - error_apis: []
2025-03-18 14:50:30,143 - INFO - Simulated traffic data for 12/12 user collected：user: normaluser malicious: False
2025-03-18 14:50:30,146 - INFO - All simulated traffic data collected：/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/simulated_traffic_data.csv
2025-03-18 14:50:30,146 - INFO - error_apis: ['4080']
2025-03-18 15:02:19,337 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-18 15:02:19,389 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-18 15:02:19,389 - INFO - Extracting API list with API discovery algorithm...
2025-03-18 15:02:19,458 - INFO - Starting Drain3 template miner
2025-03-18 15:02:19,460 - INFO - Starting Drain3 template miner
2025-03-18 15:02:19,462 - INFO - Starting Drain3 template miner
2025-03-18 15:02:19,463 - INFO - Starting Drain3 template miner
2025-03-18 15:02:19,464 - INFO - Starting Drain3 template miner
2025-03-18 15:02:21,333 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-18 15:05:33,647 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-18 15:05:33,715 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-18 15:05:33,715 - INFO - Extracting API list with API discovery algorithm...
2025-03-18 15:05:33,786 - INFO - Starting Drain3 template miner
2025-03-18 15:05:33,789 - INFO - Starting Drain3 template miner
2025-03-18 15:05:33,791 - INFO - Starting Drain3 template miner
2025-03-18 15:05:33,791 - INFO - Starting Drain3 template miner
2025-03-18 15:05:33,792 - INFO - Starting Drain3 template miner
2025-03-18 15:05:35,606 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-18 15:07:01,220 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-18 15:07:01,272 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-18 15:07:01,273 - INFO - Extracting API list with API discovery algorithm...
2025-03-18 15:07:01,342 - INFO - Starting Drain3 template miner
2025-03-18 15:07:01,345 - INFO - Starting Drain3 template miner
2025-03-18 15:07:01,346 - INFO - Starting Drain3 template miner
2025-03-18 15:07:01,347 - INFO - Starting Drain3 template miner
2025-03-18 15:07:01,348 - INFO - Starting Drain3 template miner
2025-03-18 15:07:03,554 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-18 15:27:28,849 - INFO - Extracting API logs from auto crawling logs and manual logs...
2025-03-18 15:27:28,903 - INFO - Saved API logs to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/api_discovery.py/crawl_log/API_crawl_log.csv
2025-03-18 15:27:29,163 - INFO - Saved available param set to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/param_set.json
2025-03-18 15:27:29,163 - INFO - Starting data generation...
2025-03-18 15:27:29,163 - INFO - API_KNOWLEDGE: [{'number': 'API_4275', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}, {'number': 'API_4276', 'functionDescription': 'Please fill in the function description', 'permissionInfoAndUnauthorizedSituation': 'Please fill in the permission info'}]
2025-03-18 15:27:29,163 - INFO - APP_KNOWLEDGE: {'func_description': 'This is an updated test application', 'normal_seqs': ['There are no example normal seqs'], 'malicious_seqs': ['There are no example malicious seqs'], 'roles': ['admin', 'ordinary_user', 'unlogged_in_user']}
2025-03-18 15:27:29,214 - INFO - Generating simulated API sequences...
2025-03-18 15:27:29,214 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:29,214 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:29,214 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:29,214 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:29,214 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:29,214 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:29,214 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:29,214 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:29,214 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:29,214 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:29,214 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:29,214 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:31,101 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-18 15:27:31,102 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 15:27:31,102 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 15:27:31,102 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 15:27:31,102 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 15:27:31,102 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 15:27:31,102 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 15:27:31,102 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 15:27:31,102 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 15:27:31,102 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 15:27:31,102 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 15:27:31,102 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 15:27:31,102 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 15:27:31,102 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_4275', 'API_4276'], 'ordinary_user': [], 'admin': ['API_4275', 'API_4276'], 'oridinary_user': ['API_4275', 'API_4276']}
2025-03-18 15:27:31,102 - INFO - API sequence 1/12 generated
2025-03-18 15:27:31,102 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:31,102 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:31,102 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:31,102 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:31,102 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:31,102 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:31,102 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:31,102 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:31,102 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:31,102 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:31,102 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:31,102 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:33,639 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-18 15:27:33,639 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:33,639 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:33,639 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:33,639 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:33,639 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:33,639 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:33,639 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:33,639 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:33,639 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:33,639 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:33,639 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:33,639 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:33,640 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_4275', 'API_4276'], 'ordinary_user': [], 'admin': ['API_4275', 'API_4276'], 'oridinary_user': ['API_4275', 'API_4276']}
2025-03-18 15:27:33,640 - INFO - API sequence 2/12 generated
2025-03-18 15:27:33,640 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 15:27:33,640 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 15:27:33,640 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 15:27:33,640 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 15:27:33,640 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 15:27:33,640 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 15:27:33,640 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 15:27:33,640 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 15:27:33,640 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 15:27:33,640 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 15:27:33,640 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 15:27:33,640 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 15:27:36,564 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-18 15:27:36,565 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-18 15:27:36,565 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-18 15:27:36,565 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-18 15:27:36,565 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-18 15:27:36,565 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-18 15:27:36,565 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-18 15:27:36,565 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-18 15:27:36,565 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-18 15:27:36,565 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-18 15:27:36,565 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-18 15:27:36,565 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-18 15:27:36,565 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-18 15:27:36,565 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_4275', 'API_4276'], 'ordinary_user': [], 'admin': ['API_4275', 'API_4276'], 'oridinary_user': ['API_4275', 'API_4276']}
2025-03-18 15:27:36,566 - INFO - API sequence 3/12 generated
2025-03-18 15:27:36,566 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:36,566 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:36,566 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:36,566 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:36,566 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:36,566 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:36,566 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:36,566 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:36,566 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:36,566 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:36,566 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:36,566 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:38,066 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-18 15:27:38,066 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:38,066 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:38,066 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:38,066 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:38,066 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:38,066 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:38,066 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:38,066 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:38,066 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:38,066 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:38,066 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:38,066 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:38,067 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_4275', 'API_4276'], 'ordinary_user': [], 'admin': ['API_4275', 'API_4276'], 'oridinary_user': ['API_4275', 'API_4276']}
2025-03-18 15:27:38,067 - INFO - API sequence 4/12 generated
2025-03-18 15:27:38,067 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 15:27:38,067 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 15:27:38,067 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 15:27:38,067 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 15:27:38,067 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 15:27:38,067 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 15:27:38,067 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 15:27:38,067 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 15:27:38,067 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 15:27:38,067 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 15:27:38,067 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 15:27:38,067 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 15:27:39,088 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-18 15:27:39,088 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:39,088 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:39,088 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:39,088 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:39,088 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:39,088 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:39,088 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:39,088 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:39,088 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:39,088 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:39,088 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:39,088 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:39,089 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_4275', 'API_4276'], 'ordinary_user': [], 'admin': ['API_4275', 'API_4276'], 'oridinary_user': ['API_4275', 'API_4276']}
2025-03-18 15:27:39,089 - INFO - API sequence 5/12 generated
2025-03-18 15:27:39,089 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:39,089 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:39,089 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:39,089 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:39,089 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:39,089 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:39,089 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:39,089 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:39,089 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:39,089 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:39,089 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:39,089 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:40,049 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-18 15:27:40,050 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:40,050 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:40,050 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:40,050 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:40,050 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:40,050 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:40,050 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:40,050 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:40,050 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:40,050 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:40,050 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:40,050 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:40,050 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_4275', 'API_4276'], 'ordinary_user': [], 'admin': ['API_4275', 'API_4276'], 'oridinary_user': ['API_4275', 'API_4276']}
2025-03-18 15:27:40,050 - INFO - API sequence 6/12 generated
2025-03-18 15:27:40,050 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:40,050 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:40,050 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:40,050 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:40,050 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:40,050 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:40,050 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:40,050 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:40,050 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:40,050 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:40,050 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:40,050 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:42,550 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-18 15:27:42,551 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 15:27:42,551 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 15:27:42,551 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 15:27:42,551 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 15:27:42,551 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 15:27:42,551 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 15:27:42,551 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 15:27:42,551 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 15:27:42,551 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 15:27:42,551 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 15:27:42,551 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 15:27:42,551 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 15:27:42,552 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_4275', 'API_4276'], 'ordinary_user': [], 'admin': ['API_4275', 'API_4276'], 'oridinary_user': ['API_4275', 'API_4276']}
2025-03-18 15:27:42,552 - INFO - API sequence 7/12 generated
2025-03-18 15:27:42,552 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:42,552 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:42,552 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:42,552 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:42,552 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:42,552 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:42,552 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:42,552 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:42,552 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:42,552 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:42,552 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:42,552 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:46,208 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-18 15:27:46,209 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-18 15:27:46,209 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-18 15:27:46,209 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-18 15:27:46,209 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-18 15:27:46,209 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-18 15:27:46,209 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-18 15:27:46,209 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-18 15:27:46,209 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-18 15:27:46,209 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-18 15:27:46,209 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-18 15:27:46,209 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-18 15:27:46,209 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3', 'API_5'], malicious_sign_seq=[0, 1, 0] ==========
2025-03-18 15:27:46,210 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_4275', 'API_4276'], 'ordinary_user': [], 'admin': ['API_4275', 'API_4276'], 'oridinary_user': ['API_4275', 'API_4276']}
2025-03-18 15:27:46,210 - INFO - API sequence 8/12 generated
2025-03-18 15:27:46,210 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 15:27:46,210 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 15:27:46,210 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 15:27:46,210 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 15:27:46,210 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 15:27:46,210 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 15:27:46,210 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 15:27:46,210 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 15:27:46,210 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 15:27:46,210 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 15:27:46,210 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 15:27:46,210 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=admin, action_step=1 ==========
2025-03-18 15:27:47,638 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-18 15:27:47,639 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:47,639 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:47,639 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:47,639 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:47,639 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:47,639 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:47,639 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:47,639 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:47,639 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:47,639 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:47,639 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:47,639 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:47,639 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_4275', 'API_4276'], 'ordinary_user': [], 'admin': ['API_4275', 'API_4276'], 'oridinary_user': ['API_4275', 'API_4276']}
2025-03-18 15:27:47,639 - INFO - API sequence 9/12 generated
2025-03-18 15:27:47,639 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 15:27:47,639 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 15:27:47,639 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 15:27:47,639 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 15:27:47,639 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 15:27:47,639 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 15:27:47,639 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 15:27:47,639 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 15:27:47,639 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 15:27:47,639 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 15:27:47,639 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 15:27:47,639 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 15:27:49,950 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-18 15:27:49,951 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 15:27:49,951 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 15:27:49,951 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 15:27:49,951 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 15:27:49,951 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 15:27:49,951 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 15:27:49,951 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 15:27:49,951 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 15:27:49,951 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 15:27:49,951 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 15:27:49,951 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 15:27:49,951 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 15:27:49,952 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_4275', 'API_4276'], 'ordinary_user': [], 'admin': ['API_4275', 'API_4276'], 'oridinary_user': ['API_4275', 'API_4276']}
2025-03-18 15:27:49,952 - INFO - API sequence 10/12 generated
2025-03-18 15:27:49,952 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:49,952 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:49,952 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:49,952 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:49,952 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:49,952 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:49,952 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:49,952 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:49,952 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:49,952 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:49,952 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:49,952 - INFO - ========== Called gen_api_seq() with params: malicious=False, role=ordinary_user, action_step=1 ==========
2025-03-18 15:27:50,910 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-18 15:27:50,911 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:50,911 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:50,911 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:50,911 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:50,911 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:50,911 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:50,911 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:50,911 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:50,911 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:50,911 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:50,911 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:50,911 - INFO - ========== Method gen_api_seq() returned: seq=['API_1'], malicious_sign_seq=[0] ==========
2025-03-18 15:27:50,912 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_4275', 'API_4276'], 'ordinary_user': [], 'admin': ['API_4275', 'API_4276'], 'oridinary_user': ['API_4275', 'API_4276']}
2025-03-18 15:27:50,912 - INFO - API sequence 11/12 generated
2025-03-18 15:27:50,912 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 15:27:50,912 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 15:27:50,912 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 15:27:50,912 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 15:27:50,912 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 15:27:50,912 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 15:27:50,912 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 15:27:50,912 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 15:27:50,912 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 15:27:50,912 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 15:27:50,912 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 15:27:50,912 - INFO - ========== Called gen_api_seq() with params: malicious=True, role=unlogged_in_user, action_step=1 ==========
2025-03-18 15:27:53,234 - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-18 15:27:53,235 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 15:27:53,235 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 15:27:53,235 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 15:27:53,235 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 15:27:53,235 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 15:27:53,235 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 15:27:53,235 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 15:27:53,235 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 15:27:53,235 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 15:27:53,235 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 15:27:53,235 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 15:27:53,235 - INFO - ========== Method gen_api_seq() returned: seq=['API_1', 'API_3'], malicious_sign_seq=[0, 1] ==========
2025-03-18 15:27:53,236 - INFO - User configured API_ROLE:{'unlogged_in_user': ['API_4275', 'API_4276'], 'ordinary_user': [], 'admin': ['API_4275', 'API_4276'], 'oridinary_user': ['API_4275', 'API_4276']}
2025-03-18 15:27:53,236 - INFO - API sequence 12/12 generated
2025-03-18 15:27:53,237 - INFO - API sequences serialized to /home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/traffic_data_generation.py/serialized_llm_agents.json
2025-03-18 15:27:53,237 - INFO - Generating simulated traffic data set...
2025-03-18 15:27:53,249 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-18 15:27:53,249 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-18 15:27:53,262 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-18 15:27:53,262 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-18 15:27:53,262 - INFO - error_apis: []
2025-03-18 15:27:53,262 - INFO - Simulated traffic data for 1/12 user collected：user: normaluser malicious: True
2025-03-18 15:27:53,274 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-18 15:27:53,274 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-18 15:27:53,274 - INFO - error_apis: []
2025-03-18 15:27:53,274 - INFO - Simulated traffic data for 2/12 user collected：user: normaluser malicious: False
2025-03-18 15:27:53,286 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-18 15:27:53,286 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-18 15:27:53,298 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-18 15:27:53,299 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-18 15:27:53,310 - INFO - Error when injecting params for API_5
2025-03-18 15:27:53,311 - INFO - error_apis: ['4275']
2025-03-18 15:27:53,311 - INFO - Simulated traffic data for 3/12 user collected：user: unloggeduser malicious: True
2025-03-18 15:27:53,322 - INFO - Error when injecting params for API_1
2025-03-18 15:27:53,324 - INFO - error_apis: ['4275']
2025-03-18 15:27:53,324 - INFO - Simulated traffic data for 4/12 user collected：user: normaluser malicious: False
2025-03-18 15:27:53,337 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.UserService/CreateUserAccessToken {}
2025-03-18 15:27:53,337 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-18 15:27:53,337 - INFO - error_apis: []
2025-03-18 15:27:53,337 - INFO - Simulated traffic data for 5/12 user collected：user: adminuser malicious: False
2025-03-18 15:27:53,348 - INFO - Error when injecting params for API_1
2025-03-18 15:27:53,349 - INFO - error_apis: ['4275']
2025-03-18 15:27:53,349 - INFO - Simulated traffic data for 6/12 user collected：user: normaluser malicious: False
2025-03-18 15:27:53,361 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-18 15:27:53,361 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-18 15:27:53,372 - INFO - Error when injecting params for API_3
2025-03-18 15:27:53,374 - INFO - error_apis: ['4275']
2025-03-18 15:27:53,374 - INFO - Simulated traffic data for 7/12 user collected：user: normaluser malicious: True
2025-03-18 15:27:53,385 - INFO - Error when injecting params for API_1
2025-03-18 15:27:53,481 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-18 15:27:53,481 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-18 15:27:53,493 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-18 15:27:53,493 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：False
2025-03-18 15:27:53,493 - INFO - error_apis: ['4275']
2025-03-18 15:27:53,493 - INFO - Simulated traffic data for 8/12 user collected：user: normaluser malicious: True
2025-03-18 15:27:53,506 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-18 15:27:53,506 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-18 15:27:53,506 - INFO - error_apis: []
2025-03-18 15:27:53,506 - INFO - Simulated traffic data for 9/12 user collected：user: adminuser malicious: False
2025-03-18 15:27:53,518 - INFO - Error when injecting params for API_1
2025-03-18 15:27:53,532 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-18 15:27:53,532 - INFO - Param injection attempting time：1；Single traffic data valid：False；Traffic data combination valid：False
2025-03-18 15:27:53,532 - INFO - error_apis: ['4275']
2025-03-18 15:27:53,532 - INFO - Simulated traffic data for 10/12 user collected：user: unloggeduser malicious: True
2025-03-18 15:27:53,545 - INFO - Status:  Calling API: POST http://49.234.6.241:5230/memos.api.v1.MemoService/CreateMemo {}
2025-03-18 15:27:53,546 - INFO - Param injection attempting time：0；Single traffic data valid：True；Traffic data combination valid：True
2025-03-18 15:27:53,546 - INFO - error_apis: []
2025-03-18 15:27:53,546 - INFO - Simulated traffic data for 11/12 user collected：user: normaluser malicious: False
2025-03-18 15:27:53,557 - INFO - Error when injecting params for API_1
2025-03-18 15:27:53,569 - INFO - Error when injecting params for API_3
2025-03-18 15:27:53,571 - INFO - error_apis: ['4275', '4275']
2025-03-18 15:27:53,571 - INFO - Simulated traffic data for 12/12 user collected：user: unloggeduser malicious: True
2025-03-18 15:27:53,573 - INFO - All simulated traffic data collected：/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/simulated_traffic_data.csv
2025-03-18 15:27:53,573 - INFO - error_apis: ['4275']
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-03-19 10:08:21,517 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-18 07:07:04', 'last_model_construction_at': '2025-03-18 03:57:14', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.0, 0.0, 0.0, 1.0, 0.67, 1.0, 0.8, 2.0, 0.67, 3.0, 0.33, 0.5, 0.4, 3.0, 0.44, 0.67, 0.53, 3.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-19 10:08:21,518 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-03-19 10:12:03,602 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-18 07:07:04', 'last_model_construction_at': '2025-03-18 03:57:14', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.0, 0.0, 0.0, 1.0, 0.67, 1.0, 0.8, 2.0, 0.67, 3.0, 0.33, 0.5, 0.4, 3.0, 0.44, 0.67, 0.53, 3.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-19 10:12:03,604 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
2025-03-19 10:14:52,231 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-18 07:07:04', 'last_model_construction_at': '2025-03-18 03:57:14', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.0, 0.0, 0.0, 1.0, 0.67, 1.0, 0.8, 2.0, 0.67, 3.0, 0.33, 0.5, 0.4, 3.0, 0.44, 0.67, 0.53, 3.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-19 10:14:52,232 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 7
Usage: celery [OPTIONS] COMMAND [ARGS]...
Try 'celery --help' for help.

Error: Invalid value for '-A' / '--app': 
Unable to load celery application.
While trying to load the module traffic_collector.celery the following error occurred:
Traceback (most recent call last):
  File "/home/ubuntu/.local/lib/python3.10/site-packages/celery/bin/celery.py", line 58, in convert
    return find_app(value)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/celery/app/utils.py", line 383, in find_app
    sym = symbol_by_name(app, imp=imp)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/kombu/utils/imports.py", line 59, in symbol_by_name
    module = imp(module_name, package=package, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/celery/utils/imports.py", line 109, in import_from_cwd
    return imp(module, package=package)
  File "/usr/lib/python3.10/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/traffic_collector.py", line 16, in <module>
    from enhanced_detector import read_detection_status
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/enhanced_detector.py", line 10, in <module>
    import algorithm.detection_model
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/detection_model.py", line 2, in <module>
    from typing import override
ImportError: cannot import name 'override' from 'typing' (/usr/lib/python3.10/typing.py)

Traceback (most recent call last):
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/./app.py", line 661, in <module>
    load_target_app()
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/./app.py", line 638, in load_target_app
    import enhanced_detector
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/enhanced_detector.py", line 10, in <module>
    import algorithm.detection_model
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/detection_model.py", line 2, in <module>
    from typing import override
ImportError: cannot import name 'override' from 'typing' (/usr/lib/python3.10/typing.py)
Traceback (most recent call last):
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/./app.py", line 661, in <module>
    load_target_app()
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/./app.py", line 638, in load_target_app
    import enhanced_detector
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/enhanced_detector.py", line 10, in <module>
    import algorithm.detection_model
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/detection_model.py", line 21, in <module>
    from Dynamtic_Feature_Extraction import FeatureExtractor
ModuleNotFoundError: No module named 'Dynamtic_Feature_Extraction'
2025-03-19 12:14:21,463 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-18 07:07:04', 'last_model_construction_at': '2025-03-18 03:57:14', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.0, 0.0, 0.0, 1.0, 0.67, 1.0, 0.8, 2.0, 0.67, 3.0, 0.33, 0.5, 0.4, 3.0, 0.44, 0.67, 0.53, 3.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
Traceback (most recent call last):
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/./app.py", line 661, in <module>
    load_target_app()
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/./app.py", line 651, in load_target_app
    features.append(BASIC_FEATURES[feature.get('name')])
KeyError: 'MeanUrlParamsCount'
 
 -------------- celery@VM-16-2-ubuntu v5.4.0 (opalescent)
--- ***** ----- 
-- ******* ---- Linux-5.15.0-130-generic-x86_64-with-glibc2.35 2025-03-19 12:27:14
- *** --- * --- 
- ** ---------- [config]
- ** ---------- .> app:         tasks:0x7f7378557a90
- ** ---------- .> transport:   redis://localhost:6379/0
- ** ---------- .> results:     disabled://
- *** --- * --- .> concurrency: 2 (prefork)
-- ******* ---- .> task events: OFF (enable -E to monitor tasks in this worker)
--- ***** ----- 
 -------------- [queues]
                .> celery           exchange=celery(direct) key=celery
                

[tasks]
  . traffic_collector.consume_traffic_periodically

[2025-03-19 12:27:14,557: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

[2025-03-19 12:27:14,645: INFO/MainProcess] Connected to redis://localhost:6379/0
[2025-03-19 12:27:14,645: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

[2025-03-19 12:27:14,647: INFO/MainProcess] mingle: searching for neighbors
[2025-03-19 12:27:15,652: INFO/MainProcess] mingle: all alone
[2025-03-19 12:27:15,661: INFO/MainProcess] celery@VM-16-2-ubuntu ready.
[2025-03-19 12:27:15,664: INFO/MainProcess] Task traffic_collector.consume_traffic_periodically[f4d57034-78f8-494d-846f-a826f0d93ff1] received
2025-03-19 12:27:18,125 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-18 07:07:04', 'last_model_construction_at': '2025-03-18 03:57:14', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.0, 0.0, 0.0, 1.0, 0.67, 1.0, 0.8, 2.0, 0.67, 3.0, 0.33, 0.5, 0.4, 3.0, 0.44, 0.67, 0.53, 3.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-19 12:27:18,127 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 0
 * Serving Flask app 'app'
 * Debug mode: on
[2025-03-19 12:27:25,653: ERROR/MainProcess] Received unregistered task of type '__mitmproxy_script__.traffic_collector.consume_traffic_periodically'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[[], {}, {"callbacks": null, "errbacks": null, "chain": null, "chord": null}]' (77b)

The full contents of the message headers:
{'lang': 'py', 'task': '__mitmproxy_script__.traffic_collector.consume_traffic_periodically', 'id': '89876af7-a566-43e0-8b16-a7366e920e81', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': '89876af7-a566-43e0-8b16-a7366e920e81', 'parent_id': None, 'argsrepr': '()', 'kwargsrepr': '{}', 'origin': 'gen4178@VM-16-2-ubuntu', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "/home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
KeyError: '__mitmproxy_script__.traffic_collector.consume_traffic_periodically'
 
 -------------- celery@VM-16-2-ubuntu v5.4.0 (opalescent)
--- ***** ----- 
-- ******* ---- Linux-5.15.0-130-generic-x86_64-with-glibc2.35 2025-03-19 12:27:58
- *** --- * --- 
- ** ---------- [config]
- ** ---------- .> app:         tasks:0x7f22f5b57a90
- ** ---------- .> transport:   redis://localhost:6379/0
- ** ---------- .> results:     disabled://
- *** --- * --- .> concurrency: 2 (prefork)
-- ******* ---- .> task events: OFF (enable -E to monitor tasks in this worker)
--- ***** ----- 
 -------------- [queues]
                .> celery           exchange=celery(direct) key=celery
                

[tasks]
  . traffic_collector.consume_traffic_periodically

[2025-03-19 12:27:58,679: INFO/MainProcess] Task traffic_collector.consume_traffic_periodically[9fc5f316-1f29-43fa-a55e-7a9aa16fb6ce] received
[2025-03-19 12:27:59,664: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

[2025-03-19 12:27:59,683: INFO/MainProcess] Connected to redis://localhost:6379/0
[2025-03-19 12:27:59,684: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

[2025-03-19 12:27:59,686: INFO/MainProcess] mingle: searching for neighbors
[2025-03-19 12:28:00,693: INFO/MainProcess] mingle: all alone
[2025-03-19 12:28:00,714: INFO/MainProcess] celery@VM-16-2-ubuntu ready.
 * Serving Flask app 'app'
 * Debug mode: on
 * Serving Flask app 'app'
 * Debug mode: on
2025-03-19 12:41:32,440 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-18 07:07:04', 'last_model_construction_at': '2025-03-18 03:57:14', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.0, 0.0, 0.0, 1.0, 0.67, 1.0, 0.8, 2.0, 0.67, 3.0, 0.33, 0.5, 0.4, 3.0, 0.44, 0.67, 0.53, 3.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-19 12:41:32,442 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 0
 * Serving Flask app 'app'
 * Debug mode: on
2025-03-19 12:41:37,389 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-18 07:07:04', 'last_model_construction_at': '2025-03-18 03:57:14', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.0, 0.0, 0.0, 1.0, 0.67, 1.0, 0.8, 2.0, 0.67, 3.0, 0.33, 0.5, 0.4, 3.0, 0.44, 0.67, 0.53, 3.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-19 12:41:37,389 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 0
2025-03-19 12:44:01,893 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-18 07:07:04', 'last_model_construction_at': '2025-03-18 03:57:14', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.0, 0.0, 0.0, 1.0, 0.67, 1.0, 0.8, 2.0, 0.67, 3.0, 0.33, 0.5, 0.4, 3.0, 0.44, 0.67, 0.53, 3.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-19 12:44:01,894 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 12
 * Serving Flask app 'app'
 * Debug mode: on
2025-03-19 12:44:06,767 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-18 07:07:04', 'last_model_construction_at': '2025-03-18 03:57:14', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.0, 0.0, 0.0, 1.0, 0.67, 1.0, 0.8, 2.0, 0.67, 3.0, 0.33, 0.5, 0.4, 3.0, 0.44, 0.67, 0.53, 3.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-19 12:44:06,768 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 12
2025-03-19 12:44:48,190 - INFO - Trying to construct model...
2025-03-19 12:44:48,191 - INFO - DATA_COLLECTION_STATUS: COMPLETED
Traceback (most recent call last):
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/./app.py", line 343, in construct_model
    report = train_and_save_model(features=features)
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/model_training.py", line 52, in train_and_save_model
    report = model.train_and_save_model(features)
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/detection_model.py", line 1038, in train_and_save_model
    train_extractor = FeatureExtractor(
TypeError: FeatureExtractor.__init__() got an unexpected keyword argument 'features'
2025-03-19 12:48:33,777 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-18 07:07:04', 'last_model_construction_at': '2025-03-18 03:57:14', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.0, 0.0, 0.0, 1.0, 0.67, 1.0, 0.8, 2.0, 0.67, 3.0, 0.33, 0.5, 0.4, 3.0, 0.44, 0.67, 0.53, 3.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-19 12:48:33,780 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 12
2025-03-19 12:48:58,675 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-18 07:07:04', 'last_model_construction_at': '2025-03-18 03:57:14', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.0, 0.0, 0.0, 1.0, 0.67, 1.0, 0.8, 2.0, 0.67, 3.0, 0.33, 0.5, 0.4, 3.0, 0.44, 0.67, 0.53, 3.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-19 12:48:58,684 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 12
2025-03-19 12:49:00,370 - INFO - Trying to construct model...
2025-03-19 12:49:00,374 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-19 12:49:01,003 - INFO - Model constructed.
2025-03-19 12:49:56,152 - INFO - Trying to construct model...
2025-03-19 12:49:56,154 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-19 12:49:56,668 - INFO - Model constructed.
2025-03-19 12:50:06,648 - INFO - Trying to construct model...
2025-03-19 12:50:06,649 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-19 12:50:06,874 - INFO - Model constructed.
最终选择的特征:
['UniquePathsCount', 'TotalPathsCount', 'UniqueParamsCount', 'TotalParamsCount', 'ConsecutiveRepeats', 'AvgPathDepth', 'StdPathLength', 'AvgParamCount', 'StdParamCount', 'AvgPathLength', 'StdPathDepth', 'UniquenessRatio']
最终特征数量: 12

XGBoost 测试集准确率: 0.6875
最终选择的特征:
['UniquePathsCount', 'TotalPathsCount', 'UniqueParamsCount', 'TotalParamsCount', 'ConsecutiveRepeats', 'AvgPathDepth', 'StdPathLength', 'AvgParamCount', 'StdParamCount', 'AvgPathLength', 'StdPathDepth', 'UniquenessRatio']
最终特征数量: 12

XGBoost 测试集准确率: 0.6875
最终选择的特征:
['UniquePathsCount', 'TotalPathsCount', 'UniqueParamsCount', 'TotalParamsCount', 'ConsecutiveRepeats', 'AvgPathDepth', 'StdPathLength', 'AvgParamCount', 'StdParamCount', 'AvgPathLength', 'StdPathDepth', 'UniquenessRatio']
最终特征数量: 12

XGBoost 测试集准确率: 0.6875
Usage: celery [OPTIONS] COMMAND [ARGS]...
Try 'celery --help' for help.

Error: Invalid value for '-A' / '--app': 
Unable to load celery application.
Module 'algorithm' has no attribute 'entity'
2025-03-19 12:52:02,652 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-18 07:07:04', 'last_model_construction_at': '2025-03-19 04:50:06', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.67, 1.0, 0.8, 10.0, 1.0, 0.17, 0.29, 6.0, 0.69, 16.0, 0.83, 0.58, 0.54, 16.0, 0.79, 0.69, 0.61, 16.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-19 12:52:02,654 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 12
2025-03-19 12:52:48,295 - INFO - Detection started. Combined data duration: 10
2025-03-19 12:54:20,825 - INFO - Detection paused.
2025-03-19 12:58:25,275 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-18 07:07:04', 'last_model_construction_at': '2025-03-19 04:50:06', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.67, 1.0, 0.8, 10.0, 1.0, 0.17, 0.29, 6.0, 0.69, 16.0, 0.83, 0.58, 0.54, 16.0, 0.79, 0.69, 0.61, 16.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-19 12:58:25,276 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 12
 * Serving Flask app 'app'
 * Debug mode: on
Usage: celery [OPTIONS] COMMAND [ARGS]...
Try 'celery --help' for help.

Error: Invalid value for '-A' / '--app': 
Unable to load celery application.
Module 'algorithm' has no attribute 'entity'
2025-03-19 12:58:30,835 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-18 07:07:04', 'last_model_construction_at': '2025-03-19 04:50:06', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.67, 1.0, 0.8, 10.0, 1.0, 0.17, 0.29, 6.0, 0.69, 16.0, 0.83, 0.58, 0.54, 16.0, 0.79, 0.69, 0.61, 16.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-19 12:58:30,836 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 12
Usage: celery [OPTIONS] COMMAND [ARGS]...
Try 'celery --help' for help.

Error: Invalid value for '-A' / '--app': 
Unable to load celery application.
Module 'algorithm' has no attribute 'entity'
Usage: celery [OPTIONS] COMMAND [ARGS]...
Try 'celery --help' for help.

Error: Invalid value for '-A' / '--app': 
Unable to load celery application.
Module 'algorithm' has no attribute 'entity'
2025-03-19 12:59:46,026 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-18 07:07:04', 'last_model_construction_at': '2025-03-19 04:50:06', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.67, 1.0, 0.8, 10.0, 1.0, 0.17, 0.29, 6.0, 0.69, 16.0, 0.83, 0.58, 0.54, 16.0, 0.79, 0.69, 0.61, 16.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-19 12:59:46,026 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 12
 * Serving Flask app 'app'
 * Debug mode: on
Address already in use
Port 5000 is in use by another program. Either identify and stop that program, or start the server with a different port.
2025-03-19 13:00:35,654 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-18 07:07:04', 'last_model_construction_at': '2025-03-19 04:50:06', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.67, 1.0, 0.8, 10.0, 1.0, 0.17, 0.29, 6.0, 0.69, 16.0, 0.83, 0.58, 0.54, 16.0, 0.79, 0.69, 0.61, 16.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-19 13:00:35,655 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 12
 * Serving Flask app 'app'
 * Debug mode: on
2025-03-19 13:00:40,468 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-18 07:07:04', 'last_model_construction_at': '2025-03-19 04:50:06', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.67, 1.0, 0.8, 10.0, 1.0, 0.17, 0.29, 6.0, 0.69, 16.0, 0.83, 0.58, 0.54, 16.0, 0.79, 0.69, 0.61, 16.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-19 13:00:40,468 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 12
Usage: celery [OPTIONS] COMMAND [ARGS]...
Try 'celery --help' for help.

Error: Invalid value for '-A' / '--app': 
Unable to load celery application.
Module 'algorithm' has no attribute 'entity'
2025-03-19 13:00:52,717 - INFO - Detection started. Combined data duration: 10
2025-03-19 13:01:28,333 - INFO - Detection paused.
2025-03-19 13:01:29,658 - INFO - Detection started. Combined data duration: 10
Usage: celery [OPTIONS] COMMAND [ARGS]...
Try 'celery --help' for help.

Error: Invalid value for '-A' / '--app': 
Unable to load celery application.
Module 'algorithm' has no attribute 'entity'
 
 -------------- celery@VM-16-2-ubuntu v5.4.0 (opalescent)
--- ***** ----- 
-- ******* ---- Linux-5.15.0-130-generic-x86_64-with-glibc2.35 2025-03-19 13:09:16
- *** --- * --- 
- ** ---------- [config]
- ** ---------- .> app:         tasks:0x7f4c6d16f490
- ** ---------- .> transport:   redis://localhost:6379/0
- ** ---------- .> results:     disabled://
- *** --- * --- .> concurrency: 2 (prefork)
-- ******* ---- .> task events: OFF (enable -E to monitor tasks in this worker)
--- ***** ----- 
 -------------- [queues]
                .> celery           exchange=celery(direct) key=celery
                

[tasks]
  . traffic_collector.consume_traffic_periodically

[2025-03-19 13:09:16,339: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

[2025-03-19 13:09:16,352: INFO/MainProcess] Connected to redis://localhost:6379/0
[2025-03-19 13:09:16,352: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

[2025-03-19 13:09:16,354: INFO/MainProcess] mingle: searching for neighbors
[2025-03-19 13:09:17,359: INFO/MainProcess] mingle: all alone
[2025-03-19 13:09:17,366: INFO/MainProcess] celery@VM-16-2-ubuntu ready.
[2025-03-19 13:09:17,368: ERROR/MainProcess] Received unregistered task of type '__mitmproxy_script__.traffic_collector.consume_traffic_periodically'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[[], {}, {"callbacks": null, "errbacks": null, "chain": null, "chord": null}]' (77b)

The full contents of the message headers:
{'lang': 'py', 'task': '__mitmproxy_script__.traffic_collector.consume_traffic_periodically', 'id': 'b7994e87-eb1a-4456-b684-46ab4c78684b', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': 'b7994e87-eb1a-4456-b684-46ab4c78684b', 'parent_id': None, 'argsrepr': '()', 'kwargsrepr': '{}', 'origin': 'gen3200@VM-16-2-ubuntu', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "/home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
KeyError: '__mitmproxy_script__.traffic_collector.consume_traffic_periodically'
[2025-03-19 13:09:17,371: INFO/MainProcess] Task traffic_collector.consume_traffic_periodically[449c6050-9813-49c9-8b7b-e16eb6615efd] received
[2025-03-19 13:09:27,728: ERROR/ForkPoolWorker-1] Task traffic_collector.consume_traffic_periodically[449c6050-9813-49c9-8b7b-e16eb6615efd] raised unexpected: ConnectionError(MaxRetryError("HTTPConnectionPool(host='127.0.0.1', port=5000): Max retries exceeded with url: /detect_traffic_data_seq (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f4c6c167550>: Failed to establish a new connection: [Errno 111] Connection refused'))"))
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/usr/local/lib/python3.10/dist-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/usr/local/lib/python3.10/dist-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/usr/local/lib/python3.10/dist-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/usr/local/lib/python3.10/dist-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/usr/local/lib/python3.10/dist-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
  File "/usr/local/lib/python3.10/dist-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f4c6c167550>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/requests/adapters.py", line 667, in send
    resp = conn.urlopen(
  File "/usr/local/lib/python3.10/dist-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "/usr/local/lib/python3.10/dist-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='127.0.0.1', port=5000): Max retries exceeded with url: /detect_traffic_data_seq (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f4c6c167550>: Failed to establish a new connection: [Errno 111] Connection refused'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ubuntu/.local/lib/python3.10/site-packages/celery/app/trace.py", line 453, in trace_task
    R = retval = fun(*args, **kwargs)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/celery/app/trace.py", line 736, in __protected_call__
    return self.run(*args, **kwargs)
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/traffic_collector.py", line 263, in consume_traffic_periodically
    requests.post('http://127.0.0.1:5000/detect_traffic_data_seq', json={'traffic_data_seq': traffic_sequence})
  File "/usr/local/lib/python3.10/dist-packages/requests/api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/usr/local/lib/python3.10/dist-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/requests/adapters.py", line 700, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='127.0.0.1', port=5000): Max retries exceeded with url: /detect_traffic_data_seq (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f4c6c167550>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2025-03-19 13:09:58,741: INFO/MainProcess] Task traffic_collector.consume_traffic_periodically[d8d708ce-e0ef-4974-a4ac-14068f4b800a] received
 
 -------------- celery@VM-16-2-ubuntu v5.4.0 (opalescent)
--- ***** ----- 
-- ******* ---- Linux-5.15.0-130-generic-x86_64-with-glibc2.35 2025-03-19 13:09:58
- *** --- * --- 
- ** ---------- [config]
- ** ---------- .> app:         tasks:0x7f358f06ebf0
- ** ---------- .> transport:   redis://localhost:6379/0
- ** ---------- .> results:     disabled://
- *** --- * --- .> concurrency: 2 (prefork)
-- ******* ---- .> task events: OFF (enable -E to monitor tasks in this worker)
--- ***** ----- 
 -------------- [queues]
                .> celery           exchange=celery(direct) key=celery
                

[tasks]
  . traffic_collector.consume_traffic_periodically

[2025-03-19 13:09:58,851: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

[2025-03-19 13:09:58,856: INFO/MainProcess] Connected to redis://localhost:6379/0
[2025-03-19 13:09:58,856: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

[2025-03-19 13:09:58,868: INFO/MainProcess] mingle: searching for neighbors
2025-03-19 13:09:58,955 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-18 07:07:04', 'last_model_construction_at': '2025-03-19 04:50:06', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'STARTED', 'model_report': [0.67, 1.0, 0.8, 10.0, 1.0, 0.17, 0.29, 6.0, 0.69, 16.0, 0.83, 0.58, 0.54, 16.0, 0.79, 0.69, 0.61, 16.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-19 13:09:58,956 - INFO - Loaded target app: App_id: 1, Detect_state: STARTED, Combined_data_duration: 10, Feature size: 12
 * Serving Flask app 'app'
 * Debug mode: on
[2025-03-19 13:09:59,876: INFO/MainProcess] mingle: all alone
[2025-03-19 13:09:59,889: INFO/MainProcess] celery@VM-16-2-ubuntu ready.
[2025-03-19 13:10:00,014: ERROR/MainProcess] Received unregistered task of type '__mitmproxy_script__.traffic_collector.consume_traffic_periodically'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[[], {}, {"callbacks": null, "errbacks": null, "chain": null, "chord": null}]' (77b)

The full contents of the message headers:
{'lang': 'py', 'task': '__mitmproxy_script__.traffic_collector.consume_traffic_periodically', 'id': '9ea3fac7-e3d1-4f4f-8927-0c83169b5203', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': '9ea3fac7-e3d1-4f4f-8927-0c83169b5203', 'parent_id': None, 'argsrepr': '()', 'kwargsrepr': '{}', 'origin': 'gen16626@VM-16-2-ubuntu', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "/home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
KeyError: '__mitmproxy_script__.traffic_collector.consume_traffic_periodically'
2025-03-19 13:10:02,555 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-18 07:07:04', 'last_model_construction_at': '2025-03-19 04:50:06', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'STARTED', 'model_report': [0.67, 1.0, 0.8, 10.0, 1.0, 0.17, 0.29, 6.0, 0.69, 16.0, 0.83, 0.58, 0.54, 16.0, 0.79, 0.69, 0.61, 16.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-19 13:10:02,556 - INFO - Loaded target app: App_id: 1, Detect_state: STARTED, Combined_data_duration: 10, Feature size: 12
2025-03-19 13:10:18,758 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 12
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 1536, in __call__
    return self.wsgi_app(environ, start_response)
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/./app.py", line 593, in detect_traffic_data_seq
    anomaly_detection(app_data_seq)
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/enhanced_detector.py", line 123, in anomaly_detection
    detection_result = (model.detect(FeatureExtractor(real_data=df)))[0]
AttributeError: 'XGBoost' object has no attribute 'detect'
2025-03-19 13:10:28,892 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 12
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 1536, in __call__
    return self.wsgi_app(environ, start_response)
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/./app.py", line 593, in detect_traffic_data_seq
    anomaly_detection(app_data_seq)
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/enhanced_detector.py", line 123, in anomaly_detection
    detection_result = (model.detect(FeatureExtractor(real_data=df)))[0]
AttributeError: 'XGBoost' object has no attribute 'detect'
2025-03-19 13:11:15,746 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-18 07:07:04', 'last_model_construction_at': '2025-03-19 04:50:06', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'STARTED', 'model_report': [0.67, 1.0, 0.8, 10.0, 1.0, 0.17, 0.29, 6.0, 0.69, 16.0, 0.83, 0.58, 0.54, 16.0, 0.79, 0.69, 0.61, 16.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-19 13:11:15,747 - INFO - Loaded target app: App_id: 1, Detect_state: STARTED, Combined_data_duration: 10, Feature size: 12
2025-03-19 13:11:28,956 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 12
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 1536, in __call__
    return self.wsgi_app(environ, start_response)
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/./app.py", line 593, in detect_traffic_data_seq
    anomaly_detection(app_data_seq)
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/enhanced_detector.py", line 123, in anomaly_detection
    detection_result = (model.predict(FeatureExtractor(real_data=df)))[0]
TypeError: FeatureExtractor.__init__() got an unexpected keyword argument 'real_data'
2025-03-19 13:11:38,988 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 12
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 1536, in __call__
    return self.wsgi_app(environ, start_response)
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/./app.py", line 593, in detect_traffic_data_seq
    anomaly_detection(app_data_seq)
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/enhanced_detector.py", line 123, in anomaly_detection
    detection_result = (model.predict(FeatureExtractor(real_data=df)))[0]
TypeError: FeatureExtractor.__init__() got an unexpected keyword argument 'real_data'
2025-03-19 13:14:09,130 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 12
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 1536, in __call__
    return self.wsgi_app(environ, start_response)
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/./app.py", line 593, in detect_traffic_data_seq
    anomaly_detection(app_data_seq)
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/enhanced_detector.py", line 123, in anomaly_detection
    detection_result = (model.predict(FeatureExtractor(real_data=df)))[0]
TypeError: FeatureExtractor.__init__() got an unexpected keyword argument 'real_data'
2025-03-19 13:14:23,049 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-18 07:07:04', 'last_model_construction_at': '2025-03-19 04:50:06', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'STARTED', 'model_report': [0.67, 1.0, 0.8, 10.0, 1.0, 0.17, 0.29, 6.0, 0.69, 16.0, 0.83, 0.58, 0.54, 16.0, 0.79, 0.69, 0.61, 16.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-19 13:14:23,052 - INFO - Loaded target app: App_id: 1, Detect_state: STARTED, Combined_data_duration: 10, Feature size: 12
2025-03-19 13:14:39,188 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 12
/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/Dynamtic_Feature_Extraction.py:45: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df['timestamp'] = pd.to_datetime(df['timestamp'], errors='coerce')
/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/Dynamtic_Feature_Extraction.py:46: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df['timestamp'] = df['timestamp'].astype('int64') // 10**9
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 1536, in __call__
    return self.wsgi_app(environ, start_response)
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/./app.py", line 593, in detect_traffic_data_seq
    anomaly_detection(app_data_seq)
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/enhanced_detector.py", line 123, in anomaly_detection
    detection_result = (model.predict(FeatureExtractor(real_data=df)))[0]
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/detection_model.py", line 1104, in predict
    new_data = data[loaded_feature_names]
TypeError: 'FeatureExtractor' object is not subscriptable
2025-03-19 13:15:29,426 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 12
/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/Dynamtic_Feature_Extraction.py:45: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df['timestamp'] = pd.to_datetime(df['timestamp'], errors='coerce')
/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/Dynamtic_Feature_Extraction.py:46: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df['timestamp'] = df['timestamp'].astype('int64') // 10**9
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 1536, in __call__
    return self.wsgi_app(environ, start_response)
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/./app.py", line 593, in detect_traffic_data_seq
    anomaly_detection(app_data_seq)
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/enhanced_detector.py", line 123, in anomaly_detection
    detection_result = (model.predict(FeatureExtractor(real_data=df)))[0]
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/detection_model.py", line 1104, in predict
    new_data = data[loaded_feature_names]
TypeError: 'FeatureExtractor' object is not subscriptable
2025-03-19 13:16:27,435 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-18 07:07:04', 'last_model_construction_at': '2025-03-19 04:50:06', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'STARTED', 'model_report': [0.67, 1.0, 0.8, 10.0, 1.0, 0.17, 0.29, 6.0, 0.69, 16.0, 0.83, 0.58, 0.54, 16.0, 0.79, 0.69, 0.61, 16.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-19 13:16:27,436 - INFO - Loaded target app: App_id: 1, Detect_state: STARTED, Combined_data_duration: 10, Feature size: 12
2025-03-19 13:16:39,496 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 12
/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/Dynamtic_Feature_Extraction.py:45: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df['timestamp'] = pd.to_datetime(df['timestamp'], errors='coerce')
/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/Dynamtic_Feature_Extraction.py:46: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df['timestamp'] = df['timestamp'].astype('int64') // 10**9
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 1536, in __call__
    return self.wsgi_app(environ, start_response)
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/./app.py", line 593, in detect_traffic_data_seq
    anomaly_detection(app_data_seq)
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/enhanced_detector.py", line 124, in anomaly_detection
    detection_result = (model.predict(extracted_data))[0]
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/detection_model.py", line 1104, in predict
    new_data = data[loaded_feature_names]
  File "/usr/local/lib/python3.10/dist-packages/pandas/core/frame.py", line 4108, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
  File "/usr/local/lib/python3.10/dist-packages/pandas/core/indexes/base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/usr/local/lib/python3.10/dist-packages/pandas/core/indexes/base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['UniqueParamsCount', 'TotalParamsCount', 'ConsecutiveRepeats'] not in index"
2025-03-19 13:18:38,614 - INFO - Detection paused.
2025-03-19 13:18:40,389 - INFO - Trying to construct model...
2025-03-19 13:18:40,390 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-19 13:18:40,792 - INFO - Model constructed.
最终选择的特征:
['UniquePathsCount', 'TotalPathsCount', 'UniqueParamsCount', 'TotalParamsCount', 'ConsecutiveRepeats', 'AvgPathDepth', 'StdPathLength', 'AvgParamCount', 'StdParamCount', 'AvgPathLength', 'StdPathDepth', 'UniquenessRatio']
最终特征数量: 12

XGBoost 测试集准确率: 0.6875
2025-03-19 13:22:23,120 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-18 07:07:04', 'last_model_construction_at': '2025-03-19 05:18:40', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.67, 1.0, 0.8, 10.0, 1.0, 0.17, 0.29, 6.0, 0.69, 16.0, 0.83, 0.58, 0.54, 16.0, 0.79, 0.69, 0.61, 16.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-19 13:22:23,121 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 12
2025-03-19 13:22:33,836 - INFO - Detection started. Combined data duration: 10
2025-03-19 13:22:39,982 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 12
/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/Dynamtic_Feature_Extraction.py:45: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df['timestamp'] = pd.to_datetime(df['timestamp'], errors='coerce')
/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/Dynamtic_Feature_Extraction.py:46: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df['timestamp'] = df['timestamp'].astype('int64') // 10**9
2025-03-19 13:22:40,044 - INFO - extracted_data:    UniquePathsCount  TotalPathsCount  ...  StdPathDepth  UniquenessRatio
0                 6               10  ...           0.0              0.6

[1 rows x 9 columns]
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 1536, in __call__
    return self.wsgi_app(environ, start_response)
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/./app.py", line 593, in detect_traffic_data_seq
    anomaly_detection(app_data_seq)
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/enhanced_detector.py", line 125, in anomaly_detection
    detection_result = (model.predict(extracted_data))[0]
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/detection_model.py", line 1104, in predict
    new_data = data[loaded_feature_names]
  File "/usr/local/lib/python3.10/dist-packages/pandas/core/frame.py", line 4108, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
  File "/usr/local/lib/python3.10/dist-packages/pandas/core/indexes/base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/usr/local/lib/python3.10/dist-packages/pandas/core/indexes/base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['UniqueParamsCount', 'TotalParamsCount', 'ConsecutiveRepeats'] not in index"
2025-03-19 13:22:50,117 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 12
/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/Dynamtic_Feature_Extraction.py:45: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df['timestamp'] = pd.to_datetime(df['timestamp'], errors='coerce')
/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/Dynamtic_Feature_Extraction.py:46: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df['timestamp'] = df['timestamp'].astype('int64') // 10**9
2025-03-19 13:22:50,130 - INFO - extracted_data:    UniquePathsCount  TotalPathsCount  ...  StdPathDepth  UniquenessRatio
0                 4                5  ...           0.0              0.8

[1 rows x 9 columns]
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 1536, in __call__
    return self.wsgi_app(environ, start_response)
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/./app.py", line 593, in detect_traffic_data_seq
    anomaly_detection(app_data_seq)
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/enhanced_detector.py", line 125, in anomaly_detection
    detection_result = (model.predict(extracted_data))[0]
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/detection_model.py", line 1104, in predict
    new_data = data[loaded_feature_names]
  File "/usr/local/lib/python3.10/dist-packages/pandas/core/frame.py", line 4108, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
  File "/usr/local/lib/python3.10/dist-packages/pandas/core/indexes/base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/usr/local/lib/python3.10/dist-packages/pandas/core/indexes/base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['UniqueParamsCount', 'TotalParamsCount', 'ConsecutiveRepeats'] not in index"
2025-03-19 13:24:56,397 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-18 07:07:04', 'last_model_construction_at': '2025-03-19 05:18:40', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'STARTED', 'model_report': [0.67, 1.0, 0.8, 10.0, 1.0, 0.17, 0.29, 6.0, 0.69, 16.0, 0.83, 0.58, 0.54, 16.0, 0.79, 0.69, 0.61, 16.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-19 13:24:56,399 - INFO - Loaded target app: App_id: 1, Detect_state: STARTED, Combined_data_duration: 10, Feature size: 12
2025-03-19 13:25:30,273 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 12
/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/Dynamtic_Feature_Extraction.py:45: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df['timestamp'] = pd.to_datetime(df['timestamp'], errors='coerce')
/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/Dynamtic_Feature_Extraction.py:46: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df['timestamp'] = df['timestamp'].astype('int64') // 10**9
2025-03-19 13:25:30,345 - INFO - extracted_data:    UniquePathsCount  TotalPathsCount  ...  StdPathDepth  UniquenessRatio
0                 1                1  ...           0.0              1.0

[1 rows x 12 columns]
2025-03-19 13:25:30,452 - INFO - A new detect record generated; Traffic data size: 1
2025-03-19 13:26:16,616 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-18 07:07:04', 'last_model_construction_at': '2025-03-19 05:18:40', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'STARTED', 'model_report': [0.67, 1.0, 0.8, 10.0, 1.0, 0.17, 0.29, 6.0, 0.69, 16.0, 0.83, 0.58, 0.54, 16.0, 0.79, 0.69, 0.61, 16.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-19 13:26:16,617 - INFO - Loaded target app: App_id: 1, Detect_state: STARTED, Combined_data_duration: 10, Feature size: 12
2025-03-19 13:26:30,505 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 12
/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/Dynamtic_Feature_Extraction.py:45: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df['timestamp'] = pd.to_datetime(df['timestamp'], errors='coerce')
/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/Dynamtic_Feature_Extraction.py:46: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df['timestamp'] = df['timestamp'].astype('int64') // 10**9
2025-03-19 13:26:30,562 - INFO - extracted_data:    UniquePathsCount  TotalPathsCount  ...  StdPathDepth  UniquenessRatio
0                 6               16  ...           0.0            0.375

[1 rows x 12 columns]
2025-03-19 13:26:30,654 - INFO - A new detect record generated; Traffic data size: 16
2025-03-19 13:27:45,155 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-18 07:07:04', 'last_model_construction_at': '2025-03-19 05:18:40', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'STARTED', 'model_report': [0.67, 1.0, 0.8, 10.0, 1.0, 0.17, 0.29, 6.0, 0.69, 16.0, 0.83, 0.58, 0.54, 16.0, 0.79, 0.69, 0.61, 16.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-19 13:27:45,156 - INFO - Loaded target app: App_id: 1, Detect_state: STARTED, Combined_data_duration: 10, Feature size: 12
2025-03-19 13:27:45,316 - INFO - Detection paused.
2025-03-19 13:27:46,934 - INFO - Trying to construct model...
2025-03-19 13:27:46,935 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-19 13:27:50,162 - INFO - Model constructed.
2025-03-19 13:27:54,651 - INFO - Detection started. Combined data duration: 10
2025-03-19 13:28:20,745 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 12
/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/Dynamtic_Feature_Extraction.py:45: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df['timestamp'] = pd.to_datetime(df['timestamp'], errors='coerce')
/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/Dynamtic_Feature_Extraction.py:46: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df['timestamp'] = df['timestamp'].astype('int64') // 10**9
2025-03-19 13:28:20,766 - INFO - extracted_data:    UniquePathsCount  TotalPathsCount  ...  StdPathDepth  UniquenessRatio
0                 5               10  ...           0.0              0.5

[1 rows x 12 columns]
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 1536, in __call__
    return self.wsgi_app(environ, start_response)
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/./app.py", line 593, in detect_traffic_data_seq
    anomaly_detection(app_data_seq)
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/enhanced_detector.py", line 125, in anomaly_detection
    detection_result = (model.predict(extracted_data))[0]
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/detection_model.py", line 1010, in predict
    checkpoint = torch.load(os.path.join(base_dir, "models", "VAE-CNN", "best_vae_cnn_model.pth"))
  File "/home/ubuntu/.local/lib/python3.10/site-packages/torch/serialization.py", line 1470, in load
    raise pickle.UnpicklingError(_get_wo_message(str(e))) from None
_pickle.UnpicklingError: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL sklearn.preprocessing._data.MinMaxScaler was not an allowed global by default. Please use `torch.serialization.add_safe_globals([MinMaxScaler])` or the `torch.serialization.safe_globals([MinMaxScaler])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
2025-03-19 13:30:30,888 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 12
/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/Dynamtic_Feature_Extraction.py:45: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df['timestamp'] = pd.to_datetime(df['timestamp'], errors='coerce')
/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/Dynamtic_Feature_Extraction.py:46: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df['timestamp'] = df['timestamp'].astype('int64') // 10**9
2025-03-19 13:30:30,905 - INFO - extracted_data:    UniquePathsCount  TotalPathsCount  ...  StdPathDepth  UniquenessRatio
0                 1                1  ...           0.0              1.0

[1 rows x 12 columns]
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 1536, in __call__
    return self.wsgi_app(environ, start_response)
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/./app.py", line 593, in detect_traffic_data_seq
    anomaly_detection(app_data_seq)
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/enhanced_detector.py", line 125, in anomaly_detection
    detection_result = (model.predict(extracted_data))[0]
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/detection_model.py", line 1010, in predict
    checkpoint = torch.load(os.path.join(base_dir, "models", "VAE-CNN", "best_vae_cnn_model.pth"))
  File "/home/ubuntu/.local/lib/python3.10/site-packages/torch/serialization.py", line 1470, in load
    raise pickle.UnpicklingError(_get_wo_message(str(e))) from None
_pickle.UnpicklingError: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL sklearn.preprocessing._data.MinMaxScaler was not an allowed global by default. Please use `torch.serialization.add_safe_globals([MinMaxScaler])` or the `torch.serialization.safe_globals([MinMaxScaler])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
Epoch [1/100] - Train Loss: 0.8188 - Val Loss: 0.8261
✅ 发现更好的模型，已更新变量！
Epoch [2/100] - Train Loss: 0.8151 - Val Loss: 0.8451
Epoch [3/100] - Train Loss: 0.8089 - Val Loss: 0.8107
✅ 发现更好的模型，已更新变量！
Epoch [4/100] - Train Loss: 0.7887 - Val Loss: 0.7412
✅ 发现更好的模型，已更新变量！
Epoch [5/100] - Train Loss: 0.7244 - Val Loss: 0.7630
Epoch [6/100] - Train Loss: 0.7403 - Val Loss: 0.7172
✅ 发现更好的模型，已更新变量！
Epoch [7/100] - Train Loss: 0.6699 - Val Loss: 0.6297
✅ 发现更好的模型，已更新变量！
Epoch [8/100] - Train Loss: 0.6497 - Val Loss: 0.7062
Epoch [9/100] - Train Loss: 0.6342 - Val Loss: 0.5896
✅ 发现更好的模型，已更新变量！
Epoch [10/100] - Train Loss: 0.6464 - Val Loss: 0.6135
Epoch [11/100] - Train Loss: 0.5894 - Val Loss: 0.5361
✅ 发现更好的模型，已更新变量！
Epoch [12/100] - Train Loss: 0.5228 - Val Loss: 0.5610
Epoch [13/100] - Train Loss: 0.4759 - Val Loss: 0.4805
✅ 发现更好的模型，已更新变量！
Epoch [14/100] - Train Loss: 0.4610 - Val Loss: 0.4408
✅ 发现更好的模型，已更新变量！
Epoch [15/100] - Train Loss: 0.4504 - Val Loss: 0.4176
✅ 发现更好的模型，已更新变量！
Epoch [16/100] - Train Loss: 0.4009 - Val Loss: 0.3527
✅ 发现更好的模型，已更新变量！
Epoch [17/100] - Train Loss: 0.3594 - Val Loss: 0.3249
✅ 发现更好的模型，已更新变量！
Epoch [18/100] - Train Loss: 0.3622 - Val Loss: 0.2855
✅ 发现更好的模型，已更新变量！
Epoch [19/100] - Train Loss: 0.3269 - Val Loss: 0.2610
✅ 发现更好的模型，已更新变量！
Epoch [20/100] - Train Loss: 0.2742 - Val Loss: 0.2320
✅ 发现更好的模型，已更新变量！
Epoch [21/100] - Train Loss: 0.2506 - Val Loss: 0.1970
✅ 发现更好的模型，已更新变量！
Epoch [22/100] - Train Loss: 0.2558 - Val Loss: 0.1895
✅ 发现更好的模型，已更新变量！
Epoch [23/100] - Train Loss: 0.2227 - Val Loss: 0.1886
✅ 发现更好的模型，已更新变量！
Epoch [24/100] - Train Loss: 0.2224 - Val Loss: 0.1794
✅ 发现更好的模型，已更新变量！
Epoch [25/100] - Train Loss: 0.2093 - Val Loss: 0.1402
✅ 发现更好的模型，已更新变量！
Epoch [26/100] - Train Loss: 0.2094 - Val Loss: 0.1644
Epoch [27/100] - Train Loss: 0.1996 - Val Loss: 0.1634
Epoch [28/100] - Train Loss: 0.2020 - Val Loss: 0.1563
Epoch [29/100] - Train Loss: 0.2041 - Val Loss: 0.1405
Epoch [30/100] - Train Loss: 0.1972 - Val Loss: 0.1531
⏹️ 早停触发，停止训练！

VAE-CNN 测试集准确率: 0.5625
VAE-CNN 分类报告:
2025-03-19 13:31:41,969 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-18 07:07:04', 'last_model_construction_at': '2025-03-19 05:27:50', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'STARTED', 'model_report': [0.6154, 0.8, 0.6957, 10.0, 0.3333, 0.1667, 0.2222, 6.0, 0.5625, 16.0, 0.4744, 0.4833, 0.4589, 16.0, 0.5096, 0.5625, 0.5181, 16.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-19 13:31:41,970 - INFO - Loaded target app: App_id: 1, Detect_state: STARTED, Combined_data_duration: 10, Feature size: 12
2025-03-19 13:31:58,027 - INFO - Detection paused.
2025-03-19 13:31:59,177 - INFO - Trying to construct model...
2025-03-19 13:31:59,178 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-19 13:32:03,233 - INFO - Model constructed.
2025-03-19 13:32:24,109 - INFO - Detection started. Combined data duration: 10
2025-03-19 13:32:30,999 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 12
/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/Dynamtic_Feature_Extraction.py:45: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df['timestamp'] = pd.to_datetime(df['timestamp'], errors='coerce')
/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/Dynamtic_Feature_Extraction.py:46: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df['timestamp'] = df['timestamp'].astype('int64') // 10**9
2025-03-19 13:32:31,035 - INFO - extracted_data:    UniquePathsCount  TotalPathsCount  ...  StdPathDepth  UniquenessRatio
0                 5                9  ...           0.0         0.555556

[1 rows x 12 columns]
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 1536, in __call__
    return self.wsgi_app(environ, start_response)
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/./app.py", line 593, in detect_traffic_data_seq
    anomaly_detection(app_data_seq)
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/enhanced_detector.py", line 125, in anomaly_detection
    detection_result = (model.predict(extracted_data))[0]
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/detection_model.py", line 1010, in predict
    checkpoint = torch.load(os.path.join(base_dir, "models", "VAE-CNN", "best_vae_cnn_model.pth"), weights_only=True)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/torch/serialization.py", line 1470, in load
    raise pickle.UnpicklingError(_get_wo_message(str(e))) from None
_pickle.UnpicklingError: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL sklearn.preprocessing._data.MinMaxScaler was not an allowed global by default. Please use `torch.serialization.add_safe_globals([MinMaxScaler])` or the `torch.serialization.safe_globals([MinMaxScaler])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
2025-03-19 13:32:41,064 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 12
/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/Dynamtic_Feature_Extraction.py:45: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df['timestamp'] = pd.to_datetime(df['timestamp'], errors='coerce')
/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/Dynamtic_Feature_Extraction.py:46: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df['timestamp'] = df['timestamp'].astype('int64') // 10**9
2025-03-19 13:32:41,078 - INFO - extracted_data:    UniquePathsCount  TotalPathsCount  ...  StdPathDepth  UniquenessRatio
0                 2                2  ...           0.0              1.0

[1 rows x 12 columns]
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 1536, in __call__
    return self.wsgi_app(environ, start_response)
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.10/dist-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/./app.py", line 593, in detect_traffic_data_seq
    anomaly_detection(app_data_seq)
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/enhanced_detector.py", line 125, in anomaly_detection
    detection_result = (model.predict(extracted_data))[0]
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/detection_model.py", line 1010, in predict
    checkpoint = torch.load(os.path.join(base_dir, "models", "VAE-CNN", "best_vae_cnn_model.pth"), weights_only=True)
  File "/home/ubuntu/.local/lib/python3.10/site-packages/torch/serialization.py", line 1470, in load
    raise pickle.UnpicklingError(_get_wo_message(str(e))) from None
_pickle.UnpicklingError: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL sklearn.preprocessing._data.MinMaxScaler was not an allowed global by default. Please use `torch.serialization.add_safe_globals([MinMaxScaler])` or the `torch.serialization.safe_globals([MinMaxScaler])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
Epoch [1/100] - Train Loss: 0.8462 - Val Loss: 0.8307
✅ 发现更好的模型，已更新变量！
Epoch [2/100] - Train Loss: 0.7873 - Val Loss: 0.7255
✅ 发现更好的模型，已更新变量！
Epoch [3/100] - Train Loss: 0.7849 - Val Loss: 0.7978
Epoch [4/100] - Train Loss: 0.7637 - Val Loss: 0.7648
Epoch [5/100] - Train Loss: 0.7123 - Val Loss: 0.6936
✅ 发现更好的模型，已更新变量！
Epoch [6/100] - Train Loss: 0.6585 - Val Loss: 0.6576
✅ 发现更好的模型，已更新变量！
Epoch [7/100] - Train Loss: 0.6292 - Val Loss: 0.6972
Epoch [8/100] - Train Loss: 0.6291 - Val Loss: 0.6025
✅ 发现更好的模型，已更新变量！
Epoch [9/100] - Train Loss: 0.5788 - Val Loss: 0.5174
✅ 发现更好的模型，已更新变量！
Epoch [10/100] - Train Loss: 0.5468 - Val Loss: 0.5892
Epoch [11/100] - Train Loss: 0.5429 - Val Loss: 0.4836
✅ 发现更好的模型，已更新变量！
Epoch [12/100] - Train Loss: 0.4906 - Val Loss: 0.4854
Epoch [13/100] - Train Loss: 0.4604 - Val Loss: 0.4464
✅ 发现更好的模型，已更新变量！
Epoch [14/100] - Train Loss: 0.3983 - Val Loss: 0.3551
✅ 发现更好的模型，已更新变量！
Epoch [15/100] - Train Loss: 0.3916 - Val Loss: 0.3151
✅ 发现更好的模型，已更新变量！
Epoch [16/100] - Train Loss: 0.3588 - Val Loss: 0.3337
Epoch [17/100] - Train Loss: 0.3057 - Val Loss: 0.2241
✅ 发现更好的模型，已更新变量！
Epoch [18/100] - Train Loss: 0.2820 - Val Loss: 0.2484
Epoch [19/100] - Train Loss: 0.2751 - Val Loss: 0.2123
✅ 发现更好的模型，已更新变量！
Epoch [20/100] - Train Loss: 0.2525 - Val Loss: 0.2043
✅ 发现更好的模型，已更新变量！
Epoch [21/100] - Train Loss: 0.2378 - Val Loss: 0.1920
✅ 发现更好的模型，已更新变量！
Epoch [22/100] - Train Loss: 0.2177 - Val Loss: 0.1829
✅ 发现更好的模型，已更新变量！
Epoch [23/100] - Train Loss: 0.2113 - Val Loss: 0.1679
✅ 发现更好的模型，已更新变量！
Epoch [24/100] - Train Loss: 0.2340 - Val Loss: 0.1688
Epoch [25/100] - Train Loss: 0.2103 - Val Loss: 0.1827
Epoch [26/100] - Train Loss: 0.2073 - Val Loss: 0.1533
✅ 发现更好的模型，已更新变量！
Epoch [27/100] - Train Loss: 0.2046 - Val Loss: 0.1576
Epoch [28/100] - Train Loss: 0.2018 - Val Loss: 0.1675
Epoch [29/100] - Train Loss: 0.1901 - Val Loss: 0.1363
✅ 发现更好的模型，已更新变量！
Epoch [30/100] - Train Loss: 0.1977 - Val Loss: 0.1776
Epoch [31/100] - Train Loss: 0.1875 - Val Loss: 0.1360
✅ 发现更好的模型，已更新变量！
Epoch [32/100] - Train Loss: 0.1949 - Val Loss: 0.1566
Epoch [33/100] - Train Loss: 0.1776 - Val Loss: 0.1630
Epoch [34/100] - Train Loss: 0.1755 - Val Loss: 0.1636
Epoch [35/100] - Train Loss: 0.1699 - Val Loss: 0.1548
Epoch [36/100] - Train Loss: 0.1905 - Val Loss: 0.1580
⏹️ 早停触发，停止训练！

VAE-CNN 测试集准确率: 0.4375
VAE-CNN 分类报告:
2025-03-19 13:34:18,612 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-18 07:07:04', 'last_model_construction_at': '2025-03-19 05:32:03', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'STARTED', 'model_report': [0.5385, 0.7, 0.6087, 10.0, 0.0, 0.0, 0.0, 6.0, 0.4375, 16.0, 0.2692, 0.35, 0.3043, 16.0, 0.3365, 0.4375, 0.3804, 16.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-19 13:34:18,614 - INFO - Loaded target app: App_id: 1, Detect_state: STARTED, Combined_data_duration: 10, Feature size: 12
2025-03-19 13:34:23,220 - INFO - Detection paused.
2025-03-19 13:34:24,375 - INFO - Trying to construct model...
2025-03-19 13:34:24,376 - INFO - DATA_COLLECTION_STATUS: COMPLETED
2025-03-19 13:34:28,438 - INFO - Model constructed.
2025-03-19 13:34:30,497 - INFO - Detection started. Combined data duration: 10
2025-03-19 13:34:41,185 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 12
/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/Dynamtic_Feature_Extraction.py:45: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df['timestamp'] = pd.to_datetime(df['timestamp'], errors='coerce')
/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/Dynamtic_Feature_Extraction.py:46: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df['timestamp'] = df['timestamp'].astype('int64') // 10**9
2025-03-19 13:34:41,356 - INFO - extracted_data:    UniquePathsCount  TotalPathsCount  ...  StdPathDepth  UniquenessRatio
0                 7               17  ...           0.0         0.411765

[1 rows x 12 columns]
2025-03-19 13:34:41,735 - INFO - A new detect record generated; Traffic data size: 17
2025-03-19 13:34:51,763 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 12
/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/Dynamtic_Feature_Extraction.py:45: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df['timestamp'] = pd.to_datetime(df['timestamp'], errors='coerce')
/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/Dynamtic_Feature_Extraction.py:46: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df['timestamp'] = df['timestamp'].astype('int64') // 10**9
2025-03-19 13:34:51,885 - INFO - extracted_data:    UniquePathsCount  TotalPathsCount  ...  StdPathDepth  UniquenessRatio
0                 1                1  ...           0.0              1.0

[1 rows x 12 columns]
2025-03-19 13:34:52,212 - INFO - A new detect record generated; Traffic data size: 1
2025-03-19 13:35:32,261 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 12
/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/Dynamtic_Feature_Extraction.py:45: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df['timestamp'] = pd.to_datetime(df['timestamp'], errors='coerce')
/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/Dynamtic_Feature_Extraction.py:46: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df['timestamp'] = df['timestamp'].astype('int64') // 10**9
2025-03-19 13:35:32,397 - INFO - extracted_data:    UniquePathsCount  TotalPathsCount  ...  StdPathDepth  UniquenessRatio
0                 1                1  ...           0.0              1.0

[1 rows x 12 columns]
2025-03-19 13:35:32,793 - INFO - A new detect record generated; Traffic data size: 1
Epoch [1/100] - Train Loss: 1.1543 - Val Loss: 1.1160
✅ 发现更好的模型，已更新变量！
Epoch [2/100] - Train Loss: 1.1146 - Val Loss: 1.0419
✅ 发现更好的模型，已更新变量！
Epoch [3/100] - Train Loss: 1.0726 - Val Loss: 1.0077
✅ 发现更好的模型，已更新变量！
Epoch [4/100] - Train Loss: 1.0195 - Val Loss: 0.9845
✅ 发现更好的模型，已更新变量！
Epoch [5/100] - Train Loss: 0.9986 - Val Loss: 1.0076
Epoch [6/100] - Train Loss: 0.9441 - Val Loss: 0.8360
✅ 发现更好的模型，已更新变量！
Epoch [7/100] - Train Loss: 0.9245 - Val Loss: 0.8915
Epoch [8/100] - Train Loss: 0.8824 - Val Loss: 0.7858
✅ 发现更好的模型，已更新变量！
Epoch [9/100] - Train Loss: 0.8753 - Val Loss: 0.7933
Epoch [10/100] - Train Loss: 0.7984 - Val Loss: 0.7381
✅ 发现更好的模型，已更新变量！
Epoch [11/100] - Train Loss: 0.7538 - Val Loss: 0.6857
✅ 发现更好的模型，已更新变量！
Epoch [12/100] - Train Loss: 0.7018 - Val Loss: 0.5940
✅ 发现更好的模型，已更新变量！
Epoch [13/100] - Train Loss: 0.6560 - Val Loss: 0.6094
Epoch [14/100] - Train Loss: 0.5861 - Val Loss: 0.5277
✅ 发现更好的模型，已更新变量！
Epoch [15/100] - Train Loss: 0.5457 - Val Loss: 0.4585
✅ 发现更好的模型，已更新变量！
Epoch [16/100] - Train Loss: 0.5143 - Val Loss: 0.3839
✅ 发现更好的模型，已更新变量！
Epoch [17/100] - Train Loss: 0.4439 - Val Loss: 0.3910
Epoch [18/100] - Train Loss: 0.4053 - Val Loss: 0.3121
✅ 发现更好的模型，已更新变量！
Epoch [19/100] - Train Loss: 0.3795 - Val Loss: 0.2784
✅ 发现更好的模型，已更新变量！
Epoch [20/100] - Train Loss: 0.3515 - Val Loss: 0.2827
Epoch [21/100] - Train Loss: 0.3276 - Val Loss: 0.2726
✅ 发现更好的模型，已更新变量！
Epoch [22/100] - Train Loss: 0.3135 - Val Loss: 0.2273
✅ 发现更好的模型，已更新变量！
Epoch [23/100] - Train Loss: 0.3184 - Val Loss: 0.2449
Epoch [24/100] - Train Loss: 0.2929 - Val Loss: 0.1936
✅ 发现更好的模型，已更新变量！
Epoch [25/100] - Train Loss: 0.2899 - Val Loss: 0.2057
Epoch [26/100] - Train Loss: 0.2690 - Val Loss: 0.1769
✅ 发现更好的模型，已更新变量！
Epoch [27/100] - Train Loss: 0.2640 - Val Loss: 0.2084
Epoch [28/100] - Train Loss: 0.2604 - Val Loss: 0.1849
Epoch [29/100] - Train Loss: 0.2499 - Val Loss: 0.1828
Epoch [30/100] - Train Loss: 0.2356 - Val Loss: 0.1514
✅ 发现更好的模型，已更新变量！
Epoch [31/100] - Train Loss: 0.2306 - Val Loss: 0.1540
Epoch [32/100] - Train Loss: 0.2504 - Val Loss: 0.1675
Epoch [33/100] - Train Loss: 0.2276 - Val Loss: 0.1587
Epoch [34/100] - Train Loss: 0.2316 - Val Loss: 0.1606
Epoch [35/100] - Train Loss: 0.2161 - Val Loss: 0.1643
⏹️ 早停触发，停止训练！

VAE-CNN 测试集准确率: 0.5625
VAE-CNN 分类报告:
2025-03-19 13:36:09,274 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-18 07:07:04', 'last_model_construction_at': '2025-03-19 05:34:28', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'STARTED', 'model_report': [0.6154, 0.8, 0.6957, 10.0, 0.3333, 0.1667, 0.2222, 6.0, 0.5625, 16.0, 0.4744, 0.4833, 0.4589, 16.0, 0.5096, 0.5625, 0.5181, 16.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-19 13:36:09,275 - INFO - Loaded target app: App_id: 1, Detect_state: STARTED, Combined_data_duration: 10, Feature size: 12
2025-03-19 13:36:14,661 - INFO - Detection paused.
2025-03-19 13:36:17,570 - INFO - Trying to construct model...
2025-03-19 13:36:17,570 - INFO - DATA_COLLECTION_STATUS: COMPLETED
Traceback (most recent call last):
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/./app.py", line 343, in construct_model
    report = train_and_save_model(features=features)
  File "/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/model_training.py", line 51, in train_and_save_model
    model = DETECTION_MODELS[DETECTION_MODEL_NAME]
KeyError: 'Ganormaly'
2025-03-19 13:36:52,930 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-18 07:07:04', 'last_model_construction_at': '2025-03-19 05:34:28', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.6154, 0.8, 0.6957, 10.0, 0.3333, 0.1667, 0.2222, 6.0, 0.5625, 16.0, 0.4744, 0.4833, 0.4589, 16.0, 0.5096, 0.5625, 0.5181, 16.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-19 13:36:52,932 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 12
2025-03-19 13:36:56,283 - INFO - Trying to construct model...
2025-03-19 13:36:56,284 - INFO - DATA_COLLECTION_STATUS: COMPLETED
Epoch [1/100] - D Loss: 1.3420 - G Loss: 0.6374 - Val Loss: 0.6296
✅ 发现更好的模型，已更新变量！
Epoch [2/100] - D Loss: 1.3172 - G Loss: 0.6070 - Val Loss: 0.6015
✅ 发现更好的模型，已更新变量！
Epoch [3/100] - D Loss: 1.2949 - G Loss: 0.5790 - Val Loss: 0.5735
✅ 发现更好的模型，已更新变量！
Epoch [4/100] - D Loss: 1.2755 - G Loss: 0.5519 - Val Loss: 0.5448
✅ 发现更好的模型，已更新变量！
Epoch [5/100] - D Loss: 1.2589 - G Loss: 0.5251 - Val Loss: 0.5143
✅ 发现更好的模型，已更新变量！
Epoch [6/100] - D Loss: 1.2445 - G Loss: 0.4971 - Val Loss: 0.4815
✅ 发现更好的模型，已更新变量！
Epoch [7/100] - D Loss: 1.2327 - G Loss: 0.4671 - Val Loss: 0.4461
✅ 发现更好的模型，已更新变量！
Epoch [8/100] - D Loss: 1.2244 - G Loss: 0.4352 - Val Loss: 0.4085
✅ 发现更好的模型，已更新变量！
Epoch [9/100] - D Loss: 1.2197 - G Loss: 0.4013 - Val Loss: 0.3694
✅ 发现更好的模型，已更新变量！
Epoch [10/100] - D Loss: 1.2190 - G Loss: 0.3662 - Val Loss: 0.3291
✅ 发现更好的模型，已更新变量！
Epoch [11/100] - D Loss: 1.2225 - G Loss: 0.3300 - Val Loss: 0.2888
✅ 发现更好的模型，已更新变量！
Epoch [12/100] - D Loss: 1.2319 - G Loss: 0.2939 - Val Loss: 0.2503
✅ 发现更好的模型，已更新变量！
Epoch [13/100] - D Loss: 1.2490 - G Loss: 0.2592 - Val Loss: 0.2149
✅ 发现更好的模型，已更新变量！
Epoch [14/100] - D Loss: 1.2735 - G Loss: 0.2269 - Val Loss: 0.1841
✅ 发现更好的模型，已更新变量！
Epoch [15/100] - D Loss: 1.3017 - G Loss: 0.1983 - Val Loss: 0.1585
✅ 发现更好的模型，已更新变量！
Epoch [16/100] - D Loss: 1.3321 - G Loss: 0.1744 - Val Loss: 0.1387
✅ 发现更好的模型，已更新变量！
Epoch [17/100] - D Loss: 1.3638 - G Loss: 0.1554 - Val Loss: 0.1242
✅ 发现更好的模型，已更新变量！
Epoch [18/100] - D Loss: 1.3947 - G Loss: 0.1414 - Val Loss: 0.1145
✅ 发现更好的模型，已更新变量！
Epoch [19/100] - D Loss: 1.4212 - G Loss: 0.1319 - Val Loss: 0.1084
✅ 发现更好的模型，已更新变量！
Epoch [20/100] - D Loss: 1.4412 - G Loss: 0.1257 - Val Loss: 0.1047
✅ 发现更好的模型，已更新变量！
Epoch [21/100] - D Loss: 1.4537 - G Loss: 0.1216 - Val Loss: 0.1024
✅ 发现更好的模型，已更新变量！
Epoch [22/100] - D Loss: 1.4587 - G Loss: 0.1184 - Val Loss: 0.1008
✅ 发现更好的模型，已更新变量！
Epoch [23/100] - D Loss: 1.4573 - G Loss: 0.1154 - Val Loss: 0.0998
✅ 发现更好的模型，已更新变量！
Epoch [24/100] - D Loss: 1.4512 - G Loss: 0.1125 - Val Loss: 0.0992
✅ 发现更好的模型，已更新变量！
Epoch [25/100] - D Loss: 1.4414 - G Loss: 0.1095 - Val Loss: 0.0988
✅ 发现更好的模型，已更新变量！
Epoch [26/100] - D Loss: 1.4307 - G Loss: 0.1066 - Val Loss: 0.0984
✅ 发现更好的模型，已更新变量！
Epoch [27/100] - D Loss: 1.4190 - G Loss: 0.1037 - Val Loss: 0.0975
✅ 发现更好的模型，已更新变量！
Epoch [28/100] - D Loss: 1.4063 - G Loss: 0.1006 - Val Loss: 0.0960
✅ 发现更好的模型，已更新变量！
Epoch [29/100] - D Loss: 1.3936 - G Loss: 0.0973 - Val Loss: 0.0939
✅ 发现更好的模型，已更新变量！
Epoch [30/100] - D Loss: 1.3815 - G Loss: 0.0938 - Val Loss: 0.0913
✅ 发现更好的模型，已更新变量！
Epoch [31/100] - D Loss: 1.3706 - G Loss: 0.0904 - Val Loss: 0.0884
✅ 发现更好的模型，已更新变量！
Epoch [32/100] - D Loss: 1.3616 - G Loss: 0.0872 - Val Loss: 0.0851
✅ 发现更好的模型，已更新变量！
Epoch [33/100] - D Loss: 1.3546 - G Loss: 0.0842 - Val Loss: 0.0814
✅ 发现更好的模型，已更新变量！
Epoch [34/100] - D Loss: 1.3503 - G Loss: 0.0815 - Val Loss: 0.0774
✅ 发现更好的模型，已更新变量！
Epoch [35/100] - D Loss: 1.3484 - G Loss: 0.0791 - Val Loss: 0.0732
✅ 发现更好的模型，已更新变量！
Epoch [36/100] - D Loss: 1.3482 - G Loss: 0.0769 - Val Loss: 0.0687
✅ 发现更好的模型，已更新变量！
Epoch [37/100] - D Loss: 1.3487 - G Loss: 0.0747 - Val Loss: 0.0642
✅ 发现更好的模型，已更新变量！
Epoch [38/100] - D Loss: 1.3493 - G Loss: 0.0724 - Val Loss: 0.0596
✅ 发现更好的模型，已更新变量！
Epoch [39/100] - D Loss: 1.3497 - G Loss: 0.0701 - Val Loss: 0.0551
✅ 发现更好的模型，已更新变量！
Epoch [40/100] - D Loss: 1.3498 - G Loss: 0.0676 - Val Loss: 0.0509
✅ 发现更好的模型，已更新变量！
Epoch [41/100] - D Loss: 1.3501 - G Loss: 0.0649 - Val Loss: 0.0470
✅ 发现更好的模型，已更新变量！
Epoch [42/100] - D Loss: 1.3505 - G Loss: 0.0622 - Val Loss: 0.0435
✅ 发现更好的模型，已更新变量！
Epoch [43/100] - D Loss: 1.3509 - G Loss: 0.0592 - Val Loss: 0.0403
✅ 发现更好的模型，已更新变量！
Epoch [44/100] - D Loss: 1.3514 - G Loss: 0.0562 - Val Loss: 0.0376
✅ 发现更好的模型，已更新变量！
Epoch [45/100] - D Loss: 1.3521 - G Loss: 0.0532 - Val Loss: 0.0353
✅ 发现更好的模型，已更新变量！
Epoch [46/100] - D Loss: 1.3530 - G Loss: 0.0504 - Val Loss: 0.0333
✅ 发现更好的模型，已更新变量！
Epoch [47/100] - D Loss: 1.3541 - G Loss: 0.0477 - Val Loss: 0.0316
✅ 发现更好的模型，已更新变量！
Epoch [48/100] - D Loss: 1.3552 - G Loss: 0.0453 - Val Loss: 0.0302
✅ 发现更好的模型，已更新变量！
Epoch [49/100] - D Loss: 1.3564 - G Loss: 0.0431 - Val Loss: 0.0289
✅ 发现更好的模型，已更新变量！
Epoch [50/100] - D Loss: 1.3578 - G Loss: 0.0410 - Val Loss: 0.0277
✅ 发现更好的模型，已更新变量！
Epoch [51/100] - D Loss: 1.3596 - G Loss: 0.0390 - Val Loss: 0.0264
✅ 发现更好的模型，已更新变量！
Epoch [52/100] - D Loss: 1.3618 - G Loss: 0.0371 - Val Loss: 0.0251
✅ 发现更好的模型，已更新变量！
Epoch [53/100] - D Loss: 1.3644 - G Loss: 0.0354 - Val Loss: 0.0238
✅ 发现更好的模型，已更新变量！
Epoch [54/100] - D Loss: 1.3674 - G Loss: 0.0339 - Val Loss: 0.0225
✅ 发现更好的模型，已更新变量！
Epoch [55/100] - D Loss: 1.3706 - G Loss: 0.0325 - Val Loss: 0.0213
✅ 发现更好的模型，已更新变量！
Epoch [56/100] - D Loss: 1.3736 - G Loss: 0.0314 - Val Loss: 0.0201
✅ 发现更好的模型，已更新变量！
Epoch [57/100] - D Loss: 1.3762 - G Loss: 0.0305 - Val Loss: 0.0190
✅ 发现更好的模型，已更新变量！
Epoch [58/100] - D Loss: 1.3782 - G Loss: 0.0297 - Val Loss: 0.0178
✅ 发现更好的模型，已更新变量！
Epoch [59/100] - D Loss: 1.3796 - G Loss: 0.0289 - Val Loss: 0.0166
✅ 发现更好的模型，已更新变量！
Epoch [60/100] - D Loss: 1.3802 - G Loss: 0.0280 - Val Loss: 0.0154
✅ 发现更好的模型，已更新变量！
Epoch [61/100] - D Loss: 1.3803 - G Loss: 0.0270 - Val Loss: 0.0143
✅ 发现更好的模型，已更新变量！
Epoch [62/100] - D Loss: 1.3800 - G Loss: 0.0258 - Val Loss: 0.0133
✅ 发现更好的模型，已更新变量！
Epoch [63/100] - D Loss: 1.3794 - G Loss: 0.0247 - Val Loss: 0.0125
✅ 发现更好的模型，已更新变量！
Epoch [64/100] - D Loss: 1.3788 - G Loss: 0.0236 - Val Loss: 0.0119
✅ 发现更好的模型，已更新变量！
Epoch [65/100] - D Loss: 1.3782 - G Loss: 0.0226 - Val Loss: 0.0114
✅ 发现更好的模型，已更新变量！
Epoch [66/100] - D Loss: 1.3778 - G Loss: 0.0217 - Val Loss: 0.0108
✅ 发现更好的模型，已更新变量！
Epoch [67/100] - D Loss: 1.3776 - G Loss: 0.0208 - Val Loss: 0.0101
✅ 发现更好的模型，已更新变量！
Epoch [68/100] - D Loss: 1.3775 - G Loss: 0.0199 - Val Loss: 0.0094
✅ 发现更好的模型，已更新变量！
Epoch [69/100] - D Loss: 1.3779 - G Loss: 0.0188 - Val Loss: 0.0086
✅ 发现更好的模型，已更新变量！
Epoch [70/100] - D Loss: 1.3786 - G Loss: 0.0177 - Val Loss: 0.0080
✅ 发现更好的模型，已更新变量！
Epoch [71/100] - D Loss: 1.3796 - G Loss: 0.0166 - Val Loss: 0.0075
✅ 发现更好的模型，已更新变量！
2025-03-19 13:36:59,482 - INFO - Model constructed.
2025-03-19 13:37:11,334 - INFO - Detection started. Combined data duration: 10
2025-03-19 13:37:22,892 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 12
/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/Dynamtic_Feature_Extraction.py:45: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df['timestamp'] = pd.to_datetime(df['timestamp'], errors='coerce')
/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/Dynamtic_Feature_Extraction.py:46: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df['timestamp'] = df['timestamp'].astype('int64') // 10**9
2025-03-19 13:37:22,912 - INFO - extracted_data:    UniquePathsCount  TotalPathsCount  ...  StdPathDepth  UniquenessRatio
0                10               18  ...           0.0         0.555556

[1 rows x 12 columns]
2025-03-19 13:37:22,965 - INFO - A new detect record generated; Traffic data size: 18
2025-03-19 13:37:27,939 - INFO - Detection paused.
2025-03-19 13:37:32,977 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 12
/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/Dynamtic_Feature_Extraction.py:45: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df['timestamp'] = pd.to_datetime(df['timestamp'], errors='coerce')
/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/Dynamtic_Feature_Extraction.py:46: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df['timestamp'] = df['timestamp'].astype('int64') // 10**9
2025-03-19 13:37:32,991 - INFO - extracted_data:    UniquePathsCount  TotalPathsCount  ...  StdPathDepth  UniquenessRatio
0                 2                3  ...           0.0         0.666667

[1 rows x 12 columns]
2025-03-19 13:37:33,018 - INFO - A new detect record generated; Traffic data size: 3
 
 -------------- celery@VM-16-2-ubuntu v5.4.0 (opalescent)
--- ***** ----- 
-- ******* ---- Linux-5.15.0-130-generic-x86_64-with-glibc2.35 2025-03-19 13:51:26
- *** --- * --- 
- ** ---------- [config]
- ** ---------- .> app:         tasks:0x7fece485ebf0
- ** ---------- .> transport:   redis://localhost:6379/0
- ** ---------- .> results:     disabled://
- *** --- * --- .> concurrency: 2 (prefork)
-- ******* ---- .> task events: OFF (enable -E to monitor tasks in this worker)
--- ***** ----- 
 -------------- [queues]
                .> celery           exchange=celery(direct) key=celery
                

[tasks]
  . traffic_collector.consume_traffic_periodically

[2025-03-19 13:51:27,037: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

[2025-03-19 13:51:27,100: INFO/MainProcess] Connected to redis://localhost:6379/0
[2025-03-19 13:51:27,100: WARNING/MainProcess] /home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py:508: CPendingDeprecationWarning: The broker_connection_retry configuration setting will no longer determine
whether broker connection retries are made during startup in Celery 6.0 and above.
If you wish to retain the existing behavior for retrying connections on startup,
you should set broker_connection_retry_on_startup to True.
  warnings.warn(

[2025-03-19 13:51:27,102: INFO/MainProcess] mingle: searching for neighbors
[2025-03-19 13:51:28,106: INFO/MainProcess] mingle: all alone
[2025-03-19 13:51:28,113: INFO/MainProcess] celery@VM-16-2-ubuntu ready.
[2025-03-19 13:51:28,115: INFO/MainProcess] Task traffic_collector.consume_traffic_periodically[cd318ce7-59c8-40b7-88fd-be846df0ee16] received
2025-03-19 13:51:38,301 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-18 07:07:04', 'last_model_construction_at': '2025-03-19 05:36:59', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.6667, 1.0, 0.8, 10.0, 1.0, 0.1667, 0.2857, 6.0, 0.6875, 16.0, 0.8333, 0.5833, 0.5429, 16.0, 0.7917, 0.6875, 0.6071, 16.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-19 13:51:38,304 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 12
 * Serving Flask app 'app'
 * Debug mode: on
[2025-03-19 13:51:39,833: ERROR/MainProcess] Received unregistered task of type '__mitmproxy_script__.traffic_collector.consume_traffic_periodically'.
The message has been ignored and discarded.

Did you remember to import the module containing this task?
Or maybe you're using relative imports?

Please see
https://docs.celeryq.dev/en/latest/internals/protocol.html
for more information.

The full contents of the message body was:
b'[[], {}, {"callbacks": null, "errbacks": null, "chain": null, "chord": null}]' (77b)

The full contents of the message headers:
{'lang': 'py', 'task': '__mitmproxy_script__.traffic_collector.consume_traffic_periodically', 'id': 'c78f04ab-da64-466b-858a-ec2e729ceef3', 'shadow': None, 'eta': None, 'expires': None, 'group': None, 'group_index': None, 'retries': 0, 'timelimit': [None, None], 'root_id': 'c78f04ab-da64-466b-858a-ec2e729ceef3', 'parent_id': None, 'argsrepr': '()', 'kwargsrepr': '{}', 'origin': 'gen4708@VM-16-2-ubuntu', 'ignore_result': False, 'replaced_task_nesting': 0, 'stamped_headers': None, 'stamps': {}}

The delivery info for this task is:
{'exchange': '', 'routing_key': 'celery'}
Traceback (most recent call last):
  File "/home/ubuntu/.local/lib/python3.10/site-packages/celery/worker/consumer/consumer.py", line 659, in on_task_received
    strategy = strategies[type_]
KeyError: '__mitmproxy_script__.traffic_collector.consume_traffic_periodically'
2025-03-19 13:51:42,310 - INFO - Loading App: {'id': 1, 'APP_name': 'Updated Test App', 'APP_url': 'http://49.234.6.241:5230/', 'user_behavior_cycle': 1, 'SFWAP_address': '49.234.6.241:5000', 'description': 'This is an updated test application', 'created_at': '2025-02-26 04:03:44', 'updated_at': '2025-03-14 01:06:43', 'is_draft': False, 'last_API_discovery_at': '2025-03-18 07:07:04', 'last_model_construction_at': '2025-03-19 05:36:59', 'login_credentials': [{'user_role': 'admin', 'username': 'adminuser', 'password': 'adminpass'}, {'user_role': 'ordinary_user', 'username': 'normaluser', 'password': 'normalpass'}, {'user_role': 'unlogged_in_user', 'username': 'unloggeduser', 'password': 'normalpass'}], 'detect_state': 'PAUSED', 'model_report': [0.6667, 1.0, 0.8, 10.0, 1.0, 0.1667, 0.2857, 6.0, 0.6875, 16.0, 0.8333, 0.5833, 0.5429, 16.0, 0.7917, 0.6875, 0.6071, 16.0], 'enhanced_detection_enabled': True, 'combined_data_duration': 10}
2025-03-19 13:51:42,311 - INFO - Loaded target app: App_id: 1, Detect_state: PAUSED, Combined_data_duration: 10, Feature size: 12
2025-03-19 13:52:24,635 - INFO - Detection started. Combined data duration: 10
2025-03-19 13:52:38,174 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 12
/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/Dynamtic_Feature_Extraction.py:45: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df['timestamp'] = pd.to_datetime(df['timestamp'], errors='coerce')
/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/Dynamtic_Feature_Extraction.py:46: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df['timestamp'] = df['timestamp'].astype('int64') // 10**9
2025-03-19 13:52:38,228 - INFO - extracted_data:    UniquePathsCount  TotalPathsCount  ...  StdPathDepth  UniquenessRatio
0                 1                1  ...           0.0              1.0

[1 rows x 12 columns]
2025-03-19 13:52:38,418 - INFO - A new detect record generated; Traffic data size: 1
2025-03-19 13:52:48,526 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 12
/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/Dynamtic_Feature_Extraction.py:45: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df['timestamp'] = pd.to_datetime(df['timestamp'], errors='coerce')
/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/Dynamtic_Feature_Extraction.py:46: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df['timestamp'] = df['timestamp'].astype('int64') // 10**9
2025-03-19 13:52:48,543 - INFO - extracted_data:    UniquePathsCount  TotalPathsCount  ...  StdPathDepth  UniquenessRatio
0                10               11  ...      0.385695         0.909091

[1 rows x 12 columns]
2025-03-19 13:52:48,571 - INFO - A new detect record generated; Traffic data size: 11
2025-03-19 13:52:55,089 - INFO - Detection paused.
2025-03-19 13:52:58,584 - INFO - Detecting for a new traffic data sequence; Detect Feature Size: 12
/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/Dynamtic_Feature_Extraction.py:45: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df['timestamp'] = pd.to_datetime(df['timestamp'], errors='coerce')
/home/ubuntu/graduation-design/EnhancedAccessCtrl/EnhancedAccessCtrl/algorithm-side-interfaces/algorithm/Dynamtic_Feature_Extraction.py:46: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df['timestamp'] = df['timestamp'].astype('int64') // 10**9
2025-03-19 13:52:58,598 - INFO - extracted_data:    UniquePathsCount  TotalPathsCount  ...  StdPathDepth  UniquenessRatio
0                 2                2  ...           0.0              1.0

[1 rows x 12 columns]
2025-03-19 13:52:58,624 - INFO - A new detect record generated; Traffic data size: 2
